{
    "pdf_info": [
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        75,
                        109,
                        536,
                        149
                    ],
                    "lines": [
                        {
                            "bbox": [
                                75,
                                111,
                                536,
                                127
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        111,
                                        536,
                                        127
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Fast and Memory-Efficient Exact Attention",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                238,
                                132,
                                373,
                                149
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        238,
                                        132,
                                        373,
                                        149
                                    ],
                                    "score": 1.0,
                                    "content": "with IO-Awareness",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        163,
                        515,
                        247
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                162,
                                503,
                                179
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        162,
                                        148,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": "Tri Dao",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        165,
                                        154,
                                        176
                                    ],
                                    "score": 0.37,
                                    "content": "^\\dag",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        154,
                                        162,
                                        226,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", Daniel Y. Fu",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        227,
                                        165,
                                        231,
                                        176
                                    ],
                                    "score": 0.44,
                                    "content": "^\\dag",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        232,
                                        162,
                                        315,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", Stefano Ermon",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        315,
                                        165,
                                        320,
                                        176
                                    ],
                                    "score": 0.3,
                                    "content": "^\\dag",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        321,
                                        162,
                                        384,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", Atri Rudra",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        384,
                                        165,
                                        389,
                                        176
                                    ],
                                    "score": 0.41,
                                    "content": "\\ddagger",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        389,
                                        162,
                                        503,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", and Christopher Ré†",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                163,
                                187,
                                449,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        163,
                                        187,
                                        449,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "†Department of Computer Science, Stanford University",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                95,
                                201,
                                516,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        201,
                                        516,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "‡Department of Computer Science and Engineering, University at Buffalo, SUNY",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                108,
                                220,
                                509,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        220,
                                        509,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "{trid,danfu}@cs.stanford.edu, ermon@stanford.edu, atri@buffalo.edu,",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                231,
                                235,
                                381,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        231,
                                        235,
                                        381,
                                        247
                                    ],
                                    "score": 1.0,
                                    "content": "chrismre@cs.stanford.edu",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "text",
                    "bbox": [
                        270,
                        264,
                        341,
                        277
                    ],
                    "lines": [
                        {
                            "bbox": [
                                270,
                                265,
                                342,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        270,
                                        265,
                                        342,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "June 24, 2022",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "title",
                    "bbox": [
                        285,
                        301,
                        326,
                        311
                    ],
                    "lines": [
                        {
                            "bbox": [
                                285,
                                300,
                                327,
                                312
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        285,
                                        300,
                                        327,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "Abstract",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        315,
                        517,
                        501
                    ],
                    "lines": [
                        {
                            "bbox": [
                                109,
                                315,
                                516,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        315,
                                        516,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": "Transformers are slow and memory-hungry on long sequences, since the time and memory complexity",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                95,
                                326,
                                516,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        326,
                                        516,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "of self-attention are quadratic in sequence length. Approximate attention methods have attempted",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                95,
                                338,
                                516,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        338,
                                        516,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": "to address this problem by trading off model quality to reduce the compute complexity, but often do",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                95,
                                349,
                                516,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        349,
                                        501,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "not achieve wall-clock speedup. We argue that a missing principle is making attention algorithms ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        501,
                                        350,
                                        513,
                                        357
                                    ],
                                    "score": 0.68,
                                    "content": "_{I O}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        513,
                                        349,
                                        516,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "-",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                95,
                                360,
                                516,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        360,
                                        516,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "aware—accounting for reads and writes between levels of GPU memory. We propose FlashAttention,",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                95,
                                370,
                                516,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        370,
                                        516,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "an IO-aware exact attention algorithm that uses tiling to reduce the number of memory reads/writes",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                95,
                                381,
                                515,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        381,
                                        515,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "between GPU high bandwidth memory (HBM) and GPU on-chip SRAM. We analyze the IO complexity",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                95,
                                392,
                                516,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        392,
                                        516,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "of FlashAttention, showing that it requires fewer HBM accesses than standard attention, and is",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                95,
                                403,
                                516,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        403,
                                        516,
                                        414
                                    ],
                                    "score": 1.0,
                                    "content": "optimal for a range of SRAM sizes. We also extend FlashAttention to block-sparse attention, yielding",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                95,
                                414,
                                516,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        414,
                                        516,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "an approximate attention algorithm that is faster than any existing approximate attention method.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                95,
                                425,
                                516,
                                436
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        425,
                                        374,
                                        436
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention trains Transformers faster than existing baselines: ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        374,
                                        425,
                                        392,
                                        434
                                    ],
                                    "score": 0.78,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        393,
                                        425,
                                        516,
                                        436
                                    ],
                                    "score": 1.0,
                                    "content": " end-to-end wall-clock speedup",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                95,
                                436,
                                516,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        436,
                                        453,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "on BERT-large (seq. length 512) compared to the MLPerf 1.1 training speed record, ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        453,
                                        436,
                                        465,
                                        445
                                    ],
                                    "score": 0.67,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        465,
                                        436,
                                        516,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": " speedup on",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                95,
                                446,
                                516,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        446,
                                        215,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2 (seq. length 1K), and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        216,
                                        447,
                                        234,
                                        456
                                    ],
                                    "score": 0.72,
                                    "content": "2.4\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        234,
                                        446,
                                        516,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": " speedup on long-range arena (seq. length 1K-4K). FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                96,
                                459,
                                516,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        459,
                                        516,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "and block-sparse FlashAttention enable longer context in Transformers, yielding higher quality models",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                95,
                                469,
                                516,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        469,
                                        516,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "(0.7 better perplexity on GPT-2 and 6.4 points of lift on long-document classification) and entirely new",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                95,
                                480,
                                516,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        480,
                                        516,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "capabilities: the first Transformers to achieve better-than-chance performance on the Path-X challenge",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                94,
                                490,
                                434,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        490,
                                        166,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "(seq. length 16K,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        167,
                                        490,
                                        191,
                                        500
                                    ],
                                    "score": 0.56,
                                    "content": "61.4\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        192,
                                        490,
                                        365,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": " accuracy) and Path-256 (seq. length 64K, ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        365,
                                        490,
                                        390,
                                        500
                                    ],
                                    "score": 0.49,
                                    "content": "63.1\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        390,
                                        490,
                                        434,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": " accuracy).",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        518,
                        182,
                        534
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                521,
                                182,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        521,
                                        81,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        521,
                                        182,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "Introduction",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        543,
                        540,
                        615
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                543,
                                541,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        543,
                                        541,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "Transformer models [82] have emerged as the most widely used architecture in applications such as natural",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                69,
                                556,
                                542,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        556,
                                        542,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "language processing and image classification. Transformers have grown larger [5] and deeper [83], but",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                569,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        569,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "equipping them with longer context remains difficult [80], since the self-attention module at their heart",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                581,
                                540,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        581,
                                        540,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "has time and memory complexity quadratic in sequence length. An important question is whether making",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                540,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        540,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "attention faster and more memory-efficient can help Transformer models address their runtime and memory",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                604,
                                201,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        604,
                                        201,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "challenges for long sequences.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 29.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        616,
                        541,
                        687
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                617,
                                542,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        617,
                                        542,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "Many approximate attention methods have aimed to reduce the compute and memory requirements of",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                71,
                                628,
                                541,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        628,
                                        541,
                                        640
                                    ],
                                    "score": 1.0,
                                    "content": "attention. These methods range from sparse-approximation [51, 74] to low-rank approximation [12, 50, 84],",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                640,
                                540,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        640,
                                        540,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "and their combinations [3, 9, 92]. Although these methods reduce the compute requirements to linear or",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                652,
                                541,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        652,
                                        541,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": "near-linear in sequence length, many of them do not display wall-clock speedup against standard attention",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                663,
                                541,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        663,
                                        541,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "and have not gained wide adoption. One main reason is that they focus on FLOP reduction (which may not",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                676,
                                456,
                                688
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        676,
                                        456,
                                        688
                                    ],
                                    "score": 1.0,
                                    "content": "correlate with wall-clock speed) and tend to ignore overheads from memory access (IO).",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 35.5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        688,
                        541,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                688,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        688,
                                        443,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "In this paper, we argue that a missing principle is making attention algorithms ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        443,
                                        690,
                                        455,
                                        697
                                    ],
                                    "score": 0.34,
                                    "content": "I O",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        456,
                                        688,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "-aware [1]—that is,",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                699,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        699,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "carefully accounting for reads and writes to different levels of fast and slow memory (e.g., between fast GPU",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                712,
                                541,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        712,
                                        541,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "on-chip SRAM and relatively slow GPU high bandwidth memory, or HBM [45], Figure 1 left). On modern",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 40
                }
            ],
            "layout_bboxes": [],
            "page_idx": 0,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        14,
                        210,
                        38,
                        562
                    ],
                    "lines": [
                        {
                            "bbox": [
                                15,
                                211,
                                37,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        15,
                                        211,
                                        37,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2205.14135v2  [cs.LG]  23 Jun 2022",
                                    "type": "text",
                                    "height": 352,
                                    "width": 22
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        743,
                        308,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                310,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        310,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 13,
                                    "width": 9
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        75,
                        109,
                        536,
                        149
                    ],
                    "lines": [
                        {
                            "bbox": [
                                75,
                                111,
                                536,
                                127
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        111,
                                        536,
                                        127
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Fast and Memory-Efficient Exact Attention",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                238,
                                132,
                                373,
                                149
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        238,
                                        132,
                                        373,
                                        149
                                    ],
                                    "score": 1.0,
                                    "content": "with IO-Awareness",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        163,
                        515,
                        247
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                162,
                                503,
                                179
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        162,
                                        148,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": "Tri Dao",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        165,
                                        154,
                                        176
                                    ],
                                    "score": 0.37,
                                    "content": "^\\dag",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        154,
                                        162,
                                        226,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", Daniel Y. Fu",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        227,
                                        165,
                                        231,
                                        176
                                    ],
                                    "score": 0.44,
                                    "content": "^\\dag",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        232,
                                        162,
                                        315,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", Stefano Ermon",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        315,
                                        165,
                                        320,
                                        176
                                    ],
                                    "score": 0.3,
                                    "content": "^\\dag",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        321,
                                        162,
                                        384,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", Atri Rudra",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        384,
                                        165,
                                        389,
                                        176
                                    ],
                                    "score": 0.41,
                                    "content": "\\ddagger",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        389,
                                        162,
                                        503,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": ", and Christopher Ré†",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                163,
                                187,
                                449,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        163,
                                        187,
                                        449,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "†Department of Computer Science, Stanford University",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                95,
                                201,
                                516,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        201,
                                        516,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "‡Department of Computer Science and Engineering, University at Buffalo, SUNY",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                108,
                                220,
                                509,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        220,
                                        509,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "{trid,danfu}@cs.stanford.edu, ermon@stanford.edu, atri@buffalo.edu,",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                231,
                                235,
                                381,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        231,
                                        235,
                                        381,
                                        247
                                    ],
                                    "score": 1.0,
                                    "content": "chrismre@cs.stanford.edu",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 4,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        162,
                        516,
                        247
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        270,
                        264,
                        341,
                        277
                    ],
                    "lines": [
                        {
                            "bbox": [
                                270,
                                265,
                                342,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        270,
                                        265,
                                        342,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "June 24, 2022",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        270,
                        265,
                        342,
                        277
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        285,
                        301,
                        326,
                        311
                    ],
                    "lines": [
                        {
                            "bbox": [
                                285,
                                300,
                                327,
                                312
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        285,
                                        300,
                                        327,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "Abstract",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 8,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        315,
                        517,
                        501
                    ],
                    "lines": [
                        {
                            "bbox": [
                                109,
                                315,
                                516,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        315,
                                        516,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": "Transformers are slow and memory-hungry on long sequences, since the time and memory complexity",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                95,
                                326,
                                516,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        326,
                                        516,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "of self-attention are quadratic in sequence length. Approximate attention methods have attempted",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                95,
                                338,
                                516,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        338,
                                        516,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": "to address this problem by trading off model quality to reduce the compute complexity, but often do",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                95,
                                349,
                                516,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        349,
                                        501,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "not achieve wall-clock speedup. We argue that a missing principle is making attention algorithms ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        501,
                                        350,
                                        513,
                                        357
                                    ],
                                    "score": 0.68,
                                    "content": "_{I O}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        513,
                                        349,
                                        516,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "-",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                95,
                                360,
                                516,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        360,
                                        516,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "aware—accounting for reads and writes between levels of GPU memory. We propose FlashAttention,",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                95,
                                370,
                                516,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        370,
                                        516,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "an IO-aware exact attention algorithm that uses tiling to reduce the number of memory reads/writes",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                95,
                                381,
                                515,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        381,
                                        515,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "between GPU high bandwidth memory (HBM) and GPU on-chip SRAM. We analyze the IO complexity",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                95,
                                392,
                                516,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        392,
                                        516,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "of FlashAttention, showing that it requires fewer HBM accesses than standard attention, and is",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                95,
                                403,
                                516,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        403,
                                        516,
                                        414
                                    ],
                                    "score": 1.0,
                                    "content": "optimal for a range of SRAM sizes. We also extend FlashAttention to block-sparse attention, yielding",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                95,
                                414,
                                516,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        414,
                                        516,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "an approximate attention algorithm that is faster than any existing approximate attention method.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                95,
                                425,
                                516,
                                436
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        425,
                                        374,
                                        436
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention trains Transformers faster than existing baselines: ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        374,
                                        425,
                                        392,
                                        434
                                    ],
                                    "score": 0.78,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        393,
                                        425,
                                        516,
                                        436
                                    ],
                                    "score": 1.0,
                                    "content": " end-to-end wall-clock speedup",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                95,
                                436,
                                516,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        436,
                                        453,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "on BERT-large (seq. length 512) compared to the MLPerf 1.1 training speed record, ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        453,
                                        436,
                                        465,
                                        445
                                    ],
                                    "score": 0.67,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        465,
                                        436,
                                        516,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": " speedup on",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                95,
                                446,
                                516,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        446,
                                        215,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2 (seq. length 1K), and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        216,
                                        447,
                                        234,
                                        456
                                    ],
                                    "score": 0.72,
                                    "content": "2.4\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        234,
                                        446,
                                        516,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": " speedup on long-range arena (seq. length 1K-4K). FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                96,
                                459,
                                516,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        459,
                                        516,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "and block-sparse FlashAttention enable longer context in Transformers, yielding higher quality models",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                95,
                                469,
                                516,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        469,
                                        516,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "(0.7 better perplexity on GPT-2 and 6.4 points of lift on long-document classification) and entirely new",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                95,
                                480,
                                516,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        480,
                                        516,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "capabilities: the first Transformers to achieve better-than-chance performance on the Path-X challenge",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                94,
                                490,
                                434,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        490,
                                        166,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "(seq. length 16K,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        167,
                                        490,
                                        191,
                                        500
                                    ],
                                    "score": 0.56,
                                    "content": "61.4\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        192,
                                        490,
                                        365,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": " accuracy) and Path-256 (seq. length 64K, ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        365,
                                        490,
                                        390,
                                        500
                                    ],
                                    "score": 0.49,
                                    "content": "63.1\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        390,
                                        490,
                                        434,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": " accuracy).",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 17,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        94,
                        315,
                        516,
                        502
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        518,
                        182,
                        534
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                521,
                                182,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        521,
                                        81,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        521,
                                        182,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "Introduction",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        543,
                        540,
                        615
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                543,
                                541,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        543,
                                        541,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "Transformer models [82] have emerged as the most widely used architecture in applications such as natural",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                69,
                                556,
                                542,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        556,
                                        542,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "language processing and image classification. Transformers have grown larger [5] and deeper [83], but",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                569,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        569,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "equipping them with longer context remains difficult [80], since the self-attention module at their heart",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                581,
                                540,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        581,
                                        540,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "has time and memory complexity quadratic in sequence length. An important question is whether making",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                540,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        540,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "attention faster and more memory-efficient can help Transformer models address their runtime and memory",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                604,
                                201,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        604,
                                        201,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "challenges for long sequences.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 29.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        543,
                        542,
                        617
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        616,
                        541,
                        687
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                617,
                                542,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        617,
                                        542,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "Many approximate attention methods have aimed to reduce the compute and memory requirements of",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                71,
                                628,
                                541,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        628,
                                        541,
                                        640
                                    ],
                                    "score": 1.0,
                                    "content": "attention. These methods range from sparse-approximation [51, 74] to low-rank approximation [12, 50, 84],",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                640,
                                540,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        640,
                                        540,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "and their combinations [3, 9, 92]. Although these methods reduce the compute requirements to linear or",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                652,
                                541,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        652,
                                        541,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": "near-linear in sequence length, many of them do not display wall-clock speedup against standard attention",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                663,
                                541,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        663,
                                        541,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "and have not gained wide adoption. One main reason is that they focus on FLOP reduction (which may not",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                676,
                                456,
                                688
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        676,
                                        456,
                                        688
                                    ],
                                    "score": 1.0,
                                    "content": "correlate with wall-clock speed) and tend to ignore overheads from memory access (IO).",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 35.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        617,
                        542,
                        688
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        688,
                        541,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                688,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        688,
                                        443,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "In this paper, we argue that a missing principle is making attention algorithms ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        443,
                                        690,
                                        455,
                                        697
                                    ],
                                    "score": 0.34,
                                    "content": "I O",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        456,
                                        688,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "-aware [1]—that is,",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                699,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        699,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "carefully accounting for reads and writes to different levels of fast and slow memory (e.g., between fast GPU",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                712,
                                541,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        712,
                                        541,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "on-chip SRAM and relatively slow GPU high bandwidth memory, or HBM [45], Figure 1 left). On modern",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 40,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        688,
                        541,
                        724
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        106,
                        71,
                        505,
                        226
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                106,
                                71,
                                505,
                                226
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        106,
                                        71,
                                        505,
                                        226
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                106,
                                                71,
                                                505,
                                                226
                                            ],
                                            "score": 0.971,
                                            "type": "image",
                                            "image_path": "5d95be831fc52748eb3a51b9bfc58ea72fed2dcdb3b44fb0cc70dcdb8a926ca4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        106,
                                        71,
                                        505,
                                        122.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        106,
                                        122.66666666666666,
                                        505,
                                        174.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        106,
                                        174.33333333333331,
                                        505,
                                        225.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                236,
                                541,
                                320
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        237,
                                        541,
                                        248
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                237,
                                                438,
                                                248
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 1: Left: FlashAttention uses tiling to prevent materialization of the large",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                438,
                                                237,
                                                466,
                                                247
                                            ],
                                            "score": 0.9,
                                            "content": "N\\times N",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 28
                                        },
                                        {
                                            "bbox": [
                                                466,
                                                237,
                                                541,
                                                248
                                            ],
                                            "score": 1.0,
                                            "content": "attention matrix",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        248,
                                        540,
                                        260
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                248,
                                                540,
                                                260
                                            ],
                                            "score": 1.0,
                                            "content": "(dotted box) on (relatively) slow GPU HBM. In the outer loop (red arrows), FlashAttention loops through",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        261,
                                        541,
                                        273
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                261,
                                                131,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": "blocks of the ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                131,
                                                263,
                                                140,
                                                270
                                            ],
                                            "score": 0.77,
                                            "content": "\\mathbf{K}",
                                            "type": "inline_equation",
                                            "height": 7,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                140,
                                                261,
                                                162,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": " and ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                162,
                                                262,
                                                171,
                                                271
                                            ],
                                            "score": 0.29,
                                            "content": "\\mathbf{V}",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                171,
                                                261,
                                                541,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": " matrices and loads them to fast on-chip SRAM. In each block, FlashAttention",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        273,
                                        541,
                                        285
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                273,
                                                158,
                                                285
                                            ],
                                            "score": 1.0,
                                            "content": "loops over blocks of ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                159,
                                                275,
                                                167,
                                                284
                                            ],
                                            "score": 0.66,
                                            "content": "\\mathbf{Q}",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                167,
                                                273,
                                                541,
                                                285
                                            ],
                                            "score": 1.0,
                                            "content": " matrix (blue arrows), loading them to SRAM, and writing the output of the attention",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        285,
                                        542,
                                        297
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                285,
                                                542,
                                                297
                                            ],
                                            "score": 1.0,
                                            "content": "computation back to HBM. Right: Speedup over the PyTorch implementation of attention on GPT-2.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        70,
                                        296,
                                        540,
                                        308
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                296,
                                                305,
                                                308
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention does not read and write the large ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                305,
                                                299,
                                                332,
                                                306
                                            ],
                                            "score": 0.91,
                                            "content": "N\\times N",
                                            "type": "inline_equation",
                                            "height": 7,
                                            "width": 27
                                        },
                                        {
                                            "bbox": [
                                                333,
                                                296,
                                                520,
                                                308
                                            ],
                                            "score": 1.0,
                                            "content": "attention matrix to HBM, resulting in an ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                520,
                                                298,
                                                540,
                                                307
                                            ],
                                            "score": 0.59,
                                            "content": "7.6\\times",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 20
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        71,
                                        310,
                                        242,
                                        320
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                310,
                                                242,
                                                320
                                            ],
                                            "score": 1.0,
                                            "content": "speedup on the attention computation.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 3.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        341,
                        540,
                        413
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                342,
                                541,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        342,
                                        541,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "GPUs, compute speed has out-paced memory speed [61, 62, 63], and most operations in Transformers are",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                355,
                                540,
                                366
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        355,
                                        540,
                                        366
                                    ],
                                    "score": 1.0,
                                    "content": "bottlenecked by memory accesses [43]. IO-aware algorithms have been critical for similar memory-bound",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                366,
                                541,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        366,
                                        541,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "operations, when reading and writing data can account for a large portion of the runtime—such as database",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                378,
                                540,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        378,
                                        540,
                                        390
                                    ],
                                    "score": 1.0,
                                    "content": "joins [71], image processing [70], numerical linear algebra [4], and more [40, 85]. However, common Python",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                390,
                                540,
                                402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        390,
                                        540,
                                        402
                                    ],
                                    "score": 1.0,
                                    "content": "interfaces to deep learning such as PyTorch and Tensorflow do not allow fine-grained control of memory",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                404,
                                101,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        404,
                                        101,
                                        414
                                    ],
                                    "score": 1.0,
                                    "content": "access.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 12.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        414,
                        541,
                        556
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                414,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        414,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "We propose FlashAttention, a new attention algorithm that computes exact attention with far fewer",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                426,
                                542,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        426,
                                        542,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "memory accesses. Our main goal is to avoid reading and writing the attention matrix to and from HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                437,
                                541,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        437,
                                        541,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "This requires (i) computing the softmax reduction without access to the whole input (ii) not storing the large",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                450,
                                541,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        450,
                                        541,
                                        461
                                    ],
                                    "score": 1.0,
                                    "content": "intermediate attention matrix for the backward pass. We apply two well-established techniques to address",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                462,
                                540,
                                473
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        462,
                                        540,
                                        473
                                    ],
                                    "score": 1.0,
                                    "content": "these challenges. (i) We restructure the attention computation to split the input into blocks and make several",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                69,
                                474,
                                541,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        474,
                                        541,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "passes over input blocks, thus incrementally performing the softmax reduction (also known as tiling). (ii) We",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                486,
                                540,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        486,
                                        540,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "store the softmax normalization factor from the forward pass to quickly recompute attention on-chip in the",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                498,
                                541,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        498,
                                        541,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "backward pass, which is faster than the standard approach of reading the intermediate attention matrix from",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                509,
                                541,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        509,
                                        541,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "HBM. We implement FlashAttention in CUDA to achieve fine-grained control over memory access and",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                69,
                                521,
                                542,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        521,
                                        542,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "fuse all the attention operations into one GPU kernel. Even with the increased FLOPs due to recomputation,",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                534,
                                541,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        534,
                                        541,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "our algorithm both runs faster (up to 7.6x on GPT-2 [67], Figure 1 right) and uses less memory—linear",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                69,
                                545,
                                521,
                                558
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        545,
                                        521,
                                        558
                                    ],
                                    "score": 1.0,
                                    "content": "in sequence length—than standard attention, thanks to the massively reduced amount of HBM access.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 21.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        557,
                        541,
                        628
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                556,
                                542,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        556,
                                        454,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "We analyze the IO complexity [1] of FlashAttention, proving that it requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        454,
                                        558,
                                        511,
                                        569
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 57
                                },
                                {
                                    "bbox": [
                                        511,
                                        556,
                                        542,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": " HBM",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                569,
                                541,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        569,
                                        137,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "accesses where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        137,
                                        571,
                                        143,
                                        578
                                    ],
                                    "score": 0.9,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        143,
                                        569,
                                        261,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "is the head dimension and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        262,
                                        572,
                                        272,
                                        578
                                    ],
                                    "score": 0.83,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        272,
                                        569,
                                        435,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "is the size of SRAM, as compared to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        435,
                                        570,
                                        487,
                                        580
                                    ],
                                    "score": 0.92,
                                    "content": "\\Omega(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        487,
                                        569,
                                        541,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": " of standard",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                580,
                                541,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        580,
                                        218,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "attention. For typical values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        218,
                                        583,
                                        224,
                                        591
                                    ],
                                    "score": 0.88,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        225,
                                        580,
                                        248,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        249,
                                        584,
                                        259,
                                        591
                                    ],
                                    "score": 0.67,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        259,
                                        580,
                                        541,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": ", FlashAttention requires many times fewer HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                594,
                                541,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        594,
                                        244,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "compared to standard attention (up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        244,
                                        596,
                                        256,
                                        603
                                    ],
                                    "score": 0.31,
                                    "content": "9\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        257,
                                        594,
                                        541,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": " fewer, as shown in Fig. 2). Moreover, we provide a lower bound,",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                69,
                                604,
                                542,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        604,
                                        542,
                                        618
                                    ],
                                    "score": 1.0,
                                    "content": "showing that no exact attention algorithm can asymptotically improve on the number of HBM accesses over",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                618,
                                141,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        618,
                                        141,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "all SRAM sizes.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 30.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        629,
                        541,
                        701
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                629,
                                542,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        629,
                                        542,
                                        641
                                    ],
                                    "score": 1.0,
                                    "content": "We also show that FlashAttention can serve as a useful primitive for realizing the potential of",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                641,
                                542,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        641,
                                        542,
                                        653
                                    ],
                                    "score": 1.0,
                                    "content": "approximate attention algorithms by overcoming their issues with memory access overhead. As a proof of",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                653,
                                541,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        653,
                                        541,
                                        666
                                    ],
                                    "score": 1.0,
                                    "content": "concept, we implement block-sparse FlashAttention, a sparse attention algorithm that is 2-4× faster than",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                665,
                                541,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        665,
                                        541,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "even FlashAttention, scaling up to sequence length of 64k. We prove that block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                677,
                                541,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        677,
                                        541,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "has better IO complexity than FlashAttention by a factor proportional to the sparsity ratio. We discuss",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                690,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        690,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "further extensions to other operations (attention on multi-GPU, kernel regression, block-sparse matrix",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 36.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 1,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        106,
                        71,
                        505,
                        226
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                106,
                                71,
                                505,
                                226
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        106,
                                        71,
                                        505,
                                        226
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                106,
                                                71,
                                                505,
                                                226
                                            ],
                                            "score": 0.971,
                                            "type": "image",
                                            "image_path": "5d95be831fc52748eb3a51b9bfc58ea72fed2dcdb3b44fb0cc70dcdb8a926ca4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        106,
                                        71,
                                        505,
                                        122.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        106,
                                        122.66666666666666,
                                        505,
                                        174.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        106,
                                        174.33333333333331,
                                        505,
                                        225.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                236,
                                541,
                                320
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        237,
                                        541,
                                        248
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                237,
                                                438,
                                                248
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 1: Left: FlashAttention uses tiling to prevent materialization of the large",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                438,
                                                237,
                                                466,
                                                247
                                            ],
                                            "score": 0.9,
                                            "content": "N\\times N",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 28
                                        },
                                        {
                                            "bbox": [
                                                466,
                                                237,
                                                541,
                                                248
                                            ],
                                            "score": 1.0,
                                            "content": "attention matrix",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        248,
                                        540,
                                        260
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                248,
                                                540,
                                                260
                                            ],
                                            "score": 1.0,
                                            "content": "(dotted box) on (relatively) slow GPU HBM. In the outer loop (red arrows), FlashAttention loops through",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        261,
                                        541,
                                        273
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                261,
                                                131,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": "blocks of the ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                131,
                                                263,
                                                140,
                                                270
                                            ],
                                            "score": 0.77,
                                            "content": "\\mathbf{K}",
                                            "type": "inline_equation",
                                            "height": 7,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                140,
                                                261,
                                                162,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": " and ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                162,
                                                262,
                                                171,
                                                271
                                            ],
                                            "score": 0.29,
                                            "content": "\\mathbf{V}",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                171,
                                                261,
                                                541,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": " matrices and loads them to fast on-chip SRAM. In each block, FlashAttention",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        273,
                                        541,
                                        285
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                273,
                                                158,
                                                285
                                            ],
                                            "score": 1.0,
                                            "content": "loops over blocks of ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                159,
                                                275,
                                                167,
                                                284
                                            ],
                                            "score": 0.66,
                                            "content": "\\mathbf{Q}",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                167,
                                                273,
                                                541,
                                                285
                                            ],
                                            "score": 1.0,
                                            "content": " matrix (blue arrows), loading them to SRAM, and writing the output of the attention",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        285,
                                        542,
                                        297
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                285,
                                                542,
                                                297
                                            ],
                                            "score": 1.0,
                                            "content": "computation back to HBM. Right: Speedup over the PyTorch implementation of attention on GPT-2.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        70,
                                        296,
                                        540,
                                        308
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                296,
                                                305,
                                                308
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention does not read and write the large ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                305,
                                                299,
                                                332,
                                                306
                                            ],
                                            "score": 0.91,
                                            "content": "N\\times N",
                                            "type": "inline_equation",
                                            "height": 7,
                                            "width": 27
                                        },
                                        {
                                            "bbox": [
                                                333,
                                                296,
                                                520,
                                                308
                                            ],
                                            "score": 1.0,
                                            "content": "attention matrix to HBM, resulting in an ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                520,
                                                298,
                                                540,
                                                307
                                            ],
                                            "score": 0.59,
                                            "content": "7.6\\times",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 20
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        71,
                                        310,
                                        242,
                                        320
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                310,
                                                242,
                                                320
                                            ],
                                            "score": 1.0,
                                            "content": "speedup on the attention computation.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 3.5
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                310,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        310,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "2",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        106,
                        71,
                        505,
                        226
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                106,
                                71,
                                505,
                                226
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        106,
                                        71,
                                        505,
                                        226
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                106,
                                                71,
                                                505,
                                                226
                                            ],
                                            "score": 0.971,
                                            "type": "image",
                                            "image_path": "5d95be831fc52748eb3a51b9bfc58ea72fed2dcdb3b44fb0cc70dcdb8a926ca4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        106,
                                        71,
                                        505,
                                        122.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        106,
                                        122.66666666666666,
                                        505,
                                        174.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        106,
                                        174.33333333333331,
                                        505,
                                        225.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                236,
                                541,
                                320
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        237,
                                        541,
                                        248
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                237,
                                                438,
                                                248
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 1: Left: FlashAttention uses tiling to prevent materialization of the large",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                438,
                                                237,
                                                466,
                                                247
                                            ],
                                            "score": 0.9,
                                            "content": "N\\times N",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 28
                                        },
                                        {
                                            "bbox": [
                                                466,
                                                237,
                                                541,
                                                248
                                            ],
                                            "score": 1.0,
                                            "content": "attention matrix",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        248,
                                        540,
                                        260
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                248,
                                                540,
                                                260
                                            ],
                                            "score": 1.0,
                                            "content": "(dotted box) on (relatively) slow GPU HBM. In the outer loop (red arrows), FlashAttention loops through",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        261,
                                        541,
                                        273
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                261,
                                                131,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": "blocks of the ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                131,
                                                263,
                                                140,
                                                270
                                            ],
                                            "score": 0.77,
                                            "content": "\\mathbf{K}",
                                            "type": "inline_equation",
                                            "height": 7,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                140,
                                                261,
                                                162,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": " and ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                162,
                                                262,
                                                171,
                                                271
                                            ],
                                            "score": 0.29,
                                            "content": "\\mathbf{V}",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                171,
                                                261,
                                                541,
                                                273
                                            ],
                                            "score": 1.0,
                                            "content": " matrices and loads them to fast on-chip SRAM. In each block, FlashAttention",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        273,
                                        541,
                                        285
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                273,
                                                158,
                                                285
                                            ],
                                            "score": 1.0,
                                            "content": "loops over blocks of ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                159,
                                                275,
                                                167,
                                                284
                                            ],
                                            "score": 0.66,
                                            "content": "\\mathbf{Q}",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                167,
                                                273,
                                                541,
                                                285
                                            ],
                                            "score": 1.0,
                                            "content": " matrix (blue arrows), loading them to SRAM, and writing the output of the attention",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        285,
                                        542,
                                        297
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                285,
                                                542,
                                                297
                                            ],
                                            "score": 1.0,
                                            "content": "computation back to HBM. Right: Speedup over the PyTorch implementation of attention on GPT-2.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        70,
                                        296,
                                        540,
                                        308
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                296,
                                                305,
                                                308
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention does not read and write the large ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                305,
                                                299,
                                                332,
                                                306
                                            ],
                                            "score": 0.91,
                                            "content": "N\\times N",
                                            "type": "inline_equation",
                                            "height": 7,
                                            "width": 27
                                        },
                                        {
                                            "bbox": [
                                                333,
                                                296,
                                                520,
                                                308
                                            ],
                                            "score": 1.0,
                                            "content": "attention matrix to HBM, resulting in an ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                520,
                                                298,
                                                540,
                                                307
                                            ],
                                            "score": 0.59,
                                            "content": "7.6\\times",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 20
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        71,
                                        310,
                                        242,
                                        320
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                310,
                                                242,
                                                320
                                            ],
                                            "score": 1.0,
                                            "content": "speedup on the attention computation.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 3.5,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        341,
                        540,
                        413
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                342,
                                541,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        342,
                                        541,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "GPUs, compute speed has out-paced memory speed [61, 62, 63], and most operations in Transformers are",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                355,
                                540,
                                366
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        355,
                                        540,
                                        366
                                    ],
                                    "score": 1.0,
                                    "content": "bottlenecked by memory accesses [43]. IO-aware algorithms have been critical for similar memory-bound",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                366,
                                541,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        366,
                                        541,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "operations, when reading and writing data can account for a large portion of the runtime—such as database",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                378,
                                540,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        378,
                                        540,
                                        390
                                    ],
                                    "score": 1.0,
                                    "content": "joins [71], image processing [70], numerical linear algebra [4], and more [40, 85]. However, common Python",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                390,
                                540,
                                402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        390,
                                        540,
                                        402
                                    ],
                                    "score": 1.0,
                                    "content": "interfaces to deep learning such as PyTorch and Tensorflow do not allow fine-grained control of memory",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                404,
                                101,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        404,
                                        101,
                                        414
                                    ],
                                    "score": 1.0,
                                    "content": "access.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 12.5,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        342,
                        541,
                        414
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        414,
                        541,
                        556
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                414,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        414,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "We propose FlashAttention, a new attention algorithm that computes exact attention with far fewer",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                426,
                                542,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        426,
                                        542,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "memory accesses. Our main goal is to avoid reading and writing the attention matrix to and from HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                437,
                                541,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        437,
                                        541,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "This requires (i) computing the softmax reduction without access to the whole input (ii) not storing the large",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                450,
                                541,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        450,
                                        541,
                                        461
                                    ],
                                    "score": 1.0,
                                    "content": "intermediate attention matrix for the backward pass. We apply two well-established techniques to address",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                462,
                                540,
                                473
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        462,
                                        540,
                                        473
                                    ],
                                    "score": 1.0,
                                    "content": "these challenges. (i) We restructure the attention computation to split the input into blocks and make several",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                69,
                                474,
                                541,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        474,
                                        541,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "passes over input blocks, thus incrementally performing the softmax reduction (also known as tiling). (ii) We",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                486,
                                540,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        486,
                                        540,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "store the softmax normalization factor from the forward pass to quickly recompute attention on-chip in the",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                498,
                                541,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        498,
                                        541,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "backward pass, which is faster than the standard approach of reading the intermediate attention matrix from",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                509,
                                541,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        509,
                                        541,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "HBM. We implement FlashAttention in CUDA to achieve fine-grained control over memory access and",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                69,
                                521,
                                542,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        521,
                                        542,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "fuse all the attention operations into one GPU kernel. Even with the increased FLOPs due to recomputation,",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                534,
                                541,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        534,
                                        541,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "our algorithm both runs faster (up to 7.6x on GPT-2 [67], Figure 1 right) and uses less memory—linear",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                69,
                                545,
                                521,
                                558
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        545,
                                        521,
                                        558
                                    ],
                                    "score": 1.0,
                                    "content": "in sequence length—than standard attention, thanks to the massively reduced amount of HBM access.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 21.5,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        414,
                        542,
                        558
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        557,
                        541,
                        628
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                556,
                                542,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        556,
                                        454,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "We analyze the IO complexity [1] of FlashAttention, proving that it requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        454,
                                        558,
                                        511,
                                        569
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 57
                                },
                                {
                                    "bbox": [
                                        511,
                                        556,
                                        542,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": " HBM",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                569,
                                541,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        569,
                                        137,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "accesses where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        137,
                                        571,
                                        143,
                                        578
                                    ],
                                    "score": 0.9,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        143,
                                        569,
                                        261,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "is the head dimension and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        262,
                                        572,
                                        272,
                                        578
                                    ],
                                    "score": 0.83,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        272,
                                        569,
                                        435,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "is the size of SRAM, as compared to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        435,
                                        570,
                                        487,
                                        580
                                    ],
                                    "score": 0.92,
                                    "content": "\\Omega(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        487,
                                        569,
                                        541,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": " of standard",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                580,
                                541,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        580,
                                        218,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "attention. For typical values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        218,
                                        583,
                                        224,
                                        591
                                    ],
                                    "score": 0.88,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        225,
                                        580,
                                        248,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        249,
                                        584,
                                        259,
                                        591
                                    ],
                                    "score": 0.67,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        259,
                                        580,
                                        541,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": ", FlashAttention requires many times fewer HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                594,
                                541,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        594,
                                        244,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "compared to standard attention (up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        244,
                                        596,
                                        256,
                                        603
                                    ],
                                    "score": 0.31,
                                    "content": "9\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        257,
                                        594,
                                        541,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": " fewer, as shown in Fig. 2). Moreover, we provide a lower bound,",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                69,
                                604,
                                542,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        604,
                                        542,
                                        618
                                    ],
                                    "score": 1.0,
                                    "content": "showing that no exact attention algorithm can asymptotically improve on the number of HBM accesses over",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                618,
                                141,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        618,
                                        141,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "all SRAM sizes.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 30.5,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        556,
                        542,
                        628
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        629,
                        541,
                        701
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                629,
                                542,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        629,
                                        542,
                                        641
                                    ],
                                    "score": 1.0,
                                    "content": "We also show that FlashAttention can serve as a useful primitive for realizing the potential of",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                641,
                                542,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        641,
                                        542,
                                        653
                                    ],
                                    "score": 1.0,
                                    "content": "approximate attention algorithms by overcoming their issues with memory access overhead. As a proof of",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                653,
                                541,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        653,
                                        541,
                                        666
                                    ],
                                    "score": 1.0,
                                    "content": "concept, we implement block-sparse FlashAttention, a sparse attention algorithm that is 2-4× faster than",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                665,
                                541,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        665,
                                        541,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "even FlashAttention, scaling up to sequence length of 64k. We prove that block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                677,
                                541,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        677,
                                        541,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "has better IO complexity than FlashAttention by a factor proportional to the sparsity ratio. We discuss",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                690,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        690,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "further extensions to other operations (attention on multi-GPU, kernel regression, block-sparse matrix",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                73,
                                524,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        73,
                                        524,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "multiply) in Section 5. We open-source FlashAttention to make it easier to build on this primitive.1",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 36.5,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        629,
                        542,
                        700
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        73,
                        73,
                        524,
                        85
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                73,
                                524,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        73,
                                        524,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "multiply) in Section 5. We open-source FlashAttention to make it easier to build on this primitive.1",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        86,
                        541,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                86,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        86,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "We empirically validate that FlashAttention speeds up model training and improves model quality by",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                97,
                                541,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        97,
                                        541,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "modeling longer context. We also benchmark the runtime and memory footprint of FlashAttention and",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                109,
                                412,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        109,
                                        412,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "block-sparse FlashAttention compared to prior attention implementations.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        119,
                        547,
                        333
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                122,
                                541,
                                133
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        122,
                                        541,
                                        133
                                    ],
                                    "score": 1.0,
                                    "content": "• Faster Model Training. FlashAttention trains Transformer models faster in wall-clock time. We",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                79,
                                133,
                                541,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        133,
                                        238,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "train BERT-large (seq. length 512) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        239,
                                        135,
                                        258,
                                        144
                                    ],
                                    "score": 0.56,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        258,
                                        133,
                                        541,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": " faster than the training speed record in MLPerf 1.1 [58], GPT2",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                80,
                                146,
                                541,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        146,
                                        155,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": "(seq. length 1K) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        155,
                                        148,
                                        167,
                                        155
                                    ],
                                    "score": 0.62,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        167,
                                        146,
                                        541,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": " faster than baseline implementations from HuggingFace [87] and Megatron-LM [77],",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                79,
                                158,
                                383,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        158,
                                        383,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "and long-range arena (seq. length 1K-4K) 2.4× faster than baselines.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                72,
                                173,
                                541,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        173,
                                        541,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "• Higher Quality Models. FlashAttention scales Transformers to longer sequences, which improves",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                80,
                                185,
                                542,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        185,
                                        542,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "their quality and enables new capabilities. We observe a 0.7 improvement in perplexity on GPT-2 and",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                80,
                                198,
                                541,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        198,
                                        541,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "6.4 points of lift from modeling longer sequences on long-document classification [13]. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                79,
                                208,
                                542,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        208,
                                        542,
                                        222
                                    ],
                                    "score": 1.0,
                                    "content": "enables the first Transformer that can achieve better-than-chance performance on the Path-X [80] challenge,",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                80,
                                222,
                                541,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        222,
                                        541,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "solely from using a longer sequence length (16K). Block-sparse FlashAttention enables a Transformer",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                80,
                                234,
                                541,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        234,
                                        541,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "to scale to even longer sequences (64K), resulting in the first model that can achieve better-than-chance",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                79,
                                246,
                                196,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        246,
                                        196,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "performance on Path-256.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                72,
                                261,
                                541,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        261,
                                        331,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "• Benchmarking Attention. FlashAttention is up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        332,
                                        264,
                                        344,
                                        271
                                    ],
                                    "score": 0.35,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        344,
                                        261,
                                        541,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": " faster than the standard attention implemen-",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                80,
                                274,
                                541,
                                285
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        274,
                                        541,
                                        285
                                    ],
                                    "score": 1.0,
                                    "content": "tation across common sequence lengths from 128 to 2K and scales up to 64K. Up to sequence length of 512,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                80,
                                285,
                                541,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        285,
                                        541,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention is both faster and more memory-efficient than any existing attention method, whereas",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                81,
                                298,
                                541,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        298,
                                        541,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "for sequence length beyond 1K, some approximate attention methods (e.g., Linformer) start to become",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                79,
                                308,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        308,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "faster. On the other hand, block-sparse FlashAttention is faster than all existing approximate attention",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                81,
                                322,
                                195,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        322,
                                        195,
                                        332
                                    ],
                                    "score": 1.0,
                                    "content": "methods that we know of.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 12
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        349,
                        178,
                        366
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                352,
                                178,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        352,
                                        82,
                                        364
                                    ],
                                    "score": 1.0,
                                    "content": "2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        91,
                                        352,
                                        178,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "Background",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 21
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        375,
                        541,
                        399
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                376,
                                541,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        376,
                                        541,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "We provide some background on the performance characteristics of common deep learning operations on",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                388,
                                452,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        388,
                                        452,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "modern hardware (GPUs). We also describe the standard implementation of attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 22.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        413,
                        239,
                        427
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                414,
                                239,
                                427
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        414,
                                        91,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "2.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        414,
                                        239,
                                        426
                                    ],
                                    "score": 1.0,
                                    "content": "Hardware Performance",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        433,
                        463,
                        445
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                433,
                                462,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        433,
                                        462,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "We focus here on GPUs. Performance on other hardware accelerators are similar [46, 48].",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 25
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        446,
                        541,
                        528
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                444,
                                542,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        444,
                                        542,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "GPU Memory Hierarchy. The GPU memory hierarchy (Fig. 1 left) comprises multiple forms of",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                69,
                                459,
                                541,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        459,
                                        541,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "memory of different sizes and speeds, with smaller memory being faster. As an example, the A100 GPU",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                69,
                                469,
                                541,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        469,
                                        541,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "has 40-80GB of high bandwidth memory (HBM) with bandwidth 1.5-2.0TB/s and 192KB of on-chip SRAM",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                482,
                                541,
                                494
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        482,
                                        541,
                                        494
                                    ],
                                    "score": 1.0,
                                    "content": "per each of 108 streaming multiprocessors with bandwidth estimated around 19TB/s [44, 45]. The on-chip",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                494,
                                541,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        494,
                                        541,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "SRAM is an order of magnitude faster than HBM but many orders of magnitude smaller in size. As compute",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                506,
                                541,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        506,
                                        541,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "has gotten faster relative to memory speed [61, 62, 63], operations are increasingly bottlenecked by memory",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                518,
                                383,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        518,
                                        383,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "(HBM) accesses. Thus exploiting fast SRAM becomes more important.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        529,
                        540,
                        553
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                529,
                                540,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        529,
                                        540,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "Execution Model. GPUs have a massive number of threads to execute an operation (called a kernel).",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                73,
                                541,
                                514,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        541,
                                        514,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "Each kernel loads inputs from HBM to registers and SRAM, computes, then writes outputs to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 33.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        552,
                        543,
                        665
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                553,
                                539,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        553,
                                        539,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "Performance characteristics. Depending on the balance of computation and memory accesses, op-",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                565,
                                539,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        565,
                                        539,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "erations can be classified as either compute-bound or memory-bound. This is commonly measured by the",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                578,
                                501,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        578,
                                        501,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "arithmetic intensity [85], which is the number of arithmetic operations per byte of memory access.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                590,
                                540,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        540,
                                        602
                                    ],
                                    "score": 1.0,
                                    "content": "1. Compute-bound: the time taken by the operation is determined by how many arithmetic operations there",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                82,
                                602,
                                540,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        602,
                                        540,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "are, while time accessing HBM is much smaller. Typical examples are matrix multiply with large inner",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                83,
                                614,
                                341,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        614,
                                        341,
                                        624
                                    ],
                                    "score": 1.0,
                                    "content": "dimension, and convolution with large number of channels.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                629,
                                541,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        629,
                                        541,
                                        641
                                    ],
                                    "score": 1.0,
                                    "content": "2. Memory-bound: the time taken by the operation is determined by the number of memory accesses, while",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                83,
                                640,
                                538,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        640,
                                        538,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "time spent in computation is much smaller. Examples include most other operations: elementwise (e.g.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                83,
                                654,
                                441,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        654,
                                        441,
                                        665
                                    ],
                                    "score": 1.0,
                                    "content": "activation, dropout), and reduction (e.g., sum, softmax, batch norm, layer norm).",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        }
                    ],
                    "index": 39
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        666,
                        542,
                        701
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                664,
                                542,
                                678
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        664,
                                        542,
                                        678
                                    ],
                                    "score": 1.0,
                                    "content": "Kernel fusion. The most common approach to accelerate memory-bound operations is kernel fusion: if",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                71,
                                677,
                                542,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        677,
                                        542,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "there are multiple operations applied to the same input, the input can be loaded once from HBM, instead of",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                70,
                                689,
                                542,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        689,
                                        542,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "multiple times for each operation. Compilers can automatically fuse many elementwise operations [53, 65, 75].",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 45
                }
            ],
            "layout_bboxes": [],
            "page_idx": 2,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        81,
                        708,
                        431,
                        719
                    ],
                    "lines": [
                        {
                            "bbox": [
                                81,
                                707,
                                431,
                                720
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        707,
                                        431,
                                        720
                                    ],
                                    "score": 1.0,
                                    "content": "1FlashAttention code is available at https://github.com/HazyResearch/flash-attention",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                300,
                                741,
                                311,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        300,
                                        741,
                                        311,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 13,
                                    "width": 11
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        73,
                        73,
                        524,
                        85
                    ],
                    "lines": [],
                    "index": 0,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        73,
                        524,
                        85
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        86,
                        541,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                86,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        86,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "We empirically validate that FlashAttention speeds up model training and improves model quality by",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                97,
                                541,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        97,
                                        541,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "modeling longer context. We also benchmark the runtime and memory footprint of FlashAttention and",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                109,
                                412,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        109,
                                        412,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "block-sparse FlashAttention compared to prior attention implementations.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        86,
                        541,
                        122
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        69,
                        119,
                        547,
                        333
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                122,
                                541,
                                133
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        122,
                                        541,
                                        133
                                    ],
                                    "score": 1.0,
                                    "content": "• Faster Model Training. FlashAttention trains Transformer models faster in wall-clock time. We",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                133,
                                541,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        133,
                                        238,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "train BERT-large (seq. length 512) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        239,
                                        135,
                                        258,
                                        144
                                    ],
                                    "score": 0.56,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        258,
                                        133,
                                        541,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": " faster than the training speed record in MLPerf 1.1 [58], GPT2",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                80,
                                146,
                                541,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        146,
                                        155,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": "(seq. length 1K) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        155,
                                        148,
                                        167,
                                        155
                                    ],
                                    "score": 0.62,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        167,
                                        146,
                                        541,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": " faster than baseline implementations from HuggingFace [87] and Megatron-LM [77],",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                79,
                                158,
                                383,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        158,
                                        383,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "and long-range arena (seq. length 1K-4K) 2.4× faster than baselines.",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                173,
                                541,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        173,
                                        541,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "• Higher Quality Models. FlashAttention scales Transformers to longer sequences, which improves",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                185,
                                542,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        185,
                                        542,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "their quality and enables new capabilities. We observe a 0.7 improvement in perplexity on GPT-2 and",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                80,
                                198,
                                541,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        198,
                                        541,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "6.4 points of lift from modeling longer sequences on long-document classification [13]. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                79,
                                208,
                                542,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        208,
                                        542,
                                        222
                                    ],
                                    "score": 1.0,
                                    "content": "enables the first Transformer that can achieve better-than-chance performance on the Path-X [80] challenge,",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                80,
                                222,
                                541,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        222,
                                        541,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "solely from using a longer sequence length (16K). Block-sparse FlashAttention enables a Transformer",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                80,
                                234,
                                541,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        234,
                                        541,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "to scale to even longer sequences (64K), resulting in the first model that can achieve better-than-chance",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                79,
                                246,
                                196,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        246,
                                        196,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "performance on Path-256.",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                261,
                                541,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        261,
                                        331,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "• Benchmarking Attention. FlashAttention is up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        332,
                                        264,
                                        344,
                                        271
                                    ],
                                    "score": 0.35,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        344,
                                        261,
                                        541,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": " faster than the standard attention implemen-",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                274,
                                541,
                                285
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        274,
                                        541,
                                        285
                                    ],
                                    "score": 1.0,
                                    "content": "tation across common sequence lengths from 128 to 2K and scales up to 64K. Up to sequence length of 512,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                80,
                                285,
                                541,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        285,
                                        541,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention is both faster and more memory-efficient than any existing attention method, whereas",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                81,
                                298,
                                541,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        298,
                                        541,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "for sequence length beyond 1K, some approximate attention methods (e.g., Linformer) start to become",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                79,
                                308,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        308,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "faster. On the other hand, block-sparse FlashAttention is faster than all existing approximate attention",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                81,
                                322,
                                195,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        322,
                                        195,
                                        332
                                    ],
                                    "score": 1.0,
                                    "content": "methods that we know of.",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 12,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        122,
                        542,
                        332
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        349,
                        178,
                        366
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                352,
                                178,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        352,
                                        82,
                                        364
                                    ],
                                    "score": 1.0,
                                    "content": "2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        91,
                                        352,
                                        178,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "Background",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 21,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        375,
                        541,
                        399
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                376,
                                541,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        376,
                                        541,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "We provide some background on the performance characteristics of common deep learning operations on",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                388,
                                452,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        388,
                                        452,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "modern hardware (GPUs). We also describe the standard implementation of attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 22.5,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        376,
                        541,
                        399
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        413,
                        239,
                        427
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                414,
                                239,
                                427
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        414,
                                        91,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "2.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        414,
                                        239,
                                        426
                                    ],
                                    "score": 1.0,
                                    "content": "Hardware Performance",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        433,
                        463,
                        445
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                433,
                                462,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        433,
                                        462,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "We focus here on GPUs. Performance on other hardware accelerators are similar [46, 48].",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 25,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        433,
                        462,
                        446
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        446,
                        541,
                        528
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                444,
                                542,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        444,
                                        542,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "GPU Memory Hierarchy. The GPU memory hierarchy (Fig. 1 left) comprises multiple forms of",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                69,
                                459,
                                541,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        459,
                                        541,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "memory of different sizes and speeds, with smaller memory being faster. As an example, the A100 GPU",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                69,
                                469,
                                541,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        469,
                                        541,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "has 40-80GB of high bandwidth memory (HBM) with bandwidth 1.5-2.0TB/s and 192KB of on-chip SRAM",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                482,
                                541,
                                494
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        482,
                                        541,
                                        494
                                    ],
                                    "score": 1.0,
                                    "content": "per each of 108 streaming multiprocessors with bandwidth estimated around 19TB/s [44, 45]. The on-chip",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                494,
                                541,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        494,
                                        541,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "SRAM is an order of magnitude faster than HBM but many orders of magnitude smaller in size. As compute",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                506,
                                541,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        506,
                                        541,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "has gotten faster relative to memory speed [61, 62, 63], operations are increasingly bottlenecked by memory",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                518,
                                383,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        518,
                                        383,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "(HBM) accesses. Thus exploiting fast SRAM becomes more important.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 29,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        444,
                        542,
                        529
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        529,
                        540,
                        553
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                529,
                                540,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        529,
                                        540,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "Execution Model. GPUs have a massive number of threads to execute an operation (called a kernel).",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                73,
                                541,
                                514,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        541,
                                        514,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "Each kernel loads inputs from HBM to registers and SRAM, computes, then writes outputs to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 33.5,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        73,
                        529,
                        540,
                        553
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        552,
                        543,
                        665
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                553,
                                539,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        553,
                                        539,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "Performance characteristics. Depending on the balance of computation and memory accesses, op-",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                565,
                                539,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        565,
                                        539,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "erations can be classified as either compute-bound or memory-bound. This is commonly measured by the",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                578,
                                501,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        578,
                                        501,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "arithmetic intensity [85], which is the number of arithmetic operations per byte of memory access.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                590,
                                540,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        540,
                                        602
                                    ],
                                    "score": 1.0,
                                    "content": "1. Compute-bound: the time taken by the operation is determined by how many arithmetic operations there",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                82,
                                602,
                                540,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        602,
                                        540,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "are, while time accessing HBM is much smaller. Typical examples are matrix multiply with large inner",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                83,
                                614,
                                341,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        614,
                                        341,
                                        624
                                    ],
                                    "score": 1.0,
                                    "content": "dimension, and convolution with large number of channels.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                629,
                                541,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        629,
                                        541,
                                        641
                                    ],
                                    "score": 1.0,
                                    "content": "2. Memory-bound: the time taken by the operation is determined by the number of memory accesses, while",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                83,
                                640,
                                538,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        640,
                                        538,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "time spent in computation is much smaller. Examples include most other operations: elementwise (e.g.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                83,
                                654,
                                441,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        654,
                                        441,
                                        665
                                    ],
                                    "score": 1.0,
                                    "content": "activation, dropout), and reduction (e.g., sum, softmax, batch norm, layer norm).",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        }
                    ],
                    "index": 39,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        553,
                        541,
                        665
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        666,
                        542,
                        701
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                664,
                                542,
                                678
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        664,
                                        542,
                                        678
                                    ],
                                    "score": 1.0,
                                    "content": "Kernel fusion. The most common approach to accelerate memory-bound operations is kernel fusion: if",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                71,
                                677,
                                542,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        677,
                                        542,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "there are multiple operations applied to the same input, the input can be loaded once from HBM, instead of",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                70,
                                689,
                                542,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        689,
                                        542,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "multiple times for each operation. Compilers can automatically fuse many elementwise operations [53, 65, 75].",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 45,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        664,
                        542,
                        702
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        73,
                        73,
                        541,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                74,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "However, in the context of model training, the intermediate values still need to be written to HBM to save",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                72,
                                86,
                                383,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        86,
                                        383,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "for the backward pass, reducing the effectiveness of naive kernel fusion.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        111,
                        315,
                        125
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                112,
                                314,
                                125
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        112,
                                        91,
                                        125
                                    ],
                                    "score": 1.0,
                                    "content": "2.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        113,
                                        314,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "Standard Attention Implementation",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        131,
                        541,
                        155
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                129,
                                542,
                                145
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        129,
                                        170,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "Given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        132,
                                        237,
                                        143
                                    ],
                                    "score": 0.92,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        237,
                                        129,
                                        268,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        268,
                                        135,
                                        276,
                                        141
                                    ],
                                    "score": 0.9,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        277,
                                        129,
                                        396,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "is the sequence length and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        396,
                                        134,
                                        402,
                                        141
                                    ],
                                    "score": 0.89,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        402,
                                        129,
                                        542,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "is the head dimension, we want",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                69,
                                144,
                                265,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        144,
                                        216,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": "to compute the attention output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        217,
                                        144,
                                        259,
                                        153
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        259,
                                        144,
                                        265,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": ":",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        165,
                        165,
                        444,
                        177
                    ],
                    "lines": [
                        {
                            "bbox": [
                                165,
                                165,
                                444,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        165,
                                        165,
                                        444,
                                        177
                                    ],
                                    "score": 0.86,
                                    "content": "\\begin{array}{r}{\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\operatorname{softmax}(\\mathbf{S})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                165,
                                165,
                                444,
                                177
                            ],
                            "spans": [],
                            "index": 5
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        187,
                        223,
                        199
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                188,
                                223,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        188,
                                        223,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "where softmax is applied row-wise.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 6
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        199,
                        541,
                        246
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                198,
                                542,
                                213
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        198,
                                        346,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": "Standard attention implementations materialize the matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        347,
                                        202,
                                        352,
                                        209
                                    ],
                                    "score": 0.26,
                                    "content": "\\mathbf{s}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        353,
                                        198,
                                        372,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": " and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        373,
                                        202,
                                        380,
                                        209
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        380,
                                        198,
                                        474,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM, which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        474,
                                        200,
                                        502,
                                        211
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        502,
                                        198,
                                        542,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": " memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                212,
                                541,
                                223
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        212,
                                        99,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "Often",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        214,
                                        129,
                                        221
                                    ],
                                    "score": 0.91,
                                    "content": "N\\gg d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        129,
                                        212,
                                        206,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "(e.g., for GPT2,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        207,
                                        214,
                                        247,
                                        221
                                    ],
                                    "score": 0.9,
                                    "content": "N=1024",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 40
                                },
                                {
                                    "bbox": [
                                        248,
                                        212,
                                        270,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        270,
                                        214,
                                        298,
                                        221
                                    ],
                                    "score": 0.9,
                                    "content": "d=64",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        298,
                                        212,
                                        541,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "). We describe the standard attention implementation",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                224,
                                541,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        224,
                                        541,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "in Algorithm 0. As some or most of the operations are memory-bound (e.g., softmax), the large number of",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                237,
                                296,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        237,
                                        296,
                                        247
                                    ],
                                    "score": 1.0,
                                    "content": "memory accesses translates to slow wall-clock time.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        248,
                        541,
                        282
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                247,
                                541,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        247,
                                        541,
                                        259
                                    ],
                                    "score": 1.0,
                                    "content": "This problem is exacerbated by other elementwise operations applied to the attention matrix, such as",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                259,
                                541,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        259,
                                        265,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "masking applied to S or dropout applied to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        266,
                                        262,
                                        272,
                                        269
                                    ],
                                    "score": 0.72,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        273,
                                        259,
                                        541,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": ". As a result, there have been many attempts to fuse several",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                272,
                                359,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        272,
                                        359,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "elementwise operations, such as fusing masking with softmax [77].",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 12
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        283,
                        542,
                        319
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                282,
                                541,
                                295
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        282,
                                        541,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": "In Section 3.2, we will show that the standard attention implementation performs HBM accesses quadratic",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                295,
                                541,
                                308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        295,
                                        170,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": "in the sequence length ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        298,
                                        179,
                                        305
                                    ],
                                    "score": 0.83,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        179,
                                        295,
                                        541,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": ". We also compare the number of FLOPs and number of HBM accesses of standard",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                308,
                                290,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        308,
                                        290,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "attention and of our method (FlashAttention).",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        327,
                        282,
                        339
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                328,
                                282,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        328,
                                        282,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 0 Standard Attention Implementation",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        344,
                        266,
                        355
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                343,
                                268,
                                356
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        343,
                                        159,
                                        356
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        160,
                                        345,
                                        226,
                                        356
                                    ],
                                    "score": 0.86,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        226,
                                        343,
                                        268,
                                        356
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        355,
                        407,
                        404
                    ],
                    "lines": [
                        {
                            "bbox": [
                                76,
                                357,
                                391,
                                368
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        357,
                                        113,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": "1: Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        358,
                                        133,
                                        368
                                    ],
                                    "score": 0.81,
                                    "content": "\\mathbf{Q},\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        133,
                                        357,
                                        273,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        273,
                                        357,
                                        312,
                                        367
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 39
                                },
                                {
                                    "bbox": [
                                        312,
                                        357,
                                        391,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": ", write S to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                76,
                                369,
                                363,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        369,
                                        314,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "2: Read S from HBM, compute P = softmax S , write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        314,
                                        370,
                                        321,
                                        378
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        321,
                                        369,
                                        363,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                76,
                                381,
                                407,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        381,
                                        113,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "3: Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        382,
                                        120,
                                        390
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        120,
                                        381,
                                        142,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        142,
                                        382,
                                        151,
                                        390
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        151,
                                        381,
                                        291,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        291,
                                        382,
                                        325,
                                        390
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{0}=\\mathbf{PV}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        325,
                                        381,
                                        356,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": ", write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        356,
                                        382,
                                        364,
                                        390
                                    ],
                                    "score": 0.44,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        365,
                                        381,
                                        407,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                75,
                                392,
                                134,
                                402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        392,
                                        134,
                                        402
                                    ],
                                    "score": 1.0,
                                    "content": "4: Return O.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        427,
                        484,
                        444
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                429,
                                485,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        430,
                                        82,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        429,
                                        485,
                                        443
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Algorithm, Analysis, and Extensions",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 23
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        452,
                        541,
                        512
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                453,
                                541,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        453,
                                        541,
                                        465
                                    ],
                                    "score": 1.0,
                                    "content": "We show how to compute exact attention with fewer HBM reads/writes and without storing large intermediate",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                465,
                                541,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        465,
                                        541,
                                        477
                                    ],
                                    "score": 1.0,
                                    "content": "matrices for the backward pass. This yields an attention algorithm that is both memory efficient and faster in",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                541,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        541,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "wall-clock time. We analyze its IO complexity, showing that our method requires much fewer HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                490,
                                541,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        490,
                                        541,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "compared to standard attention. We further show that FlashAttention can serve as a useful primitive by",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                501,
                                271,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        501,
                                        271,
                                        513
                                    ],
                                    "score": 1.0,
                                    "content": "extending it to handle block-sparse attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "text",
                    "bbox": [
                        78,
                        512,
                        542,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                512,
                                542,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        512,
                                        542,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "We focus here on the forward pass for ease of exposition; Appendix B contains details for the backward.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "title",
                    "bbox": [
                        73,
                        538,
                        494,
                        553
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                538,
                                493,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        538,
                                        91,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "3.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        540,
                                        493,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "An Efficient Attention Algorithm With Tiling and Recomputation",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        559,
                        541,
                        582
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                557,
                                542,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        557,
                                        146,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "Given the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        146,
                                        560,
                                        212,
                                        570
                                    ],
                                    "score": 0.81,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        213,
                                        557,
                                        431,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, we aim to compute the attention output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        432,
                                        560,
                                        474,
                                        569
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        474,
                                        557,
                                        542,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "and write it to",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                572,
                                431,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        572,
                                        416,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": "HBM. Our goal is to reduce the amount of HBM accesses (to sub-quadratic in ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        416,
                                        574,
                                        424,
                                        581
                                    ],
                                    "score": 0.87,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        425,
                                        572,
                                        431,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": ").",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 31.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        583,
                        541,
                        642
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                583,
                                541,
                                594
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        583,
                                        541,
                                        594
                                    ],
                                    "score": 1.0,
                                    "content": "We apply two established techniques (tiling, recomputation) to overcome the technical challenge of",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                596,
                                541,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        596,
                                        541,
                                        607
                                    ],
                                    "score": 1.0,
                                    "content": "computing exact attention in sub-quadratic HBM accesses. We describe this in Algorithm 1. The main idea",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        187,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "is that we split the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        609,
                                        219,
                                        618
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        219,
                                        608,
                                        541,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": " into blocks, load them from slow HBM to fast SRAM, then compute the",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                620,
                                541,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        620,
                                        541,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "attention output with respect to those blocks. By scaling the output of each block by the right normalization",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                632,
                                363,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        632,
                                        363,
                                        643
                                    ],
                                    "score": 1.0,
                                    "content": "factor before adding them up, we get the correct result at the end.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 35
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        642,
                        540,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                642,
                                541,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        642,
                                        406,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "Tiling. We compute attention by blocks. Softmax couples columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        406,
                                        645,
                                        414,
                                        652
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        415,
                                        642,
                                        541,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": ", so we decompose the large",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                654,
                                526,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        654,
                                        423,
                                        666
                                    ],
                                    "score": 1.0,
                                    "content": "softmax with scaling [51, 60, 66]. For numerical stability, the softmax of vector",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        423,
                                        655,
                                        453,
                                        664
                                    ],
                                    "score": 0.93,
                                    "content": "\\boldsymbol{x}\\in\\mathbb{R}^{B}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        453,
                                        654,
                                        526,
                                        666
                                    ],
                                    "score": 1.0,
                                    "content": "is computed as:",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 38.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        111,
                        677,
                        513,
                        704
                    ],
                    "lines": [
                        {
                            "bbox": [
                                111,
                                677,
                                513,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        111,
                                        677,
                                        513,
                                        704
                                    ],
                                    "score": 0.85,
                                    "content": "x):=\\operatorname*{max}_{i}\\quad x_{i},\\quad f(x):=\\left[e^{x_{1}-m(x)}\\quad\\ldots\\quad e^{x_{B}-m(x)}\\right],\\quad\\ell(x):=\\sum_{i}f(x)_{i},\\quad\\mathrm{softmax}(x):=\\frac{f(x)}{\\ell(x)}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 41,
                    "virtual_lines": [
                        {
                            "bbox": [
                                111,
                                677,
                                513,
                                686.0
                            ],
                            "spans": [],
                            "index": 40
                        },
                        {
                            "bbox": [
                                111,
                                686.0,
                                513,
                                695.0
                            ],
                            "spans": [],
                            "index": 41
                        },
                        {
                            "bbox": [
                                111,
                                695.0,
                                513,
                                704.0
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                }
            ],
            "layout_bboxes": [],
            "page_idx": 3,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        165,
                        165,
                        444,
                        177
                    ],
                    "lines": [
                        {
                            "bbox": [
                                165,
                                165,
                                444,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        165,
                                        165,
                                        444,
                                        177
                                    ],
                                    "score": 0.86,
                                    "content": "\\begin{array}{r}{\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\operatorname{softmax}(\\mathbf{S})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                165,
                                165,
                                444,
                                177
                            ],
                            "spans": [],
                            "index": 5
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        111,
                        677,
                        513,
                        704
                    ],
                    "lines": [
                        {
                            "bbox": [
                                111,
                                677,
                                513,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        111,
                                        677,
                                        513,
                                        704
                                    ],
                                    "score": 0.85,
                                    "content": "x):=\\operatorname*{max}_{i}\\quad x_{i},\\quad f(x):=\\left[e^{x_{1}-m(x)}\\quad\\ldots\\quad e^{x_{B}-m(x)}\\right],\\quad\\ell(x):=\\sum_{i}f(x)_{i},\\quad\\mathrm{softmax}(x):=\\frac{f(x)}{\\ell(x)}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 41,
                    "virtual_lines": [
                        {
                            "bbox": [
                                111,
                                677,
                                513,
                                686.0
                            ],
                            "spans": [],
                            "index": 40
                        },
                        {
                            "bbox": [
                                111,
                                686.0,
                                513,
                                695.0
                            ],
                            "spans": [],
                            "index": 41
                        },
                        {
                            "bbox": [
                                111,
                                695.0,
                                513,
                                704.0
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                311,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        311,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "4",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        73,
                        73,
                        541,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                74,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "However, in the context of model training, the intermediate values still need to be written to HBM to save",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                72,
                                86,
                                383,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        86,
                                        383,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "for the backward pass, reducing the effectiveness of naive kernel fusion.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        74,
                        541,
                        97
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        111,
                        315,
                        125
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                112,
                                314,
                                125
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        112,
                                        91,
                                        125
                                    ],
                                    "score": 1.0,
                                    "content": "2.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        113,
                                        314,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "Standard Attention Implementation",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        131,
                        541,
                        155
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                129,
                                542,
                                145
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        129,
                                        170,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "Given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        132,
                                        237,
                                        143
                                    ],
                                    "score": 0.92,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        237,
                                        129,
                                        268,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        268,
                                        135,
                                        276,
                                        141
                                    ],
                                    "score": 0.9,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        277,
                                        129,
                                        396,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "is the sequence length and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        396,
                                        134,
                                        402,
                                        141
                                    ],
                                    "score": 0.89,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        402,
                                        129,
                                        542,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "is the head dimension, we want",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                69,
                                144,
                                265,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        144,
                                        216,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": "to compute the attention output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        217,
                                        144,
                                        259,
                                        153
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        259,
                                        144,
                                        265,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": ":",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        129,
                        542,
                        155
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        165,
                        165,
                        444,
                        177
                    ],
                    "lines": [
                        {
                            "bbox": [
                                165,
                                165,
                                444,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        165,
                                        165,
                                        444,
                                        177
                                    ],
                                    "score": 0.86,
                                    "content": "\\begin{array}{r}{\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\operatorname{softmax}(\\mathbf{S})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                165,
                                165,
                                444,
                                177
                            ],
                            "spans": [],
                            "index": 5
                        }
                    ],
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        187,
                        223,
                        199
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                188,
                                223,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        188,
                                        223,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "where softmax is applied row-wise.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 6,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        188,
                        223,
                        199
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        199,
                        541,
                        246
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                198,
                                542,
                                213
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        198,
                                        346,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": "Standard attention implementations materialize the matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        347,
                                        202,
                                        352,
                                        209
                                    ],
                                    "score": 0.26,
                                    "content": "\\mathbf{s}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        353,
                                        198,
                                        372,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": " and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        373,
                                        202,
                                        380,
                                        209
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        380,
                                        198,
                                        474,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM, which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        474,
                                        200,
                                        502,
                                        211
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        502,
                                        198,
                                        542,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": " memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                212,
                                541,
                                223
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        212,
                                        99,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "Often",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        214,
                                        129,
                                        221
                                    ],
                                    "score": 0.91,
                                    "content": "N\\gg d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        129,
                                        212,
                                        206,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "(e.g., for GPT2,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        207,
                                        214,
                                        247,
                                        221
                                    ],
                                    "score": 0.9,
                                    "content": "N=1024",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 40
                                },
                                {
                                    "bbox": [
                                        248,
                                        212,
                                        270,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        270,
                                        214,
                                        298,
                                        221
                                    ],
                                    "score": 0.9,
                                    "content": "d=64",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        298,
                                        212,
                                        541,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "). We describe the standard attention implementation",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                224,
                                541,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        224,
                                        541,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "in Algorithm 0. As some or most of the operations are memory-bound (e.g., softmax), the large number of",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                237,
                                296,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        237,
                                        296,
                                        247
                                    ],
                                    "score": 1.0,
                                    "content": "memory accesses translates to slow wall-clock time.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        198,
                        542,
                        247
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        248,
                        541,
                        282
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                247,
                                541,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        247,
                                        541,
                                        259
                                    ],
                                    "score": 1.0,
                                    "content": "This problem is exacerbated by other elementwise operations applied to the attention matrix, such as",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                259,
                                541,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        259,
                                        265,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "masking applied to S or dropout applied to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        266,
                                        262,
                                        272,
                                        269
                                    ],
                                    "score": 0.72,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        273,
                                        259,
                                        541,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": ". As a result, there have been many attempts to fuse several",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                272,
                                359,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        272,
                                        359,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "elementwise operations, such as fusing masking with softmax [77].",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 12,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        247,
                        541,
                        284
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        283,
                        542,
                        319
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                282,
                                541,
                                295
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        282,
                                        541,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": "In Section 3.2, we will show that the standard attention implementation performs HBM accesses quadratic",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                295,
                                541,
                                308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        295,
                                        170,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": "in the sequence length ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        298,
                                        179,
                                        305
                                    ],
                                    "score": 0.83,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        179,
                                        295,
                                        541,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": ". We also compare the number of FLOPs and number of HBM accesses of standard",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                308,
                                290,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        308,
                                        290,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "attention and of our method (FlashAttention).",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        282,
                        541,
                        319
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        327,
                        282,
                        339
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                328,
                                282,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        328,
                                        282,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 0 Standard Attention Implementation",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        344,
                        266,
                        355
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                343,
                                268,
                                356
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        343,
                                        159,
                                        356
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        160,
                                        345,
                                        226,
                                        356
                                    ],
                                    "score": 0.86,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        226,
                                        343,
                                        268,
                                        356
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        343,
                        268,
                        356
                    ]
                },
                {
                    "type": "index",
                    "bbox": [
                        75,
                        355,
                        407,
                        404
                    ],
                    "lines": [
                        {
                            "bbox": [
                                76,
                                357,
                                391,
                                368
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        357,
                                        113,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": "1: Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        358,
                                        133,
                                        368
                                    ],
                                    "score": 0.81,
                                    "content": "\\mathbf{Q},\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        133,
                                        357,
                                        273,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        273,
                                        357,
                                        312,
                                        367
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 39
                                },
                                {
                                    "bbox": [
                                        312,
                                        357,
                                        391,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": ", write S to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                76,
                                369,
                                363,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        369,
                                        314,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "2: Read S from HBM, compute P = softmax S , write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        314,
                                        370,
                                        321,
                                        378
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        321,
                                        369,
                                        363,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                76,
                                381,
                                407,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        381,
                                        113,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "3: Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        382,
                                        120,
                                        390
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        120,
                                        381,
                                        142,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        142,
                                        382,
                                        151,
                                        390
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        151,
                                        381,
                                        291,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        291,
                                        382,
                                        325,
                                        390
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{0}=\\mathbf{PV}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        325,
                                        381,
                                        356,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": ", write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        356,
                                        382,
                                        364,
                                        390
                                    ],
                                    "score": 0.44,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        365,
                                        381,
                                        407,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                75,
                                392,
                                134,
                                402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        392,
                                        134,
                                        402
                                    ],
                                    "score": 1.0,
                                    "content": "4: Return O.",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true
                        }
                    ],
                    "index": 20.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        75,
                        357,
                        407,
                        402
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        427,
                        484,
                        444
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                429,
                                485,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        430,
                                        82,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        429,
                                        485,
                                        443
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Algorithm, Analysis, and Extensions",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 23,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        452,
                        541,
                        512
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                453,
                                541,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        453,
                                        541,
                                        465
                                    ],
                                    "score": 1.0,
                                    "content": "We show how to compute exact attention with fewer HBM reads/writes and without storing large intermediate",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                465,
                                541,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        465,
                                        541,
                                        477
                                    ],
                                    "score": 1.0,
                                    "content": "matrices for the backward pass. This yields an attention algorithm that is both memory efficient and faster in",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                541,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        541,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "wall-clock time. We analyze its IO complexity, showing that our method requires much fewer HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                490,
                                541,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        490,
                                        541,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "compared to standard attention. We further show that FlashAttention can serve as a useful primitive by",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                501,
                                271,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        501,
                                        271,
                                        513
                                    ],
                                    "score": 1.0,
                                    "content": "extending it to handle block-sparse attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 26,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        453,
                        541,
                        513
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        78,
                        512,
                        542,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                512,
                                542,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        512,
                                        542,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "We focus here on the forward pass for ease of exposition; Appendix B contains details for the backward.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        512,
                        542,
                        525
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        73,
                        538,
                        494,
                        553
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                538,
                                493,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        538,
                                        91,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "3.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        540,
                                        493,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "An Efficient Attention Algorithm With Tiling and Recomputation",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 30,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        559,
                        541,
                        582
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                557,
                                542,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        557,
                                        146,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "Given the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        146,
                                        560,
                                        212,
                                        570
                                    ],
                                    "score": 0.81,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        213,
                                        557,
                                        431,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, we aim to compute the attention output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        432,
                                        560,
                                        474,
                                        569
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        474,
                                        557,
                                        542,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "and write it to",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                572,
                                431,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        572,
                                        416,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": "HBM. Our goal is to reduce the amount of HBM accesses (to sub-quadratic in ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        416,
                                        574,
                                        424,
                                        581
                                    ],
                                    "score": 0.87,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        425,
                                        572,
                                        431,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": ").",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 31.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        557,
                        542,
                        583
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        583,
                        541,
                        642
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                583,
                                541,
                                594
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        583,
                                        541,
                                        594
                                    ],
                                    "score": 1.0,
                                    "content": "We apply two established techniques (tiling, recomputation) to overcome the technical challenge of",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                596,
                                541,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        596,
                                        541,
                                        607
                                    ],
                                    "score": 1.0,
                                    "content": "computing exact attention in sub-quadratic HBM accesses. We describe this in Algorithm 1. The main idea",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        187,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "is that we split the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        609,
                                        219,
                                        618
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        219,
                                        608,
                                        541,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": " into blocks, load them from slow HBM to fast SRAM, then compute the",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                620,
                                541,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        620,
                                        541,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "attention output with respect to those blocks. By scaling the output of each block by the right normalization",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                632,
                                363,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        632,
                                        363,
                                        643
                                    ],
                                    "score": 1.0,
                                    "content": "factor before adding them up, we get the correct result at the end.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 35,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        583,
                        541,
                        643
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        642,
                        540,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                642,
                                541,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        642,
                                        406,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "Tiling. We compute attention by blocks. Softmax couples columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        406,
                                        645,
                                        414,
                                        652
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        415,
                                        642,
                                        541,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": ", so we decompose the large",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                654,
                                526,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        654,
                                        423,
                                        666
                                    ],
                                    "score": 1.0,
                                    "content": "softmax with scaling [51, 60, 66]. For numerical stability, the softmax of vector",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        423,
                                        655,
                                        453,
                                        664
                                    ],
                                    "score": 0.93,
                                    "content": "\\boldsymbol{x}\\in\\mathbb{R}^{B}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        453,
                                        654,
                                        526,
                                        666
                                    ],
                                    "score": 1.0,
                                    "content": "is computed as:",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 38.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        642,
                        541,
                        666
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        111,
                        677,
                        513,
                        704
                    ],
                    "lines": [
                        {
                            "bbox": [
                                111,
                                677,
                                513,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        111,
                                        677,
                                        513,
                                        704
                                    ],
                                    "score": 0.85,
                                    "content": "x):=\\operatorname*{max}_{i}\\quad x_{i},\\quad f(x):=\\left[e^{x_{1}-m(x)}\\quad\\ldots\\quad e^{x_{B}-m(x)}\\right],\\quad\\ell(x):=\\sum_{i}f(x)_{i},\\quad\\mathrm{softmax}(x):=\\frac{f(x)}{\\ell(x)}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 41,
                    "virtual_lines": [
                        {
                            "bbox": [
                                111,
                                677,
                                513,
                                686.0
                            ],
                            "spans": [],
                            "index": 40
                        },
                        {
                            "bbox": [
                                111,
                                686.0,
                                513,
                                695.0
                            ],
                            "spans": [],
                            "index": 41
                        },
                        {
                            "bbox": [
                                111,
                                695.0,
                                513,
                                704.0
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ],
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        72,
                        520,
                        86
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                521,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        122,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "For vectors",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        74,
                                        183,
                                        84
                                    ],
                                    "score": 0.93,
                                    "content": "\\boldsymbol{x}^{(1)},\\boldsymbol{x}^{(2)}\\in\\mathbb{R}^{B}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 61
                                },
                                {
                                    "bbox": [
                                        183,
                                        72,
                                        415,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": ", we can decompose the softmax of the concatenated ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        415,
                                        74,
                                        503,
                                        87
                                    ],
                                    "score": 0.94,
                                    "content": "x=\\left[x^{(1)}~x^{(2)}\\right]\\in\\mathbb{R}^{2B}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        504,
                                        72,
                                        521,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "as:",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        97,
                        91,
                        500,
                        140
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                91,
                                500,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        91,
                                        500,
                                        140
                                    ],
                                    "score": 0.88,
                                    "content": "\\begin{array}{r l}&{(x)=m(\\left[x^{(1)}~x^{(2)}\\right])=\\operatorname*{max}(m(x^{(1)}),m(x^{(2)})),\\quad f(x)=\\left[e^{m(x^{(1)})-m(x)}f(x^{(1)})\\right.\\quad e^{m(x^{(2)})-m(x)}f(x^{(2)})\\right.}\\\\ &{\\left.\\left.\\dot{x}\\right)=\\ell(\\left[x^{(1)}~x^{(2)}\\right])=e^{m(x^{(1)})-m(x)}\\ell(x^{(1)})+e^{m(x^{(2)})-m(x)}\\ell(x^{(2)}),\\quad\\mathrm{softmax}(x)=\\frac{f(x)}{\\ell(x)}.}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                97,
                                91,
                                500,
                                107.33333333333333
                            ],
                            "spans": [],
                            "index": 1
                        },
                        {
                            "bbox": [
                                97,
                                107.33333333333333,
                                500,
                                123.66666666666666
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                97,
                                123.66666666666666,
                                500,
                                140.0
                            ],
                            "spans": [],
                            "index": 3
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        144,
                        540,
                        180
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                143,
                                543,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        143,
                                        286,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "Therefore if we keep track of some extra statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        286,
                                        146,
                                        336,
                                        156
                                    ],
                                    "score": 0.92,
                                    "content": "(m(x),\\ell(x))",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        336,
                                        143,
                                        543,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": ", we can compute softmax one block at a time.2",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                156,
                                542,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        156,
                                        182,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "We thus split the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        182,
                                        159,
                                        214,
                                        168
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        214,
                                        156,
                                        542,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": " into blocks (Algorithm 1 line 3), compute the softmax values along with",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                169,
                                440,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        169,
                                        440,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "extra statistics (Algorithm 1 line 10), and combine the results (Algorithm 1 line 12).",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        180,
                        541,
                        276
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                180,
                                541,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        180,
                                        306,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "Recomputation. One of our goals is to not store ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        306,
                                        181,
                                        334,
                                        191
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        334,
                                        180,
                                        541,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": " intermediate values for the backward pass. The",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                68,
                                189,
                                539,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        189,
                                        270,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "backward pass typically requires the matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        270,
                                        193,
                                        324,
                                        203
                                    ],
                                    "score": 0.9,
                                    "content": "{\\bf S},{\\bf P}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        324,
                                        189,
                                        507,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "to compute the gradients with respect to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        507,
                                        194,
                                        539,
                                        203
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 32
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                205,
                                541,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        205,
                                        215,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "However, by storing the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        215,
                                        207,
                                        223,
                                        214
                                    ],
                                    "score": 0.52,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        223,
                                        205,
                                        410,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": " and the softmax normalization statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        411,
                                        206,
                                        435,
                                        216
                                    ],
                                    "score": 0.92,
                                    "content": "(m,\\ell)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        435,
                                        205,
                                        541,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": ", we can recompute the",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                69,
                                216,
                                542,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        216,
                                        172,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "attention matrix S and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        173,
                                        218,
                                        180,
                                        226
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        180,
                                        216,
                                        367,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": " easily in the backward pass from blocks of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        367,
                                        218,
                                        398,
                                        227
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 31
                                },
                                {
                                    "bbox": [
                                        399,
                                        216,
                                        542,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": " in SRAM. This can be seen as a",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                229,
                                541,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        229,
                                        541,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "form of selective gradient checkpointing [10, 34]. While gradient checkpointing has been suggested to reduce",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                241,
                                541,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        241,
                                        541,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "the maximum amount of memory required [66], all implementations (that we know off) have to trade speed",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                253,
                                541,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        253,
                                        541,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "for memory. In contrast, even with more FLOPs, our recomputation speeds up the backward pass due to",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                265,
                                446,
                                276
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        265,
                                        446,
                                        276
                                    ],
                                    "score": 1.0,
                                    "content": "reduced HBM accesses (Fig. 2). The full backward pass description is in Appendix B.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        276,
                        540,
                        323
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                276,
                                541,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        276,
                                        541,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "Implementation details: Kernel fusion. Tiling enables us to implement our algorithm in one",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                286,
                                541,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        286,
                                        541,
                                        300
                                    ],
                                    "score": 1.0,
                                    "content": "CUDA kernel, loading input from HBM, performing all the computation steps (matrix multiply, softmax,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                72,
                                301,
                                540,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        301,
                                        540,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "optionally masking and dropout, matrix multiply), then write the result back to HBM (masking and dropout",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                312,
                                516,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        312,
                                        516,
                                        324
                                    ],
                                    "score": 1.0,
                                    "content": "in Appendix B). This avoids repeatedly reading and writing of inputs and outputs from and to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 16.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        330,
                        211,
                        342
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                331,
                                211,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        331,
                                        211,
                                        342
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 1 FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19
                },
                {
                    "type": "table",
                    "bbox": [
                        69,
                        345,
                        543,
                        601
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                69,
                                345,
                                543,
                                601
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        345,
                                        543,
                                        601
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                345,
                                                543,
                                                601
                                            ],
                                            "score": 0.638,
                                            "type": "table",
                                            "image_path": "4cbe573cd544d6f831cfc084db67d6e0352e4fe306d4513d0329108e29d0c02f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 21,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        69,
                                        345,
                                        543,
                                        430.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        69,
                                        430.3333333333333,
                                        543,
                                        515.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        69,
                                        515.6666666666666,
                                        543,
                                        601.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "type": "text",
                    "bbox": [
                        77,
                        609,
                        533,
                        621
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                608,
                                527,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        608,
                                        527,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "We show FlashAttention’s correctness, runtime, and memory requirement (proof in Appendix C).",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 23
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        624,
                        536,
                        650
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                625,
                                538,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        625,
                                        223,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "Theorem 1. Algorithm 1 returns",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        626,
                                        314,
                                        637
                                    ],
                                    "score": 0.54,
                                    "content": "{\\bf0}=\\mathrm{softmax}({\\bf Q}{\\bf K}^{\\top}){\\bf V}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 90
                                },
                                {
                                    "bbox": [
                                        315,
                                        625,
                                        339,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": " with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        339,
                                        627,
                                        373,
                                        637
                                    ],
                                    "score": 0.9,
                                    "content": "O(N^{2}d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        374,
                                        625,
                                        468,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs and requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        468,
                                        627,
                                        492,
                                        637
                                    ],
                                    "score": 0.87,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        492,
                                        625,
                                        538,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": " additiona",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                638,
                                223,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        638,
                                        223,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "memory beyond inputs and output.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        662,
                        376,
                        678
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                376,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        91,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "3.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        664,
                                        376,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "Analysis: IO Complexity of FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        683,
                        541,
                        708
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                683,
                                541,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        683,
                                        541,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "We analyze the IO complexity of FlashAttention, showing significant reduction in HBM accesses compared",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                696,
                                540,
                                707
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        696,
                                        540,
                                        707
                                    ],
                                    "score": 1.0,
                                    "content": "to standard attention. We also provide a lower bound, proving that no exact attention algorithm can",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 4,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        69,
                        345,
                        543,
                        601
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                69,
                                345,
                                543,
                                601
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        345,
                                        543,
                                        601
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                345,
                                                543,
                                                601
                                            ],
                                            "score": 0.638,
                                            "type": "table",
                                            "image_path": "4cbe573cd544d6f831cfc084db67d6e0352e4fe306d4513d0329108e29d0c02f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 21,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        69,
                                        345,
                                        543,
                                        430.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        69,
                                        430.3333333333333,
                                        543,
                                        515.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        69,
                                        515.6666666666666,
                                        543,
                                        601.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                }
                            ]
                        }
                    ],
                    "index": 21
                }
            ],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        97,
                        91,
                        500,
                        140
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                91,
                                500,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        91,
                                        500,
                                        140
                                    ],
                                    "score": 0.88,
                                    "content": "\\begin{array}{r l}&{(x)=m(\\left[x^{(1)}~x^{(2)}\\right])=\\operatorname*{max}(m(x^{(1)}),m(x^{(2)})),\\quad f(x)=\\left[e^{m(x^{(1)})-m(x)}f(x^{(1)})\\right.\\quad e^{m(x^{(2)})-m(x)}f(x^{(2)})\\right.}\\\\ &{\\left.\\left.\\dot{x}\\right)=\\ell(\\left[x^{(1)}~x^{(2)}\\right])=e^{m(x^{(1)})-m(x)}\\ell(x^{(1)})+e^{m(x^{(2)})-m(x)}\\ell(x^{(2)}),\\quad\\mathrm{softmax}(x)=\\frac{f(x)}{\\ell(x)}.}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                97,
                                91,
                                500,
                                107.33333333333333
                            ],
                            "spans": [],
                            "index": 1
                        },
                        {
                            "bbox": [
                                97,
                                107.33333333333333,
                                500,
                                123.66666666666666
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                97,
                                123.66666666666666,
                                500,
                                140.0
                            ],
                            "spans": [],
                            "index": 3
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        81,
                        713,
                        310,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                81,
                                711,
                                311,
                                725
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        711,
                                        311,
                                        725
                                    ],
                                    "score": 1.0,
                                    "content": "2This style of aggregation is called algebraic aggregation [33].",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                310,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        310,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "5",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        72,
                        520,
                        86
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                521,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        122,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "For vectors",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        74,
                                        183,
                                        84
                                    ],
                                    "score": 0.93,
                                    "content": "\\boldsymbol{x}^{(1)},\\boldsymbol{x}^{(2)}\\in\\mathbb{R}^{B}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 61
                                },
                                {
                                    "bbox": [
                                        183,
                                        72,
                                        415,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": ", we can decompose the softmax of the concatenated ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        415,
                                        74,
                                        503,
                                        87
                                    ],
                                    "score": 0.94,
                                    "content": "x=\\left[x^{(1)}~x^{(2)}\\right]\\in\\mathbb{R}^{2B}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        504,
                                        72,
                                        521,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "as:",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        72,
                        521,
                        87
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        97,
                        91,
                        500,
                        140
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                91,
                                500,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        91,
                                        500,
                                        140
                                    ],
                                    "score": 0.88,
                                    "content": "\\begin{array}{r l}&{(x)=m(\\left[x^{(1)}~x^{(2)}\\right])=\\operatorname*{max}(m(x^{(1)}),m(x^{(2)})),\\quad f(x)=\\left[e^{m(x^{(1)})-m(x)}f(x^{(1)})\\right.\\quad e^{m(x^{(2)})-m(x)}f(x^{(2)})\\right.}\\\\ &{\\left.\\left.\\dot{x}\\right)=\\ell(\\left[x^{(1)}~x^{(2)}\\right])=e^{m(x^{(1)})-m(x)}\\ell(x^{(1)})+e^{m(x^{(2)})-m(x)}\\ell(x^{(2)}),\\quad\\mathrm{softmax}(x)=\\frac{f(x)}{\\ell(x)}.}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                97,
                                91,
                                500,
                                107.33333333333333
                            ],
                            "spans": [],
                            "index": 1
                        },
                        {
                            "bbox": [
                                97,
                                107.33333333333333,
                                500,
                                123.66666666666666
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                97,
                                123.66666666666666,
                                500,
                                140.0
                            ],
                            "spans": [],
                            "index": 3
                        }
                    ],
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        144,
                        540,
                        180
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                143,
                                543,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        143,
                                        286,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "Therefore if we keep track of some extra statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        286,
                                        146,
                                        336,
                                        156
                                    ],
                                    "score": 0.92,
                                    "content": "(m(x),\\ell(x))",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        336,
                                        143,
                                        543,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": ", we can compute softmax one block at a time.2",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                156,
                                542,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        156,
                                        182,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "We thus split the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        182,
                                        159,
                                        214,
                                        168
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        214,
                                        156,
                                        542,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": " into blocks (Algorithm 1 line 3), compute the softmax values along with",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                169,
                                440,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        169,
                                        440,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "extra statistics (Algorithm 1 line 10), and combine the results (Algorithm 1 line 12).",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        143,
                        543,
                        180
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        180,
                        541,
                        276
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                180,
                                541,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        180,
                                        306,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "Recomputation. One of our goals is to not store ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        306,
                                        181,
                                        334,
                                        191
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        334,
                                        180,
                                        541,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": " intermediate values for the backward pass. The",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                68,
                                189,
                                539,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        189,
                                        270,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "backward pass typically requires the matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        270,
                                        193,
                                        324,
                                        203
                                    ],
                                    "score": 0.9,
                                    "content": "{\\bf S},{\\bf P}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        324,
                                        189,
                                        507,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "to compute the gradients with respect to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        507,
                                        194,
                                        539,
                                        203
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 32
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                205,
                                541,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        205,
                                        215,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "However, by storing the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        215,
                                        207,
                                        223,
                                        214
                                    ],
                                    "score": 0.52,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        223,
                                        205,
                                        410,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": " and the softmax normalization statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        411,
                                        206,
                                        435,
                                        216
                                    ],
                                    "score": 0.92,
                                    "content": "(m,\\ell)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        435,
                                        205,
                                        541,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": ", we can recompute the",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                69,
                                216,
                                542,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        216,
                                        172,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "attention matrix S and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        173,
                                        218,
                                        180,
                                        226
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        180,
                                        216,
                                        367,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": " easily in the backward pass from blocks of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        367,
                                        218,
                                        398,
                                        227
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 31
                                },
                                {
                                    "bbox": [
                                        399,
                                        216,
                                        542,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": " in SRAM. This can be seen as a",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                229,
                                541,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        229,
                                        541,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "form of selective gradient checkpointing [10, 34]. While gradient checkpointing has been suggested to reduce",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                241,
                                541,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        241,
                                        541,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "the maximum amount of memory required [66], all implementations (that we know off) have to trade speed",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                253,
                                541,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        253,
                                        541,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "for memory. In contrast, even with more FLOPs, our recomputation speeds up the backward pass due to",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                265,
                                446,
                                276
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        265,
                                        446,
                                        276
                                    ],
                                    "score": 1.0,
                                    "content": "reduced HBM accesses (Fig. 2). The full backward pass description is in Appendix B.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        180,
                        542,
                        276
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        276,
                        540,
                        323
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                276,
                                541,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        276,
                                        541,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "Implementation details: Kernel fusion. Tiling enables us to implement our algorithm in one",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                286,
                                541,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        286,
                                        541,
                                        300
                                    ],
                                    "score": 1.0,
                                    "content": "CUDA kernel, loading input from HBM, performing all the computation steps (matrix multiply, softmax,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                72,
                                301,
                                540,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        301,
                                        540,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "optionally masking and dropout, matrix multiply), then write the result back to HBM (masking and dropout",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                312,
                                516,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        312,
                                        516,
                                        324
                                    ],
                                    "score": 1.0,
                                    "content": "in Appendix B). This avoids repeatedly reading and writing of inputs and outputs from and to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 16.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        276,
                        541,
                        324
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        330,
                        211,
                        342
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                331,
                                211,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        331,
                                        211,
                                        342
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 1 FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        69,
                        345,
                        543,
                        601
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                69,
                                345,
                                543,
                                601
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        345,
                                        543,
                                        601
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                345,
                                                543,
                                                601
                                            ],
                                            "score": 0.638,
                                            "type": "table",
                                            "image_path": "4cbe573cd544d6f831cfc084db67d6e0352e4fe306d4513d0329108e29d0c02f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 21,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        69,
                                        345,
                                        543,
                                        430.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        69,
                                        430.3333333333333,
                                        543,
                                        515.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        69,
                                        515.6666666666666,
                                        543,
                                        601.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                }
                            ]
                        }
                    ],
                    "index": 21,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        77,
                        609,
                        533,
                        621
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                608,
                                527,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        608,
                                        527,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "We show FlashAttention’s correctness, runtime, and memory requirement (proof in Appendix C).",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 23,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        608,
                        527,
                        622
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        624,
                        536,
                        650
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                625,
                                538,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        625,
                                        223,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "Theorem 1. Algorithm 1 returns",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        626,
                                        314,
                                        637
                                    ],
                                    "score": 0.54,
                                    "content": "{\\bf0}=\\mathrm{softmax}({\\bf Q}{\\bf K}^{\\top}){\\bf V}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 90
                                },
                                {
                                    "bbox": [
                                        315,
                                        625,
                                        339,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": " with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        339,
                                        627,
                                        373,
                                        637
                                    ],
                                    "score": 0.9,
                                    "content": "O(N^{2}d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        374,
                                        625,
                                        468,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs and requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        468,
                                        627,
                                        492,
                                        637
                                    ],
                                    "score": 0.87,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        492,
                                        625,
                                        538,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": " additiona",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                638,
                                223,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        638,
                                        223,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "memory beyond inputs and output.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        625,
                        538,
                        650
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        662,
                        376,
                        678
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                376,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        91,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "3.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        664,
                                        376,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "Analysis: IO Complexity of FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        683,
                        541,
                        708
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                683,
                                541,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        683,
                                        541,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "We analyze the IO complexity of FlashAttention, showing significant reduction in HBM accesses compared",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                696,
                                540,
                                707
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        696,
                                        540,
                                        707
                                    ],
                                    "score": 1.0,
                                    "content": "to standard attention. We also provide a lower bound, proving that no exact attention algorithm can",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                219,
                                464,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        219,
                                        464,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "asymptotically improve on HBM accesses over all SRAM sizes. Proofs are in Appendix C.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 27.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        683,
                        541,
                        707
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        114,
                        71,
                        499,
                        145
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                114,
                                71,
                                499,
                                145
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        114,
                                        71,
                                        499,
                                        145
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                71,
                                                499,
                                                145
                                            ],
                                            "score": 0.75,
                                            "type": "image",
                                            "image_path": "edbcabe35f057ac056c678a0f88c4ca4a1063eb653d9e2d523dae3a2c3964844.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        114,
                                        71,
                                        499,
                                        95.66666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        114,
                                        95.66666666666667,
                                        499,
                                        120.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        114,
                                        120.33333333333334,
                                        499,
                                        145.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                154,
                                542,
                                209
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        155,
                                        541,
                                        166
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                155,
                                                180,
                                                166
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 2: Left: Forward",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                181,
                                                156,
                                                189,
                                                165
                                            ],
                                            "score": 0.43,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                190,
                                                155,
                                                541,
                                                166
                                            ],
                                            "score": 1.0,
                                            "content": " backward runtime of standard attention and FlashAttention for GPT-2 medium",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        69,
                                        165,
                                        541,
                                        178
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                165,
                                                541,
                                                178
                                            ],
                                            "score": 1.0,
                                            "content": "(seq. length 1024, head dim. 64, 16 heads, batch size 64) on A100 GPU. HBM access is the primary factor affecting",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        177,
                                        541,
                                        188
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                177,
                                                541,
                                                188
                                            ],
                                            "score": 1.0,
                                            "content": "runtime. Middle: Forward runtime of FlashAttention (seq. length 1024, head dim. 64, 16 heads, batch size 64) on",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        186,
                                        542,
                                        200
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                186,
                                                542,
                                                200
                                            ],
                                            "score": 1.0,
                                            "content": "A100 GPU. Fewer HBM accesses result in faster runtime, up to a point. Right: The runtime (for seq. length 4K) of",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        198,
                                        495,
                                        211
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                198,
                                                495,
                                                211
                                            ],
                                            "score": 1.0,
                                            "content": "block-sparse FlashAttention is faster than FlashAttention by a factor proportional to the sparsity.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.0
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        218,
                        465,
                        230
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                219,
                                464,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        219,
                                        464,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "asymptotically improve on HBM accesses over all SRAM sizes. Proofs are in Appendix C.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        236,
                        542,
                        272
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                237,
                                540,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        237,
                                        483,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "Theorem 2. Let 𝑁 be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        484,
                                        237,
                                        538,
                                        247
                                    ],
                                    "score": 0.87,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        538,
                                        237,
                                        540,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                249,
                                541,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        249,
                                        203,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "Standard attention (Algorithm ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        204,
                                        250,
                                        209,
                                        259
                                    ],
                                    "score": 0.38,
                                    "content": "\\boldsymbol{\\theta}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        210,
                                        249,
                                        251,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": ") requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        252,
                                        250,
                                        302,
                                        261
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        303,
                                        249,
                                        541,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses, while FlashAttention (Algorithm 1)",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                261,
                                233,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        261,
                                        107,
                                        273
                                    ],
                                    "score": 1.0,
                                    "content": "requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        107,
                                        262,
                                        163,
                                        272
                                    ],
                                    "score": 0.91,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        163,
                                        261,
                                        233,
                                        273
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        277,
                        541,
                        314
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                278,
                                541,
                                290
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        278,
                                        181,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "For typical values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        181,
                                        281,
                                        187,
                                        288
                                    ],
                                    "score": 0.81,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        187,
                                        278,
                                        251,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "(64-128) and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        251,
                                        281,
                                        261,
                                        288
                                    ],
                                    "score": 0.68,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        262,
                                        278,
                                        344,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "(around 100KB), ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        344,
                                        279,
                                        354,
                                        288
                                    ],
                                    "score": 0.91,
                                    "content": "d^{2}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        355,
                                        278,
                                        483,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": " is many times smaller than",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        484,
                                        281,
                                        494,
                                        288
                                    ],
                                    "score": 0.85,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        494,
                                        278,
                                        541,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": ", and thus",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                291,
                                541,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        291,
                                        541,
                                        302
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention requires many times fewer HBM accesses than standard implementation. This leads to",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                303,
                                437,
                                314
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        303,
                                        437,
                                        314
                                    ],
                                    "score": 1.0,
                                    "content": "both faster execution and lower memory footprint, which we validate in Section 4.3.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        315,
                        541,
                        386
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                315,
                                540,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        315,
                                        334,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": "The main idea of the proof is that given the SRAM size of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        334,
                                        317,
                                        344,
                                        324
                                    ],
                                    "score": 0.89,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        344,
                                        315,
                                        441,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": ", we can load blocks of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        442,
                                        317,
                                        461,
                                        325
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        462,
                                        315,
                                        492,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": " of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        493,
                                        316,
                                        518,
                                        326
                                    ],
                                    "score": 0.88,
                                    "content": "\\Theta(M)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        518,
                                        315,
                                        540,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": " each",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                326,
                                541,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        326,
                                        235,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "(Algorithm 1 line 6). For each block of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        329,
                                        243,
                                        336
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        244,
                                        326,
                                        264,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        264,
                                        329,
                                        272,
                                        336
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        272,
                                        326,
                                        394,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": ", we iterate over all blocks of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        395,
                                        329,
                                        402,
                                        338
                                    ],
                                    "score": 0.72,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        403,
                                        326,
                                        541,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": " (Algorithm 1 line 8) to compute",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                338,
                                541,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        338,
                                        238,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "the intermediate values, resulting in ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        238,
                                        339,
                                        285,
                                        349
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d M^{-1})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 47
                                },
                                {
                                    "bbox": [
                                        285,
                                        338,
                                        343,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": " passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        343,
                                        340,
                                        351,
                                        349
                                    ],
                                    "score": 0.33,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        351,
                                        338,
                                        435,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": ". Each pass loads ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        435,
                                        340,
                                        464,
                                        350
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta(N d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        465,
                                        338,
                                        541,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": " elements, which",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                350,
                                541,
                                362
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        350,
                                        124,
                                        362
                                    ],
                                    "score": 1.0,
                                    "content": "amounts to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        124,
                                        351,
                                        180,
                                        362
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        181,
                                        350,
                                        541,
                                        362
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses. We similarly prove that the backward pass of standard attention",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                69,
                                361,
                                539,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        361,
                                        109,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        162,
                                        374
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 53
                                },
                                {
                                    "bbox": [
                                        162,
                                        361,
                                        482,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses while the backward pass of FlashAttention requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        483,
                                        363,
                                        539,
                                        374
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 56
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                374,
                                200,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        374,
                                        200,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "HBM accesses (Appendix B).",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 17.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        386,
                        540,
                        410
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                386,
                                541,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        386,
                                        541,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "We prove a lower-bound: one cannot asymptotically improve on the number of HBM accesses for all",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                398,
                                347,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        398,
                                        111,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "values of",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        112,
                                        401,
                                        122,
                                        407
                                    ],
                                    "score": 0.84,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        122,
                                        398,
                                        347,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "(the SRAM size) when computing exact attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 21.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        415,
                        541,
                        451
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                416,
                                540,
                                427
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        416,
                                        166,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "Proposition 3. Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        167,
                                        419,
                                        176,
                                        425
                                    ],
                                    "score": 0.68,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        416,
                                        540,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                428,
                                542,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        429,
                                        126,
                                        438
                                    ],
                                    "score": 0.89,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        126,
                                        428,
                                        420,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": ". There does not exist an algorithm to compute exact attention with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        420,
                                        429,
                                        475,
                                        439
                                    ],
                                    "score": 0.9,
                                    "content": "o(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        475,
                                        428,
                                        542,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                441,
                                206,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        441,
                                        171,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "for all 𝑀 in the range",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        171,
                                        442,
                                        202,
                                        451
                                    ],
                                    "score": 0.9,
                                    "content": "[d,N d]",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 31
                                },
                                {
                                    "bbox": [
                                        203,
                                        441,
                                        206,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        457,
                        540,
                        504
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                457,
                                539,
                                470
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        457,
                                        253,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": "The proof relies on the fact that for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        253,
                                        460,
                                        305,
                                        469
                                    ],
                                    "score": 0.92,
                                    "content": "M=\\Theta(N d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        305,
                                        457,
                                        439,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": " any algorithm must perform ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        440,
                                        459,
                                        539,
                                        469
                                    ],
                                    "score": 0.93,
                                    "content": "\\Omega(N^{2}d^{2}M^{-1})=\\Omega(N d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 99
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                469,
                                541,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        469,
                                        348,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "HBM accesses. This type of lower bound over a subrange of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        349,
                                        472,
                                        359,
                                        479
                                    ],
                                    "score": 0.89,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        359,
                                        469,
                                        541,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "is common in the streaming algorithms",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                482,
                                541,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        482,
                                        452,
                                        495
                                    ],
                                    "score": 1.0,
                                    "content": "literature [88]. We leave proving parameterized complexity [27] lower bounds in terms of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        452,
                                        484,
                                        462,
                                        491
                                    ],
                                    "score": 0.88,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        462,
                                        482,
                                        541,
                                        495
                                    ],
                                    "score": 1.0,
                                    "content": "as exciting future",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                493,
                                96,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        493,
                                        96,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "work.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 27.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        505,
                        541,
                        601
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                505,
                                541,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        505,
                                        541,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "We validate that the number of HBM accesses is the main determining factor of attention run-time.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                518,
                                541,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        518,
                                        541,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "In Fig. 2 (left), we see that even though FlashAttention has higher FLOP count compared to standard",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                69,
                                528,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        528,
                                        541,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "attention (due to recomputation in the backward pass), it has much fewer HBM accesses, resulting in much",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                69,
                                541,
                                541,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        541,
                                        320,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "faster runtime. In Fig. 2 (middle), we vary the block size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        544,
                                        331,
                                        552
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        332,
                                        541,
                                        541,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "of FlashAttention, which results in different",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                71,
                                554,
                                540,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        554,
                                        540,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "amounts of HBM accesses, and measure the runtime of the forward pass. As block size increases, the number",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                565,
                                540,
                                577
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        565,
                                        540,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": "of HBM accesses decreases (as we make fewer passes over the input), and runtime decreases. For large enough",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                576,
                                541,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        576,
                                        541,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "block size (beyond 256), the runtime is then bottlenecked by other factors (e.g., arithmetic operations).",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                69,
                                588,
                                358,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        588,
                                        358,
                                        602
                                    ],
                                    "score": 1.0,
                                    "content": "Moreover, larger block size will not fit into the small SRAM size.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 33.5
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        614,
                        357,
                        628
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                615,
                                357,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        615,
                                        91,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "3.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        615,
                                        357,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "Extension: Block-Sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 38
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        635,
                        542,
                        671
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                634,
                                541,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        634,
                                        541,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "We extend FlashAttention to approximate attention: we propose block-sparse FlashAttention, whose",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                646,
                                463,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        646,
                                        463,
                                        659
                                    ],
                                    "score": 1.0,
                                    "content": "IO complexity is smaller than FlashAttention by a factor proportional to the sparsity.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                83,
                                654,
                                466,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        654,
                                        145,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": "Given inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        659,
                                        212,
                                        670
                                    ],
                                    "score": 0.92,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        212,
                                        654,
                                        301,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": "and a mask matrix",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        301,
                                        658,
                                        365,
                                        671
                                    ],
                                    "score": 0.93,
                                    "content": "\\tilde{\\mathbf{M}}\\in\\{0,1\\}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 64
                                },
                                {
                                    "bbox": [
                                        365,
                                        654,
                                        466,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": ", we want to compute:",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 40
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        153,
                        677,
                        456,
                        690
                    ],
                    "lines": [
                        {
                            "bbox": [
                                153,
                                677,
                                456,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        153,
                                        677,
                                        456,
                                        690
                                    ],
                                    "score": 0.61,
                                    "content": "\\begin{array}{r}{\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S}\\odot\\mathbb{1}_{\\tilde{\\mathbf{M}}})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                153,
                                677,
                                456,
                                690
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        697,
                        538,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                698,
                                540,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        698,
                                        99,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        699,
                                        169,
                                        711
                                    ],
                                    "score": 0.87,
                                    "content": "(\\mathbf{S}\\odot\\mathbb{1}_{\\tilde{\\mathbf{M}}})_{k l}=\\mathbf{S}_{k l}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 69
                                },
                                {
                                    "bbox": [
                                        169,
                                        698,
                                        180,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "if",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        181,
                                        698,
                                        215,
                                        709
                                    ],
                                    "score": 0.92,
                                    "content": "\\tilde{\\mathbf{M}}_{k l}=1",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        215,
                                        698,
                                        236,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        236,
                                        702,
                                        252,
                                        708
                                    ],
                                    "score": 0.82,
                                    "content": "-\\infty",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        252,
                                        698,
                                        263,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "if ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        263,
                                        701,
                                        298,
                                        709
                                    ],
                                    "score": 0.91,
                                    "content": "{\\bf{M}}_{k l}=0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 35
                                },
                                {
                                    "bbox": [
                                        298,
                                        698,
                                        354,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": ". We require",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        354,
                                        698,
                                        364,
                                        708
                                    ],
                                    "score": 0.9,
                                    "content": "\\tilde{\\mathbf{M}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        364,
                                        698,
                                        540,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": " to have block form: for some block sizes",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                711,
                                455,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        714,
                                        98,
                                        723
                                    ],
                                    "score": 0.91,
                                    "content": "B_{r},B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        98,
                                        711,
                                        132,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": ", for all",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        133,
                                        713,
                                        146,
                                        723
                                    ],
                                    "score": 0.81,
                                    "content": "k,l",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        147,
                                        711,
                                        152,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        152,
                                        711,
                                        200,
                                        724
                                    ],
                                    "score": 0.89,
                                    "content": "\\tilde{\\mathbf{M}}_{k,l}=\\mathbf{M}_{i j}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        200,
                                        711,
                                        225,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        713,
                                        319,
                                        723
                                    ],
                                    "score": 0.89,
                                    "content": "i=\\lfloor k/B_{r}\\rfloor,j=\\lfloor l/B_{c}\\rfloor",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 94
                                },
                                {
                                    "bbox": [
                                        319,
                                        711,
                                        362,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "for some ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        362,
                                        712,
                                        452,
                                        723
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{M}\\in\\{0,1\\}^{N/B_{r}\\times N/B_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 90
                                },
                                {
                                    "bbox": [
                                        452,
                                        711,
                                        455,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        }
                    ],
                    "index": 43.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 5,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        114,
                        71,
                        499,
                        145
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                114,
                                71,
                                499,
                                145
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        114,
                                        71,
                                        499,
                                        145
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                71,
                                                499,
                                                145
                                            ],
                                            "score": 0.75,
                                            "type": "image",
                                            "image_path": "edbcabe35f057ac056c678a0f88c4ca4a1063eb653d9e2d523dae3a2c3964844.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        114,
                                        71,
                                        499,
                                        95.66666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        114,
                                        95.66666666666667,
                                        499,
                                        120.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        114,
                                        120.33333333333334,
                                        499,
                                        145.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                154,
                                542,
                                209
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        155,
                                        541,
                                        166
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                155,
                                                180,
                                                166
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 2: Left: Forward",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                181,
                                                156,
                                                189,
                                                165
                                            ],
                                            "score": 0.43,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                190,
                                                155,
                                                541,
                                                166
                                            ],
                                            "score": 1.0,
                                            "content": " backward runtime of standard attention and FlashAttention for GPT-2 medium",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        69,
                                        165,
                                        541,
                                        178
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                165,
                                                541,
                                                178
                                            ],
                                            "score": 1.0,
                                            "content": "(seq. length 1024, head dim. 64, 16 heads, batch size 64) on A100 GPU. HBM access is the primary factor affecting",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        177,
                                        541,
                                        188
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                177,
                                                541,
                                                188
                                            ],
                                            "score": 1.0,
                                            "content": "runtime. Middle: Forward runtime of FlashAttention (seq. length 1024, head dim. 64, 16 heads, batch size 64) on",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        186,
                                        542,
                                        200
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                186,
                                                542,
                                                200
                                            ],
                                            "score": 1.0,
                                            "content": "A100 GPU. Fewer HBM accesses result in faster runtime, up to a point. Right: The runtime (for seq. length 4K) of",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        198,
                                        495,
                                        211
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                198,
                                                495,
                                                211
                                            ],
                                            "score": 1.0,
                                            "content": "block-sparse FlashAttention is faster than FlashAttention by a factor proportional to the sparsity.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.0
                }
            ],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        153,
                        677,
                        456,
                        690
                    ],
                    "lines": [
                        {
                            "bbox": [
                                153,
                                677,
                                456,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        153,
                                        677,
                                        456,
                                        690
                                    ],
                                    "score": 0.61,
                                    "content": "\\begin{array}{r}{\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S}\\odot\\mathbb{1}_{\\tilde{\\mathbf{M}}})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                153,
                                677,
                                456,
                                690
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                310,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        310,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "6",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        114,
                        71,
                        499,
                        145
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                114,
                                71,
                                499,
                                145
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        114,
                                        71,
                                        499,
                                        145
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                71,
                                                499,
                                                145
                                            ],
                                            "score": 0.75,
                                            "type": "image",
                                            "image_path": "edbcabe35f057ac056c678a0f88c4ca4a1063eb653d9e2d523dae3a2c3964844.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        114,
                                        71,
                                        499,
                                        95.66666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        114,
                                        95.66666666666667,
                                        499,
                                        120.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        114,
                                        120.33333333333334,
                                        499,
                                        145.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                154,
                                542,
                                209
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        155,
                                        541,
                                        166
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                155,
                                                180,
                                                166
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 2: Left: Forward",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                181,
                                                156,
                                                189,
                                                165
                                            ],
                                            "score": 0.43,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                190,
                                                155,
                                                541,
                                                166
                                            ],
                                            "score": 1.0,
                                            "content": " backward runtime of standard attention and FlashAttention for GPT-2 medium",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        69,
                                        165,
                                        541,
                                        178
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                165,
                                                541,
                                                178
                                            ],
                                            "score": 1.0,
                                            "content": "(seq. length 1024, head dim. 64, 16 heads, batch size 64) on A100 GPU. HBM access is the primary factor affecting",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        177,
                                        541,
                                        188
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                177,
                                                541,
                                                188
                                            ],
                                            "score": 1.0,
                                            "content": "runtime. Middle: Forward runtime of FlashAttention (seq. length 1024, head dim. 64, 16 heads, batch size 64) on",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        186,
                                        542,
                                        200
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                186,
                                                542,
                                                200
                                            ],
                                            "score": 1.0,
                                            "content": "A100 GPU. Fewer HBM accesses result in faster runtime, up to a point. Right: The runtime (for seq. length 4K) of",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        198,
                                        495,
                                        211
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                198,
                                                495,
                                                211
                                            ],
                                            "score": 1.0,
                                            "content": "block-sparse FlashAttention is faster than FlashAttention by a factor proportional to the sparsity.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.0,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        218,
                        465,
                        230
                    ],
                    "lines": [],
                    "index": 8,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        219,
                        464,
                        231
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        236,
                        542,
                        272
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                237,
                                540,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        237,
                                        483,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "Theorem 2. Let 𝑁 be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        484,
                                        237,
                                        538,
                                        247
                                    ],
                                    "score": 0.87,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        538,
                                        237,
                                        540,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                249,
                                541,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        249,
                                        203,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "Standard attention (Algorithm ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        204,
                                        250,
                                        209,
                                        259
                                    ],
                                    "score": 0.38,
                                    "content": "\\boldsymbol{\\theta}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        210,
                                        249,
                                        251,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": ") requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        252,
                                        250,
                                        302,
                                        261
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        303,
                                        249,
                                        541,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses, while FlashAttention (Algorithm 1)",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                261,
                                233,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        261,
                                        107,
                                        273
                                    ],
                                    "score": 1.0,
                                    "content": "requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        107,
                                        262,
                                        163,
                                        272
                                    ],
                                    "score": 0.91,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        163,
                                        261,
                                        233,
                                        273
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        237,
                        541,
                        273
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        277,
                        541,
                        314
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                278,
                                541,
                                290
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        278,
                                        181,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "For typical values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        181,
                                        281,
                                        187,
                                        288
                                    ],
                                    "score": 0.81,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        187,
                                        278,
                                        251,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "(64-128) and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        251,
                                        281,
                                        261,
                                        288
                                    ],
                                    "score": 0.68,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        262,
                                        278,
                                        344,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "(around 100KB), ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        344,
                                        279,
                                        354,
                                        288
                                    ],
                                    "score": 0.91,
                                    "content": "d^{2}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        355,
                                        278,
                                        483,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": " is many times smaller than",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        484,
                                        281,
                                        494,
                                        288
                                    ],
                                    "score": 0.85,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        494,
                                        278,
                                        541,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": ", and thus",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                291,
                                541,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        291,
                                        541,
                                        302
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention requires many times fewer HBM accesses than standard implementation. This leads to",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                303,
                                437,
                                314
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        303,
                                        437,
                                        314
                                    ],
                                    "score": 1.0,
                                    "content": "both faster execution and lower memory footprint, which we validate in Section 4.3.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 13,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        278,
                        541,
                        314
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        315,
                        541,
                        386
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                315,
                                540,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        315,
                                        334,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": "The main idea of the proof is that given the SRAM size of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        334,
                                        317,
                                        344,
                                        324
                                    ],
                                    "score": 0.89,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        344,
                                        315,
                                        441,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": ", we can load blocks of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        442,
                                        317,
                                        461,
                                        325
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        462,
                                        315,
                                        492,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": " of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        493,
                                        316,
                                        518,
                                        326
                                    ],
                                    "score": 0.88,
                                    "content": "\\Theta(M)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        518,
                                        315,
                                        540,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": " each",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                326,
                                541,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        326,
                                        235,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "(Algorithm 1 line 6). For each block of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        329,
                                        243,
                                        336
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        244,
                                        326,
                                        264,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        264,
                                        329,
                                        272,
                                        336
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        272,
                                        326,
                                        394,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": ", we iterate over all blocks of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        395,
                                        329,
                                        402,
                                        338
                                    ],
                                    "score": 0.72,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        403,
                                        326,
                                        541,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": " (Algorithm 1 line 8) to compute",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                338,
                                541,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        338,
                                        238,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "the intermediate values, resulting in ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        238,
                                        339,
                                        285,
                                        349
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d M^{-1})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 47
                                },
                                {
                                    "bbox": [
                                        285,
                                        338,
                                        343,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": " passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        343,
                                        340,
                                        351,
                                        349
                                    ],
                                    "score": 0.33,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        351,
                                        338,
                                        435,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": ". Each pass loads ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        435,
                                        340,
                                        464,
                                        350
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta(N d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        465,
                                        338,
                                        541,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": " elements, which",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                350,
                                541,
                                362
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        350,
                                        124,
                                        362
                                    ],
                                    "score": 1.0,
                                    "content": "amounts to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        124,
                                        351,
                                        180,
                                        362
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        181,
                                        350,
                                        541,
                                        362
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses. We similarly prove that the backward pass of standard attention",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                69,
                                361,
                                539,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        361,
                                        109,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        162,
                                        374
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 53
                                },
                                {
                                    "bbox": [
                                        162,
                                        361,
                                        482,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses while the backward pass of FlashAttention requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        483,
                                        363,
                                        539,
                                        374
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 56
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                374,
                                200,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        374,
                                        200,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "HBM accesses (Appendix B).",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 17.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        315,
                        541,
                        387
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        386,
                        540,
                        410
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                386,
                                541,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        386,
                                        541,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "We prove a lower-bound: one cannot asymptotically improve on the number of HBM accesses for all",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                398,
                                347,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        398,
                                        111,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "values of",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        112,
                                        401,
                                        122,
                                        407
                                    ],
                                    "score": 0.84,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        122,
                                        398,
                                        347,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "(the SRAM size) when computing exact attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 21.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        386,
                        541,
                        410
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        415,
                        541,
                        451
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                416,
                                540,
                                427
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        416,
                                        166,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "Proposition 3. Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        167,
                                        419,
                                        176,
                                        425
                                    ],
                                    "score": 0.68,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        416,
                                        540,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                428,
                                542,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        429,
                                        126,
                                        438
                                    ],
                                    "score": 0.89,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        126,
                                        428,
                                        420,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": ". There does not exist an algorithm to compute exact attention with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        420,
                                        429,
                                        475,
                                        439
                                    ],
                                    "score": 0.9,
                                    "content": "o(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        475,
                                        428,
                                        542,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                441,
                                206,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        441,
                                        171,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "for all 𝑀 in the range",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        171,
                                        442,
                                        202,
                                        451
                                    ],
                                    "score": 0.9,
                                    "content": "[d,N d]",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 31
                                },
                                {
                                    "bbox": [
                                        203,
                                        441,
                                        206,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        416,
                        542,
                        451
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        457,
                        540,
                        504
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                457,
                                539,
                                470
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        457,
                                        253,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": "The proof relies on the fact that for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        253,
                                        460,
                                        305,
                                        469
                                    ],
                                    "score": 0.92,
                                    "content": "M=\\Theta(N d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        305,
                                        457,
                                        439,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": " any algorithm must perform ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        440,
                                        459,
                                        539,
                                        469
                                    ],
                                    "score": 0.93,
                                    "content": "\\Omega(N^{2}d^{2}M^{-1})=\\Omega(N d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 99
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                469,
                                541,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        469,
                                        348,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "HBM accesses. This type of lower bound over a subrange of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        349,
                                        472,
                                        359,
                                        479
                                    ],
                                    "score": 0.89,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        359,
                                        469,
                                        541,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "is common in the streaming algorithms",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                482,
                                541,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        482,
                                        452,
                                        495
                                    ],
                                    "score": 1.0,
                                    "content": "literature [88]. We leave proving parameterized complexity [27] lower bounds in terms of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        452,
                                        484,
                                        462,
                                        491
                                    ],
                                    "score": 0.88,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        462,
                                        482,
                                        541,
                                        495
                                    ],
                                    "score": 1.0,
                                    "content": "as exciting future",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                493,
                                96,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        493,
                                        96,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "work.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 27.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        457,
                        541,
                        505
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        505,
                        541,
                        601
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                505,
                                541,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        505,
                                        541,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "We validate that the number of HBM accesses is the main determining factor of attention run-time.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                518,
                                541,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        518,
                                        541,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "In Fig. 2 (left), we see that even though FlashAttention has higher FLOP count compared to standard",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                69,
                                528,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        528,
                                        541,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "attention (due to recomputation in the backward pass), it has much fewer HBM accesses, resulting in much",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                69,
                                541,
                                541,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        541,
                                        320,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "faster runtime. In Fig. 2 (middle), we vary the block size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        544,
                                        331,
                                        552
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        332,
                                        541,
                                        541,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "of FlashAttention, which results in different",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                71,
                                554,
                                540,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        554,
                                        540,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "amounts of HBM accesses, and measure the runtime of the forward pass. As block size increases, the number",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                565,
                                540,
                                577
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        565,
                                        540,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": "of HBM accesses decreases (as we make fewer passes over the input), and runtime decreases. For large enough",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                576,
                                541,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        576,
                                        541,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "block size (beyond 256), the runtime is then bottlenecked by other factors (e.g., arithmetic operations).",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                69,
                                588,
                                358,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        588,
                                        358,
                                        602
                                    ],
                                    "score": 1.0,
                                    "content": "Moreover, larger block size will not fit into the small SRAM size.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 33.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        505,
                        541,
                        602
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        614,
                        357,
                        628
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                615,
                                357,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        615,
                                        91,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "3.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        615,
                                        357,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "Extension: Block-Sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 38,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        635,
                        542,
                        671
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                634,
                                541,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        634,
                                        541,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "We extend FlashAttention to approximate attention: we propose block-sparse FlashAttention, whose",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                646,
                                463,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        646,
                                        463,
                                        659
                                    ],
                                    "score": 1.0,
                                    "content": "IO complexity is smaller than FlashAttention by a factor proportional to the sparsity.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                83,
                                654,
                                466,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        654,
                                        145,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": "Given inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        659,
                                        212,
                                        670
                                    ],
                                    "score": 0.92,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        212,
                                        654,
                                        301,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": "and a mask matrix",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        301,
                                        658,
                                        365,
                                        671
                                    ],
                                    "score": 0.93,
                                    "content": "\\tilde{\\mathbf{M}}\\in\\{0,1\\}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 64
                                },
                                {
                                    "bbox": [
                                        365,
                                        654,
                                        466,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": ", we want to compute:",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 40,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        634,
                        541,
                        674
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        153,
                        677,
                        456,
                        690
                    ],
                    "lines": [
                        {
                            "bbox": [
                                153,
                                677,
                                456,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        153,
                                        677,
                                        456,
                                        690
                                    ],
                                    "score": 0.61,
                                    "content": "\\begin{array}{r}{\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S}\\odot\\mathbb{1}_{\\tilde{\\mathbf{M}}})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                153,
                                677,
                                456,
                                690
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ],
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        697,
                        538,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                698,
                                540,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        698,
                                        99,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        699,
                                        169,
                                        711
                                    ],
                                    "score": 0.87,
                                    "content": "(\\mathbf{S}\\odot\\mathbb{1}_{\\tilde{\\mathbf{M}}})_{k l}=\\mathbf{S}_{k l}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 69
                                },
                                {
                                    "bbox": [
                                        169,
                                        698,
                                        180,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "if",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        181,
                                        698,
                                        215,
                                        709
                                    ],
                                    "score": 0.92,
                                    "content": "\\tilde{\\mathbf{M}}_{k l}=1",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        215,
                                        698,
                                        236,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        236,
                                        702,
                                        252,
                                        708
                                    ],
                                    "score": 0.82,
                                    "content": "-\\infty",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        252,
                                        698,
                                        263,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "if ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        263,
                                        701,
                                        298,
                                        709
                                    ],
                                    "score": 0.91,
                                    "content": "{\\bf{M}}_{k l}=0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 35
                                },
                                {
                                    "bbox": [
                                        298,
                                        698,
                                        354,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": ". We require",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        354,
                                        698,
                                        364,
                                        708
                                    ],
                                    "score": 0.9,
                                    "content": "\\tilde{\\mathbf{M}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        364,
                                        698,
                                        540,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": " to have block form: for some block sizes",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                711,
                                455,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        714,
                                        98,
                                        723
                                    ],
                                    "score": 0.91,
                                    "content": "B_{r},B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        98,
                                        711,
                                        132,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": ", for all",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        133,
                                        713,
                                        146,
                                        723
                                    ],
                                    "score": 0.81,
                                    "content": "k,l",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        147,
                                        711,
                                        152,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        152,
                                        711,
                                        200,
                                        724
                                    ],
                                    "score": 0.89,
                                    "content": "\\tilde{\\mathbf{M}}_{k,l}=\\mathbf{M}_{i j}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        200,
                                        711,
                                        225,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        713,
                                        319,
                                        723
                                    ],
                                    "score": 0.89,
                                    "content": "i=\\lfloor k/B_{r}\\rfloor,j=\\lfloor l/B_{c}\\rfloor",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 94
                                },
                                {
                                    "bbox": [
                                        319,
                                        711,
                                        362,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "for some ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        362,
                                        712,
                                        452,
                                        723
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{M}\\in\\{0,1\\}^{N/B_{r}\\times N/B_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 90
                                },
                                {
                                    "bbox": [
                                        452,
                                        711,
                                        455,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        }
                    ],
                    "index": 43.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        698,
                        540,
                        724
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        72,
                        541,
                        109
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                69,
                                541,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        69,
                                        265,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "Given a predefined block sparsity mask ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        74,
                                        355,
                                        85
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{M}\\in\\{0,1\\}^{N/B_{r}\\times N/B_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 90
                                },
                                {
                                    "bbox": [
                                        355,
                                        69,
                                        541,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "we can easily adapt Algorithm 1 to only",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                86,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        86,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "compute the nonzero blocks of the attention matrix. The algorithm is identical to Algorithm 1, except we",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                98,
                                461,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        98,
                                        461,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "skip zero blocks. We reproduce the algorithm description in Algorithm 5 in Appendix B.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "text",
                    "bbox": [
                        83,
                        109,
                        393,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                110,
                                394,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        394,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "We also analyze the IO complexity of block-sparse FlashAttention.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        128,
                        542,
                        164
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                130,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        130,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "Proposition 4. Let 𝑁 be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                141,
                                542,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        142,
                                        129,
                                        151
                                    ],
                                    "score": 0.84,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 58
                                },
                                {
                                    "bbox": [
                                        129,
                                        141,
                                        386,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": ". Block-sparse FlashAttention (Algorithm 5) requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        387,
                                        142,
                                        471,
                                        152
                                    ],
                                    "score": 0.88,
                                    "content": "\\Theta(N d+N^{2}d^{2}M^{-1}s)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 84
                                },
                                {
                                    "bbox": [
                                        471,
                                        141,
                                        542,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                153,
                                364,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        153,
                                        364,
                                        165
                                    ],
                                    "score": 1.0,
                                    "content": "where 𝑠 is the fraction of nonzero blocks in the block-sparsity mask.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        171,
                        541,
                        219
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                171,
                                541,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        171,
                                        541,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "We see that applying block-sparsity yields a direct improvement by the sparsity to the larger term in the",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                69,
                                182,
                                541,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        182,
                                        261,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "IO complexity. For large sequence lengths ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        261,
                                        187,
                                        270,
                                        194
                                    ],
                                    "score": 0.87,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        270,
                                        182,
                                        276,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": ", ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        276,
                                        189,
                                        280,
                                        194
                                    ],
                                    "score": 0.85,
                                    "content": "s",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        281,
                                        182,
                                        347,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "is often set to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        348,
                                        184,
                                        372,
                                        194
                                    ],
                                    "score": 0.9,
                                    "content": "N^{-1/2}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        372,
                                        182,
                                        406,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": " [11] or",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        407,
                                        185,
                                        448,
                                        195
                                    ],
                                    "score": 0.9,
                                    "content": "N^{-1}\\log N",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        449,
                                        182,
                                        541,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "[3, 17, 92], resulting",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                196,
                                540,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        196,
                                        82,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "in",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        83,
                                        196,
                                        120,
                                        208
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N\\sqrt{N})",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 37
                                },
                                {
                                    "bbox": [
                                        121,
                                        196,
                                        136,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": " or ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        136,
                                        198,
                                        183,
                                        208
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N\\log N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 47
                                },
                                {
                                    "bbox": [
                                        184,
                                        196,
                                        540,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": " IO complexity. For downstream experiments, we use the fixed butterfly sparsity",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                209,
                                443,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        209,
                                        443,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "pattern [17], which has been shown to be able to approximate arbitrary sparsity [16].",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        220,
                        541,
                        255
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                219,
                                541,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        219,
                                        541,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "In Fig. 2 (right), we validate that as the sparsity increases, the runtime of block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                232,
                                542,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        232,
                                        479,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "improves proportionally. On the LRA benchmark, block-sparse FlashAttention achieves ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        479,
                                        233,
                                        500,
                                        242
                                    ],
                                    "score": 0.48,
                                    "content": "2.8\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        500,
                                        232,
                                        542,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": " speedup,",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                244,
                                337,
                                255
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        244,
                                        337,
                                        255
                                    ],
                                    "score": 1.0,
                                    "content": "while performing on par with standard attention (Section 4).",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 12
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        273,
                        183,
                        289
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                274,
                                183,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        275,
                                        82,
                                        287
                                    ],
                                    "score": 1.0,
                                    "content": "4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        94,
                                        274,
                                        183,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "Experiments",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 14
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        298,
                        540,
                        322
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                299,
                                541,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        299,
                                        541,
                                        310
                                    ],
                                    "score": 1.0,
                                    "content": "We evaluate the impact of using FlashAttention to train Transformer models. We validate two claims",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                311,
                                495,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        311,
                                        495,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "about training time and model accuracy, and report attention runtime and memory benchmarks.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        323,
                        542,
                        509
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                322,
                                541,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        322,
                                        500,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "• Training Speed. FlashAttention outperforms the MLPerf 1.1 [58] speed record for BERT by ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        500,
                                        324,
                                        518,
                                        333
                                    ],
                                    "score": 0.34,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        518,
                                        323,
                                        541,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": ", and",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                79,
                                334,
                                542,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        334,
                                        315,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": "speeds up GPT-2 up to 3× over HuggingFace [87] and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        315,
                                        335,
                                        335,
                                        345
                                    ],
                                    "score": 0.46,
                                    "content": "1.8\\times",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        335,
                                        334,
                                        542,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": " over Megatron [77] over standard Transformers.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                80,
                                346,
                                411,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        346,
                                        387,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention speeds up the long-range arena (LRA) benchmark ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        388,
                                        348,
                                        407,
                                        356
                                    ],
                                    "score": 0.51,
                                    "content": "2.4\\times",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        407,
                                        346,
                                        411,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                362,
                                542,
                                374
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        362,
                                        542,
                                        374
                                    ],
                                    "score": 1.0,
                                    "content": "• Quality. FlashAttention scales Transformers to longer sequences, yielding higher quality. FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                80,
                                375,
                                541,
                                386
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        375,
                                        541,
                                        386
                                    ],
                                    "score": 1.0,
                                    "content": "tention trains GPT-2 with context length 4K faster than Megatron trains GPT-2 with context length",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                79,
                                385,
                                542,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        385,
                                        542,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "1K, while achieving 0.7 better perplexity. Modeling longer sequences yields 6.4 points of lift on two long-",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                80,
                                398,
                                541,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        398,
                                        541,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "document classification tasks. Finally, FlashAttention yields the first Transformer that can achieve",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                80,
                                410,
                                541,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        410,
                                        541,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "better-than-random performance on the challenging Path-X task (sequence length 16K), and block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                80,
                                423,
                                541,
                                434
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        423,
                                        541,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention yields the first sequence model that we know of that can achieve better-than-random",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                80,
                                435,
                                295,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        435,
                                        295,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "performance on Path-256 (sequence length 64K).",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                72,
                                451,
                                541,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        451,
                                        541,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "• Benchmarking Attention. We measure the runtime and memory performance of FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                80,
                                462,
                                541,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        462,
                                        541,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "and block-sparse FlashAttention based on sequence length. We confirm that the memory footprint",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                80,
                                474,
                                541,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        474,
                                        379,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "of FlashAttention scales linearly with seq. length and is up to 3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        379,
                                        477,
                                        387,
                                        484
                                    ],
                                    "score": 0.27,
                                    "content": "\\Join",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        387,
                                        474,
                                        541,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": " faster than standard attention for",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                80,
                                486,
                                540,
                                498
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        486,
                                        540,
                                        498
                                    ],
                                    "score": 1.0,
                                    "content": "common seq. lengths (up to 2K). We confirm that runtime of block-sparse FlashAttention scales linearly",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                80,
                                497,
                                417,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        497,
                                        417,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "in seq. length and is faster than all existing approximate attention baselines.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        510,
                        288,
                        522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                511,
                                287,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        511,
                                        287,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "Additional experiment details are in Appendix E.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 32
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        535,
                        327,
                        549
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                536,
                                327,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        536,
                                        91,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "4.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        537,
                                        327,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "Faster Models with FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        555,
                        541,
                        603
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                555,
                                541,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        555,
                                        541,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "BERT. FlashAttention yields the fastest single-node BERT training speed that we know of. We train a",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                567,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        567,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "BERT-large [22] model with FlashAttention on Wikipedia. Table 1 compares our training time to the",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                69,
                                579,
                                541,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        579,
                                        541,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "implementation from Nvidia that set the training speed record for MLPerf 1.1 [58]. Our implementation is",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                120,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        593,
                                        90,
                                        602
                                    ],
                                    "score": 0.41,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        90,
                                        592,
                                        120,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": " faster.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 35.5
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        603,
                        540,
                        625
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                603,
                                541,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        603,
                                        541,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "Table 1: Training time of BERT-large, starting from the same initialization provided by the MLPerf benchmark, to",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                614,
                                509,
                                626
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        614,
                                        187,
                                        626
                                    ],
                                    "score": 1.0,
                                    "content": "reach the target accuracy of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        614,
                                        212,
                                        624
                                    ],
                                    "score": 0.62,
                                    "content": "72.0\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        212,
                                        614,
                                        451,
                                        626
                                    ],
                                    "score": 1.0,
                                    "content": " on masked language modeling. Averaged over 10 runs on 8",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        451,
                                        617,
                                        457,
                                        623
                                    ],
                                    "score": 0.29,
                                    "content": "\\mathbf{\\nabla}\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        458,
                                        614,
                                        509,
                                        626
                                    ],
                                    "score": 1.0,
                                    "content": "A100 GPUs.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 38.5
                },
                {
                    "type": "table",
                    "bbox": [
                        196,
                        634,
                        408,
                        669
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                196,
                                634,
                                408,
                                669
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        196,
                                        634,
                                        408,
                                        669
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                196,
                                                634,
                                                408,
                                                669
                                            ],
                                            "score": 0.962,
                                            "type": "table",
                                            "image_path": "d288e33f7788d1fe0d8b937d203237a7ca0db2c22e0a2050d63c92de5c5d79ec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 40.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        196,
                                        634,
                                        408,
                                        651.5
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        196,
                                        651.5,
                                        408,
                                        669.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                }
                            ]
                        }
                    ],
                    "index": 40.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        687,
                        542,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                687,
                                540,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        687,
                                        540,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2. FlashAttention yields faster training times for GPT-2 [67] on the large OpenWebtext dataset [32]",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                699,
                                542,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        699,
                                        542,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "than the widely used HuggingFace [87] and Megatron-LM [77] implementations. Table 2 shows up to 3× end-",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                70,
                                713,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        713,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "to-end speedup compared to Huggingface and 1.7 speedup compared to Megatron-LM. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        }
                    ],
                    "index": 43
                }
            ],
            "layout_bboxes": [],
            "page_idx": 6,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        196,
                        634,
                        408,
                        669
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                196,
                                634,
                                408,
                                669
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        196,
                                        634,
                                        408,
                                        669
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                196,
                                                634,
                                                408,
                                                669
                                            ],
                                            "score": 0.962,
                                            "type": "table",
                                            "image_path": "d288e33f7788d1fe0d8b937d203237a7ca0db2c22e0a2050d63c92de5c5d79ec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 40.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        196,
                                        634,
                                        408,
                                        651.5
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        196,
                                        651.5,
                                        408,
                                        669.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                }
                            ]
                        }
                    ],
                    "index": 40.5
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                311,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        311,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 13,
                                    "width": 10
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        72,
                        541,
                        109
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                69,
                                541,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        69,
                                        265,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "Given a predefined block sparsity mask ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        74,
                                        355,
                                        85
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{M}\\in\\{0,1\\}^{N/B_{r}\\times N/B_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 90
                                },
                                {
                                    "bbox": [
                                        355,
                                        69,
                                        541,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "we can easily adapt Algorithm 1 to only",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                86,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        86,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "compute the nonzero blocks of the attention matrix. The algorithm is identical to Algorithm 1, except we",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                98,
                                461,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        98,
                                        461,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "skip zero blocks. We reproduce the algorithm description in Algorithm 5 in Appendix B.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 1,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        69,
                        541,
                        110
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        83,
                        109,
                        393,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                110,
                                394,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        394,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "We also analyze the IO complexity of block-sparse FlashAttention.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 3,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        110,
                        394,
                        122
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        128,
                        542,
                        164
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                130,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        130,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "Proposition 4. Let 𝑁 be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                141,
                                542,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        142,
                                        129,
                                        151
                                    ],
                                    "score": 0.84,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 58
                                },
                                {
                                    "bbox": [
                                        129,
                                        141,
                                        386,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": ". Block-sparse FlashAttention (Algorithm 5) requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        387,
                                        142,
                                        471,
                                        152
                                    ],
                                    "score": 0.88,
                                    "content": "\\Theta(N d+N^{2}d^{2}M^{-1}s)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 84
                                },
                                {
                                    "bbox": [
                                        471,
                                        141,
                                        542,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                153,
                                364,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        153,
                                        364,
                                        165
                                    ],
                                    "score": 1.0,
                                    "content": "where 𝑠 is the fraction of nonzero blocks in the block-sparsity mask.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        130,
                        542,
                        165
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        171,
                        541,
                        219
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                171,
                                541,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        171,
                                        541,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "We see that applying block-sparsity yields a direct improvement by the sparsity to the larger term in the",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                69,
                                182,
                                541,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        182,
                                        261,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "IO complexity. For large sequence lengths ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        261,
                                        187,
                                        270,
                                        194
                                    ],
                                    "score": 0.87,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        270,
                                        182,
                                        276,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": ", ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        276,
                                        189,
                                        280,
                                        194
                                    ],
                                    "score": 0.85,
                                    "content": "s",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        281,
                                        182,
                                        347,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "is often set to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        348,
                                        184,
                                        372,
                                        194
                                    ],
                                    "score": 0.9,
                                    "content": "N^{-1/2}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        372,
                                        182,
                                        406,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": " [11] or",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        407,
                                        185,
                                        448,
                                        195
                                    ],
                                    "score": 0.9,
                                    "content": "N^{-1}\\log N",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        449,
                                        182,
                                        541,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "[3, 17, 92], resulting",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                196,
                                540,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        196,
                                        82,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "in",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        83,
                                        196,
                                        120,
                                        208
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N\\sqrt{N})",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 37
                                },
                                {
                                    "bbox": [
                                        121,
                                        196,
                                        136,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": " or ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        136,
                                        198,
                                        183,
                                        208
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N\\log N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 47
                                },
                                {
                                    "bbox": [
                                        184,
                                        196,
                                        540,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": " IO complexity. For downstream experiments, we use the fixed butterfly sparsity",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                209,
                                443,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        209,
                                        443,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "pattern [17], which has been shown to be able to approximate arbitrary sparsity [16].",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8.5,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        171,
                        541,
                        221
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        220,
                        541,
                        255
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                219,
                                541,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        219,
                                        541,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "In Fig. 2 (right), we validate that as the sparsity increases, the runtime of block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                232,
                                542,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        232,
                                        479,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "improves proportionally. On the LRA benchmark, block-sparse FlashAttention achieves ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        479,
                                        233,
                                        500,
                                        242
                                    ],
                                    "score": 0.48,
                                    "content": "2.8\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        500,
                                        232,
                                        542,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": " speedup,",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                244,
                                337,
                                255
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        244,
                                        337,
                                        255
                                    ],
                                    "score": 1.0,
                                    "content": "while performing on par with standard attention (Section 4).",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 12,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        219,
                        542,
                        255
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        273,
                        183,
                        289
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                274,
                                183,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        275,
                                        82,
                                        287
                                    ],
                                    "score": 1.0,
                                    "content": "4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        94,
                                        274,
                                        183,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "Experiments",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 14,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        298,
                        540,
                        322
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                299,
                                541,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        299,
                                        541,
                                        310
                                    ],
                                    "score": 1.0,
                                    "content": "We evaluate the impact of using FlashAttention to train Transformer models. We validate two claims",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                311,
                                495,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        311,
                                        495,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "about training time and model accuracy, and report attention runtime and memory benchmarks.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        299,
                        541,
                        322
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        69,
                        323,
                        542,
                        509
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                322,
                                541,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        322,
                                        500,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "• Training Speed. FlashAttention outperforms the MLPerf 1.1 [58] speed record for BERT by ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        500,
                                        324,
                                        518,
                                        333
                                    ],
                                    "score": 0.34,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        518,
                                        323,
                                        541,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": ", and",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                334,
                                542,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        334,
                                        315,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": "speeds up GPT-2 up to 3× over HuggingFace [87] and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        315,
                                        335,
                                        335,
                                        345
                                    ],
                                    "score": 0.46,
                                    "content": "1.8\\times",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        335,
                                        334,
                                        542,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": " over Megatron [77] over standard Transformers.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                80,
                                346,
                                411,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        346,
                                        387,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention speeds up the long-range arena (LRA) benchmark ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        388,
                                        348,
                                        407,
                                        356
                                    ],
                                    "score": 0.51,
                                    "content": "2.4\\times",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        407,
                                        346,
                                        411,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                362,
                                542,
                                374
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        362,
                                        542,
                                        374
                                    ],
                                    "score": 1.0,
                                    "content": "• Quality. FlashAttention scales Transformers to longer sequences, yielding higher quality. FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                375,
                                541,
                                386
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        375,
                                        541,
                                        386
                                    ],
                                    "score": 1.0,
                                    "content": "tention trains GPT-2 with context length 4K faster than Megatron trains GPT-2 with context length",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                79,
                                385,
                                542,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        385,
                                        542,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "1K, while achieving 0.7 better perplexity. Modeling longer sequences yields 6.4 points of lift on two long-",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                80,
                                398,
                                541,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        398,
                                        541,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "document classification tasks. Finally, FlashAttention yields the first Transformer that can achieve",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                80,
                                410,
                                541,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        410,
                                        541,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "better-than-random performance on the challenging Path-X task (sequence length 16K), and block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                80,
                                423,
                                541,
                                434
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        423,
                                        541,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention yields the first sequence model that we know of that can achieve better-than-random",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                80,
                                435,
                                295,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        435,
                                        295,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "performance on Path-256 (sequence length 64K).",
                                    "type": "text"
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                451,
                                541,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        451,
                                        541,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "• Benchmarking Attention. We measure the runtime and memory performance of FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 27,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                462,
                                541,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        462,
                                        541,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "and block-sparse FlashAttention based on sequence length. We confirm that the memory footprint",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                80,
                                474,
                                541,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        474,
                                        379,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "of FlashAttention scales linearly with seq. length and is up to 3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        379,
                                        477,
                                        387,
                                        484
                                    ],
                                    "score": 0.27,
                                    "content": "\\Join",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        387,
                                        474,
                                        541,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": " faster than standard attention for",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                80,
                                486,
                                540,
                                498
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        486,
                                        540,
                                        498
                                    ],
                                    "score": 1.0,
                                    "content": "common seq. lengths (up to 2K). We confirm that runtime of block-sparse FlashAttention scales linearly",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                80,
                                497,
                                417,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        497,
                                        417,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "in seq. length and is faster than all existing approximate attention baselines.",
                                    "type": "text"
                                }
                            ],
                            "index": 31,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 24,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        322,
                        542,
                        511
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        510,
                        288,
                        522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                511,
                                287,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        511,
                                        287,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "Additional experiment details are in Appendix E.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 32,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        511,
                        287,
                        521
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        535,
                        327,
                        549
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                536,
                                327,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        536,
                                        91,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "4.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        537,
                                        327,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "Faster Models with FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        555,
                        541,
                        603
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                555,
                                541,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        555,
                                        541,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "BERT. FlashAttention yields the fastest single-node BERT training speed that we know of. We train a",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                567,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        567,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "BERT-large [22] model with FlashAttention on Wikipedia. Table 1 compares our training time to the",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                69,
                                579,
                                541,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        579,
                                        541,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "implementation from Nvidia that set the training speed record for MLPerf 1.1 [58]. Our implementation is",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                120,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        593,
                                        90,
                                        602
                                    ],
                                    "score": 0.41,
                                    "content": "15\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        90,
                                        592,
                                        120,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": " faster.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 35.5,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        555,
                        541,
                        603
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        603,
                        540,
                        625
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                603,
                                541,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        603,
                                        541,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "Table 1: Training time of BERT-large, starting from the same initialization provided by the MLPerf benchmark, to",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                614,
                                509,
                                626
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        614,
                                        187,
                                        626
                                    ],
                                    "score": 1.0,
                                    "content": "reach the target accuracy of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        614,
                                        212,
                                        624
                                    ],
                                    "score": 0.62,
                                    "content": "72.0\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        212,
                                        614,
                                        451,
                                        626
                                    ],
                                    "score": 1.0,
                                    "content": " on masked language modeling. Averaged over 10 runs on 8",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        451,
                                        617,
                                        457,
                                        623
                                    ],
                                    "score": 0.29,
                                    "content": "\\mathbf{\\nabla}\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        458,
                                        614,
                                        509,
                                        626
                                    ],
                                    "score": 1.0,
                                    "content": "A100 GPUs.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 38.5,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        603,
                        541,
                        626
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        196,
                        634,
                        408,
                        669
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                196,
                                634,
                                408,
                                669
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        196,
                                        634,
                                        408,
                                        669
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                196,
                                                634,
                                                408,
                                                669
                                            ],
                                            "score": 0.962,
                                            "type": "table",
                                            "image_path": "d288e33f7788d1fe0d8b937d203237a7ca0db2c22e0a2050d63c92de5c5d79ec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 40.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        196,
                                        634,
                                        408,
                                        651.5
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        196,
                                        651.5,
                                        408,
                                        669.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                }
                            ]
                        }
                    ],
                    "index": 40.5,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        687,
                        542,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                687,
                                540,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        687,
                                        540,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2. FlashAttention yields faster training times for GPT-2 [67] on the large OpenWebtext dataset [32]",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                699,
                                542,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        699,
                                        542,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "than the widely used HuggingFace [87] and Megatron-LM [77] implementations. Table 2 shows up to 3× end-",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                70,
                                713,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        713,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "to-end speedup compared to Huggingface and 1.7 speedup compared to Megatron-LM. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                72,
                                74,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "achieves the same perplexity as the other two implementations, as we do not change the model definition.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                85,
                                542,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        85,
                                        542,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Appendix E includes plots of the validation perplexity throughout training, confirming that FlashAttention",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                69,
                                97,
                                474,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        97,
                                        474,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "is as numerically stable as the baselines and produces the same training / validation curves.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 43,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        687,
                        542,
                        723
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        73,
                        542,
                        109
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                74,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "achieves the same perplexity as the other two implementations, as we do not change the model definition.",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                85,
                                542,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        85,
                                        542,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Appendix E includes plots of the validation perplexity throughout training, confirming that FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                69,
                                97,
                                474,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        97,
                                        474,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "is as numerically stable as the baselines and produces the same training / validation curves.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "table",
                    "bbox": [
                        128,
                        141,
                        476,
                        221
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                69,
                                110,
                                539,
                                133
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        109,
                                        540,
                                        122
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                109,
                                                540,
                                                122
                                            ],
                                            "score": 1.0,
                                            "content": "Table 2: GPT-2 small and medium using FlashAttention achieve up to 3× speed up compared to Huggingface",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        122,
                                        489,
                                        132
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                122,
                                                489,
                                                132
                                            ],
                                            "score": 1.0,
                                            "content": "implementation and up to 1.7 compared to Megatron-LM. Training time reported on 8 A100s GPUs.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                128,
                                141,
                                476,
                                221
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        128,
                                        141,
                                        476,
                                        221
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                128,
                                                141,
                                                476,
                                                221
                                            ],
                                            "score": 0.979,
                                            "type": "table",
                                            "image_path": "688e51ed9ca6b66de5bfb050768a54dcc1c77d32eb1f9b904f6d6a67e6a4c153.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        128,
                                        141,
                                        476,
                                        167.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        128,
                                        167.66666666666666,
                                        476,
                                        194.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        128,
                                        194.33333333333331,
                                        476,
                                        220.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 4.75
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        232,
                        542,
                        304
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                232,
                                541,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        232,
                                        541,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "Long-range Arena. We compare vanilla Transformer (with either standard implementation or FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                245,
                                541,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        245,
                                        541,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "tention) on the long-range arena (LRA [80]) benchmark. We measure accuracy, throughput, and training",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                257,
                                541,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        257,
                                        541,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "time of all models. Each task has a different sequence length varying between 1024 and 4096. We follow the",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                268,
                                541,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        268,
                                        541,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "implementation and experimental setting in Tay et al. [80]and Xiong et al. [90].3 Table 3 shows that FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                281,
                                542,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        281,
                                        169,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "tention achieves up ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        169,
                                        281,
                                        189,
                                        291
                                    ],
                                    "score": 0.39,
                                    "content": "2.4\\times",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        190,
                                        281,
                                        542,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": " speed-up compared to standard attention. Block-sparse FlashAttention is",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                292,
                                394,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        292,
                                        394,
                                        304
                                    ],
                                    "score": 1.0,
                                    "content": "faster than all of the approximate attention methods that we have tested.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        304,
                        542,
                        326
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                304,
                                541,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        304,
                                        541,
                                        316
                                    ],
                                    "score": 1.0,
                                    "content": "Table 3: The performance of standard attention, FlashAttention, block-sparse FlashAttention, and approximate",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                315,
                                308,
                                327
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        315,
                                        308,
                                        327
                                    ],
                                    "score": 1.0,
                                    "content": "attention baselines on the Long-Range-Arena benchmarks.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 14.5
                },
                {
                    "type": "table",
                    "bbox": [
                        86,
                        335,
                        516,
                        448
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                86,
                                335,
                                516,
                                448
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        86,
                                        335,
                                        516,
                                        448
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                86,
                                                335,
                                                516,
                                                448
                                            ],
                                            "score": 0.982,
                                            "type": "table",
                                            "image_path": "a438f9a680cc501a0c189c2547fc471c02fac36a64b74ec9a0fa8ab1fbc362bb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 17,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        86,
                                        335,
                                        516,
                                        372.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        86,
                                        372.6666666666667,
                                        516,
                                        410.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        86,
                                        410.33333333333337,
                                        516,
                                        448.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 18
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        464,
                        327,
                        479
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                465,
                                327,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        465,
                                        91,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "4.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        465,
                                        327,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "Better Models with Longer Sequences",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        484,
                        541,
                        544
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                486,
                                541,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        486,
                                        541,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "Language Modeling with Long Context. The runtime and memory-efficiency of FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                497,
                                541,
                                508
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        497,
                                        324,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": "allow us to increase the context length of GPT-2 by 4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        324,
                                        500,
                                        331,
                                        507
                                    ],
                                    "score": 0.3,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        331,
                                        497,
                                        541,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": " while still running faster than the optimized",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                509,
                                541,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        509,
                                        541,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "implementation from Megatron-LM. Table 4 shows that that GPT-2 with FlashAttention and context",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                69,
                                521,
                                542,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        521,
                                        542,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "length 4K is still 30% faster than GPT-2 from Megatron with context length 1K, while achieving 0.7 better",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                533,
                                119,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        533,
                                        119,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "perplexity.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 22
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        546,
                        541,
                        568
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                545,
                                540,
                                557
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        540,
                                        557
                                    ],
                                    "score": 1.0,
                                    "content": "Table 4: GPT-2 small with FlashAttention, with 4 larger context length compared to Megatron-LM, is still 30%",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                557,
                                429,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        557,
                                        320,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "faster while achieving 0.7 better perplexity. Training time on ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        557,
                                        352,
                                        567
                                    ],
                                    "score": 0.28,
                                    "content": "8\\mathrm{\\timesA100}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        353,
                                        557,
                                        429,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": " GPUs is reported.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.5
                },
                {
                    "type": "table",
                    "bbox": [
                        96,
                        586,
                        506,
                        644
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                96,
                                586,
                                506,
                                644
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        96,
                                        586,
                                        506,
                                        644
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                96,
                                                586,
                                                506,
                                                644
                                            ],
                                            "score": 0.978,
                                            "type": "table",
                                            "image_path": "83293b818d909a5b49fcf23cff15a93f815c28cb98641adde10ee277de84fdec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 28,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        96,
                                        586,
                                        506,
                                        605.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        96,
                                        605.3333333333334,
                                        506,
                                        624.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        96,
                                        624.6666666666667,
                                        506,
                                        644.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 29
                                }
                            ]
                        }
                    ],
                    "index": 28
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        660,
                        541,
                        697
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                662,
                                540,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        662,
                                        540,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "Long Document Classification. Training Transformers with longer sequences with FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                672,
                                541,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        672,
                                        541,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "improves performance on the MIMIC-III [47] and ECtHR [6, 7] datasets. MIMIC-III contains intensive care",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                697
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        697
                                    ],
                                    "score": 1.0,
                                    "content": "unit patient discharge summaries, each annotated with multiple labels. ECtHR contains legal cases from the",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 31
                }
            ],
            "layout_bboxes": [],
            "page_idx": 7,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        128,
                        141,
                        476,
                        221
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                69,
                                110,
                                539,
                                133
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        109,
                                        540,
                                        122
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                109,
                                                540,
                                                122
                                            ],
                                            "score": 1.0,
                                            "content": "Table 2: GPT-2 small and medium using FlashAttention achieve up to 3× speed up compared to Huggingface",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        122,
                                        489,
                                        132
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                122,
                                                489,
                                                132
                                            ],
                                            "score": 1.0,
                                            "content": "implementation and up to 1.7 compared to Megatron-LM. Training time reported on 8 A100s GPUs.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                128,
                                141,
                                476,
                                221
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        128,
                                        141,
                                        476,
                                        221
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                128,
                                                141,
                                                476,
                                                221
                                            ],
                                            "score": 0.979,
                                            "type": "table",
                                            "image_path": "688e51ed9ca6b66de5bfb050768a54dcc1c77d32eb1f9b904f6d6a67e6a4c153.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        128,
                                        141,
                                        476,
                                        167.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        128,
                                        167.66666666666666,
                                        476,
                                        194.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        128,
                                        194.33333333333331,
                                        476,
                                        220.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 4.75
                },
                {
                    "type": "table",
                    "bbox": [
                        86,
                        335,
                        516,
                        448
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                86,
                                335,
                                516,
                                448
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        86,
                                        335,
                                        516,
                                        448
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                86,
                                                335,
                                                516,
                                                448
                                            ],
                                            "score": 0.982,
                                            "type": "table",
                                            "image_path": "a438f9a680cc501a0c189c2547fc471c02fac36a64b74ec9a0fa8ab1fbc362bb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 17,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        86,
                                        335,
                                        516,
                                        372.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        86,
                                        372.6666666666667,
                                        516,
                                        410.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        86,
                                        410.33333333333337,
                                        516,
                                        448.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 18
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "table",
                    "bbox": [
                        96,
                        586,
                        506,
                        644
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                96,
                                586,
                                506,
                                644
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        96,
                                        586,
                                        506,
                                        644
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                96,
                                                586,
                                                506,
                                                644
                                            ],
                                            "score": 0.978,
                                            "type": "table",
                                            "image_path": "83293b818d909a5b49fcf23cff15a93f815c28cb98641adde10ee277de84fdec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 28,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        96,
                                        586,
                                        506,
                                        605.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        96,
                                        605.3333333333334,
                                        506,
                                        624.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        96,
                                        624.6666666666667,
                                        506,
                                        644.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 29
                                }
                            ]
                        }
                    ],
                    "index": 28
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        70,
                        703,
                        538,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                80,
                                701,
                                539,
                                715
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        701,
                                        539,
                                        715
                                    ],
                                    "score": 1.0,
                                    "content": "3LRA accuracy results are known to be highly dependent on the tuning procedure [90]. Our reproduced baselines perform",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                71,
                                713,
                                276,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        713,
                                        276,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "better than as reported in the original comparison [80].",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                310,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        310,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "8",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        73,
                        542,
                        109
                    ],
                    "lines": [],
                    "index": 1,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        74,
                        542,
                        110
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "table",
                    "bbox": [
                        128,
                        141,
                        476,
                        221
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                69,
                                110,
                                539,
                                133
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        109,
                                        540,
                                        122
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                109,
                                                540,
                                                122
                                            ],
                                            "score": 1.0,
                                            "content": "Table 2: GPT-2 small and medium using FlashAttention achieve up to 3× speed up compared to Huggingface",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        122,
                                        489,
                                        132
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                122,
                                                489,
                                                132
                                            ],
                                            "score": 1.0,
                                            "content": "implementation and up to 1.7 compared to Megatron-LM. Training time reported on 8 A100s GPUs.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                128,
                                141,
                                476,
                                221
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        128,
                                        141,
                                        476,
                                        221
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                128,
                                                141,
                                                476,
                                                221
                                            ],
                                            "score": 0.979,
                                            "type": "table",
                                            "image_path": "688e51ed9ca6b66de5bfb050768a54dcc1c77d32eb1f9b904f6d6a67e6a4c153.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        128,
                                        141,
                                        476,
                                        167.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        128,
                                        167.66666666666666,
                                        476,
                                        194.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        128,
                                        194.33333333333331,
                                        476,
                                        220.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 4.75,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        232,
                        542,
                        304
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                232,
                                541,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        232,
                                        541,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "Long-range Arena. We compare vanilla Transformer (with either standard implementation or FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                245,
                                541,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        245,
                                        541,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "tention) on the long-range arena (LRA [80]) benchmark. We measure accuracy, throughput, and training",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                257,
                                541,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        257,
                                        541,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "time of all models. Each task has a different sequence length varying between 1024 and 4096. We follow the",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                268,
                                541,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        268,
                                        541,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "implementation and experimental setting in Tay et al. [80]and Xiong et al. [90].3 Table 3 shows that FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                281,
                                542,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        281,
                                        169,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "tention achieves up ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        169,
                                        281,
                                        189,
                                        291
                                    ],
                                    "score": 0.39,
                                    "content": "2.4\\times",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        190,
                                        281,
                                        542,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": " speed-up compared to standard attention. Block-sparse FlashAttention is",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                292,
                                394,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        292,
                                        394,
                                        304
                                    ],
                                    "score": 1.0,
                                    "content": "faster than all of the approximate attention methods that we have tested.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        232,
                        542,
                        304
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        304,
                        542,
                        326
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                304,
                                541,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        304,
                                        541,
                                        316
                                    ],
                                    "score": 1.0,
                                    "content": "Table 3: The performance of standard attention, FlashAttention, block-sparse FlashAttention, and approximate",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                315,
                                308,
                                327
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        315,
                                        308,
                                        327
                                    ],
                                    "score": 1.0,
                                    "content": "attention baselines on the Long-Range-Arena benchmarks.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 14.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        304,
                        541,
                        327
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        86,
                        335,
                        516,
                        448
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                86,
                                335,
                                516,
                                448
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        86,
                                        335,
                                        516,
                                        448
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                86,
                                                335,
                                                516,
                                                448
                                            ],
                                            "score": 0.982,
                                            "type": "table",
                                            "image_path": "a438f9a680cc501a0c189c2547fc471c02fac36a64b74ec9a0fa8ab1fbc362bb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 17,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        86,
                                        335,
                                        516,
                                        372.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        86,
                                        372.6666666666667,
                                        516,
                                        410.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        86,
                                        410.33333333333337,
                                        516,
                                        448.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 18
                                }
                            ]
                        }
                    ],
                    "index": 17,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        464,
                        327,
                        479
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                465,
                                327,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        465,
                                        91,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "4.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        465,
                                        327,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "Better Models with Longer Sequences",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        484,
                        541,
                        544
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                486,
                                541,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        486,
                                        541,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "Language Modeling with Long Context. The runtime and memory-efficiency of FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                497,
                                541,
                                508
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        497,
                                        324,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": "allow us to increase the context length of GPT-2 by 4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        324,
                                        500,
                                        331,
                                        507
                                    ],
                                    "score": 0.3,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        331,
                                        497,
                                        541,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": " while still running faster than the optimized",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                509,
                                541,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        509,
                                        541,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "implementation from Megatron-LM. Table 4 shows that that GPT-2 with FlashAttention and context",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                69,
                                521,
                                542,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        521,
                                        542,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "length 4K is still 30% faster than GPT-2 from Megatron with context length 1K, while achieving 0.7 better",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                533,
                                119,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        533,
                                        119,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "perplexity.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 22,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        486,
                        542,
                        545
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        546,
                        541,
                        568
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                545,
                                540,
                                557
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        540,
                                        557
                                    ],
                                    "score": 1.0,
                                    "content": "Table 4: GPT-2 small with FlashAttention, with 4 larger context length compared to Megatron-LM, is still 30%",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                557,
                                429,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        557,
                                        320,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "faster while achieving 0.7 better perplexity. Training time on ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        557,
                                        352,
                                        567
                                    ],
                                    "score": 0.28,
                                    "content": "8\\mathrm{\\timesA100}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        353,
                                        557,
                                        429,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": " GPUs is reported.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        545,
                        540,
                        569
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        96,
                        586,
                        506,
                        644
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                96,
                                586,
                                506,
                                644
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        96,
                                        586,
                                        506,
                                        644
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                96,
                                                586,
                                                506,
                                                644
                                            ],
                                            "score": 0.978,
                                            "type": "table",
                                            "image_path": "83293b818d909a5b49fcf23cff15a93f815c28cb98641adde10ee277de84fdec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 28,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        96,
                                        586,
                                        506,
                                        605.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        96,
                                        605.3333333333334,
                                        506,
                                        624.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        96,
                                        624.6666666666667,
                                        506,
                                        644.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 29
                                }
                            ]
                        }
                    ],
                    "index": 28,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        660,
                        541,
                        697
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                662,
                                540,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        662,
                                        540,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "Long Document Classification. Training Transformers with longer sequences with FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                672,
                                541,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        672,
                                        541,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "improves performance on the MIMIC-III [47] and ECtHR [6, 7] datasets. MIMIC-III contains intensive care",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                697
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        697
                                    ],
                                    "score": 1.0,
                                    "content": "unit patient discharge summaries, each annotated with multiple labels. ECtHR contains legal cases from the",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 31,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        662,
                        541,
                        697
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        105,
                        71,
                        504,
                        193
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                105,
                                71,
                                504,
                                193
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        71,
                                        504,
                                        193
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                71,
                                                504,
                                                193
                                            ],
                                            "score": 0.973,
                                            "type": "image",
                                            "image_path": "8a24916aa7bd2fea11c2b24532f8b937677627f52580089425918f819ca6e689.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        105,
                                        71,
                                        504,
                                        111.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        105,
                                        111.66666666666666,
                                        504,
                                        152.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        105,
                                        152.33333333333331,
                                        504,
                                        192.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                101,
                                202,
                                507,
                                214
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        103,
                                        202,
                                        507,
                                        215
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                103,
                                                202,
                                                281,
                                                215
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 3: Left: runtime of forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                281,
                                                204,
                                                291,
                                                213
                                            ],
                                            "score": 0.66,
                                            "content": "^+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 10
                                        },
                                        {
                                            "bbox": [
                                                291,
                                                202,
                                                507,
                                                215
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass. Right: attention memory usage.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.0
                },
                {
                    "type": "text",
                    "bbox": [
                        66,
                        235,
                        541,
                        343
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                236,
                                540,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        236,
                                        540,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "European Court of Human Rights, each of which is mapped to articles of the Convention of Human Rights",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                249,
                                541,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        249,
                                        541,
                                        259
                                    ],
                                    "score": 1.0,
                                    "content": "that were allegedly violaged. Both of these datasets contain very long text documents; the average number of",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                260,
                                541,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        260,
                                        541,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "tokens in MIMIC is 2,395 tokens, and the longest document contains 14,562 tokens, while the average and",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                272,
                                540,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        272,
                                        540,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "longest numbers in ECtHR are 2,197 and 49,392, respectively. We evaluate lift from increasing the sequence",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                283,
                                539,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        283,
                                        539,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "length of a pretrained RoBERTa model [56] (we repeat the positional embeddings, as in Beltagy et al. [3]).",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                85,
                                295,
                                541,
                                308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        295,
                                        541,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": "Table 5 shows that sequence length 16K outperforms length 512 by 4.3 points on MIMIC, and that length",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                308,
                                541,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        308,
                                        541,
                                        320
                                    ],
                                    "score": 1.0,
                                    "content": "8K outperforms length 512 by 8.5 points on ECtHR. The discrepancies may be due to subtle distribution",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                320,
                                541,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        320,
                                        541,
                                        332
                                    ],
                                    "score": 1.0,
                                    "content": "shifts: MIMIC-III contains specialized medical text and thus may be more susceptible to a distribution shift",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                332,
                                369,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        332,
                                        369,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "in the document length, whereas ECtHR contains general language.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        315,
                        344,
                        498,
                        376
                    ],
                    "lines": [
                        {
                            "bbox": [
                                315,
                                344,
                                497,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        315,
                                        344,
                                        497,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "Table 6: We report the first Transformer",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                315,
                                356,
                                496,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        315,
                                        356,
                                        496,
                                        364
                                    ],
                                    "score": 1.0,
                                    "content": "model that can achieve non-random perfor-",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                315,
                                367,
                                447,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        315,
                                        367,
                                        447,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "mance on Path-X and Path-256.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 14
                },
                {
                    "type": "table",
                    "bbox": [
                        116,
                        413,
                        301,
                        440
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                114,
                                371,
                                297,
                                404
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        114,
                                        372,
                                        296,
                                        382
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                372,
                                                296,
                                                382
                                            ],
                                            "score": 1.0,
                                            "content": "Table 5: Long Document performance (mi-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        114,
                                        383,
                                        296,
                                        394
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                383,
                                                131,
                                                394
                                            ],
                                            "score": 1.0,
                                            "content": "cro ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                131,
                                                385,
                                                141,
                                                393
                                            ],
                                            "score": 0.87,
                                            "content": "F_{1}",
                                            "type": "inline_equation",
                                            "height": 8,
                                            "width": 10
                                        },
                                        {
                                            "bbox": [
                                                141,
                                                383,
                                                296,
                                                394
                                            ],
                                            "score": 1.0,
                                            "content": ") at different sequence lengths using",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        114,
                                        394,
                                        193,
                                        404
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                394,
                                                193,
                                                404
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 18
                                }
                            ],
                            "index": 17
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                116,
                                413,
                                301,
                                440
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        116,
                                        413,
                                        301,
                                        440
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                116,
                                                413,
                                                301,
                                                440
                                            ],
                                            "score": 0.958,
                                            "type": "table",
                                            "image_path": "b3427df3649e66f0d4389fe95c534c84f4ca6ba6f0e843adb998a32ad18562d6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 21.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        116,
                                        413,
                                        301,
                                        426.5
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        116,
                                        426.5,
                                        301,
                                        440.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                }
                            ]
                        }
                    ],
                    "index": 19.25
                },
                {
                    "type": "table",
                    "bbox": [
                        318,
                        385,
                        488,
                        468
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                318,
                                385,
                                488,
                                468
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        318,
                                        385,
                                        488,
                                        468
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                318,
                                                385,
                                                488,
                                                468
                                            ],
                                            "score": 0.973,
                                            "type": "table",
                                            "image_path": "64c797ada83595cf2d15b1fd9ba963a9f9f93cdc7996848492bcb371616300ab.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 23.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        318,
                                        385,
                                        488,
                                        398.8333333333333
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        318,
                                        398.8333333333333,
                                        488,
                                        412.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        318,
                                        412.66666666666663,
                                        488,
                                        426.49999999999994
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        318,
                                        426.49999999999994,
                                        488,
                                        440.33333333333326
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        318,
                                        440.33333333333326,
                                        488,
                                        454.1666666666666
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        318,
                                        454.1666666666666,
                                        488,
                                        467.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 26
                                }
                            ]
                        }
                    ],
                    "index": 23.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        484,
                        540,
                        604
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                484,
                                541,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        484,
                                        541,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "Path-X and Path-256. The Path-X and Path-256 benchmarks are challenging tasks from the long-range",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                497,
                                541,
                                508
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        497,
                                        541,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": "arena benchmark designed to test long context. The task is to classify whether two points in a black and",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                509,
                                540,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        509,
                                        112,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "white 128",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        512,
                                        119,
                                        518
                                    ],
                                    "score": 0.48,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        120,
                                        509,
                                        540,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "128 (or 256 256) image have a path connecting them, and the images are fed to the transformer",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                521,
                                541,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        521,
                                        541,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "one pixel at a time. In prior work, all transformer models have either run out of memory, or only achieved",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                532,
                                540,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        532,
                                        540,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "random performance [80]. There has been a search for alternative architectures that can model such long",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                541,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        541,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "context [37]. We present here the first result of Transformer models being able to solve Path-X and Path-256",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                69,
                                555,
                                541,
                                570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        555,
                                        541,
                                        570
                                    ],
                                    "score": 1.0,
                                    "content": "(Table 6). We pretrain a transformer on Path-64, and then transfer to Path-X by spatially interpolating",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                568,
                                541,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        568,
                                        541,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "the positional embeddings. FlashAttention achieves 61.4 accuracy on Path-X. Additionally, block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                580,
                                541,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        580,
                                        520,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention enables the Transformers to scale to sequence length 64K, achieving 63.1 accuracy",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        521,
                                        581,
                                        525,
                                        590
                                    ],
                                    "score": 0.39,
                                    "content": "^4",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        525,
                                        580,
                                        541,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": " on",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                114,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        114,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "Path-256.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 31.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        618,
                        248,
                        632
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                619,
                                248,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        91,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "4.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        619,
                                        248,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "Benchmarking Attention",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        638,
                        540,
                        697
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                637,
                                541,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        637,
                                        541,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "We vary sequence length and measure runtime and memory usage of FlashAttention and block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                650,
                                542,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        650,
                                        542,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention against various attention baselines on one A100 GPU with 40 GB HBM, with dropout and",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                662,
                                542,
                                675
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        662,
                                        542,
                                        675
                                    ],
                                    "score": 1.0,
                                    "content": "a padding mask. We compare against reference implementations for exact attention, approximate attention,",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                71,
                                675,
                                541,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        675,
                                        541,
                                        686
                                    ],
                                    "score": 1.0,
                                    "content": "and sparse attention. We report a subset of baselines in the main body; Appendix E contains more baselines",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                686,
                                141,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        686,
                                        141,
                                        698
                                    ],
                                    "score": 1.0,
                                    "content": "and full details.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 40
                }
            ],
            "layout_bboxes": [],
            "page_idx": 8,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        105,
                        71,
                        504,
                        193
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                105,
                                71,
                                504,
                                193
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        71,
                                        504,
                                        193
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                71,
                                                504,
                                                193
                                            ],
                                            "score": 0.973,
                                            "type": "image",
                                            "image_path": "8a24916aa7bd2fea11c2b24532f8b937677627f52580089425918f819ca6e689.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        105,
                                        71,
                                        504,
                                        111.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        105,
                                        111.66666666666666,
                                        504,
                                        152.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        105,
                                        152.33333333333331,
                                        504,
                                        192.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                101,
                                202,
                                507,
                                214
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        103,
                                        202,
                                        507,
                                        215
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                103,
                                                202,
                                                281,
                                                215
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 3: Left: runtime of forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                281,
                                                204,
                                                291,
                                                213
                                            ],
                                            "score": 0.66,
                                            "content": "^+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 10
                                        },
                                        {
                                            "bbox": [
                                                291,
                                                202,
                                                507,
                                                215
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass. Right: attention memory usage.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.0
                }
            ],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        116,
                        413,
                        301,
                        440
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                114,
                                371,
                                297,
                                404
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        114,
                                        372,
                                        296,
                                        382
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                372,
                                                296,
                                                382
                                            ],
                                            "score": 1.0,
                                            "content": "Table 5: Long Document performance (mi-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        114,
                                        383,
                                        296,
                                        394
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                383,
                                                131,
                                                394
                                            ],
                                            "score": 1.0,
                                            "content": "cro ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                131,
                                                385,
                                                141,
                                                393
                                            ],
                                            "score": 0.87,
                                            "content": "F_{1}",
                                            "type": "inline_equation",
                                            "height": 8,
                                            "width": 10
                                        },
                                        {
                                            "bbox": [
                                                141,
                                                383,
                                                296,
                                                394
                                            ],
                                            "score": 1.0,
                                            "content": ") at different sequence lengths using",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        114,
                                        394,
                                        193,
                                        404
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                394,
                                                193,
                                                404
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 18
                                }
                            ],
                            "index": 17
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                116,
                                413,
                                301,
                                440
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        116,
                                        413,
                                        301,
                                        440
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                116,
                                                413,
                                                301,
                                                440
                                            ],
                                            "score": 0.958,
                                            "type": "table",
                                            "image_path": "b3427df3649e66f0d4389fe95c534c84f4ca6ba6f0e843adb998a32ad18562d6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 21.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        116,
                                        413,
                                        301,
                                        426.5
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        116,
                                        426.5,
                                        301,
                                        440.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                }
                            ]
                        }
                    ],
                    "index": 19.25
                },
                {
                    "type": "table",
                    "bbox": [
                        318,
                        385,
                        488,
                        468
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                318,
                                385,
                                488,
                                468
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        318,
                                        385,
                                        488,
                                        468
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                318,
                                                385,
                                                488,
                                                468
                                            ],
                                            "score": 0.973,
                                            "type": "table",
                                            "image_path": "64c797ada83595cf2d15b1fd9ba963a9f9f93cdc7996848492bcb371616300ab.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 23.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        318,
                                        385,
                                        488,
                                        398.8333333333333
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        318,
                                        398.8333333333333,
                                        488,
                                        412.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        318,
                                        412.66666666666663,
                                        488,
                                        426.49999999999994
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        318,
                                        426.49999999999994,
                                        488,
                                        440.33333333333326
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        318,
                                        440.33333333333326,
                                        488,
                                        454.1666666666666
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        318,
                                        454.1666666666666,
                                        488,
                                        467.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 26
                                }
                            ]
                        }
                    ],
                    "index": 23.5
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        83,
                        703,
                        537,
                        714
                    ],
                    "lines": [
                        {
                            "bbox": [
                                82,
                                703,
                                538,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        703,
                                        538,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": "4Path-256 requires longer sequences but has relatively shorter paths than Path-X, so it is easier to obtain a higher accuracy.",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                310,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        310,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "9",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        105,
                        71,
                        504,
                        193
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                105,
                                71,
                                504,
                                193
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        71,
                                        504,
                                        193
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                71,
                                                504,
                                                193
                                            ],
                                            "score": 0.973,
                                            "type": "image",
                                            "image_path": "8a24916aa7bd2fea11c2b24532f8b937677627f52580089425918f819ca6e689.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        105,
                                        71,
                                        504,
                                        111.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        105,
                                        111.66666666666666,
                                        504,
                                        152.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        105,
                                        152.33333333333331,
                                        504,
                                        192.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                101,
                                202,
                                507,
                                214
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        103,
                                        202,
                                        507,
                                        215
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                103,
                                                202,
                                                281,
                                                215
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 3: Left: runtime of forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                281,
                                                204,
                                                291,
                                                213
                                            ],
                                            "score": 0.66,
                                            "content": "^+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 10
                                        },
                                        {
                                            "bbox": [
                                                291,
                                                202,
                                                507,
                                                215
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass. Right: attention memory usage.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.0,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        66,
                        235,
                        541,
                        343
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                236,
                                540,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        236,
                                        540,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "European Court of Human Rights, each of which is mapped to articles of the Convention of Human Rights",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                249,
                                541,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        249,
                                        541,
                                        259
                                    ],
                                    "score": 1.0,
                                    "content": "that were allegedly violaged. Both of these datasets contain very long text documents; the average number of",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                260,
                                541,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        260,
                                        541,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "tokens in MIMIC is 2,395 tokens, and the longest document contains 14,562 tokens, while the average and",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                272,
                                540,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        272,
                                        540,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "longest numbers in ECtHR are 2,197 and 49,392, respectively. We evaluate lift from increasing the sequence",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                283,
                                539,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        283,
                                        539,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "length of a pretrained RoBERTa model [56] (we repeat the positional embeddings, as in Beltagy et al. [3]).",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                85,
                                295,
                                541,
                                308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        295,
                                        541,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": "Table 5 shows that sequence length 16K outperforms length 512 by 4.3 points on MIMIC, and that length",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                308,
                                541,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        308,
                                        541,
                                        320
                                    ],
                                    "score": 1.0,
                                    "content": "8K outperforms length 512 by 8.5 points on ECtHR. The discrepancies may be due to subtle distribution",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                320,
                                541,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        320,
                                        541,
                                        332
                                    ],
                                    "score": 1.0,
                                    "content": "shifts: MIMIC-III contains specialized medical text and thus may be more susceptible to a distribution shift",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                332,
                                369,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        332,
                                        369,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "in the document length, whereas ECtHR contains general language.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 8,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        236,
                        541,
                        345
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        315,
                        344,
                        498,
                        376
                    ],
                    "lines": [
                        {
                            "bbox": [
                                315,
                                344,
                                497,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        315,
                                        344,
                                        497,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "Table 6: We report the first Transformer",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                315,
                                356,
                                496,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        315,
                                        356,
                                        496,
                                        364
                                    ],
                                    "score": 1.0,
                                    "content": "model that can achieve non-random perfor-",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                315,
                                367,
                                447,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        315,
                                        367,
                                        447,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "mance on Path-X and Path-256.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 14,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        315,
                        344,
                        497,
                        375
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        116,
                        413,
                        301,
                        440
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                114,
                                371,
                                297,
                                404
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        114,
                                        372,
                                        296,
                                        382
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                372,
                                                296,
                                                382
                                            ],
                                            "score": 1.0,
                                            "content": "Table 5: Long Document performance (mi-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        114,
                                        383,
                                        296,
                                        394
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                383,
                                                131,
                                                394
                                            ],
                                            "score": 1.0,
                                            "content": "cro ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                131,
                                                385,
                                                141,
                                                393
                                            ],
                                            "score": 0.87,
                                            "content": "F_{1}",
                                            "type": "inline_equation",
                                            "height": 8,
                                            "width": 10
                                        },
                                        {
                                            "bbox": [
                                                141,
                                                383,
                                                296,
                                                394
                                            ],
                                            "score": 1.0,
                                            "content": ") at different sequence lengths using",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        114,
                                        394,
                                        193,
                                        404
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                114,
                                                394,
                                                193,
                                                404
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 18
                                }
                            ],
                            "index": 17
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                116,
                                413,
                                301,
                                440
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        116,
                                        413,
                                        301,
                                        440
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                116,
                                                413,
                                                301,
                                                440
                                            ],
                                            "score": 0.958,
                                            "type": "table",
                                            "image_path": "b3427df3649e66f0d4389fe95c534c84f4ca6ba6f0e843adb998a32ad18562d6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 21.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        116,
                                        413,
                                        301,
                                        426.5
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        116,
                                        426.5,
                                        301,
                                        440.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                }
                            ]
                        }
                    ],
                    "index": 19.25,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        318,
                        385,
                        488,
                        468
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                318,
                                385,
                                488,
                                468
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        318,
                                        385,
                                        488,
                                        468
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                318,
                                                385,
                                                488,
                                                468
                                            ],
                                            "score": 0.973,
                                            "type": "table",
                                            "image_path": "64c797ada83595cf2d15b1fd9ba963a9f9f93cdc7996848492bcb371616300ab.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 23.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        318,
                                        385,
                                        488,
                                        398.8333333333333
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        318,
                                        398.8333333333333,
                                        488,
                                        412.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        318,
                                        412.66666666666663,
                                        488,
                                        426.49999999999994
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        318,
                                        426.49999999999994,
                                        488,
                                        440.33333333333326
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        318,
                                        440.33333333333326,
                                        488,
                                        454.1666666666666
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        318,
                                        454.1666666666666,
                                        488,
                                        467.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 26
                                }
                            ]
                        }
                    ],
                    "index": 23.5,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        484,
                        540,
                        604
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                484,
                                541,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        484,
                                        541,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "Path-X and Path-256. The Path-X and Path-256 benchmarks are challenging tasks from the long-range",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                497,
                                541,
                                508
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        497,
                                        541,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": "arena benchmark designed to test long context. The task is to classify whether two points in a black and",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                509,
                                540,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        509,
                                        112,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "white 128",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        512,
                                        119,
                                        518
                                    ],
                                    "score": 0.48,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        120,
                                        509,
                                        540,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "128 (or 256 256) image have a path connecting them, and the images are fed to the transformer",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                521,
                                541,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        521,
                                        541,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "one pixel at a time. In prior work, all transformer models have either run out of memory, or only achieved",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                532,
                                540,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        532,
                                        540,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "random performance [80]. There has been a search for alternative architectures that can model such long",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                541,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        541,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "context [37]. We present here the first result of Transformer models being able to solve Path-X and Path-256",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                69,
                                555,
                                541,
                                570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        555,
                                        541,
                                        570
                                    ],
                                    "score": 1.0,
                                    "content": "(Table 6). We pretrain a transformer on Path-64, and then transfer to Path-X by spatially interpolating",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                568,
                                541,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        568,
                                        541,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "the positional embeddings. FlashAttention achieves 61.4 accuracy on Path-X. Additionally, block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                580,
                                541,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        580,
                                        520,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention enables the Transformers to scale to sequence length 64K, achieving 63.1 accuracy",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        521,
                                        581,
                                        525,
                                        590
                                    ],
                                    "score": 0.39,
                                    "content": "^4",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        525,
                                        580,
                                        541,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": " on",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                114,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        114,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "Path-256.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 31.5,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        484,
                        541,
                        603
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        618,
                        248,
                        632
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                619,
                                248,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        91,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "4.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        619,
                                        248,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "Benchmarking Attention",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        638,
                        540,
                        697
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                637,
                                541,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        637,
                                        541,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "We vary sequence length and measure runtime and memory usage of FlashAttention and block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                650,
                                542,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        650,
                                        542,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention against various attention baselines on one A100 GPU with 40 GB HBM, with dropout and",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                662,
                                542,
                                675
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        662,
                                        542,
                                        675
                                    ],
                                    "score": 1.0,
                                    "content": "a padding mask. We compare against reference implementations for exact attention, approximate attention,",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                71,
                                675,
                                541,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        675,
                                        541,
                                        686
                                    ],
                                    "score": 1.0,
                                    "content": "and sparse attention. We report a subset of baselines in the main body; Appendix E contains more baselines",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                686,
                                141,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        686,
                                        141,
                                        698
                                    ],
                                    "score": 1.0,
                                    "content": "and full details.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 40,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        637,
                        542,
                        698
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        73,
                        541,
                        192
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                541,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        407,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "Runtime. Figure 3 (left) reports the runtime in milliseconds of the forward",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        408,
                                        76,
                                        417,
                                        84
                                    ],
                                    "score": 0.3,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        417,
                                        74,
                                        541,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass of FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                86,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        86,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "tention and block-sparse FlashAttention compared to the baselines in exact, approximate, and sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                99,
                                541,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        99,
                                        541,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "attention (exact numbers in Appendix E). Runtime grows quadratically with sequence length, but FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                110,
                                541,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        110,
                                        411,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "tention runs significantly faster than exact attention baselines, up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        411,
                                        111,
                                        424,
                                        120
                                    ],
                                    "score": 0.37,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        424,
                                        110,
                                        541,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": " faster than the PyTorch",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                122,
                                542,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        122,
                                        542,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "implementation. The runtimes of many approximate/sparse attention mechanisms grow linearly with se-",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                133,
                                542,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        133,
                                        542,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "quence length, but FlashAttention still runs faster than approximate and sparse attention for short",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                147,
                                541,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        147,
                                        541,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "sequences due to fewer memory accesses. The approximate attention runtimes begin to cross over with",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                158,
                                541,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        158,
                                        541,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention at sequences between 512 and 1024. On the other hand, block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                69,
                                169,
                                542,
                                182
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        169,
                                        542,
                                        182
                                    ],
                                    "score": 1.0,
                                    "content": "is faster than all implementations of exact, sparse, and approximate attention that we know of, across all",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                181,
                                147,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        181,
                                        147,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "sequence lengths.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 4.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        206,
                        540,
                        278
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                207,
                                541,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        207,
                                        541,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "Memory Footprint. Figure 3 (right) shows the memory footprint of FlashAttention and block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                219,
                                541,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        219,
                                        541,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention compared to various exact, approximate, and sparse attention baselines. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                230,
                                541,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        230,
                                        541,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "and block-sparse FlashAttention have the same memory footprint, which grows linearly with sequence",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                243,
                                541,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        244,
                                        224,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "length. FlashAttention is up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        243,
                                        241,
                                        253
                                    ],
                                    "score": 0.71,
                                    "content": "20\\times",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        242,
                                        244,
                                        541,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": " more memory efficient than exact attention baselines, and is more",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                255,
                                541,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        255,
                                        541,
                                        267
                                    ],
                                    "score": 1.0,
                                    "content": "memory-efficient than the approximate attention baselines. All other algorithms except for Linformer run",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                267,
                                542,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        267,
                                        403,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "out of memory on an A100 GPU before 64K, and FlashAttention is still 2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        403,
                                        270,
                                        410,
                                        276
                                    ],
                                    "score": 0.43,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        410,
                                        267,
                                        542,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": " more efficient than Linformer.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 12.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        295,
                        332,
                        311
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                297,
                                331,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        297,
                                        81,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        297,
                                        331,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "Limitations and Future Directions",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        320,
                        507,
                        332
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                321,
                                506,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        321,
                                        506,
                                        333
                                    ],
                                    "score": 1.0,
                                    "content": "We discuss limitations of our approach and future directions. Related work is given in Appendix A.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        333,
                        541,
                        404
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                333,
                                541,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        333,
                                        541,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "Compiling to CUDA. Our current approach to building IO-aware implementations of attention requires",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                344,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        344,
                                        541,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "writing a new CUDA kernel for each new attention implementation. This requires writing the attention",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                357,
                                542,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        357,
                                        542,
                                        369
                                    ],
                                    "score": 1.0,
                                    "content": "algorithm in a considerably lower-level language than PyTorch, and requires significant engineering effort.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                369,
                                541,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        369,
                                        541,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "Implementations may also not be transferrable across GPU architectures. These limitations suggest the",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                380,
                                541,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        380,
                                        541,
                                        394
                                    ],
                                    "score": 1.0,
                                    "content": "need for a method that supports writing attention algorithms in a high-level language (e.g., PyTorch), and",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                393,
                                541,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        393,
                                        541,
                                        405
                                    ],
                                    "score": 1.0,
                                    "content": "compiling to IO-aware implementations in CUDA—similar to efforts such as Halide in image processing [70].",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 20.5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        405,
                        541,
                        451
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                403,
                                542,
                                417
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        403,
                                        542,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "IO-Aware Deep Learning. We believe that the IO-aware approach can extend beyond attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                417,
                                541,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        541,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "Attention is the most memory-intensive computation in Transformers, but every layer in a deep network",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                429,
                                541,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        429,
                                        541,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "touches GPU HBM. We hope our work inspires IO-aware implementations of additional modules. We discuss",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                442,
                                256,
                                452
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        442,
                                        256,
                                        452
                                    ],
                                    "score": 1.0,
                                    "content": "these potential extensions in Appendix D.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 25.5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        453,
                        540,
                        500
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                452,
                                540,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        452,
                                        540,
                                        465
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-GPU IO-Aware Methods. Our IO-aware implementation of attention is optimal within con-",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                465,
                                541,
                                476
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        465,
                                        541,
                                        476
                                    ],
                                    "score": 1.0,
                                    "content": "stants for computing attention on a single GPU. However, the attention computation may be parallelizable",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                477,
                                540,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        477,
                                        540,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": "across multiple GPUs [72]. Using multiple GPUs adds an additional layer to IO analysis—accounting for",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                489,
                                450,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        489,
                                        450,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "data transfer between GPUs. We hope our work inspires future work in this direction.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        513,
                        162,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                514,
                                162,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        514,
                                        162,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "Acknowledgments",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 32
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        532,
                        541,
                        603
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                532,
                                541,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        532,
                                        541,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "Our implementation uses Apex’s FMHA code (https://github.com/NVIDIA/apex/tree/master/apex/",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                540,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        540,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "contrib/csrc/fmha) as a starting point. We thank Young-Jun Ko for the in-depth explanation of his FMHA",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                557,
                                540,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        557,
                                        540,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "implementation and for his thoughtful answers to our questions about CUDA. We thank Sabri Eyuboglu,",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                569,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        569,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "Megan Leszczynski, Laurel Orr, Yuhuai Wu, Beidi Chen, and Xun Huang for their constructive feedback and",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                580,
                                542,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        580,
                                        542,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "suggestions on early drafts of the paper. We thank Markus Rabe and Charles Staats for helpful discussion of",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                593,
                                183,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        593,
                                        183,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "their attention algorithm.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 35.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        604,
                        541,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                603,
                                542,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        603,
                                        542,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "We gratefully acknowledge the support of NIH under No. U54EB020405 (Mobilize), NSF under Nos.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                616,
                                541,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        616,
                                        541,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "CCF1763315 (Beyond Sparsity), CCF1563078 (Volume to Velocity), and 1937301 (RTML); ARL under",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                628,
                                541,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        628,
                                        541,
                                        640
                                    ],
                                    "score": 1.0,
                                    "content": "No. W911NF-21-2-0251 (Interactive Human-AI Teaming); ONR under No. N000141712266 (Unifying Weak",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                71,
                                640,
                                541,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        640,
                                        541,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "Supervision); ONR N00014-20-1-2480: Understanding and Applying Non-Euclidean Geometry in Machine",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                651,
                                542,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        651,
                                        542,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": "Learning; N000142012275 (NEPTUNE); NXP, Xilinx, LETI-CEA, Intel, IBM, Microsoft, NEC, Toshiba,",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                70,
                                663,
                                542,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        663,
                                        542,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "TSMC, ARM, Hitachi, BASF, Accenture, Ericsson, Qualcomm, Analog Devices, Google Cloud, Salesforce,",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                70,
                                676,
                                542,
                                688
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        676,
                                        542,
                                        688
                                    ],
                                    "score": 1.0,
                                    "content": "Total, the HAI-GCP & HAI-Azure Cloud Credits for Research program, the Stanford Data Science Initiative",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                70,
                                688,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        688,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "(SDSI), Department of Defense (DoD) through the National Defense Science and Engineering Graduate",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        },
                        {
                            "bbox": [
                                70,
                                699,
                                541,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        699,
                                        541,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "Fellowship (NDSEG) Program, and members of the Stanford DAWN project: Facebook, Google, and",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        },
                        {
                            "bbox": [
                                70,
                                711,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        711,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "VMWare. The U.S. Government is authorized to reproduce and distribute reprints for Governmental purposes",
                                    "type": "text"
                                }
                            ],
                            "index": 48
                        }
                    ],
                    "index": 43.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 9,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        743,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                314,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        314,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 13,
                                    "width": 16
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        73,
                        541,
                        192
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                541,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        407,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "Runtime. Figure 3 (left) reports the runtime in milliseconds of the forward",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        408,
                                        76,
                                        417,
                                        84
                                    ],
                                    "score": 0.3,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        417,
                                        74,
                                        541,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass of FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                86,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        86,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "tention and block-sparse FlashAttention compared to the baselines in exact, approximate, and sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                99,
                                541,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        99,
                                        541,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "attention (exact numbers in Appendix E). Runtime grows quadratically with sequence length, but FlashAt-",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                110,
                                541,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        110,
                                        411,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "tention runs significantly faster than exact attention baselines, up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        411,
                                        111,
                                        424,
                                        120
                                    ],
                                    "score": 0.37,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        424,
                                        110,
                                        541,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": " faster than the PyTorch",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                122,
                                542,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        122,
                                        542,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "implementation. The runtimes of many approximate/sparse attention mechanisms grow linearly with se-",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                133,
                                542,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        133,
                                        542,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "quence length, but FlashAttention still runs faster than approximate and sparse attention for short",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                147,
                                541,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        147,
                                        541,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "sequences due to fewer memory accesses. The approximate attention runtimes begin to cross over with",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                158,
                                541,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        158,
                                        541,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention at sequences between 512 and 1024. On the other hand, block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                69,
                                169,
                                542,
                                182
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        169,
                                        542,
                                        182
                                    ],
                                    "score": 1.0,
                                    "content": "is faster than all implementations of exact, sparse, and approximate attention that we know of, across all",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                181,
                                147,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        181,
                                        147,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "sequence lengths.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 4.5,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        74,
                        542,
                        192
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        206,
                        540,
                        278
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                207,
                                541,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        207,
                                        541,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "Memory Footprint. Figure 3 (right) shows the memory footprint of FlashAttention and block-sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                219,
                                541,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        219,
                                        541,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention compared to various exact, approximate, and sparse attention baselines. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                230,
                                541,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        230,
                                        541,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "and block-sparse FlashAttention have the same memory footprint, which grows linearly with sequence",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                243,
                                541,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        244,
                                        224,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "length. FlashAttention is up to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        243,
                                        241,
                                        253
                                    ],
                                    "score": 0.71,
                                    "content": "20\\times",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        242,
                                        244,
                                        541,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": " more memory efficient than exact attention baselines, and is more",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                255,
                                541,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        255,
                                        541,
                                        267
                                    ],
                                    "score": 1.0,
                                    "content": "memory-efficient than the approximate attention baselines. All other algorithms except for Linformer run",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                267,
                                542,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        267,
                                        403,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "out of memory on an A100 GPU before 64K, and FlashAttention is still 2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        403,
                                        270,
                                        410,
                                        276
                                    ],
                                    "score": 0.43,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        410,
                                        267,
                                        542,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": " more efficient than Linformer.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 12.5,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        207,
                        542,
                        279
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        295,
                        332,
                        311
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                297,
                                331,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        297,
                                        81,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        297,
                                        331,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "Limitations and Future Directions",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        320,
                        507,
                        332
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                321,
                                506,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        321,
                                        506,
                                        333
                                    ],
                                    "score": 1.0,
                                    "content": "We discuss limitations of our approach and future directions. Related work is given in Appendix A.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        321,
                        506,
                        333
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        333,
                        541,
                        404
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                333,
                                541,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        333,
                                        541,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "Compiling to CUDA. Our current approach to building IO-aware implementations of attention requires",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                344,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        344,
                                        541,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "writing a new CUDA kernel for each new attention implementation. This requires writing the attention",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                357,
                                542,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        357,
                                        542,
                                        369
                                    ],
                                    "score": 1.0,
                                    "content": "algorithm in a considerably lower-level language than PyTorch, and requires significant engineering effort.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                369,
                                541,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        369,
                                        541,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "Implementations may also not be transferrable across GPU architectures. These limitations suggest the",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                380,
                                541,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        380,
                                        541,
                                        394
                                    ],
                                    "score": 1.0,
                                    "content": "need for a method that supports writing attention algorithms in a high-level language (e.g., PyTorch), and",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                393,
                                541,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        393,
                                        541,
                                        405
                                    ],
                                    "score": 1.0,
                                    "content": "compiling to IO-aware implementations in CUDA—similar to efforts such as Halide in image processing [70].",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 20.5,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        333,
                        542,
                        405
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        405,
                        541,
                        451
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                403,
                                542,
                                417
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        403,
                                        542,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "IO-Aware Deep Learning. We believe that the IO-aware approach can extend beyond attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                417,
                                541,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        541,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "Attention is the most memory-intensive computation in Transformers, but every layer in a deep network",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                429,
                                541,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        429,
                                        541,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "touches GPU HBM. We hope our work inspires IO-aware implementations of additional modules. We discuss",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                442,
                                256,
                                452
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        442,
                                        256,
                                        452
                                    ],
                                    "score": 1.0,
                                    "content": "these potential extensions in Appendix D.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 25.5,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        403,
                        542,
                        452
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        453,
                        540,
                        500
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                452,
                                540,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        452,
                                        540,
                                        465
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-GPU IO-Aware Methods. Our IO-aware implementation of attention is optimal within con-",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                465,
                                541,
                                476
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        465,
                                        541,
                                        476
                                    ],
                                    "score": 1.0,
                                    "content": "stants for computing attention on a single GPU. However, the attention computation may be parallelizable",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                477,
                                540,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        477,
                                        540,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": "across multiple GPUs [72]. Using multiple GPUs adds an additional layer to IO analysis—accounting for",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                489,
                                450,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        489,
                                        450,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "data transfer between GPUs. We hope our work inspires future work in this direction.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29.5,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        452,
                        541,
                        501
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        513,
                        162,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                514,
                                162,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        514,
                                        162,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "Acknowledgments",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 32,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        532,
                        541,
                        603
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                532,
                                541,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        532,
                                        541,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "Our implementation uses Apex’s FMHA code (https://github.com/NVIDIA/apex/tree/master/apex/",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                540,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        540,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "contrib/csrc/fmha) as a starting point. We thank Young-Jun Ko for the in-depth explanation of his FMHA",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                557,
                                540,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        557,
                                        540,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "implementation and for his thoughtful answers to our questions about CUDA. We thank Sabri Eyuboglu,",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                569,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        569,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "Megan Leszczynski, Laurel Orr, Yuhuai Wu, Beidi Chen, and Xun Huang for their constructive feedback and",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                580,
                                542,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        580,
                                        542,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "suggestions on early drafts of the paper. We thank Markus Rabe and Charles Staats for helpful discussion of",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                593,
                                183,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        593,
                                        183,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "their attention algorithm.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 35.5,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        532,
                        542,
                        604
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        604,
                        541,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                603,
                                542,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        603,
                                        542,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "We gratefully acknowledge the support of NIH under No. U54EB020405 (Mobilize), NSF under Nos.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                616,
                                541,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        616,
                                        541,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "CCF1763315 (Beyond Sparsity), CCF1563078 (Volume to Velocity), and 1937301 (RTML); ARL under",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                628,
                                541,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        628,
                                        541,
                                        640
                                    ],
                                    "score": 1.0,
                                    "content": "No. W911NF-21-2-0251 (Interactive Human-AI Teaming); ONR under No. N000141712266 (Unifying Weak",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                71,
                                640,
                                541,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        640,
                                        541,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "Supervision); ONR N00014-20-1-2480: Understanding and Applying Non-Euclidean Geometry in Machine",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                651,
                                542,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        651,
                                        542,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": "Learning; N000142012275 (NEPTUNE); NXP, Xilinx, LETI-CEA, Intel, IBM, Microsoft, NEC, Toshiba,",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                70,
                                663,
                                542,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        663,
                                        542,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "TSMC, ARM, Hitachi, BASF, Accenture, Ericsson, Qualcomm, Analog Devices, Google Cloud, Salesforce,",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                70,
                                676,
                                542,
                                688
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        676,
                                        542,
                                        688
                                    ],
                                    "score": 1.0,
                                    "content": "Total, the HAI-GCP & HAI-Azure Cloud Credits for Research program, the Stanford Data Science Initiative",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                70,
                                688,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        688,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "(SDSI), Department of Defense (DoD) through the National Defense Science and Engineering Graduate",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        },
                        {
                            "bbox": [
                                70,
                                699,
                                541,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        699,
                                        541,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "Fellowship (NDSEG) Program, and members of the Stanford DAWN project: Facebook, Google, and",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        },
                        {
                            "bbox": [
                                70,
                                711,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        711,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "VMWare. The U.S. Government is authorized to reproduce and distribute reprints for Governmental purposes",
                                    "type": "text"
                                }
                            ],
                            "index": 48
                        },
                        {
                            "bbox": [
                                71,
                                74,
                                541,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        541,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "notwithstanding any copyright notation thereon. Any opinions, findings, and conclusions or recommendations",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                86,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        86,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "expressed in this material are those of the authors and do not necessarily reflect the views, policies, or",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                99,
                                541,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        99,
                                        541,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "endorsements, either expressed or implied, of NIH, ONR, or the U.S. Government. Atri Rudra’s research is",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                110,
                                245,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        110,
                                        245,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "supported by NSF grant CCF-1763481.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 43.5,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        603,
                        542,
                        723
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        73,
                        540,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                541,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        541,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "notwithstanding any copyright notation thereon. Any opinions, findings, and conclusions or recommendations",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                86,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        86,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "expressed in this material are those of the authors and do not necessarily reflect the views, policies, or",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                99,
                                541,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        99,
                                        541,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "endorsements, either expressed or implied, of NIH, ONR, or the U.S. Government. Atri Rudra’s research is",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                110,
                                245,
                                122
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        110,
                                        245,
                                        122
                                    ],
                                    "score": 1.0,
                                    "content": "supported by NSF grant CCF-1763481.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 1.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        138,
                        145,
                        154
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                139,
                                146,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        139,
                                        146,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "References",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        147,
                        544,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                75,
                                163,
                                542,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        163,
                                        542,
                                        177
                                    ],
                                    "score": 1.0,
                                    "content": "[1] Alok Aggarwal and S Vitter, Jeffrey. The input/output complexity of sorting and related problems.",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                91,
                                176,
                                324,
                                188
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        176,
                                        324,
                                        188
                                    ],
                                    "score": 1.0,
                                    "content": "Communications of the ACM, 31(9):1116–1127, 1988.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                75,
                                195,
                                542,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        195,
                                        542,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "[2] Irwan Bello. LambdaNetworks: Modeling long-range interactions without attention. arXiv preprint",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                91,
                                209,
                                198,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        209,
                                        198,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2102.08602, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                76,
                                228,
                                542,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        228,
                                        542,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "[3] Iz Beltagy, Matthew E Peters, and Arman Cohan. Longformer: The long-document transformer. arXiv",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                89,
                                240,
                                237,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        240,
                                        237,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "preprint arXiv:2004.05150, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                76,
                                259,
                                542,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        259,
                                        542,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "[4] L Susan Blackford, Antoine Petitet, Roldan Pozo, Karin Remington, R Clint Whaley, James Demmel,",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                90,
                                272,
                                541,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        272,
                                        541,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "Jack Dongarra, Iain Duff, Sven Hammarling, Greg Henry, et al. An updated set of basic linear algebra",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                89,
                                283,
                                479,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        283,
                                        479,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "subprograms (blas). ACM Transactions on Mathematical Software, 28(2):135–151, 2002.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                76,
                                304,
                                542,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        304,
                                        542,
                                        316
                                    ],
                                    "score": 1.0,
                                    "content": "[5] Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                90,
                                315,
                                542,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        315,
                                        542,
                                        329
                                    ],
                                    "score": 1.0,
                                    "content": "Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                90,
                                327,
                                407,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        327,
                                        407,
                                        340
                                    ],
                                    "score": 1.0,
                                    "content": "Advances in neural information processing systems, 33:1877–1901, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                76,
                                348,
                                542,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        348,
                                        542,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "[6] Ilias Chalkidis, Ion Androutsopoulos, and Nikolaos Aletras. Neural legal judgment prediction in English.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                89,
                                358,
                                542,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        358,
                                        542,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "In Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                91,
                                371,
                                542,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        371,
                                        542,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "4317–4323, Florence, Italy, 2019. Association for Computational Linguistics. doi: 10.18653/v1/P19-1424.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                90,
                                382,
                                336,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        382,
                                        336,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": "URL https://www.aclweb.org/anthology/P19-1424.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                77,
                                403,
                                541,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        403,
                                        541,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "[7] Ilias Chalkidis, Manos Fergadiotis, Dimitrios Tsarapatsanis, Nikolaos Aletras, Ion Androutsopoulos, and",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                91,
                                416,
                                540,
                                427
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        416,
                                        540,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "Prodromos Malakasiotis. Paragraph-level rationale extraction through regularization: A case study on",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                90,
                                427,
                                542,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        427,
                                        542,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": "european court of human rights cases. In Proceedings of the Annual Conference of the North American",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                91,
                                439,
                                542,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        439,
                                        542,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "Chapter of the Association for Computational Linguistics, Mexico City, Mexico, 2021. Association for",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                91,
                                452,
                                212,
                                464
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        452,
                                        212,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": "Computational Linguistics.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                77,
                                471,
                                542,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        471,
                                        542,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "[8] Benjamin Charlier, Jean Feydy, Joan Alexis Glaunès, François-David Collin, and Ghislain Durif. Kernel",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                91,
                                483,
                                542,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        483,
                                        542,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "operations on the gpu, with autodiff, without memory overflows. Journal of Machine Learning Research,",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                90,
                                494,
                                397,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        494,
                                        397,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "22(74):1–6, 2021. URL http://jmlr.org/papers/v22/20-275.html.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                75,
                                514,
                                542,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        514,
                                        542,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": "[9] Beidi Chen, Tri Dao, Eric Winsor, Zhao Song, Atri Rudra, and Christopher Ré. Scatterbrain: Unifying",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                89,
                                528,
                                542,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        528,
                                        542,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "sparse and low-rank attention. In Advances in Neural Information Processing Systems (NeurIPS), 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                542,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        542,
                                        560
                                    ],
                                    "score": 1.0,
                                    "content": "[10] Tianqi Chen, Bing Xu, Chiyuan Zhang, and Carlos Guestrin. Training deep nets with sublinear memory",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                90,
                                559,
                                288,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        559,
                                        288,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "cost. arXiv preprint arXiv:1604.06174, 2016.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                72,
                                578,
                                540,
                                591
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        578,
                                        540,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "[11] Rewon Child, Scott Gray, Alec Radford, and Ilya Sutskever. Generating long sequences with sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                89,
                                590,
                                327,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        590,
                                        327,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "transformers. arXiv preprint arXiv:1904.10509, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                609,
                                542,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        609,
                                        542,
                                        624
                                    ],
                                    "score": 1.0,
                                    "content": "[12] Krzysztof Marcin Choromanski, Valerii Likhosherstov, David Dohan, Xingyou Song, Andreea Gane,",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                91,
                                622,
                                541,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        622,
                                        541,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "Tamas Sarlos, Peter Hawkins, Jared Quincy Davis, Afroz Mohiuddin, Lukasz Kaiser, et al. Rethinking",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                91,
                                635,
                                526,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        635,
                                        526,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "attention with performers. In International Conference on Learning Representations (ICLR), 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                653,
                                542,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        653,
                                        542,
                                        667
                                    ],
                                    "score": 1.0,
                                    "content": "[13] Xiang Dai, Ilias Chalkidis, Sune Darkner, and Desmond Elliott. Revisiting transformer-based models for",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                90,
                                667,
                                394,
                                679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        667,
                                        394,
                                        679
                                    ],
                                    "score": 1.0,
                                    "content": "long document classification. arXiv preprint arXiv:2204.06683, 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                686,
                                542,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        686,
                                        542,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "[14] Zihang Dai, Zhilin Yang, Yiming Yang, Jaime G Carbonell, Quoc Le, and Ruslan Salakhutdinov.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                91,
                                698,
                                542,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        698,
                                        542,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "Transformer-XL: Attentive language models beyond a fixed-length context. In Proceedings of the 57th",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                91,
                                711,
                                484,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        711,
                                        484,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "Annual Meeting of the Association for Computational Linguistics, pages 2978–2988, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 23.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 10,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        310,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 12,
                                    "width": 15
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        73,
                        540,
                        121
                    ],
                    "lines": [],
                    "index": 1.5,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        74,
                        541,
                        122
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        138,
                        145,
                        154
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                139,
                                146,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        139,
                                        146,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "References",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        70,
                        147,
                        544,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                75,
                                163,
                                542,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        163,
                                        542,
                                        177
                                    ],
                                    "score": 1.0,
                                    "content": "[1] Alok Aggarwal and S Vitter, Jeffrey. The input/output complexity of sorting and related problems.",
                                    "type": "text"
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                176,
                                324,
                                188
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        176,
                                        324,
                                        188
                                    ],
                                    "score": 1.0,
                                    "content": "Communications of the ACM, 31(9):1116–1127, 1988.",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                195,
                                542,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        195,
                                        542,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "[2] Irwan Bello. LambdaNetworks: Modeling long-range interactions without attention. arXiv preprint",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                209,
                                198,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        209,
                                        198,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2102.08602, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                76,
                                228,
                                542,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        228,
                                        542,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "[3] Iz Beltagy, Matthew E Peters, and Arman Cohan. Longformer: The long-document transformer. arXiv",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                240,
                                237,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        240,
                                        237,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "preprint arXiv:2004.05150, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                76,
                                259,
                                542,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        259,
                                        542,
                                        272
                                    ],
                                    "score": 1.0,
                                    "content": "[4] L Susan Blackford, Antoine Petitet, Roldan Pozo, Karin Remington, R Clint Whaley, James Demmel,",
                                    "type": "text"
                                }
                            ],
                            "index": 11,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                272,
                                541,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        272,
                                        541,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "Jack Dongarra, Iain Duff, Sven Hammarling, Greg Henry, et al. An updated set of basic linear algebra",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                89,
                                283,
                                479,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        283,
                                        479,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "subprograms (blas). ACM Transactions on Mathematical Software, 28(2):135–151, 2002.",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                76,
                                304,
                                542,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        304,
                                        542,
                                        316
                                    ],
                                    "score": 1.0,
                                    "content": "[5] Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                315,
                                542,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        315,
                                        542,
                                        329
                                    ],
                                    "score": 1.0,
                                    "content": "Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                90,
                                327,
                                407,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        327,
                                        407,
                                        340
                                    ],
                                    "score": 1.0,
                                    "content": "Advances in neural information processing systems, 33:1877–1901, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                76,
                                348,
                                542,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        348,
                                        542,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "[6] Ilias Chalkidis, Ion Androutsopoulos, and Nikolaos Aletras. Neural legal judgment prediction in English.",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                358,
                                542,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        358,
                                        542,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "In Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                91,
                                371,
                                542,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        371,
                                        542,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "4317–4323, Florence, Italy, 2019. Association for Computational Linguistics. doi: 10.18653/v1/P19-1424.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                90,
                                382,
                                336,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        382,
                                        336,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": "URL https://www.aclweb.org/anthology/P19-1424.",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                77,
                                403,
                                541,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        403,
                                        541,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "[7] Ilias Chalkidis, Manos Fergadiotis, Dimitrios Tsarapatsanis, Nikolaos Aletras, Ion Androutsopoulos, and",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                91,
                                416,
                                540,
                                427
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        416,
                                        540,
                                        427
                                    ],
                                    "score": 1.0,
                                    "content": "Prodromos Malakasiotis. Paragraph-level rationale extraction through regularization: A case study on",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                90,
                                427,
                                542,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        427,
                                        542,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": "european court of human rights cases. In Proceedings of the Annual Conference of the North American",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                91,
                                439,
                                542,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        439,
                                        542,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "Chapter of the Association for Computational Linguistics, Mexico City, Mexico, 2021. Association for",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                91,
                                452,
                                212,
                                464
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        452,
                                        212,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": "Computational Linguistics.",
                                    "type": "text"
                                }
                            ],
                            "index": 25,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                77,
                                471,
                                542,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        471,
                                        542,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "[8] Benjamin Charlier, Jean Feydy, Joan Alexis Glaunès, François-David Collin, and Ghislain Durif. Kernel",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                91,
                                483,
                                542,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        483,
                                        542,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "operations on the gpu, with autodiff, without memory overflows. Journal of Machine Learning Research,",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                90,
                                494,
                                397,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        494,
                                        397,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "22(74):1–6, 2021. URL http://jmlr.org/papers/v22/20-275.html.",
                                    "type": "text"
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                514,
                                542,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        514,
                                        542,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": "[9] Beidi Chen, Tri Dao, Eric Winsor, Zhao Song, Atri Rudra, and Christopher Ré. Scatterbrain: Unifying",
                                    "type": "text"
                                }
                            ],
                            "index": 29,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                528,
                                542,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        528,
                                        542,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "sparse and low-rank attention. In Advances in Neural Information Processing Systems (NeurIPS), 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                542,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        542,
                                        560
                                    ],
                                    "score": 1.0,
                                    "content": "[10] Tianqi Chen, Bing Xu, Chiyuan Zhang, and Carlos Guestrin. Training deep nets with sublinear memory",
                                    "type": "text"
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                559,
                                288,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        559,
                                        288,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "cost. arXiv preprint arXiv:1604.06174, 2016.",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                578,
                                540,
                                591
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        578,
                                        540,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "[11] Rewon Child, Scott Gray, Alec Radford, and Ilya Sutskever. Generating long sequences with sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                590,
                                327,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        590,
                                        327,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "transformers. arXiv preprint arXiv:1904.10509, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                609,
                                542,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        609,
                                        542,
                                        624
                                    ],
                                    "score": 1.0,
                                    "content": "[12] Krzysztof Marcin Choromanski, Valerii Likhosherstov, David Dohan, Xingyou Song, Andreea Gane,",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                622,
                                541,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        622,
                                        541,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "Tamas Sarlos, Peter Hawkins, Jared Quincy Davis, Afroz Mohiuddin, Lukasz Kaiser, et al. Rethinking",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                91,
                                635,
                                526,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        635,
                                        526,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "attention with performers. In International Conference on Learning Representations (ICLR), 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                653,
                                542,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        653,
                                        542,
                                        667
                                    ],
                                    "score": 1.0,
                                    "content": "[13] Xiang Dai, Ilias Chalkidis, Sune Darkner, and Desmond Elliott. Revisiting transformer-based models for",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                667,
                                394,
                                679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        667,
                                        394,
                                        679
                                    ],
                                    "score": 1.0,
                                    "content": "long document classification. arXiv preprint arXiv:2204.06683, 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                686,
                                542,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        686,
                                        542,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "[14] Zihang Dai, Zhilin Yang, Yiming Yang, Jaime G Carbonell, Quoc Le, and Ruslan Salakhutdinov.",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                698,
                                542,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        698,
                                        542,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "Transformer-XL: Attentive language models beyond a fixed-length context. In Proceedings of the 57th",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                91,
                                711,
                                484,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        711,
                                        484,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "Annual Meeting of the Association for Computational Linguistics, pages 2978–2988, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                72,
                                541,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        541,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "[15] Tri Dao, Albert Gu, Matthew Eichhorn, Atri Rudra, and Christopher Ré. Learning fast algorithms",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                85,
                                542,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        85,
                                        542,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "for linear transforms using butterfly factorizations. In International Conference on Machine Learning",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                90,
                                96,
                                156,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        96,
                                        156,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "(ICML), 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                541,
                                129
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        541,
                                        129
                                    ],
                                    "score": 1.0,
                                    "content": "[16] Tri Dao, Nimit Sohoni, Albert Gu, Matthew Eichhorn, Amit Blonder, Megan Leszczynski, Atri Rudra,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                88,
                                128,
                                542,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        128,
                                        542,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "and Christopher Ré. Kaleidoscope: An efficient, learnable representation for all structured linear maps.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                90,
                                141,
                                409,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        141,
                                        409,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": "In International Conference on Learning Representations (ICLR), 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                161,
                                542,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        161,
                                        542,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "[17] Tri Dao, Beidi Chen, Kaizhao Liang, Jiaming Yang, Zhao Song, Atri Rudra, and Christopher Ré.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                174,
                                542,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        174,
                                        542,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "Pixelated butterfly: Simple and efficient sparse training for neural network models. In International",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                91,
                                185,
                                334,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        185,
                                        334,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "Conference on Learning Representations (ICLR), 2022.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                205,
                                541,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        205,
                                        541,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "[18] Tri Dao, Beidi Chen, Nimit Sohoni, Arjun Desai, Michael Poli, Jessica Grogan, Alexander Liu, Aniruddh",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                218,
                                541,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        218,
                                        541,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "Rao, Atri Rudra, and Christopher Ré. Monarch: Expressive structured matrices for efficient and accurate",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                91,
                                230,
                                419,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        230,
                                        419,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": "training. In International Conference on Machine Learning (ICML), 2022.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                249,
                                541,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        249,
                                        541,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "[19] Giannis Daras, Nikita Kitaev, Augustus Odena, and Alexandros G Dimakis. Smyrf-efficient attention",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                88,
                                261,
                                542,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        261,
                                        542,
                                        273
                                    ],
                                    "score": 1.0,
                                    "content": "using asymmetric clustering. Advances in Neural Information Processing Systems, 33:6476–6489, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                69,
                                280,
                                541,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        280,
                                        541,
                                        294
                                    ],
                                    "score": 1.0,
                                    "content": "[20] Christopher De Sa, Albert Gu, Rohan Puttagunta, Christopher Ré, and Atri Rudra. A two-pronged",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                293,
                                543,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        293,
                                        543,
                                        305
                                    ],
                                    "score": 1.0,
                                    "content": "progress in structured dense matrix vector multiplication. In Proceedings of the Twenty-Ninth Annual",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                90,
                                304,
                                442,
                                318
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        304,
                                        442,
                                        318
                                    ],
                                    "score": 1.0,
                                    "content": "ACM-SIAM Symposium on Discrete Algorithms, pages 1060–1079. SIAM, 2018.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                324,
                                543,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        324,
                                        543,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "[21] Peter J Denning. The working set model for program behavior. Communications of the ACM, 11(5):",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                337,
                                157,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        337,
                                        157,
                                        349
                                    ],
                                    "score": 1.0,
                                    "content": "323–333, 1968.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                357,
                                541,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        357,
                                        541,
                                        369
                                    ],
                                    "score": 1.0,
                                    "content": "[22] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. BERT: Pre-training of deep",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                369,
                                358,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        369,
                                        358,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "bidirectional transformers for language understanding. 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                389,
                                541,
                                401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        389,
                                        541,
                                        401
                                    ],
                                    "score": 1.0,
                                    "content": "[23] Xin Dong, Shangyu Chen, and Sinno Jialin Pan. Learning to prune deep neural networks via layer-wise",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                400,
                                369,
                                413
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        400,
                                        369,
                                        413
                                    ],
                                    "score": 1.0,
                                    "content": "optimal brain surgeon. arXiv preprint arXiv:1705.07565, 2017.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                420,
                                541,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        420,
                                        541,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "[24] Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                430,
                                542,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        430,
                                        542,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al. An image is",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                89,
                                443,
                                542,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        443,
                                        542,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "worth 16x16 words: Transformers for image recognition at scale. In International Conference on Learning",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                91,
                                456,
                                190,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        456,
                                        190,
                                        468
                                    ],
                                    "score": 1.0,
                                    "content": "Representations, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                474,
                                542,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        474,
                                        542,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "[25] Y Eidelman and I Gohberg. On a new class of structured matrices. Integral Equations and Operator",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 27,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                487,
                                220,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        487,
                                        220,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "Theory, 34(3):293–324, 1999.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                507,
                                541,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        507,
                                        541,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "[26] Jean Feydy, Joan Glaunès, Benjamin Charlier, and Michael Bronstein. Fast geometric learning with",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 29,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                519,
                                451,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        519,
                                        451,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "symbolic matrices. Advances in Neural Information Processing Systems, 33, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                539,
                                449,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        539,
                                        449,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "[27] Jörg Flum and Martin Grohe. Parameterized Complexity Theory. Springer, 2006.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                560,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        560,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "[28] Jonathan Frankle and Michael Carbin. The lottery ticket hypothesis: Finding sparse, trainable neural",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                88,
                                571,
                                417,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        571,
                                        417,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "networks. In International Conference on Learning Representations, 2018.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                591,
                                541,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        591,
                                        541,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "[29] Jonathan Frankle, Gintare Karolina Dziugaite, Daniel M Roy, and Michael Carbin. Stabilizing the",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 34,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                604,
                                378,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        604,
                                        378,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "lottery ticket hypothesis. arXiv preprint arXiv:1903.01611, 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                623,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        623,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "[30] Jonathan Frankle, Gintare Karolina Dziugaite, Daniel Roy, and Michael Carbin. Linear mode connectivity",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 36,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                635,
                                542,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        635,
                                        542,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "and the lottery ticket hypothesis. In International Conference on Machine Learning, pages 3259–3269.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                91,
                                647,
                                151,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        647,
                                        151,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "PMLR, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 38,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                666,
                                541,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        666,
                                        541,
                                        681
                                    ],
                                    "score": 1.0,
                                    "content": "[31] Karan Goel, Albert Gu, Chris Donahue, and Christopher Ré. It’s raw! audio generation with state-space",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 39,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                680,
                                415,
                                691
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        680,
                                        415,
                                        691
                                    ],
                                    "score": 1.0,
                                    "content": "models. In International Conference on Machine Learning (ICML), 2022.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 40,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                700,
                                501,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        700,
                                        501,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "[32] Aaron Gokaslan, Vanya Cohen, Pavlick Ellie, and Stefanie Tellex. Openwebtext corpus, 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 41,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                73,
                                542,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        73,
                                        542,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "[33] Jim Gray, Surajit Chaudhuri, Adam Bosworth, Andrew Layman, Don Reichart, Murali Venkatrao,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                83,
                                542,
                                100
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        83,
                                        542,
                                        100
                                    ],
                                    "score": 1.0,
                                    "content": "Frank Pellow, and Hamid Pirahesh. Data cube: A relational aggregation operator generalizing group-by,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                88,
                                96,
                                453,
                                111
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        96,
                                        453,
                                        111
                                    ],
                                    "score": 1.0,
                                    "content": "cross-tab, and sub-totals. Data mining and knowledge discovery, 1(1):29–53, 1997.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                116,
                                542,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        116,
                                        542,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "[34] Andreas Griewank and Andrea Walther. Evaluating derivatives: principles and techniques of algorithmic",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                129,
                                218,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        129,
                                        218,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "differentiation. SIAM, 2008.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                149,
                                541,
                                161
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        149,
                                        541,
                                        161
                                    ],
                                    "score": 1.0,
                                    "content": "[35] Albert Gu, Tri Dao, Stefano Ermon, Atri Rudra, and Christopher Ré. Hippo: Recurrent memory with",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                161,
                                542,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        161,
                                        542,
                                        175
                                    ],
                                    "score": 1.0,
                                    "content": "optimal polynomial projections. In Advances in neural information processing systems (NeurIPS), 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                178,
                                542,
                                195
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        178,
                                        542,
                                        195
                                    ],
                                    "score": 1.0,
                                    "content": "[36] Albert Gu, Isys Johnson, Karan Goel, Khaled Saab, Tri Dao, Atri Rudra, and Christopher Ré. Combining",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                194,
                                542,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        194,
                                        542,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "recurrent, convolutional, and continuous-time models with linear state space layers. Advances in Neural",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                90,
                                205,
                                278,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        205,
                                        278,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "Information Processing Systems, 34, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                224,
                                542,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        224,
                                        542,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "[37] Albert Gu, Karan Goel, and Christopher Ré. Efficiently modeling long sequences with structured state",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                236,
                                462,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        236,
                                        462,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "spaces. In The International Conference on Learning Representations (ICLR), 2022.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                256,
                                542,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        256,
                                        542,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "[38] Song Han, Jeff Pool, John Tran, and William J Dally. Learning both weights and connections for efficient",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                268,
                                342,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        268,
                                        342,
                                        282
                                    ],
                                    "score": 1.0,
                                    "content": "neural networks. arXiv preprint arXiv:1506.02626, 2015.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                288,
                                542,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        288,
                                        542,
                                        302
                                    ],
                                    "score": 1.0,
                                    "content": "[39] Song Han, Huizi Mao, and William J Dally. Deep compression: Compressing deep neural networks",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                300,
                                542,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        300,
                                        542,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "with pruning, trained quantization and huffman coding. In International Conference on Learning",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                91,
                                313,
                                191,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        313,
                                        191,
                                        325
                                    ],
                                    "score": 1.0,
                                    "content": "Representations, 2016.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                332,
                                542,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        332,
                                        542,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "[40] John Hennessy and David Patterson. Memory hierarchy design. Computer Architecture: A Quantitative",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                345,
                                231,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        345,
                                        231,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "Approach, pages 390–525, 2003.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                365,
                                425,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        365,
                                        425,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "[41] Sara Hooker. The hardware lottery. arXiv preprint arXiv:2009.06489, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                383,
                                542,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        383,
                                        542,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": "[42] Weizhe Hua, Zihang Dai, Hanxiao Liu, and Quoc V Le. Transformer quality in linear time. arXiv",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                396,
                                237,
                                409
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        396,
                                        237,
                                        409
                                    ],
                                    "score": 1.0,
                                    "content": "preprint arXiv:2202.10447, 2022.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                417,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        417,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "[43] Andrei Ivanov, Nikoli Dryden, Tal Ben-Nun, Shigang Li, and Torsten Hoefler. Data movement is all",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                429,
                                542,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        429,
                                        542,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "you need: A case study on optimizing transformers. Proceedings of Machine Learning and Systems, 3:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                90,
                                439,
                                158,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        439,
                                        158,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "711–732, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                460,
                                541,
                                472
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        460,
                                        541,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": "[44] Zhe Jia and Peter Van Sandt. Dissecting the Ampere GPU architecture via microbenchmarking. GPU",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 25,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                471,
                                223,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        471,
                                        223,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "Technology Conference, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                491,
                                541,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        491,
                                        541,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "[45] Zhe Jia, Marco Maggioni, Benjamin Staiger, and Daniele P Scarpazza. Dissecting the nvidia Volta GPU",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 27,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                504,
                                430,
                                517
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        504,
                                        430,
                                        517
                                    ],
                                    "score": 1.0,
                                    "content": "architecture via microbenchmarking. arXiv preprint arXiv:1804.06826, 2018.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                523,
                                541,
                                537
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        523,
                                        541,
                                        537
                                    ],
                                    "score": 1.0,
                                    "content": "[46] Zhe Jia, Blake Tillman, Marco Maggioni, and Daniele Paolo Scarpazza. Dissecting the graphcore IPU",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 29,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                535,
                                430,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        535,
                                        430,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "architecture via microbenchmarking. arXiv preprint arXiv:1912.03413, 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                555,
                                542,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        555,
                                        542,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "[47] Alistair EW Johnson, Tom J Pollard, Lu Shen, Li-wei H Lehman, Mengling Feng, Mohammad Ghassemi,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                569,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        569,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "Benjamin Moody, Peter Szolovits, Leo Anthony Celi, and Roger G Mark. Mimic-iii, a freely accessible",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                90,
                                580,
                                326,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        580,
                                        326,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "critical care database. Scientific data, 3(1):1–9, 2016.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                599,
                                542,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        599,
                                        542,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "[48] Norman P Jouppi, Cliff Young, Nishant Patil, David Patterson, Gaurav Agrawal, Raminder Bajwa, Sarah",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 34,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                610,
                                542,
                                625
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        610,
                                        542,
                                        625
                                    ],
                                    "score": 1.0,
                                    "content": "Bates, Suresh Bhatia, Nan Boden, Al Borchers, et al. In-datacenter performance analysis of a tensor",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                90,
                                623,
                                543,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        623,
                                        543,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "processing unit. In Proceedings of the 44th annual international symposium on computer architecture,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                89,
                                635,
                                170,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        635,
                                        170,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "pages 1–12, 2017.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                654,
                                542,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        654,
                                        542,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": "[49] Thomas Kailath, Sun-Yuan Kung, and Martin Morf. Displacement ranks of matrices and linear equations.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                667,
                                414,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        667,
                                        414,
                                        680
                                    ],
                                    "score": 1.0,
                                    "content": "Journal of Mathematical Analysis and Applications, 68(2):395–407, 1979.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                687,
                                542,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        687,
                                        542,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": "[50] Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François Fleuret. Transformers are RNNs:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 40,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                699,
                                542,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        699,
                                        542,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "Fast autoregressive transformers with linear attention. In International Conference on Machine Learning,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                89,
                                711,
                                230,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        711,
                                        230,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "pages 5156–5165. PMLR, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                72,
                                542,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        542,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "[51] Nikita Kitaev, Łukasz Kaiser, and Anselm Levskaya. Reformer: The efficient transformer. In The",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                86,
                                365,
                                98
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        86,
                                        365,
                                        98
                                    ],
                                    "score": 1.0,
                                    "content": "International Conference on Machine Learning (ICML), 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                105,
                                542,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        105,
                                        542,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "[52] Zhenzhong Lan, Mingda Chen, Sebastian Goodman, Kevin Gimpel, Piyush Sharma, and Radu Soricut.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                115,
                                543,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        115,
                                        543,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "Albert: A lite BEDRT for self-supervised learning of language representations. In The International",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                89,
                                128,
                                334,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        128,
                                        334,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "Conference on Learning Representations (ICLR), 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                147,
                                542,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        147,
                                        542,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "[53] Mingzhen Li, Yi Liu, Xiaoyan Liu, Qingxiao Sun, Xin You, Hailong Yang, Zhongzhi Luan, Lin Gan,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                159,
                                542,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        159,
                                        542,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "Guangwen Yang, and Depei Qian. The deep learning compiler: A comprehensive survey. IEEE",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                88,
                                171,
                                405,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        171,
                                        405,
                                        186
                                    ],
                                    "score": 1.0,
                                    "content": "Transactions on Parallel and Distributed Systems, 32(3):708–727, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                192,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        192,
                                        541,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "[54] Valerii Likhosherstov, Krzysztof Choromanski, Jared Davis, Xingyou Song, and Adrian Weller. Sub-linear",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                204,
                                444,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        204,
                                        444,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "memory: How to make performers slim. arXiv preprint arXiv:2012.11346, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                222,
                                542,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        222,
                                        542,
                                        237
                                    ],
                                    "score": 1.0,
                                    "content": "[55] Ji Lin, Yongming Rao, Jiwen Lu, and Jie Zhou. Runtime neural pruning. In I. Guyon, U. V. Luxburg,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                236,
                                542,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        236,
                                        542,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, editors, Advances in Neural",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                91,
                                248,
                                420,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        248,
                                        420,
                                        259
                                    ],
                                    "score": 1.0,
                                    "content": "Information Processing Systems, volume 30. Curran Associates, Inc., 2017.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                267,
                                542,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        267,
                                        542,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "[56] Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                88,
                                277,
                                542,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        277,
                                        542,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "Luke Zettlemoyer, and Veselin Stoyanov. Roberta: A robustly optimized bert pretraining approach.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                89,
                                290,
                                265,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        290,
                                        265,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv preprint arXiv:1907.11692, 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                309,
                                542,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        309,
                                        542,
                                        324
                                    ],
                                    "score": 1.0,
                                    "content": "[57] Xuezhe Ma, Xiang Kong, Sinong Wang, Chunting Zhou, Jonathan May, Hao Ma, and Luke Zettlemoyer.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                323,
                                536,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        323,
                                        536,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "Luna: Linear unified nested attention. Advances in Neural Information Processing Systems, 34, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                340,
                                542,
                                355
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        340,
                                        542,
                                        355
                                    ],
                                    "score": 1.0,
                                    "content": "[58] Peter Mattson, Christine Cheng, Gregory Diamos, Cody Coleman, Paulius Micikevicius, David Patterson,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                354,
                                542,
                                366
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        354,
                                        542,
                                        366
                                    ],
                                    "score": 1.0,
                                    "content": "Hanlin Tang, Gu-Yeon Wei, Peter Bailis, Victor Bittorf, et al. Mlperf training benchmark. Proceedings",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                91,
                                366,
                                318,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        366,
                                        318,
                                        378
                                    ],
                                    "score": 1.0,
                                    "content": "of Machine Learning and Systems, 2:336–349, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                384,
                                542,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        384,
                                        542,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "[59] Frank McSherry, Michael Isard, and Derek G Murray. Scalability! but at what {COST}? In 15th",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                397,
                                384,
                                409
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        397,
                                        384,
                                        409
                                    ],
                                    "score": 1.0,
                                    "content": "Workshop on Hot Topics in Operating Systems (HotOS XV), 2015.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                415,
                                542,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        415,
                                        542,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "[60] Maxim Milakov and Natalia Gimelshein. Online normalizer calculation for softmax. arXiv preprint",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                429,
                                198,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        429,
                                        198,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:1805.02867, 2018.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                448,
                                327,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        448,
                                        327,
                                        460
                                    ],
                                    "score": 1.0,
                                    "content": "[61] NVIDIA. Nvidia Tesla V100 GPU architecture, 2017.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 25,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                467,
                                352,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        467,
                                        352,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "[62] NVIDIA. Nvidia A100 tensor core GPU architecture, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 26,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                487,
                                352,
                                498
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        487,
                                        352,
                                        498
                                    ],
                                    "score": 1.0,
                                    "content": "[63] NVIDIA. Nvidia H100 tensor core GPU architecture, 2022.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 27,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                505,
                                542,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        505,
                                        542,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "[64] D Stott Parker. Random butterfly transformations with applications in computational linear algebra.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 28,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                518,
                                117,
                                531
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        518,
                                        117,
                                        531
                                    ],
                                    "score": 1.0,
                                    "content": "1995.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 29,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                537,
                                542,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        537,
                                        542,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "[65] Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 30,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                549,
                                542,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        549,
                                        542,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al. Pytorch: An imperative style, high-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                88,
                                561,
                                514,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        561,
                                        514,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "performance deep learning library. Advances in neural information processing systems, 32, 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 32,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                581,
                                542,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        581,
                                        398,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": "[66] Markus N Rabe and Charles Staats. Self-attention does not need ",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        399,
                                        583,
                                        424,
                                        593
                                    ],
                                    "score": 0.93,
                                    "content": "O(n^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        424,
                                        581,
                                        542,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": " memory. arXiv preprint",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 33,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                593,
                                198,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        593,
                                        198,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2112.05682, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                610,
                                542,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        610,
                                        542,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "[67] Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al. Language",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 35,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                625,
                                403,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        625,
                                        403,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "models are unsupervised multitask learners. OpenAI blog, 1(8):9, 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 36,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                644,
                                542,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        644,
                                        542,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "[68] Jack Rae and Ali Razavi. Do transformers need deep long-range memory? In Proceedings of the 58th",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 37,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                655,
                                542,
                                670
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        655,
                                        542,
                                        670
                                    ],
                                    "score": 1.0,
                                    "content": "Annual Meeting of the Association for Computational Linguistics, Online, July 2020. Association for",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                89,
                                667,
                                506,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        667,
                                        506,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "Computational Linguistics. URL https://www.aclweb.org/anthology/2020.acl-main.672.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                688,
                                542,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        688,
                                        542,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "[69] Jack W Rae, Anna Potapenko, Siddhant M Jayakumar, and Timothy P Lillicrap. Compressive trans-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 40,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                698,
                                543,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        698,
                                        543,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "formers for long-range sequence modelling. In The International Conference on Learning Representations",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                91,
                                711,
                                153,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        711,
                                        153,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "(ICLR), 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                74,
                                540,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        540,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "[70] Jonathan Ragan-Kelley, Connelly Barnes, Andrew Adams, Sylvain Paris, Frédo Durand, and Saman",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                85,
                                542,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        85,
                                        542,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "Amarasinghe. Halide: a language and compiler for optimizing parallelism, locality, and recomputation in",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                89,
                                97,
                                401,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        97,
                                        401,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "image processing pipelines. Acm Sigplan Notices, 48(6):519–530, 2013.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                116,
                                542,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        116,
                                        542,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "[71] Raghu Ramakrishnan, Johannes Gehrke, and Johannes Gehrke. Database management systems, volume 3.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                128,
                                226,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        128,
                                        226,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "McGraw-Hill New York, 2003.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                148,
                                542,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        148,
                                        542,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "[72] Benjamin Recht and Christopher Ré. Parallel stochastic gradient algorithms for large-scale matrix",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                161,
                                419,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        161,
                                        419,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "completion. Mathematical Programming Computation, 5(2):201–226, 2013.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                180,
                                542,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        180,
                                        542,
                                        194
                                    ],
                                    "score": 1.0,
                                    "content": "[73] Hongyu Ren, Hanjun Dai, Zihang Dai, Mengjiao Yang, Jure Leskovec, Dale Schuurmans, and Bo Dai.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                192,
                                542,
                                207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        192,
                                        542,
                                        207
                                    ],
                                    "score": 1.0,
                                    "content": "Combiner: Full attention transformer with sparse computation cost. Advances in Neural Information",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                90,
                                204,
                                224,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        204,
                                        224,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "Processing Systems, 34, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                225,
                                542,
                                238
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        225,
                                        542,
                                        238
                                    ],
                                    "score": 1.0,
                                    "content": "[74] Aurko Roy, Mohammad Saffar, Ashish Vaswani, and David Grangier. Efficient content-based sparse",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                236,
                                542,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        236,
                                        542,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "attention with routing transformers. Transactions of the Association for Computational Linguistics, 9:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                90,
                                249,
                                148,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        249,
                                        148,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "53–68, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                268,
                                428,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        428,
                                        282
                                    ],
                                    "score": 1.0,
                                    "content": "[75] Amit Sabne. XLA: Compiling machine learning for peak performance. 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                289,
                                541,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        289,
                                        541,
                                        302
                                    ],
                                    "score": 1.0,
                                    "content": "[76] Victor Sanh, Thomas Wolf, and Alexander M Rush. Movement pruning: Adaptive sparsity by fine-tuning.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                300,
                                265,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        300,
                                        265,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv preprint arXiv:2005.07683, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                320,
                                542,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        320,
                                        542,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "[77] Mohammad Shoeybi, Mostofa Patwary, Raul Puri, Patrick LeGresley, Jared Casper, and Bryan Catanzaro.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                331,
                                542,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        331,
                                        542,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "Megatron-LM: Training multi-billion parameter language models using model parallelism. arXiv preprint",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                90,
                                345,
                                199,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        345,
                                        199,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:1909.08053, 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                363,
                                541,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        363,
                                        541,
                                        378
                                    ],
                                    "score": 1.0,
                                    "content": "[78] Vikas Sindhwani, Tara Sainath, and Sanjiv Kumar. Structured transforms for small-footprint deep",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                376,
                                482,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        376,
                                        482,
                                        389
                                    ],
                                    "score": 1.0,
                                    "content": "learning. In Advances in Neural Information Processing Systems, pages 3088–3096, 2015.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                395,
                                542,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        395,
                                        542,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "[79] Sainbayar Sukhbaatar, Edouard Grave, Piotr Bojanowski, and Armand Joulin. Adaptive attention span",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                409,
                                542,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        409,
                                        542,
                                        421
                                    ],
                                    "score": 1.0,
                                    "content": "in transformers. In Proceedings of the Annual Meeting of the Association for Computational Linguistics,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                90,
                                420,
                                117,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        420,
                                        117,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 23,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                439,
                                542,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        439,
                                        542,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "[80] Yi Tay, Mostafa Dehghani, Samira Abnar, Yikang Shen, Dara Bahri, Philip Pham, Jinfeng Rao, Liu",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 24,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                452,
                                542,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        452,
                                        542,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "Yang, Sebastian Ruder, and Donald Metzler. Long range arena: A benchmark for efficient transformers.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                90,
                                464,
                                372,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        464,
                                        372,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "In International Conference on Learning Representations, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                483,
                                542,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        483,
                                        542,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "[81] Yi Tay, Mostafa Dehghani, Dara Bahri, and Donald Metzler. Efficient transformers: A survey. arXiv",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 27,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                496,
                                237,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        496,
                                        237,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "preprint arXiv:2009.06732, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                516,
                                541,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        516,
                                        541,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": "[82] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 29,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                527,
                                542,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        527,
                                        542,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                88,
                                540,
                                173,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        540,
                                        173,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "systems, 30, 2017.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 31,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                559,
                                542,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        559,
                                        542,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "[83] Hongyu Wang, Shuming Ma, Li Dong, Shaohan Huang, Dongdong Zhang, and Furu Wei. Deepnet:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                571,
                                427,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        571,
                                        427,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "Scaling transformers to 1,000 layers. arXiv preprint arXiv:2203.00555, 2022.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                592,
                                541,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        592,
                                        541,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "[84] Sinong Wang, Belinda Z Li, Madian Khabsa, Han Fang, and Hao Ma. Linformer: Self-attention with",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 34,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                89,
                                603,
                                348,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        603,
                                        348,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "linear complexity. arXiv preprint arXiv:2006.04768, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                623,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        623,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "[85] Samuel Williams, Andrew Waterman, and David Patterson. Roofline: an insightful visual performance",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 36,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                635,
                                459,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        635,
                                        459,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "model for multicore architectures. Communications of the ACM, 52(4):65–76, 2009.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                654,
                                542,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        654,
                                        542,
                                        668
                                    ],
                                    "score": 1.0,
                                    "content": "[86] Michael E Wolf and Monica S Lam. A data locality optimizing algorithm. In Proceedings of the ACM",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                667,
                                534,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        667,
                                        534,
                                        681
                                    ],
                                    "score": 1.0,
                                    "content": "SIGPLAN 1991 conference on Programming language design and implementation, pages 30–44, 1991.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                72,
                                74,
                                541,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        541,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "[87] Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                86,
                                542,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        86,
                                        542,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                91,
                                97,
                                542,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        97,
                                        542,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                91,
                                109,
                                542,
                                123
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        109,
                                        542,
                                        123
                                    ],
                                    "score": 1.0,
                                    "content": "Quentin Lhoest, and Alexander M. Rush. Transformers: State-of-the-art natural language processing.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                90,
                                121,
                                541,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        121,
                                        541,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "In Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                91,
                                134,
                                541,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        134,
                                        541,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "Demonstrations, pages 38–45, Online, October 2020. Association for Computational Linguistics. URL",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                90,
                                145,
                                363,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        145,
                                        363,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": "https://www.aclweb.org/anthology/2020.emnlp-demos.6.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                164,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        164,
                                        541,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "[88] David P Woodruff. Optimal space lower bounds for all frequency moments. In SODA, volume 4, pages",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                177,
                                198,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        177,
                                        198,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "167–175. Citeseer, 2004.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                197,
                                541,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        197,
                                        541,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "[89] Felix Wu, Angela Fan, Alexei Baevski, Yann N Dauphin, and Michael Auli. Pay less attention with",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                209,
                                542,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        209,
                                        542,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "lightweight and dynamic convolutions. In The International Conference on Learning Representations",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                91,
                                221,
                                154,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        221,
                                        154,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "(ICLR), 2019.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                241,
                                541,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        241,
                                        541,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "[90] Yunyang Xiong, Zhanpeng Zeng, Rudrasis Chakraborty, Mingxing Tan, Glenn Fung, Yin Li, and Vikas",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                254,
                                541,
                                265
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        254,
                                        541,
                                        265
                                    ],
                                    "score": 1.0,
                                    "content": "Singh. Nyströmformer: A nystöm-based algorithm for approximating self-attention. In Proceedings of",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                90,
                                264,
                                542,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        264,
                                        542,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "the AAAI Conference on Artificial Intelligence. AAAI Conference on Artificial Intelligence, volume 35,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                89,
                                277,
                                171,
                                289
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        277,
                                        171,
                                        289
                                    ],
                                    "score": 1.0,
                                    "content": "page 14138, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                296,
                                541,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        296,
                                        541,
                                        310
                                    ],
                                    "score": 1.0,
                                    "content": "[91] Li Yuan, Yunpeng Chen, Tao Wang, Weihao Yu, Yujun Shi, Zi-Hang Jiang, Francis EH Tay, Jiashi Feng,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                308,
                                541,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        308,
                                        541,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "and Shuicheng Yan. Tokens-to-token vit: Training vision transformers from scratch on imagenet. In",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                90,
                                320,
                                527,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        320,
                                        527,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 558–567, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                340,
                                541,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        340,
                                        541,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "[92] Manzil Zaheer, Guru Guruganesh, Kumar Avinava Dubey, Joshua Ainslie, Chris Alberti, Santiago",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                353,
                                541,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        353,
                                        541,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "Ontanon, Philip Pham, Anirudh Ravula, Qifan Wang, Li Yang, et al. Big bird: Transformers for longer",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                91,
                                365,
                                414,
                                377
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        365,
                                        414,
                                        377
                                    ],
                                    "score": 1.0,
                                    "content": "sequences. Advances in Neural Information Processing Systems, 33, 2020.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                384,
                                540,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        384,
                                        540,
                                        396
                                    ],
                                    "score": 1.0,
                                    "content": "[93] Shuangfei Zhai, Walter Talbott, Nitish Srivastava, Chen Huang, Hanlin Goh, Ruixiang Zhang, and Josh",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                397,
                                446,
                                409
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        397,
                                        446,
                                        409
                                    ],
                                    "score": 1.0,
                                    "content": "Susskind. An attention free transformer. arXiv preprint arXiv:2105.14103, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 23,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                417,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        417,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "[94] Chen Zhu, Wei Ping, Chaowei Xiao, Mohammad Shoeybi, Tom Goldstein, Anima Anandkumar, and",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 24,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                91,
                                429,
                                542,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        429,
                                        542,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "Bryan Catanzaro. Long-short transformer: Efficient transformers for language and vision. Advances in",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                91,
                                440,
                                308,
                                452
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        440,
                                        308,
                                        452
                                    ],
                                    "score": 1.0,
                                    "content": "Neural Information Processing Systems, 34, 2021.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 23.5,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        163,
                        542,
                        723
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        68,
                        52,
                        543,
                        716
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                541,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        541,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "[15] Tri Dao, Albert Gu, Matthew Eichhorn, Atri Rudra, and Christopher Ré. Learning fast algorithms",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                90,
                                85,
                                542,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        85,
                                        542,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "for linear transforms using butterfly factorizations. In International Conference on Machine Learning",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                90,
                                96,
                                156,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        96,
                                        156,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "(ICML), 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                541,
                                129
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        541,
                                        129
                                    ],
                                    "score": 1.0,
                                    "content": "[16] Tri Dao, Nimit Sohoni, Albert Gu, Matthew Eichhorn, Amit Blonder, Megan Leszczynski, Atri Rudra,",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                88,
                                128,
                                542,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        128,
                                        542,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "and Christopher Ré. Kaleidoscope: An efficient, learnable representation for all structured linear maps.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                90,
                                141,
                                409,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        141,
                                        409,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": "In International Conference on Learning Representations (ICLR), 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                69,
                                161,
                                542,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        161,
                                        542,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "[17] Tri Dao, Beidi Chen, Kaizhao Liang, Jiaming Yang, Zhao Song, Atri Rudra, and Christopher Ré.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                91,
                                174,
                                542,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        174,
                                        542,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "Pixelated butterfly: Simple and efficient sparse training for neural network models. In International",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                91,
                                185,
                                334,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        185,
                                        334,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "Conference on Learning Representations (ICLR), 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                205,
                                541,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        205,
                                        541,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "[18] Tri Dao, Beidi Chen, Nimit Sohoni, Arjun Desai, Michael Poli, Jessica Grogan, Alexander Liu, Aniruddh",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                91,
                                218,
                                541,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        218,
                                        541,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "Rao, Atri Rudra, and Christopher Ré. Monarch: Expressive structured matrices for efficient and accurate",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                91,
                                230,
                                419,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        230,
                                        419,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": "training. In International Conference on Machine Learning (ICML), 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                249,
                                541,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        249,
                                        541,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "[19] Giannis Daras, Nikita Kitaev, Augustus Odena, and Alexandros G Dimakis. Smyrf-efficient attention",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                88,
                                261,
                                542,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        261,
                                        542,
                                        273
                                    ],
                                    "score": 1.0,
                                    "content": "using asymmetric clustering. Advances in Neural Information Processing Systems, 33:6476–6489, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                69,
                                280,
                                541,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        280,
                                        541,
                                        294
                                    ],
                                    "score": 1.0,
                                    "content": "[20] Christopher De Sa, Albert Gu, Rohan Puttagunta, Christopher Ré, and Atri Rudra. A two-pronged",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                91,
                                293,
                                543,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        293,
                                        543,
                                        305
                                    ],
                                    "score": 1.0,
                                    "content": "progress in structured dense matrix vector multiplication. In Proceedings of the Twenty-Ninth Annual",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                90,
                                304,
                                442,
                                318
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        304,
                                        442,
                                        318
                                    ],
                                    "score": 1.0,
                                    "content": "ACM-SIAM Symposium on Discrete Algorithms, pages 1060–1079. SIAM, 2018.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                324,
                                543,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        324,
                                        543,
                                        338
                                    ],
                                    "score": 1.0,
                                    "content": "[21] Peter J Denning. The working set model for program behavior. Communications of the ACM, 11(5):",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                90,
                                337,
                                157,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        337,
                                        157,
                                        349
                                    ],
                                    "score": 1.0,
                                    "content": "323–333, 1968.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                357,
                                541,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        357,
                                        541,
                                        369
                                    ],
                                    "score": 1.0,
                                    "content": "[22] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. BERT: Pre-training of deep",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                91,
                                369,
                                358,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        369,
                                        358,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "bidirectional transformers for language understanding. 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                389,
                                541,
                                401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        389,
                                        541,
                                        401
                                    ],
                                    "score": 1.0,
                                    "content": "[23] Xin Dong, Shangyu Chen, and Sinno Jialin Pan. Learning to prune deep neural networks via layer-wise",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                89,
                                400,
                                369,
                                413
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        400,
                                        369,
                                        413
                                    ],
                                    "score": 1.0,
                                    "content": "optimal brain surgeon. arXiv preprint arXiv:1705.07565, 2017.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                420,
                                541,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        420,
                                        541,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "[24] Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                89,
                                430,
                                542,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        430,
                                        542,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al. An image is",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                89,
                                443,
                                542,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        443,
                                        542,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "worth 16x16 words: Transformers for image recognition at scale. In International Conference on Learning",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                91,
                                456,
                                190,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        456,
                                        190,
                                        468
                                    ],
                                    "score": 1.0,
                                    "content": "Representations, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                69,
                                474,
                                542,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        474,
                                        542,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "[25] Y Eidelman and I Gohberg. On a new class of structured matrices. Integral Equations and Operator",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                89,
                                487,
                                220,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        487,
                                        220,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "Theory, 34(3):293–324, 1999.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                507,
                                541,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        507,
                                        541,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "[26] Jean Feydy, Joan Glaunès, Benjamin Charlier, and Michael Bronstein. Fast geometric learning with",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                89,
                                519,
                                451,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        519,
                                        451,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "symbolic matrices. Advances in Neural Information Processing Systems, 33, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                539,
                                449,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        539,
                                        449,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "[27] Jörg Flum and Martin Grohe. Parameterized Complexity Theory. Springer, 2006.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                560,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        560,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "[28] Jonathan Frankle and Michael Carbin. The lottery ticket hypothesis: Finding sparse, trainable neural",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                88,
                                571,
                                417,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        571,
                                        417,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "networks. In International Conference on Learning Representations, 2018.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                591,
                                541,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        591,
                                        541,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "[29] Jonathan Frankle, Gintare Karolina Dziugaite, Daniel M Roy, and Michael Carbin. Stabilizing the",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                90,
                                604,
                                378,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        604,
                                        378,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "lottery ticket hypothesis. arXiv preprint arXiv:1903.01611, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                623,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        623,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "[30] Jonathan Frankle, Gintare Karolina Dziugaite, Daniel Roy, and Michael Carbin. Linear mode connectivity",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                89,
                                635,
                                542,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        635,
                                        542,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "and the lottery ticket hypothesis. In International Conference on Machine Learning, pages 3259–3269.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                91,
                                647,
                                151,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        647,
                                        151,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "PMLR, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                69,
                                666,
                                541,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        666,
                                        541,
                                        681
                                    ],
                                    "score": 1.0,
                                    "content": "[31] Karan Goel, Albert Gu, Chris Donahue, and Christopher Ré. It’s raw! audio generation with state-space",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                90,
                                680,
                                415,
                                691
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        680,
                                        415,
                                        691
                                    ],
                                    "score": 1.0,
                                    "content": "models. In International Conference on Machine Learning (ICML), 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                71,
                                700,
                                501,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        700,
                                        501,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "[32] Aaron Gokaslan, Vanya Cohen, Pavlick Ellie, and Stefanie Tellex. Openwebtext corpus, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 20.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 11,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "12",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        68,
                        52,
                        543,
                        716
                    ],
                    "lines": [],
                    "index": 20.5,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        72,
                        543,
                        711
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        68,
                        64,
                        545,
                        730
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                73,
                                542,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        73,
                                        542,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "[33] Jim Gray, Surajit Chaudhuri, Adam Bosworth, Andrew Layman, Don Reichart, Murali Venkatrao,",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                89,
                                83,
                                542,
                                100
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        83,
                                        542,
                                        100
                                    ],
                                    "score": 1.0,
                                    "content": "Frank Pellow, and Hamid Pirahesh. Data cube: A relational aggregation operator generalizing group-by,",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                88,
                                96,
                                453,
                                111
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        96,
                                        453,
                                        111
                                    ],
                                    "score": 1.0,
                                    "content": "cross-tab, and sub-totals. Data mining and knowledge discovery, 1(1):29–53, 1997.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                69,
                                116,
                                542,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        116,
                                        542,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "[34] Andreas Griewank and Andrea Walther. Evaluating derivatives: principles and techniques of algorithmic",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                89,
                                129,
                                218,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        129,
                                        218,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "differentiation. SIAM, 2008.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                72,
                                149,
                                541,
                                161
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        149,
                                        541,
                                        161
                                    ],
                                    "score": 1.0,
                                    "content": "[35] Albert Gu, Tri Dao, Stefano Ermon, Atri Rudra, and Christopher Ré. Hippo: Recurrent memory with",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                90,
                                161,
                                542,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        161,
                                        542,
                                        175
                                    ],
                                    "score": 1.0,
                                    "content": "optimal polynomial projections. In Advances in neural information processing systems (NeurIPS), 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                178,
                                542,
                                195
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        178,
                                        542,
                                        195
                                    ],
                                    "score": 1.0,
                                    "content": "[36] Albert Gu, Isys Johnson, Karan Goel, Khaled Saab, Tri Dao, Atri Rudra, and Christopher Ré. Combining",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                91,
                                194,
                                542,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        194,
                                        542,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "recurrent, convolutional, and continuous-time models with linear state space layers. Advances in Neural",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                90,
                                205,
                                278,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        205,
                                        278,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "Information Processing Systems, 34, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                69,
                                224,
                                542,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        224,
                                        542,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "[37] Albert Gu, Karan Goel, and Christopher Ré. Efficiently modeling long sequences with structured state",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                89,
                                236,
                                462,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        236,
                                        462,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "spaces. In The International Conference on Learning Representations (ICLR), 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                256,
                                542,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        256,
                                        542,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "[38] Song Han, Jeff Pool, John Tran, and William J Dally. Learning both weights and connections for efficient",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                89,
                                268,
                                342,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        268,
                                        342,
                                        282
                                    ],
                                    "score": 1.0,
                                    "content": "neural networks. arXiv preprint arXiv:1506.02626, 2015.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                288,
                                542,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        288,
                                        542,
                                        302
                                    ],
                                    "score": 1.0,
                                    "content": "[39] Song Han, Huizi Mao, and William J Dally. Deep compression: Compressing deep neural networks",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                90,
                                300,
                                542,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        300,
                                        542,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "with pruning, trained quantization and huffman coding. In International Conference on Learning",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                91,
                                313,
                                191,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        313,
                                        191,
                                        325
                                    ],
                                    "score": 1.0,
                                    "content": "Representations, 2016.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                332,
                                542,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        332,
                                        542,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "[40] John Hennessy and David Patterson. Memory hierarchy design. Computer Architecture: A Quantitative",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                89,
                                345,
                                231,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        345,
                                        231,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "Approach, pages 390–525, 2003.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                72,
                                365,
                                425,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        365,
                                        425,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "[41] Sara Hooker. The hardware lottery. arXiv preprint arXiv:2009.06489, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                383,
                                542,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        383,
                                        542,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": "[42] Weizhe Hua, Zihang Dai, Hanxiao Liu, and Quoc V Le. Transformer quality in linear time. arXiv",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                89,
                                396,
                                237,
                                409
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        396,
                                        237,
                                        409
                                    ],
                                    "score": 1.0,
                                    "content": "preprint arXiv:2202.10447, 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                72,
                                417,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        417,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "[43] Andrei Ivanov, Nikoli Dryden, Tal Ben-Nun, Shigang Li, and Torsten Hoefler. Data movement is all",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                90,
                                429,
                                542,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        429,
                                        542,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "you need: A case study on optimizing transformers. Proceedings of Machine Learning and Systems, 3:",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                90,
                                439,
                                158,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        439,
                                        158,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "711–732, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                69,
                                460,
                                541,
                                472
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        460,
                                        541,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": "[44] Zhe Jia and Peter Van Sandt. Dissecting the Ampere GPU architecture via microbenchmarking. GPU",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                89,
                                471,
                                223,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        471,
                                        223,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "Technology Conference, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                491,
                                541,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        491,
                                        541,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "[45] Zhe Jia, Marco Maggioni, Benjamin Staiger, and Daniele P Scarpazza. Dissecting the nvidia Volta GPU",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                89,
                                504,
                                430,
                                517
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        504,
                                        430,
                                        517
                                    ],
                                    "score": 1.0,
                                    "content": "architecture via microbenchmarking. arXiv preprint arXiv:1804.06826, 2018.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                523,
                                541,
                                537
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        523,
                                        541,
                                        537
                                    ],
                                    "score": 1.0,
                                    "content": "[46] Zhe Jia, Blake Tillman, Marco Maggioni, and Daniele Paolo Scarpazza. Dissecting the graphcore IPU",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                89,
                                535,
                                430,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        535,
                                        430,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "architecture via microbenchmarking. arXiv preprint arXiv:1912.03413, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                555,
                                542,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        555,
                                        542,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "[47] Alistair EW Johnson, Tom J Pollard, Lu Shen, Li-wei H Lehman, Mengling Feng, Mohammad Ghassemi,",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                91,
                                569,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        569,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "Benjamin Moody, Peter Szolovits, Leo Anthony Celi, and Roger G Mark. Mimic-iii, a freely accessible",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                90,
                                580,
                                326,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        580,
                                        326,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "critical care database. Scientific data, 3(1):1–9, 2016.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                599,
                                542,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        599,
                                        542,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "[48] Norman P Jouppi, Cliff Young, Nishant Patil, David Patterson, Gaurav Agrawal, Raminder Bajwa, Sarah",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                90,
                                610,
                                542,
                                625
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        610,
                                        542,
                                        625
                                    ],
                                    "score": 1.0,
                                    "content": "Bates, Suresh Bhatia, Nan Boden, Al Borchers, et al. In-datacenter performance analysis of a tensor",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                90,
                                623,
                                543,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        623,
                                        543,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "processing unit. In Proceedings of the 44th annual international symposium on computer architecture,",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                89,
                                635,
                                170,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        635,
                                        170,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "pages 1–12, 2017.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                69,
                                654,
                                542,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        654,
                                        542,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": "[49] Thomas Kailath, Sun-Yuan Kung, and Martin Morf. Displacement ranks of matrices and linear equations.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                89,
                                667,
                                414,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        667,
                                        414,
                                        680
                                    ],
                                    "score": 1.0,
                                    "content": "Journal of Mathematical Analysis and Applications, 68(2):395–407, 1979.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                687,
                                542,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        687,
                                        542,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": "[50] Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François Fleuret. Transformers are RNNs:",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                90,
                                699,
                                542,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        699,
                                        542,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "Fast autoregressive transformers with linear attention. In International Conference on Machine Learning,",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                89,
                                711,
                                230,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        711,
                                        230,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "pages 5156–5165. PMLR, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 21
                }
            ],
            "layout_bboxes": [],
            "page_idx": 12,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        752
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "13",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        68,
                        64,
                        545,
                        730
                    ],
                    "lines": [],
                    "index": 21,
                    "page_num": "page_12",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        73,
                        543,
                        723
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        68,
                        45,
                        546,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                542,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        542,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "[51] Nikita Kitaev, Łukasz Kaiser, and Anselm Levskaya. Reformer: The efficient transformer. In The",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                91,
                                86,
                                365,
                                98
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        86,
                                        365,
                                        98
                                    ],
                                    "score": 1.0,
                                    "content": "International Conference on Machine Learning (ICML), 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                105,
                                542,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        105,
                                        542,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "[52] Zhenzhong Lan, Mingda Chen, Sebastian Goodman, Kevin Gimpel, Piyush Sharma, and Radu Soricut.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                89,
                                115,
                                543,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        115,
                                        543,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "Albert: A lite BEDRT for self-supervised learning of language representations. In The International",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                89,
                                128,
                                334,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        128,
                                        334,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "Conference on Learning Representations (ICLR), 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                147,
                                542,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        147,
                                        542,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "[53] Mingzhen Li, Yi Liu, Xiaoyan Liu, Qingxiao Sun, Xin You, Hailong Yang, Zhongzhi Luan, Lin Gan,",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                90,
                                159,
                                542,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        159,
                                        542,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "Guangwen Yang, and Depei Qian. The deep learning compiler: A comprehensive survey. IEEE",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                88,
                                171,
                                405,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        171,
                                        405,
                                        186
                                    ],
                                    "score": 1.0,
                                    "content": "Transactions on Parallel and Distributed Systems, 32(3):708–727, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                72,
                                192,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        192,
                                        541,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "[54] Valerii Likhosherstov, Krzysztof Choromanski, Jared Davis, Xingyou Song, and Adrian Weller. Sub-linear",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                89,
                                204,
                                444,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        204,
                                        444,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "memory: How to make performers slim. arXiv preprint arXiv:2012.11346, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                222,
                                542,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        222,
                                        542,
                                        237
                                    ],
                                    "score": 1.0,
                                    "content": "[55] Ji Lin, Yongming Rao, Jiwen Lu, and Jie Zhou. Runtime neural pruning. In I. Guyon, U. V. Luxburg,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                90,
                                236,
                                542,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        236,
                                        542,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, editors, Advances in Neural",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                91,
                                248,
                                420,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        248,
                                        420,
                                        259
                                    ],
                                    "score": 1.0,
                                    "content": "Information Processing Systems, volume 30. Curran Associates, Inc., 2017.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                267,
                                542,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        267,
                                        542,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "[56] Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis,",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                88,
                                277,
                                542,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        277,
                                        542,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "Luke Zettlemoyer, and Veselin Stoyanov. Roberta: A robustly optimized bert pretraining approach.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                89,
                                290,
                                265,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        290,
                                        265,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv preprint arXiv:1907.11692, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                309,
                                542,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        309,
                                        542,
                                        324
                                    ],
                                    "score": 1.0,
                                    "content": "[57] Xuezhe Ma, Xiang Kong, Sinong Wang, Chunting Zhou, Jonathan May, Hao Ma, and Luke Zettlemoyer.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                90,
                                323,
                                536,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        323,
                                        536,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "Luna: Linear unified nested attention. Advances in Neural Information Processing Systems, 34, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                340,
                                542,
                                355
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        340,
                                        542,
                                        355
                                    ],
                                    "score": 1.0,
                                    "content": "[58] Peter Mattson, Christine Cheng, Gregory Diamos, Cody Coleman, Paulius Micikevicius, David Patterson,",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                91,
                                354,
                                542,
                                366
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        354,
                                        542,
                                        366
                                    ],
                                    "score": 1.0,
                                    "content": "Hanlin Tang, Gu-Yeon Wei, Peter Bailis, Victor Bittorf, et al. Mlperf training benchmark. Proceedings",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                91,
                                366,
                                318,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        366,
                                        318,
                                        378
                                    ],
                                    "score": 1.0,
                                    "content": "of Machine Learning and Systems, 2:336–349, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                384,
                                542,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        384,
                                        542,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "[59] Frank McSherry, Michael Isard, and Derek G Murray. Scalability! but at what {COST}? In 15th",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                90,
                                397,
                                384,
                                409
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        397,
                                        384,
                                        409
                                    ],
                                    "score": 1.0,
                                    "content": "Workshop on Hot Topics in Operating Systems (HotOS XV), 2015.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                69,
                                415,
                                542,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        415,
                                        542,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "[60] Maxim Milakov and Natalia Gimelshein. Online normalizer calculation for softmax. arXiv preprint",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                90,
                                429,
                                198,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        429,
                                        198,
                                        441
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:1805.02867, 2018.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                72,
                                448,
                                327,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        448,
                                        327,
                                        460
                                    ],
                                    "score": 1.0,
                                    "content": "[61] NVIDIA. Nvidia Tesla V100 GPU architecture, 2017.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                467,
                                352,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        467,
                                        352,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "[62] NVIDIA. Nvidia A100 tensor core GPU architecture, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                487,
                                352,
                                498
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        487,
                                        352,
                                        498
                                    ],
                                    "score": 1.0,
                                    "content": "[63] NVIDIA. Nvidia H100 tensor core GPU architecture, 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                69,
                                505,
                                542,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        505,
                                        542,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "[64] D Stott Parker. Random butterfly transformations with applications in computational linear algebra.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                90,
                                518,
                                117,
                                531
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        518,
                                        117,
                                        531
                                    ],
                                    "score": 1.0,
                                    "content": "1995.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                537,
                                542,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        537,
                                        542,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "[65] Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                90,
                                549,
                                542,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        549,
                                        542,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al. Pytorch: An imperative style, high-",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                88,
                                561,
                                514,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        561,
                                        514,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "performance deep learning library. Advances in neural information processing systems, 32, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                581,
                                542,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        581,
                                        398,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": "[66] Markus N Rabe and Charles Staats. Self-attention does not need ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        399,
                                        583,
                                        424,
                                        593
                                    ],
                                    "score": 0.93,
                                    "content": "O(n^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        424,
                                        581,
                                        542,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": " memory. arXiv preprint",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                90,
                                593,
                                198,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        593,
                                        198,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2112.05682, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                69,
                                610,
                                542,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        610,
                                        542,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "[67] Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al. Language",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                90,
                                625,
                                403,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        625,
                                        403,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "models are unsupervised multitask learners. OpenAI blog, 1(8):9, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                644,
                                542,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        644,
                                        542,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "[68] Jack Rae and Ali Razavi. Do transformers need deep long-range memory? In Proceedings of the 58th",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                90,
                                655,
                                542,
                                670
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        655,
                                        542,
                                        670
                                    ],
                                    "score": 1.0,
                                    "content": "Annual Meeting of the Association for Computational Linguistics, Online, July 2020. Association for",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                89,
                                667,
                                506,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        667,
                                        506,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "Computational Linguistics. URL https://www.aclweb.org/anthology/2020.acl-main.672.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                688,
                                542,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        688,
                                        542,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "[69] Jack W Rae, Anna Potapenko, Siddhant M Jayakumar, and Timothy P Lillicrap. Compressive trans-",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                89,
                                698,
                                543,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        698,
                                        543,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "formers for long-range sequence modelling. In The International Conference on Learning Representations",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                91,
                                711,
                                153,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        711,
                                        153,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "(ICLR), 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 21
                }
            ],
            "layout_bboxes": [],
            "page_idx": 13,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        752
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "14",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        68,
                        45,
                        546,
                        724
                    ],
                    "lines": [],
                    "index": 21,
                    "page_num": "page_13",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        72,
                        543,
                        724
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        68,
                        23,
                        544,
                        684
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                74,
                                540,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        540,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "[70] Jonathan Ragan-Kelley, Connelly Barnes, Andrew Adams, Sylvain Paris, Frédo Durand, and Saman",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                90,
                                85,
                                542,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        85,
                                        542,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "Amarasinghe. Halide: a language and compiler for optimizing parallelism, locality, and recomputation in",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                89,
                                97,
                                401,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        97,
                                        401,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "image processing pipelines. Acm Sigplan Notices, 48(6):519–530, 2013.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                116,
                                542,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        116,
                                        542,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "[71] Raghu Ramakrishnan, Johannes Gehrke, and Johannes Gehrke. Database management systems, volume 3.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                89,
                                128,
                                226,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        128,
                                        226,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "McGraw-Hill New York, 2003.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                148,
                                542,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        148,
                                        542,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "[72] Benjamin Recht and Christopher Ré. Parallel stochastic gradient algorithms for large-scale matrix",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                89,
                                161,
                                419,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        161,
                                        419,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "completion. Mathematical Programming Computation, 5(2):201–226, 2013.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                180,
                                542,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        180,
                                        542,
                                        194
                                    ],
                                    "score": 1.0,
                                    "content": "[73] Hongyu Ren, Hanjun Dai, Zihang Dai, Mengjiao Yang, Jure Leskovec, Dale Schuurmans, and Bo Dai.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                90,
                                192,
                                542,
                                207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        192,
                                        542,
                                        207
                                    ],
                                    "score": 1.0,
                                    "content": "Combiner: Full attention transformer with sparse computation cost. Advances in Neural Information",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                90,
                                204,
                                224,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        204,
                                        224,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "Processing Systems, 34, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                225,
                                542,
                                238
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        225,
                                        542,
                                        238
                                    ],
                                    "score": 1.0,
                                    "content": "[74] Aurko Roy, Mohammad Saffar, Ashish Vaswani, and David Grangier. Efficient content-based sparse",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                90,
                                236,
                                542,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        236,
                                        542,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "attention with routing transformers. Transactions of the Association for Computational Linguistics, 9:",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                90,
                                249,
                                148,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        249,
                                        148,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "53–68, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                268,
                                428,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        428,
                                        282
                                    ],
                                    "score": 1.0,
                                    "content": "[75] Amit Sabne. XLA: Compiling machine learning for peak performance. 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                289,
                                541,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        289,
                                        541,
                                        302
                                    ],
                                    "score": 1.0,
                                    "content": "[76] Victor Sanh, Thomas Wolf, and Alexander M Rush. Movement pruning: Adaptive sparsity by fine-tuning.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                90,
                                300,
                                265,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        300,
                                        265,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv preprint arXiv:2005.07683, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                320,
                                542,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        320,
                                        542,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "[77] Mohammad Shoeybi, Mostofa Patwary, Raul Puri, Patrick LeGresley, Jared Casper, and Bryan Catanzaro.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                90,
                                331,
                                542,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        331,
                                        542,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "Megatron-LM: Training multi-billion parameter language models using model parallelism. arXiv preprint",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                90,
                                345,
                                199,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        345,
                                        199,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:1909.08053, 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                363,
                                541,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        363,
                                        541,
                                        378
                                    ],
                                    "score": 1.0,
                                    "content": "[78] Vikas Sindhwani, Tara Sainath, and Sanjiv Kumar. Structured transforms for small-footprint deep",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                89,
                                376,
                                482,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        376,
                                        482,
                                        389
                                    ],
                                    "score": 1.0,
                                    "content": "learning. In Advances in Neural Information Processing Systems, pages 3088–3096, 2015.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                395,
                                542,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        395,
                                        542,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "[79] Sainbayar Sukhbaatar, Edouard Grave, Piotr Bojanowski, and Armand Joulin. Adaptive attention span",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                90,
                                409,
                                542,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        409,
                                        542,
                                        421
                                    ],
                                    "score": 1.0,
                                    "content": "in transformers. In Proceedings of the Annual Meeting of the Association for Computational Linguistics,",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                90,
                                420,
                                117,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        420,
                                        117,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                439,
                                542,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        439,
                                        542,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "[80] Yi Tay, Mostafa Dehghani, Samira Abnar, Yikang Shen, Dara Bahri, Philip Pham, Jinfeng Rao, Liu",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                90,
                                452,
                                542,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        452,
                                        542,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "Yang, Sebastian Ruder, and Donald Metzler. Long range arena: A benchmark for efficient transformers.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                90,
                                464,
                                372,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        464,
                                        372,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "In International Conference on Learning Representations, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                483,
                                542,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        483,
                                        542,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "[81] Yi Tay, Mostafa Dehghani, Dara Bahri, and Donald Metzler. Efficient transformers: A survey. arXiv",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                90,
                                496,
                                237,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        496,
                                        237,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "preprint arXiv:2009.06732, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                516,
                                541,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        516,
                                        541,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": "[82] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                90,
                                527,
                                542,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        527,
                                        542,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                88,
                                540,
                                173,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        540,
                                        173,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "systems, 30, 2017.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                559,
                                542,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        559,
                                        542,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "[83] Hongyu Wang, Shuming Ma, Li Dong, Shaohan Huang, Dongdong Zhang, and Furu Wei. Deepnet:",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                90,
                                571,
                                427,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        571,
                                        427,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "Scaling transformers to 1,000 layers. arXiv preprint arXiv:2203.00555, 2022.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                72,
                                592,
                                541,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        592,
                                        541,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "[84] Sinong Wang, Belinda Z Li, Madian Khabsa, Han Fang, and Hao Ma. Linformer: Self-attention with",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                89,
                                603,
                                348,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        603,
                                        348,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "linear complexity. arXiv preprint arXiv:2006.04768, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                623,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        623,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "[85] Samuel Williams, Andrew Waterman, and David Patterson. Roofline: an insightful visual performance",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                90,
                                635,
                                459,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        635,
                                        459,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "model for multicore architectures. Communications of the ACM, 52(4):65–76, 2009.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                654,
                                542,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        654,
                                        542,
                                        668
                                    ],
                                    "score": 1.0,
                                    "content": "[86] Michael E Wolf and Monica S Lam. A data locality optimizing algorithm. In Proceedings of the ACM",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                90,
                                667,
                                534,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        667,
                                        534,
                                        681
                                    ],
                                    "score": 1.0,
                                    "content": "SIGPLAN 1991 conference on Programming language design and implementation, pages 30–44, 1991.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 19.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 14,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                741,
                                312,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        741,
                                        312,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "15",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        68,
                        23,
                        544,
                        684
                    ],
                    "lines": [],
                    "index": 19.5,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        74,
                        542,
                        681
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        67,
                        73,
                        544,
                        452
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                74,
                                541,
                                86
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        74,
                                        541,
                                        86
                                    ],
                                    "score": 1.0,
                                    "content": "[87] Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                91,
                                86,
                                542,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        86,
                                        542,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen,",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                91,
                                97,
                                542,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        97,
                                        542,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame,",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                91,
                                109,
                                542,
                                123
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        109,
                                        542,
                                        123
                                    ],
                                    "score": 1.0,
                                    "content": "Quentin Lhoest, and Alexander M. Rush. Transformers: State-of-the-art natural language processing.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                90,
                                121,
                                541,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        121,
                                        541,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "In Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                91,
                                134,
                                541,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        134,
                                        541,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "Demonstrations, pages 38–45, Online, October 2020. Association for Computational Linguistics. URL",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                90,
                                145,
                                363,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        145,
                                        363,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": "https://www.aclweb.org/anthology/2020.emnlp-demos.6.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                164,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        164,
                                        541,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "[88] David P Woodruff. Optimal space lower bounds for all frequency moments. In SODA, volume 4, pages",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                91,
                                177,
                                198,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        177,
                                        198,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "167–175. Citeseer, 2004.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                197,
                                541,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        197,
                                        541,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "[89] Felix Wu, Angela Fan, Alexei Baevski, Yann N Dauphin, and Michael Auli. Pay less attention with",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                91,
                                209,
                                542,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        209,
                                        542,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "lightweight and dynamic convolutions. In The International Conference on Learning Representations",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                91,
                                221,
                                154,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        221,
                                        154,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "(ICLR), 2019.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                72,
                                241,
                                541,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        241,
                                        541,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "[90] Yunyang Xiong, Zhanpeng Zeng, Rudrasis Chakraborty, Mingxing Tan, Glenn Fung, Yin Li, and Vikas",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                91,
                                254,
                                541,
                                265
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        254,
                                        541,
                                        265
                                    ],
                                    "score": 1.0,
                                    "content": "Singh. Nyströmformer: A nystöm-based algorithm for approximating self-attention. In Proceedings of",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                90,
                                264,
                                542,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        264,
                                        542,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "the AAAI Conference on Artificial Intelligence. AAAI Conference on Artificial Intelligence, volume 35,",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                89,
                                277,
                                171,
                                289
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        277,
                                        171,
                                        289
                                    ],
                                    "score": 1.0,
                                    "content": "page 14138, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                296,
                                541,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        296,
                                        541,
                                        310
                                    ],
                                    "score": 1.0,
                                    "content": "[91] Li Yuan, Yunpeng Chen, Tao Wang, Weihao Yu, Yujun Shi, Zi-Hang Jiang, Francis EH Tay, Jiashi Feng,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                90,
                                308,
                                541,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        308,
                                        541,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "and Shuicheng Yan. Tokens-to-token vit: Training vision transformers from scratch on imagenet. In",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                90,
                                320,
                                527,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        320,
                                        527,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 558–567, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                340,
                                541,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        340,
                                        541,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "[92] Manzil Zaheer, Guru Guruganesh, Kumar Avinava Dubey, Joshua Ainslie, Chris Alberti, Santiago",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                91,
                                353,
                                541,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        353,
                                        541,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "Ontanon, Philip Pham, Anirudh Ravula, Qifan Wang, Li Yang, et al. Big bird: Transformers for longer",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                91,
                                365,
                                414,
                                377
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        365,
                                        414,
                                        377
                                    ],
                                    "score": 1.0,
                                    "content": "sequences. Advances in Neural Information Processing Systems, 33, 2020.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                72,
                                384,
                                540,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        384,
                                        540,
                                        396
                                    ],
                                    "score": 1.0,
                                    "content": "[93] Shuangfei Zhai, Walter Talbott, Nitish Srivastava, Chen Huang, Hanlin Goh, Ruixiang Zhang, and Josh",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                91,
                                397,
                                446,
                                409
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        397,
                                        446,
                                        409
                                    ],
                                    "score": 1.0,
                                    "content": "Susskind. An attention free transformer. arXiv preprint arXiv:2105.14103, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                72,
                                417,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        417,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "[94] Chen Zhu, Wei Ping, Chaowei Xiao, Mohammad Shoeybi, Tom Goldstein, Anima Anandkumar, and",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                91,
                                429,
                                542,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        429,
                                        542,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "Bryan Catanzaro. Long-short transformer: Efficient transformers for language and vision. Advances in",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                91,
                                440,
                                308,
                                452
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        440,
                                        308,
                                        452
                                    ],
                                    "score": 1.0,
                                    "content": "Neural Information Processing Systems, 34, 2021.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 13
                }
            ],
            "layout_bboxes": [],
            "page_idx": 15,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "16",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        67,
                        73,
                        544,
                        452
                    ],
                    "lines": [],
                    "index": 13,
                    "page_num": "page_15",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        74,
                        542,
                        452
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        69,
                        196,
                        86
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                71,
                                195,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        71,
                                        86,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "A",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        97,
                                        72,
                                        195,
                                        83
                                    ],
                                    "score": 1.0,
                                    "content": "Related Work",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        95,
                        541,
                        178
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "IO-Aware Runtime Optimization. The broad concept of optimizing for reading and writing to fast/slow",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                108,
                                541,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        108,
                                        541,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "memory has a long history in computer science and has been known by many names. We draw the most",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                120,
                                540,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        120,
                                        540,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "direct connection to the literature of analyzing I/O complexity in this work [1], but concepts of memory",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                132,
                                541,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        132,
                                        541,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "hierarchies are fundamental and has appeared in many forms, from the working set model [21], to data",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                144,
                                541,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        144,
                                        541,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "locality [86], to the Roofline model of arithmetic intensity [85], to analyses of scalability [59], to standard",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                156,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        156,
                                        541,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "textbook treatments of computer architecture [40]. We hope that this work encourages the community to",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                167,
                                327,
                                179
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        167,
                                        327,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": "adopt these ideas in more parts of the deep learning stack.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        179,
                        541,
                        345
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                178,
                                541,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        178,
                                        541,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "Efficient ML Models with Structured Matrices. Matrix multiply is the core computational bottle-",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                191,
                                541,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        191,
                                        541,
                                        203
                                    ],
                                    "score": 1.0,
                                    "content": "neck of most machine learning models. To reduce the computational complexity, there have been numerous",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                204,
                                541,
                                214
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        204,
                                        541,
                                        214
                                    ],
                                    "score": 1.0,
                                    "content": "approaches to learn over a more efficient set of matrices. These matrices are called structured matrices, which",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                216,
                                541,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        216,
                                        158,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": "have subquadratic (",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        158,
                                        216,
                                        181,
                                        227
                                    ],
                                    "score": 0.9,
                                    "content": "o(n^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        181,
                                        216,
                                        246,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": " for dimension ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        246,
                                        218,
                                        268,
                                        225
                                    ],
                                    "score": 0.86,
                                    "content": "n\\times n",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        268,
                                        216,
                                        541,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": ") number of parameters and runtime. Most common examples",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                227,
                                541,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        227,
                                        541,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "of structured matrices are sparse and low-rank matrices, along with fast transforms commonly encountered",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                239,
                                540,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        239,
                                        540,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "in signal processing (Fourier, Chebyshev, sine/cosine, orthogonal polynomials). There have been several",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                251,
                                541,
                                263
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        251,
                                        541,
                                        263
                                    ],
                                    "score": 1.0,
                                    "content": "more general classes of structured matrices proposed in machine learning: Toeplitz-like [78], low-displacement",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                263,
                                541,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        263,
                                        541,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": "rank [49], quasi-separable [25]). The butterfly pattern we use for our block-sparse attention is motivated",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                275,
                                541,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        275,
                                        541,
                                        287
                                    ],
                                    "score": 1.0,
                                    "content": "by the fact that butterfly matrices [15, 64] and their products have been shown to be able to express any",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                71,
                                288,
                                540,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        288,
                                        540,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "structured matrices with almost optimal runtime and number of parameters [16, 20]. However, even though",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                299,
                                541,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        299,
                                        541,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "structured matrices are efficient in theory, they have not seen wide adoption since it is hard to translate their",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                310,
                                541,
                                323
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        310,
                                        541,
                                        323
                                    ],
                                    "score": 1.0,
                                    "content": "efficiency to wall-clock speedup since dense unconstrained matrix multiply has very optimize implementation,",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                324,
                                541,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        324,
                                        541,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "a phenomenon known as the hardware lottery [41]. Extensions of butterfly matrices [17, 18] aimed to make",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                335,
                                257,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        335,
                                        257,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": "butterfly matrices more hardware-friendly.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 14.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        346,
                        541,
                        429
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                347,
                                541,
                                358
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        347,
                                        541,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": "Sparse Training. Our block-sparse FlashAttention can be seen as a step towards making sparse model",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                358,
                                541,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        358,
                                        541,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "training more efficient. Sparse models have seen success in compressing models for inference (pruning) by",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                370,
                                540,
                                382
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        370,
                                        540,
                                        382
                                    ],
                                    "score": 1.0,
                                    "content": "sparsifying the weight matrices [23, 38, 39, 55, 76]. For model training, the lottery tickets hypothesis [28, 29, 30]",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                383,
                                541,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        383,
                                        541,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "suggests that there are a set of small sub-networks derived from a larger dense network that performs as",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                393,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        393,
                                        541,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "well as the original dense network. Out block-sparse FlashAttention can also be seen as a fixed lottery",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                406,
                                541,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        406,
                                        541,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "ticket in the context of attention: we fix the sparsity pattern to be the butterfly pattern through training,",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                419,
                                542,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        419,
                                        542,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "and observe that it performs almost as well as the (dense) FlashAttention on the Long-range Arena tasks.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 25
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        430,
                        541,
                        549
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                430,
                                541,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        430,
                                        541,
                                        442
                                    ],
                                    "score": 1.0,
                                    "content": "Efficient Transformer. Transformer-based models have become the most widely-used architecture in",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                443,
                                541,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        443,
                                        541,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "natural language processing [22] and computer vision [24, 91]. However, one of their computational bottlenecks",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                69,
                                453,
                                542,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        453,
                                        542,
                                        467
                                    ],
                                    "score": 1.0,
                                    "content": "is that their time and memory scales quadratic in the sequence length. There are numerous approaches to",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                466,
                                541,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        466,
                                        541,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "overcome this bottleneck, including approximation with hashing (i.e., sparse) such as Reformer [51] and",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                541,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        541,
                                        490
                                    ],
                                    "score": 1.0,
                                    "content": "Smyrf [19] and with low-rank approximation such as Performer [12, 54]. One can even combine sparse and",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                490,
                                541,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        490,
                                        541,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "low-rank approximation for better accuracy (e.g., Longformer [3], BigBird [92], Scatterbrain [9], Long-short",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                503,
                                541,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        503,
                                        541,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "transformer [94], Combiner [73]). Other approaches include compressing along the sequence dimension to",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                514,
                                541,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        514,
                                        541,
                                        526
                                    ],
                                    "score": 1.0,
                                    "content": "attend to multiple tokens at once [52, 57, 79, 89]. One can also attend over the states from previous sequences",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                526,
                                541,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        526,
                                        541,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "to help lengthen the context (e.g., Transformer-XL [14] and Compressive Transformer [69]). We recommend",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                538,
                                212,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        538,
                                        212,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "the survey [81] for more details.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 33.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        550,
                        541,
                        622
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                550,
                                541,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        550,
                                        541,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "There are several lines of work on developing other modules instead of attention to model longer context.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                561,
                                542,
                                575
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        561,
                                        542,
                                        575
                                    ],
                                    "score": 1.0,
                                    "content": "HiPPO [35] and its extensions, most notably S4 [31, 36, 37] projects the history on a polynomial basis,",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                71,
                                574,
                                542,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        574,
                                        542,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "allowing accurate reconstruction of the history through state-space models. They combine the strengths of",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                586,
                                541,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        586,
                                        541,
                                        598
                                    ],
                                    "score": 1.0,
                                    "content": "CNNs (efficient training), RNNs (efficient inference), and continuous models (robust to change in sampling",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                597,
                                541,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        597,
                                        541,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "rates). LambdaNetworks [2], AFT [93] and FLASH [42] are other attempts at replacing attention in the",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                69,
                                608,
                                309,
                                623
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        608,
                                        309,
                                        623
                                    ],
                                    "score": 1.0,
                                    "content": "context of image classification and language modeling.",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        }
                    ],
                    "index": 41.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        638,
                        224,
                        655
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                640,
                                224,
                                654
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        640,
                                        84,
                                        653
                                    ],
                                    "score": 1.0,
                                    "content": "B",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        640,
                                        224,
                                        654
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm Details",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        }
                    ],
                    "index": 45
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        664,
                        540,
                        711
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                541,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        541,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "We first derive the forward and backward passes of attention and show that they can be computed in a",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        },
                        {
                            "bbox": [
                                70,
                                677,
                                540,
                                688
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        677,
                                        540,
                                        688
                                    ],
                                    "score": 1.0,
                                    "content": "memory-efficient manner (requiring extra memory linear instead of quadratic in the sequence length). Though",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        },
                        {
                            "bbox": [
                                71,
                                689,
                                540,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        689,
                                        540,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "they reduce the amount of extra memory required, naively they still incur quadratic HBM accesses, resulting",
                                    "type": "text"
                                }
                            ],
                            "index": 48
                        },
                        {
                            "bbox": [
                                70,
                                700,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        700,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "in slower execution speed. We describe the FlashAttention algorithm to implement both the forward",
                                    "type": "text"
                                }
                            ],
                            "index": 49
                        }
                    ],
                    "index": 47.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 16,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                314,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        314,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 13,
                                    "width": 16
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        69,
                        196,
                        86
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                71,
                                195,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        71,
                                        86,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "A",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        97,
                                        72,
                                        195,
                                        83
                                    ],
                                    "score": 1.0,
                                    "content": "Related Work",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        95,
                        541,
                        178
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "IO-Aware Runtime Optimization. The broad concept of optimizing for reading and writing to fast/slow",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                108,
                                541,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        108,
                                        541,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "memory has a long history in computer science and has been known by many names. We draw the most",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                120,
                                540,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        120,
                                        540,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "direct connection to the literature of analyzing I/O complexity in this work [1], but concepts of memory",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                132,
                                541,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        132,
                                        541,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "hierarchies are fundamental and has appeared in many forms, from the working set model [21], to data",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                144,
                                541,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        144,
                                        541,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "locality [86], to the Roofline model of arithmetic intensity [85], to analyses of scalability [59], to standard",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                156,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        156,
                                        541,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "textbook treatments of computer architecture [40]. We hope that this work encourages the community to",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                167,
                                327,
                                179
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        167,
                                        327,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": "adopt these ideas in more parts of the deep learning stack.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 4,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        95,
                        541,
                        179
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        179,
                        541,
                        345
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                178,
                                541,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        178,
                                        541,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "Efficient ML Models with Structured Matrices. Matrix multiply is the core computational bottle-",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                191,
                                541,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        191,
                                        541,
                                        203
                                    ],
                                    "score": 1.0,
                                    "content": "neck of most machine learning models. To reduce the computational complexity, there have been numerous",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                204,
                                541,
                                214
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        204,
                                        541,
                                        214
                                    ],
                                    "score": 1.0,
                                    "content": "approaches to learn over a more efficient set of matrices. These matrices are called structured matrices, which",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                216,
                                541,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        216,
                                        158,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": "have subquadratic (",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        158,
                                        216,
                                        181,
                                        227
                                    ],
                                    "score": 0.9,
                                    "content": "o(n^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        181,
                                        216,
                                        246,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": " for dimension ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        246,
                                        218,
                                        268,
                                        225
                                    ],
                                    "score": 0.86,
                                    "content": "n\\times n",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        268,
                                        216,
                                        541,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": ") number of parameters and runtime. Most common examples",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                227,
                                541,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        227,
                                        541,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "of structured matrices are sparse and low-rank matrices, along with fast transforms commonly encountered",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                239,
                                540,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        239,
                                        540,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "in signal processing (Fourier, Chebyshev, sine/cosine, orthogonal polynomials). There have been several",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                251,
                                541,
                                263
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        251,
                                        541,
                                        263
                                    ],
                                    "score": 1.0,
                                    "content": "more general classes of structured matrices proposed in machine learning: Toeplitz-like [78], low-displacement",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                263,
                                541,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        263,
                                        541,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": "rank [49], quasi-separable [25]). The butterfly pattern we use for our block-sparse attention is motivated",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                275,
                                541,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        275,
                                        541,
                                        287
                                    ],
                                    "score": 1.0,
                                    "content": "by the fact that butterfly matrices [15, 64] and their products have been shown to be able to express any",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                71,
                                288,
                                540,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        288,
                                        540,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "structured matrices with almost optimal runtime and number of parameters [16, 20]. However, even though",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                299,
                                541,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        299,
                                        541,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "structured matrices are efficient in theory, they have not seen wide adoption since it is hard to translate their",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                310,
                                541,
                                323
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        310,
                                        541,
                                        323
                                    ],
                                    "score": 1.0,
                                    "content": "efficiency to wall-clock speedup since dense unconstrained matrix multiply has very optimize implementation,",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                324,
                                541,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        324,
                                        541,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "a phenomenon known as the hardware lottery [41]. Extensions of butterfly matrices [17, 18] aimed to make",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                335,
                                257,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        335,
                                        257,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": "butterfly matrices more hardware-friendly.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 14.5,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        178,
                        541,
                        347
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        346,
                        541,
                        429
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                347,
                                541,
                                358
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        347,
                                        541,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": "Sparse Training. Our block-sparse FlashAttention can be seen as a step towards making sparse model",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                358,
                                541,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        358,
                                        541,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "training more efficient. Sparse models have seen success in compressing models for inference (pruning) by",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                370,
                                540,
                                382
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        370,
                                        540,
                                        382
                                    ],
                                    "score": 1.0,
                                    "content": "sparsifying the weight matrices [23, 38, 39, 55, 76]. For model training, the lottery tickets hypothesis [28, 29, 30]",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                383,
                                541,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        383,
                                        541,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "suggests that there are a set of small sub-networks derived from a larger dense network that performs as",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                393,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        393,
                                        541,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "well as the original dense network. Out block-sparse FlashAttention can also be seen as a fixed lottery",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                406,
                                541,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        406,
                                        541,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "ticket in the context of attention: we fix the sparsity pattern to be the butterfly pattern through training,",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                419,
                                542,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        419,
                                        542,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "and observe that it performs almost as well as the (dense) FlashAttention on the Long-range Arena tasks.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 25,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        347,
                        542,
                        430
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        430,
                        541,
                        549
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                430,
                                541,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        430,
                                        541,
                                        442
                                    ],
                                    "score": 1.0,
                                    "content": "Efficient Transformer. Transformer-based models have become the most widely-used architecture in",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                443,
                                541,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        443,
                                        541,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "natural language processing [22] and computer vision [24, 91]. However, one of their computational bottlenecks",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                69,
                                453,
                                542,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        453,
                                        542,
                                        467
                                    ],
                                    "score": 1.0,
                                    "content": "is that their time and memory scales quadratic in the sequence length. There are numerous approaches to",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                466,
                                541,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        466,
                                        541,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "overcome this bottleneck, including approximation with hashing (i.e., sparse) such as Reformer [51] and",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                541,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        541,
                                        490
                                    ],
                                    "score": 1.0,
                                    "content": "Smyrf [19] and with low-rank approximation such as Performer [12, 54]. One can even combine sparse and",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                490,
                                541,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        490,
                                        541,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "low-rank approximation for better accuracy (e.g., Longformer [3], BigBird [92], Scatterbrain [9], Long-short",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                503,
                                541,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        503,
                                        541,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "transformer [94], Combiner [73]). Other approaches include compressing along the sequence dimension to",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                514,
                                541,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        514,
                                        541,
                                        526
                                    ],
                                    "score": 1.0,
                                    "content": "attend to multiple tokens at once [52, 57, 79, 89]. One can also attend over the states from previous sequences",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                526,
                                541,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        526,
                                        541,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "to help lengthen the context (e.g., Transformer-XL [14] and Compressive Transformer [69]). We recommend",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                538,
                                212,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        538,
                                        212,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "the survey [81] for more details.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 33.5,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        430,
                        542,
                        550
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        550,
                        541,
                        622
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                550,
                                541,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        550,
                                        541,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "There are several lines of work on developing other modules instead of attention to model longer context.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                561,
                                542,
                                575
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        561,
                                        542,
                                        575
                                    ],
                                    "score": 1.0,
                                    "content": "HiPPO [35] and its extensions, most notably S4 [31, 36, 37] projects the history on a polynomial basis,",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                71,
                                574,
                                542,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        574,
                                        542,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "allowing accurate reconstruction of the history through state-space models. They combine the strengths of",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                586,
                                541,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        586,
                                        541,
                                        598
                                    ],
                                    "score": 1.0,
                                    "content": "CNNs (efficient training), RNNs (efficient inference), and continuous models (robust to change in sampling",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                597,
                                541,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        597,
                                        541,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "rates). LambdaNetworks [2], AFT [93] and FLASH [42] are other attempts at replacing attention in the",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                69,
                                608,
                                309,
                                623
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        608,
                                        309,
                                        623
                                    ],
                                    "score": 1.0,
                                    "content": "context of image classification and language modeling.",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        }
                    ],
                    "index": 41.5,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        550,
                        542,
                        623
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        638,
                        224,
                        655
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                640,
                                224,
                                654
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        640,
                                        84,
                                        653
                                    ],
                                    "score": 1.0,
                                    "content": "B",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        640,
                                        224,
                                        654
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm Details",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        }
                    ],
                    "index": 45,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        664,
                        540,
                        711
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                541,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        541,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "We first derive the forward and backward passes of attention and show that they can be computed in a",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        },
                        {
                            "bbox": [
                                70,
                                677,
                                540,
                                688
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        677,
                                        540,
                                        688
                                    ],
                                    "score": 1.0,
                                    "content": "memory-efficient manner (requiring extra memory linear instead of quadratic in the sequence length). Though",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        },
                        {
                            "bbox": [
                                71,
                                689,
                                540,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        689,
                                        540,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "they reduce the amount of extra memory required, naively they still incur quadratic HBM accesses, resulting",
                                    "type": "text"
                                }
                            ],
                            "index": 48
                        },
                        {
                            "bbox": [
                                70,
                                700,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        700,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "in slower execution speed. We describe the FlashAttention algorithm to implement both the forward",
                                    "type": "text"
                                }
                            ],
                            "index": 49
                        },
                        {
                            "bbox": [
                                71,
                                74,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "and the backward passes on GPUs that reduces HBM accesses, leading to both faster runtime and smaller",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                85,
                                152,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        85,
                                        152,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "memory footprint.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 47.5,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        664,
                        541,
                        712
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        73,
                        540,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "and the backward passes on GPUs that reduces HBM accesses, leading to both faster runtime and smaller",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                85,
                                152,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        85,
                                        152,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "memory footprint.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        111,
                        285,
                        126
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                111,
                                284,
                                124
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        111,
                                        93,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "B.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        112,
                                        284,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "Memory-efficient forward pass",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        131,
                        541,
                        190
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                132,
                                541,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        132,
                                        508,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "The main challenge in making attention memory-efficient is the softmax that couples the columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        509,
                                        134,
                                        516,
                                        141
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        517,
                                        132,
                                        541,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": " (and",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                143,
                                541,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        143,
                                        121,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        146,
                                        129,
                                        153
                                    ],
                                    "score": 0.85,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        129,
                                        143,
                                        541,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "). Our approach is to compute the softmax normalization constant separately to decouple the",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                69,
                                155,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        155,
                                        541,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "columns. This technique [60] has been used in the literature [51, 66] to show that attention computation",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                168,
                                541,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        168,
                                        541,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "does not need quadratic extra memory (though the number of HBM accesses is still quadratic, resulting in",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                180,
                                139,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        180,
                                        139,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "slow run-time).",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        191,
                        538,
                        214
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                192,
                                540,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        192,
                                        540,
                                        203
                                    ],
                                    "score": 1.0,
                                    "content": "For simplicity, we omit here the max-shifting step during softmax. The full algorithm in Appendix B.3",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                203,
                                167,
                                215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        203,
                                        167,
                                        215
                                    ],
                                    "score": 1.0,
                                    "content": "contains all the steps.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 8.5
                },
                {
                    "type": "text",
                    "bbox": [
                        79,
                        215,
                        539,
                        227
                    ],
                    "lines": [
                        {
                            "bbox": [
                                83,
                                212,
                                540,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        212,
                                        235,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "Recall that given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        236,
                                        216,
                                        302,
                                        227
                                    ],
                                    "score": 0.92,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        303,
                                        212,
                                        492,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": ", we want to compute the attention output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        492,
                                        216,
                                        535,
                                        225
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        535,
                                        212,
                                        540,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": ":",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        165,
                        234,
                        444,
                        247
                    ],
                    "lines": [
                        {
                            "bbox": [
                                165,
                                234,
                                444,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        165,
                                        234,
                                        444,
                                        247
                                    ],
                                    "score": 0.67,
                                    "content": "\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\operatorname{softmax}(\\mathbf{S})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 11,
                    "virtual_lines": [
                        {
                            "bbox": [
                                165,
                                234,
                                444,
                                247
                            ],
                            "spans": [],
                            "index": 11
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        255,
                        540,
                        279
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                255,
                                542,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        255,
                                        147,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "We have that",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        148,
                                        257,
                                        193,
                                        269
                                    ],
                                    "score": 0.95,
                                    "content": "S_{i j}=q_{i}^{T}k_{j}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 45
                                },
                                {
                                    "bbox": [
                                        193,
                                        255,
                                        225,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        261,
                                        234,
                                        268
                                    ],
                                    "score": 0.89,
                                    "content": "q_{i}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        234,
                                        255,
                                        256,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        257,
                                        258,
                                        266,
                                        268
                                    ],
                                    "score": 0.91,
                                    "content": "k_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        267,
                                        255,
                                        303,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "are the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        303,
                                        259,
                                        307,
                                        266
                                    ],
                                    "score": 0.83,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        307,
                                        255,
                                        341,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "-th and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        342,
                                        259,
                                        347,
                                        268
                                    ],
                                    "score": 0.88,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        347,
                                        255,
                                        413,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "-th columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        413,
                                        258,
                                        421,
                                        267
                                    ],
                                    "score": 0.83,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        421,
                                        255,
                                        443,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        443,
                                        258,
                                        451,
                                        266
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        452,
                                        255,
                                        542,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": " respectively. Define",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                268,
                                245,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        245,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "the normalization constants of softmax:",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 12.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        274,
                        276,
                        337,
                        303
                    ],
                    "lines": [
                        {
                            "bbox": [
                                274,
                                276,
                                337,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        274,
                                        276,
                                        337,
                                        303
                                    ],
                                    "score": 0.94,
                                    "content": "L_{i}=\\sum_{j}e^{q_{i}^{T}k_{j}}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 14.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                274,
                                276,
                                337,
                                289.5
                            ],
                            "spans": [],
                            "index": 14
                        },
                        {
                            "bbox": [
                                274,
                                289.5,
                                337,
                                303.0
                            ],
                            "spans": [],
                            "index": 15
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        306,
                        381,
                        319
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                307,
                                380,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        307,
                                        89,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        307,
                                        132,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "be the",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        132,
                                        309,
                                        137,
                                        318
                                    ],
                                    "score": 0.89,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        138,
                                        307,
                                        199,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "-th column of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        200,
                                        309,
                                        208,
                                        316
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        208,
                                        307,
                                        253,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": ", then the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        253,
                                        309,
                                        257,
                                        316
                                    ],
                                    "score": 0.83,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        257,
                                        307,
                                        380,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "-th columns of the output is",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                89,
                                312,
                                99,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        312,
                                        99,
                                        319
                                    ],
                                    "score": 0.9,
                                    "content": "\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        229,
                        326,
                        382,
                        359
                    ],
                    "lines": [
                        {
                            "bbox": [
                                229,
                                326,
                                382,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        229,
                                        326,
                                        382,
                                        359
                                    ],
                                    "score": 0.95,
                                    "content": "o_{i}=P_{i:}\\mathbf{V}=\\sum_{j}P_{i j}\\nu_{j}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}\\nu_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 18.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                229,
                                326,
                                382,
                                342.5
                            ],
                            "spans": [],
                            "index": 18
                        },
                        {
                            "bbox": [
                                229,
                                342.5,
                                382,
                                359.0
                            ],
                            "spans": [],
                            "index": 19
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        366,
                        540,
                        394
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                366,
                                541,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        366,
                                        167,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "We see that once ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        167,
                                        369,
                                        177,
                                        377
                                    ],
                                    "score": 0.91,
                                    "content": "L_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        177,
                                        366,
                                        317,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "is computed, we can compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        371,
                                        326,
                                        377
                                    ],
                                    "score": 0.88,
                                    "content": "o_{i}",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        326,
                                        366,
                                        541,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "without extra memory by repeatedly summing",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                72,
                                378,
                                421,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        378,
                                        104,
                                        396
                                    ],
                                    "score": 0.93,
                                    "content": "\\frac{e^{q_{i}^{I}k_{j}}}{L_{i}}\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 18,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        104,
                                        378,
                                        331,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": ". Therefore the forward pass can be computed with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        331,
                                        384,
                                        352,
                                        394
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        353,
                                        378,
                                        421,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory:",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 20.5
                },
                {
                    "type": "text",
                    "bbox": [
                        81,
                        401,
                        426,
                        434
                    ],
                    "lines": [
                        {
                            "bbox": [
                                83,
                                401,
                                424,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        401,
                                        139,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "1. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        405,
                                        149,
                                        413
                                    ],
                                    "score": 0.92,
                                    "content": "L_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        149,
                                        401,
                                        181,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        181,
                                        405,
                                        185,
                                        411
                                    ],
                                    "score": 0.87,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        185,
                                        401,
                                        335,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (1), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        336,
                                        404,
                                        356,
                                        414
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        357,
                                        401,
                                        424,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                83,
                                421,
                                423,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        421,
                                        139,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "2. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        426,
                                        148,
                                        432
                                    ],
                                    "score": 0.89,
                                    "content": "o_{i}",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        148,
                                        421,
                                        180,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        180,
                                        424,
                                        183,
                                        431
                                    ],
                                    "score": 0.73,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        184,
                                        421,
                                        334,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (2), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        335,
                                        423,
                                        356,
                                        433
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        356,
                                        421,
                                        423,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 22.5
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        446,
                        295,
                        461
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                447,
                                294,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        447,
                                        94,
                                        460
                                    ],
                                    "score": 1.0,
                                    "content": "B.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        294,
                                        460
                                    ],
                                    "score": 1.0,
                                    "content": "Memory-efficient backward pass",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        466,
                        540,
                        514
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                468,
                                541,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        468,
                                        541,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "We derive the backward pass of attention and show that it can also be computed with linear memory. Rabe",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                478,
                                541,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        478,
                                        541,
                                        492
                                    ],
                                    "score": 1.0,
                                    "content": "and Staats [66] suggests that the backward pass can be done without quadratic extra memory by applying",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                492,
                                540,
                                504
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        492,
                                        540,
                                        504
                                    ],
                                    "score": 1.0,
                                    "content": "gradient checkpointing to the memory-efficient forward pass. We instead derive the backward pass explicitly",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                504,
                                355,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        504,
                                        355,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "and show how it can be computed in a memory-efficient manner.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 26.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        515,
                        540,
                        553
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                514,
                                542,
                                527
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        514,
                                        269,
                                        527
                                    ],
                                    "score": 1.0,
                                    "content": "Suppose that there is a scalar loss function ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        270,
                                        518,
                                        276,
                                        527
                                    ],
                                    "score": 0.9,
                                    "content": "\\phi",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        276,
                                        514,
                                        411,
                                        527
                                    ],
                                    "score": 1.0,
                                    "content": ", and let the output gradient be",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        412,
                                        515,
                                        457,
                                        525
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{dO}\\in\\mathbb{R}^{n\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 45
                                },
                                {
                                    "bbox": [
                                        457,
                                        514,
                                        542,
                                        527
                                    ],
                                    "score": 1.0,
                                    "content": "(where dO denotes",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                72,
                                522,
                                539,
                                547
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        528,
                                        83,
                                        541
                                    ],
                                    "score": 0.77,
                                    "content": "\\frac{\\partial\\phi}{\\partial\\mathbf{0}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        84,
                                        522,
                                        286,
                                        547
                                    ],
                                    "score": 1.0,
                                    "content": "). We want to compute the input gradients ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        287,
                                        529,
                                        370,
                                        540
                                    ],
                                    "score": 0.63,
                                    "content": "\\mathbf{dQ},\\mathbf{dK},\\mathbf{dV}\\in\\mathbb{R}^{n\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 83
                                },
                                {
                                    "bbox": [
                                        370,
                                        522,
                                        493,
                                        547
                                    ],
                                    "score": 1.0,
                                    "content": "(where dQ, dK, dV denote ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        494,
                                        528,
                                        539,
                                        543
                                    ],
                                    "score": 0.92,
                                    "content": "\\frac{\\partial\\phi}{\\partial\\mathbf{Q}},\\frac{\\partial\\phi}{\\partial\\mathbf{K}},\\frac{\\partial\\phi}{\\partial\\mathbf{V}}",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 45
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                543,
                                130,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        543,
                                        130,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "respectively).",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        554,
                        537,
                        577
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                554,
                                538,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        554,
                                        145,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "The gradient ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        556,
                                        159,
                                        563
                                    ],
                                    "score": 0.5,
                                    "content": "\\mathbf{dV}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        159,
                                        554,
                                        538,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": " is easy to see. Applying reverse-mode autodiff by hand (aka the chain rule), we obtain",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                566,
                                245,
                                577
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        566,
                                        161,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": "(in matrix notation) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        162,
                                        567,
                                        212,
                                        576
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{dV}=\\mathbf{P}^{T}\\mathbf{dO}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        213,
                                        566,
                                        245,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": ". Thus:",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 32.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        237,
                        585,
                        375,
                        616
                    ],
                    "lines": [
                        {
                            "bbox": [
                                237,
                                585,
                                375,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        237,
                                        585,
                                        375,
                                        616
                                    ],
                                    "score": 0.94,
                                    "content": "d\\nu_{j}=\\sum_{i}P_{i j}d o_{i}=\\sum_{i}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}d o_{i}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 34.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                237,
                                585,
                                375,
                                600.5
                            ],
                            "spans": [],
                            "index": 34
                        },
                        {
                            "bbox": [
                                237,
                                600.5,
                                375,
                                616.0
                            ],
                            "spans": [],
                            "index": 35
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        623,
                        510,
                        635
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                623,
                                502,
                                636
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        623,
                                        192,
                                        636
                                    ],
                                    "score": 1.0,
                                    "content": "Since we already computed",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        193,
                                        626,
                                        203,
                                        634
                                    ],
                                    "score": 0.89,
                                    "content": "L_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        203,
                                        623,
                                        208,
                                        636
                                    ],
                                    "score": 1.0,
                                    "content": ", ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        209,
                                        625,
                                        224,
                                        635
                                    ],
                                    "score": 0.92,
                                    "content": "d\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        224,
                                        623,
                                        502,
                                        636
                                    ],
                                    "score": 1.0,
                                    "content": "can be computed without extra memory by repeated summing.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        635,
                        542,
                        658
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                635,
                                542,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        635,
                                        187,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": "The gradients dQ and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        637,
                                        201,
                                        644
                                    ],
                                    "score": 0.67,
                                    "content": "\\mathbf{dK}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        201,
                                        635,
                                        470,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": " are a little more complicated. We go through the gradients ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        470,
                                        637,
                                        483,
                                        645
                                    ],
                                    "score": 0.8,
                                    "content": "\\mathbf{dP}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        484,
                                        635,
                                        542,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": " and dS first.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                646,
                                284,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        646,
                                        193,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "From Eq. (2), we have that ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        194,
                                        648,
                                        244,
                                        657
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{dP}=\\mathbf{dOV}^{T}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        244,
                                        646,
                                        284,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": ", and so:",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 37.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        276,
                        667,
                        336,
                        680
                    ],
                    "lines": [
                        {
                            "bbox": [
                                276,
                                667,
                                336,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        276,
                                        667,
                                        336,
                                        680
                                    ],
                                    "score": 0.91,
                                    "content": "d P_{i j}=d o_{i}^{T}\\nu_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 39,
                    "virtual_lines": [
                        {
                            "bbox": [
                                276,
                                667,
                                336,
                                680
                            ],
                            "spans": [],
                            "index": 39
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        686,
                        541,
                        711
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                686,
                                541,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        686,
                                        138,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": "Recall that",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        690,
                                        217,
                                        699
                                    ],
                                    "score": 0.73,
                                    "content": "P_{i:}=\\mathrm{softmax}(S_{i:})",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 78
                                },
                                {
                                    "bbox": [
                                        217,
                                        686,
                                        384,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": ". Using the fact that the Jacobian of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        384,
                                        689,
                                        448,
                                        699
                                    ],
                                    "score": 0.47,
                                    "content": "y=\\operatorname{softmax}(x)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 64
                                },
                                {
                                    "bbox": [
                                        449,
                                        686,
                                        462,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": " is ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        688,
                                        521,
                                        699
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathrm{diag}(y)-y y^{T}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 59
                                },
                                {
                                    "bbox": [
                                        522,
                                        686,
                                        541,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": ", we",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                69,
                                700,
                                115,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        700,
                                        115,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "have that",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 40.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        186,
                        711,
                        425,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                186,
                                711,
                                425,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        186,
                                        711,
                                        425,
                                        724
                                    ],
                                    "score": 0.87,
                                    "content": "d S_{i:}=(\\mathrm{diag}(P_{i:})-P_{i:}P_{i:}^{T})d P_{i:}=P_{i:}\\circ d P_{i:}-(P_{i:}^{T}d P_{i:})P_{i:},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                186,
                                711,
                                425,
                                724
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                }
            ],
            "layout_bboxes": [],
            "page_idx": 17,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        165,
                        234,
                        444,
                        247
                    ],
                    "lines": [
                        {
                            "bbox": [
                                165,
                                234,
                                444,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        165,
                                        234,
                                        444,
                                        247
                                    ],
                                    "score": 0.67,
                                    "content": "\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\operatorname{softmax}(\\mathbf{S})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 11,
                    "virtual_lines": [
                        {
                            "bbox": [
                                165,
                                234,
                                444,
                                247
                            ],
                            "spans": [],
                            "index": 11
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        274,
                        276,
                        337,
                        303
                    ],
                    "lines": [
                        {
                            "bbox": [
                                274,
                                276,
                                337,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        274,
                                        276,
                                        337,
                                        303
                                    ],
                                    "score": 0.94,
                                    "content": "L_{i}=\\sum_{j}e^{q_{i}^{T}k_{j}}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 14.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                274,
                                276,
                                337,
                                289.5
                            ],
                            "spans": [],
                            "index": 14
                        },
                        {
                            "bbox": [
                                274,
                                289.5,
                                337,
                                303.0
                            ],
                            "spans": [],
                            "index": 15
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        229,
                        326,
                        382,
                        359
                    ],
                    "lines": [
                        {
                            "bbox": [
                                229,
                                326,
                                382,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        229,
                                        326,
                                        382,
                                        359
                                    ],
                                    "score": 0.95,
                                    "content": "o_{i}=P_{i:}\\mathbf{V}=\\sum_{j}P_{i j}\\nu_{j}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}\\nu_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 18.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                229,
                                326,
                                382,
                                342.5
                            ],
                            "spans": [],
                            "index": 18
                        },
                        {
                            "bbox": [
                                229,
                                342.5,
                                382,
                                359.0
                            ],
                            "spans": [],
                            "index": 19
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        237,
                        585,
                        375,
                        616
                    ],
                    "lines": [
                        {
                            "bbox": [
                                237,
                                585,
                                375,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        237,
                                        585,
                                        375,
                                        616
                                    ],
                                    "score": 0.94,
                                    "content": "d\\nu_{j}=\\sum_{i}P_{i j}d o_{i}=\\sum_{i}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}d o_{i}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 34.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                237,
                                585,
                                375,
                                600.5
                            ],
                            "spans": [],
                            "index": 34
                        },
                        {
                            "bbox": [
                                237,
                                600.5,
                                375,
                                616.0
                            ],
                            "spans": [],
                            "index": 35
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        276,
                        667,
                        336,
                        680
                    ],
                    "lines": [
                        {
                            "bbox": [
                                276,
                                667,
                                336,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        276,
                                        667,
                                        336,
                                        680
                                    ],
                                    "score": 0.91,
                                    "content": "d P_{i j}=d o_{i}^{T}\\nu_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 39,
                    "virtual_lines": [
                        {
                            "bbox": [
                                276,
                                667,
                                336,
                                680
                            ],
                            "spans": [],
                            "index": 39
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        186,
                        711,
                        425,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                186,
                                711,
                                425,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        186,
                                        711,
                                        425,
                                        724
                                    ],
                                    "score": 0.87,
                                    "content": "d S_{i:}=(\\mathrm{diag}(P_{i:})-P_{i:}P_{i:}^{T})d P_{i:}=P_{i:}\\circ d P_{i:}-(P_{i:}^{T}d P_{i:})P_{i:},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                186,
                                711,
                                425,
                                724
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "18",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        73,
                        540,
                        97
                    ],
                    "lines": [],
                    "index": 0.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        74,
                        541,
                        97
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        111,
                        285,
                        126
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                111,
                                284,
                                124
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        111,
                                        93,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "B.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        112,
                                        284,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "Memory-efficient forward pass",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        131,
                        541,
                        190
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                132,
                                541,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        132,
                                        508,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "The main challenge in making attention memory-efficient is the softmax that couples the columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        509,
                                        134,
                                        516,
                                        141
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        517,
                                        132,
                                        541,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": " (and",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                143,
                                541,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        143,
                                        121,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        146,
                                        129,
                                        153
                                    ],
                                    "score": 0.85,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        129,
                                        143,
                                        541,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "). Our approach is to compute the softmax normalization constant separately to decouple the",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                69,
                                155,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        155,
                                        541,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "columns. This technique [60] has been used in the literature [51, 66] to show that attention computation",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                168,
                                541,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        168,
                                        541,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "does not need quadratic extra memory (though the number of HBM accesses is still quadratic, resulting in",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                180,
                                139,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        180,
                                        139,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "slow run-time).",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        132,
                        541,
                        192
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        191,
                        538,
                        214
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                192,
                                540,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        192,
                                        540,
                                        203
                                    ],
                                    "score": 1.0,
                                    "content": "For simplicity, we omit here the max-shifting step during softmax. The full algorithm in Appendix B.3",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                203,
                                167,
                                215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        203,
                                        167,
                                        215
                                    ],
                                    "score": 1.0,
                                    "content": "contains all the steps.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 8.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        192,
                        540,
                        215
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        79,
                        215,
                        539,
                        227
                    ],
                    "lines": [
                        {
                            "bbox": [
                                83,
                                212,
                                540,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        212,
                                        235,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "Recall that given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        236,
                                        216,
                                        302,
                                        227
                                    ],
                                    "score": 0.92,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        303,
                                        212,
                                        492,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": ", we want to compute the attention output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        492,
                                        216,
                                        535,
                                        225
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        535,
                                        212,
                                        540,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": ":",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        83,
                        212,
                        540,
                        228
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        165,
                        234,
                        444,
                        247
                    ],
                    "lines": [
                        {
                            "bbox": [
                                165,
                                234,
                                444,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        165,
                                        234,
                                        444,
                                        247
                                    ],
                                    "score": 0.67,
                                    "content": "\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\operatorname{softmax}(\\mathbf{S})\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{0}=\\mathbf{P}\\mathbf{V}\\in\\mathbb{R}^{N\\times d}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 11,
                    "virtual_lines": [
                        {
                            "bbox": [
                                165,
                                234,
                                444,
                                247
                            ],
                            "spans": [],
                            "index": 11
                        }
                    ],
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        255,
                        540,
                        279
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                255,
                                542,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        255,
                                        147,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "We have that",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        148,
                                        257,
                                        193,
                                        269
                                    ],
                                    "score": 0.95,
                                    "content": "S_{i j}=q_{i}^{T}k_{j}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 45
                                },
                                {
                                    "bbox": [
                                        193,
                                        255,
                                        225,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        261,
                                        234,
                                        268
                                    ],
                                    "score": 0.89,
                                    "content": "q_{i}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        234,
                                        255,
                                        256,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        257,
                                        258,
                                        266,
                                        268
                                    ],
                                    "score": 0.91,
                                    "content": "k_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        267,
                                        255,
                                        303,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "are the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        303,
                                        259,
                                        307,
                                        266
                                    ],
                                    "score": 0.83,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        307,
                                        255,
                                        341,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "-th and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        342,
                                        259,
                                        347,
                                        268
                                    ],
                                    "score": 0.88,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        347,
                                        255,
                                        413,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "-th columns of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        413,
                                        258,
                                        421,
                                        267
                                    ],
                                    "score": 0.83,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        421,
                                        255,
                                        443,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        443,
                                        258,
                                        451,
                                        266
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        452,
                                        255,
                                        542,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": " respectively. Define",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                268,
                                245,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        245,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "the normalization constants of softmax:",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 12.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        255,
                        542,
                        279
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        274,
                        276,
                        337,
                        303
                    ],
                    "lines": [
                        {
                            "bbox": [
                                274,
                                276,
                                337,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        274,
                                        276,
                                        337,
                                        303
                                    ],
                                    "score": 0.94,
                                    "content": "L_{i}=\\sum_{j}e^{q_{i}^{T}k_{j}}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 14.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                274,
                                276,
                                337,
                                289.5
                            ],
                            "spans": [],
                            "index": 14
                        },
                        {
                            "bbox": [
                                274,
                                289.5,
                                337,
                                303.0
                            ],
                            "spans": [],
                            "index": 15
                        }
                    ],
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        306,
                        381,
                        319
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                307,
                                380,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        307,
                                        89,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        307,
                                        132,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "be the",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        132,
                                        309,
                                        137,
                                        318
                                    ],
                                    "score": 0.89,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        138,
                                        307,
                                        199,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "-th column of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        200,
                                        309,
                                        208,
                                        316
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        208,
                                        307,
                                        253,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": ", then the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        253,
                                        309,
                                        257,
                                        316
                                    ],
                                    "score": 0.83,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        257,
                                        307,
                                        380,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "-th columns of the output is",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                89,
                                312,
                                99,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        312,
                                        99,
                                        319
                                    ],
                                    "score": 0.9,
                                    "content": "\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        307,
                        380,
                        319
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        229,
                        326,
                        382,
                        359
                    ],
                    "lines": [
                        {
                            "bbox": [
                                229,
                                326,
                                382,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        229,
                                        326,
                                        382,
                                        359
                                    ],
                                    "score": 0.95,
                                    "content": "o_{i}=P_{i:}\\mathbf{V}=\\sum_{j}P_{i j}\\nu_{j}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}\\nu_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 18.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                229,
                                326,
                                382,
                                342.5
                            ],
                            "spans": [],
                            "index": 18
                        },
                        {
                            "bbox": [
                                229,
                                342.5,
                                382,
                                359.0
                            ],
                            "spans": [],
                            "index": 19
                        }
                    ],
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        366,
                        540,
                        394
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                366,
                                541,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        366,
                                        167,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "We see that once ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        167,
                                        369,
                                        177,
                                        377
                                    ],
                                    "score": 0.91,
                                    "content": "L_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        177,
                                        366,
                                        317,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "is computed, we can compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        371,
                                        326,
                                        377
                                    ],
                                    "score": 0.88,
                                    "content": "o_{i}",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        326,
                                        366,
                                        541,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "without extra memory by repeatedly summing",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                72,
                                378,
                                421,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        378,
                                        104,
                                        396
                                    ],
                                    "score": 0.93,
                                    "content": "\\frac{e^{q_{i}^{I}k_{j}}}{L_{i}}\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 18,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        104,
                                        378,
                                        331,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": ". Therefore the forward pass can be computed with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        331,
                                        384,
                                        352,
                                        394
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        353,
                                        378,
                                        421,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory:",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 20.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        366,
                        541,
                        396
                    ]
                },
                {
                    "type": "index",
                    "bbox": [
                        81,
                        401,
                        426,
                        434
                    ],
                    "lines": [
                        {
                            "bbox": [
                                83,
                                401,
                                424,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        401,
                                        139,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "1. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        405,
                                        149,
                                        413
                                    ],
                                    "score": 0.92,
                                    "content": "L_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        149,
                                        401,
                                        181,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        181,
                                        405,
                                        185,
                                        411
                                    ],
                                    "score": 0.87,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        185,
                                        401,
                                        335,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (1), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        336,
                                        404,
                                        356,
                                        414
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        357,
                                        401,
                                        424,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                83,
                                421,
                                423,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        421,
                                        139,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "2. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        426,
                                        148,
                                        432
                                    ],
                                    "score": 0.89,
                                    "content": "o_{i}",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        148,
                                        421,
                                        180,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        180,
                                        424,
                                        183,
                                        431
                                    ],
                                    "score": 0.73,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        184,
                                        421,
                                        334,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (2), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        335,
                                        423,
                                        356,
                                        433
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        356,
                                        421,
                                        423,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true
                        }
                    ],
                    "index": 22.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        83,
                        401,
                        424,
                        433
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        446,
                        295,
                        461
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                447,
                                294,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        447,
                                        94,
                                        460
                                    ],
                                    "score": 1.0,
                                    "content": "B.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        294,
                                        460
                                    ],
                                    "score": 1.0,
                                    "content": "Memory-efficient backward pass",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        466,
                        540,
                        514
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                468,
                                541,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        468,
                                        541,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "We derive the backward pass of attention and show that it can also be computed with linear memory. Rabe",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                478,
                                541,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        478,
                                        541,
                                        492
                                    ],
                                    "score": 1.0,
                                    "content": "and Staats [66] suggests that the backward pass can be done without quadratic extra memory by applying",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                492,
                                540,
                                504
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        492,
                                        540,
                                        504
                                    ],
                                    "score": 1.0,
                                    "content": "gradient checkpointing to the memory-efficient forward pass. We instead derive the backward pass explicitly",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                504,
                                355,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        504,
                                        355,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "and show how it can be computed in a memory-efficient manner.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 26.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        468,
                        541,
                        515
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        515,
                        540,
                        553
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                514,
                                542,
                                527
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        514,
                                        269,
                                        527
                                    ],
                                    "score": 1.0,
                                    "content": "Suppose that there is a scalar loss function ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        270,
                                        518,
                                        276,
                                        527
                                    ],
                                    "score": 0.9,
                                    "content": "\\phi",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        276,
                                        514,
                                        411,
                                        527
                                    ],
                                    "score": 1.0,
                                    "content": ", and let the output gradient be",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        412,
                                        515,
                                        457,
                                        525
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{dO}\\in\\mathbb{R}^{n\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 45
                                },
                                {
                                    "bbox": [
                                        457,
                                        514,
                                        542,
                                        527
                                    ],
                                    "score": 1.0,
                                    "content": "(where dO denotes",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                72,
                                522,
                                539,
                                547
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        528,
                                        83,
                                        541
                                    ],
                                    "score": 0.77,
                                    "content": "\\frac{\\partial\\phi}{\\partial\\mathbf{0}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        84,
                                        522,
                                        286,
                                        547
                                    ],
                                    "score": 1.0,
                                    "content": "). We want to compute the input gradients ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        287,
                                        529,
                                        370,
                                        540
                                    ],
                                    "score": 0.63,
                                    "content": "\\mathbf{dQ},\\mathbf{dK},\\mathbf{dV}\\in\\mathbb{R}^{n\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 83
                                },
                                {
                                    "bbox": [
                                        370,
                                        522,
                                        493,
                                        547
                                    ],
                                    "score": 1.0,
                                    "content": "(where dQ, dK, dV denote ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        494,
                                        528,
                                        539,
                                        543
                                    ],
                                    "score": 0.92,
                                    "content": "\\frac{\\partial\\phi}{\\partial\\mathbf{Q}},\\frac{\\partial\\phi}{\\partial\\mathbf{K}},\\frac{\\partial\\phi}{\\partial\\mathbf{V}}",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 45
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                543,
                                130,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        543,
                                        130,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "respectively).",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 30,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        514,
                        542,
                        554
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        554,
                        537,
                        577
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                554,
                                538,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        554,
                                        145,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "The gradient ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        556,
                                        159,
                                        563
                                    ],
                                    "score": 0.5,
                                    "content": "\\mathbf{dV}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        159,
                                        554,
                                        538,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": " is easy to see. Applying reverse-mode autodiff by hand (aka the chain rule), we obtain",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                566,
                                245,
                                577
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        566,
                                        161,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": "(in matrix notation) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        162,
                                        567,
                                        212,
                                        576
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{dV}=\\mathbf{P}^{T}\\mathbf{dO}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        213,
                                        566,
                                        245,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": ". Thus:",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 32.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        554,
                        538,
                        577
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        237,
                        585,
                        375,
                        616
                    ],
                    "lines": [
                        {
                            "bbox": [
                                237,
                                585,
                                375,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        237,
                                        585,
                                        375,
                                        616
                                    ],
                                    "score": 0.94,
                                    "content": "d\\nu_{j}=\\sum_{i}P_{i j}d o_{i}=\\sum_{i}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}d o_{i}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 34.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                237,
                                585,
                                375,
                                600.5
                            ],
                            "spans": [],
                            "index": 34
                        },
                        {
                            "bbox": [
                                237,
                                600.5,
                                375,
                                616.0
                            ],
                            "spans": [],
                            "index": 35
                        }
                    ],
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        623,
                        510,
                        635
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                623,
                                502,
                                636
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        623,
                                        192,
                                        636
                                    ],
                                    "score": 1.0,
                                    "content": "Since we already computed",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        193,
                                        626,
                                        203,
                                        634
                                    ],
                                    "score": 0.89,
                                    "content": "L_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        203,
                                        623,
                                        208,
                                        636
                                    ],
                                    "score": 1.0,
                                    "content": ", ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        209,
                                        625,
                                        224,
                                        635
                                    ],
                                    "score": 0.92,
                                    "content": "d\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        224,
                                        623,
                                        502,
                                        636
                                    ],
                                    "score": 1.0,
                                    "content": "can be computed without extra memory by repeated summing.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        623,
                        502,
                        636
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        635,
                        542,
                        658
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                635,
                                542,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        635,
                                        187,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": "The gradients dQ and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        637,
                                        201,
                                        644
                                    ],
                                    "score": 0.67,
                                    "content": "\\mathbf{dK}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        201,
                                        635,
                                        470,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": " are a little more complicated. We go through the gradients ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        470,
                                        637,
                                        483,
                                        645
                                    ],
                                    "score": 0.8,
                                    "content": "\\mathbf{dP}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        484,
                                        635,
                                        542,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": " and dS first.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                646,
                                284,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        646,
                                        193,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "From Eq. (2), we have that ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        194,
                                        648,
                                        244,
                                        657
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{dP}=\\mathbf{dOV}^{T}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        244,
                                        646,
                                        284,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": ", and so:",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 37.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        635,
                        542,
                        658
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        276,
                        667,
                        336,
                        680
                    ],
                    "lines": [
                        {
                            "bbox": [
                                276,
                                667,
                                336,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        276,
                                        667,
                                        336,
                                        680
                                    ],
                                    "score": 0.91,
                                    "content": "d P_{i j}=d o_{i}^{T}\\nu_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 39,
                    "virtual_lines": [
                        {
                            "bbox": [
                                276,
                                667,
                                336,
                                680
                            ],
                            "spans": [],
                            "index": 39
                        }
                    ],
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        686,
                        541,
                        711
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                686,
                                541,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        686,
                                        138,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": "Recall that",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        690,
                                        217,
                                        699
                                    ],
                                    "score": 0.73,
                                    "content": "P_{i:}=\\mathrm{softmax}(S_{i:})",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 78
                                },
                                {
                                    "bbox": [
                                        217,
                                        686,
                                        384,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": ". Using the fact that the Jacobian of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        384,
                                        689,
                                        448,
                                        699
                                    ],
                                    "score": 0.47,
                                    "content": "y=\\operatorname{softmax}(x)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 64
                                },
                                {
                                    "bbox": [
                                        449,
                                        686,
                                        462,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": " is ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        688,
                                        521,
                                        699
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathrm{diag}(y)-y y^{T}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 59
                                },
                                {
                                    "bbox": [
                                        522,
                                        686,
                                        541,
                                        701
                                    ],
                                    "score": 1.0,
                                    "content": ", we",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                69,
                                700,
                                115,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        700,
                                        115,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "have that",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 40.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        686,
                        541,
                        711
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        186,
                        711,
                        425,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                186,
                                711,
                                425,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        186,
                                        711,
                                        425,
                                        724
                                    ],
                                    "score": 0.87,
                                    "content": "d S_{i:}=(\\mathrm{diag}(P_{i:})-P_{i:}P_{i:}^{T})d P_{i:}=P_{i:}\\circ d P_{i:}-(P_{i:}^{T}d P_{i:})P_{i:},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                186,
                                711,
                                425,
                                724
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ],
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        73,
                        252,
                        85
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                251,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        100,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "where",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        78,
                                        105,
                                        83
                                    ],
                                    "score": 0.8,
                                    "content": "\\circ",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        105,
                                        74,
                                        251,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "denotes pointwise multiplication.",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        86,
                        115,
                        96
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                85,
                                115,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        85,
                                        115,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Define",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        181,
                        94,
                        430,
                        126
                    ],
                    "lines": [
                        {
                            "bbox": [
                                181,
                                94,
                                430,
                                126
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        181,
                                        94,
                                        430,
                                        126
                                    ],
                                    "score": 0.94,
                                    "content": "D_{i}=P_{i:}^{T}d P_{i:}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}d o_{i}^{T}\\nu_{j}=d o_{i}^{T}\\sum_{j}\\frac{e^{q_{i}^{\\top}k_{j}}}{L_{i}}\\nu_{j}=d o_{i}^{T}o_{i},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "virtual_lines": [
                        {
                            "bbox": [
                                181,
                                94,
                                430,
                                104.66666666666667
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                181,
                                104.66666666666667,
                                430,
                                115.33333333333334
                            ],
                            "spans": [],
                            "index": 3
                        },
                        {
                            "bbox": [
                                181,
                                115.33333333333334,
                                430,
                                126.00000000000001
                            ],
                            "spans": [],
                            "index": 4
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        131,
                        92,
                        142
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                130,
                                93,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        130,
                                        93,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "then",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        254,
                        144,
                        357,
                        154
                    ],
                    "lines": [
                        {
                            "bbox": [
                                254,
                                144,
                                357,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        254,
                                        144,
                                        357,
                                        154
                                    ],
                                    "score": 0.86,
                                    "content": "d S_{i:}=P_{i:}\\circ d P_{i:}-D_{i}P_{i:}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "virtual_lines": [
                        {
                            "bbox": [
                                254,
                                144,
                                357,
                                154
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        160,
                        99,
                        172
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                160,
                                100,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        160,
                                        100,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "Hence",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        219,
                        173,
                        392,
                        185
                    ],
                    "lines": [
                        {
                            "bbox": [
                                219,
                                173,
                                392,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        219,
                                        173,
                                        392,
                                        185
                                    ],
                                    "score": 0.88,
                                    "content": "d S_{i j}=P_{i j}d P_{i j}-D_{i}P_{i j}=P_{i j}(d P_{i j}-D_{i}).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 8,
                    "virtual_lines": [
                        {
                            "bbox": [
                                219,
                                173,
                                392,
                                185
                            ],
                            "spans": [],
                            "index": 8
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        85,
                        189,
                        389,
                        203
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                190,
                                387,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        190,
                                        254,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "Now we can get the gradients dQ and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        254,
                                        193,
                                        268,
                                        200
                                    ],
                                    "score": 0.29,
                                    "content": "\\mathbf{dK}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        268,
                                        190,
                                        326,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": ". Recall that ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        326,
                                        191,
                                        372,
                                        203
                                    ],
                                    "score": 0.94,
                                    "content": "S_{i j}=q_{i}^{T}k_{j}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 46
                                },
                                {
                                    "bbox": [
                                        372,
                                        190,
                                        387,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": ", so",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 9
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        162,
                        212,
                        450,
                        244
                    ],
                    "lines": [
                        {
                            "bbox": [
                                162,
                                212,
                                450,
                                244
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        162,
                                        212,
                                        450,
                                        244
                                    ],
                                    "score": 0.93,
                                    "content": "d q_{i}=\\sum_{j}d S_{i j}k_{j}=\\sum_{j}P_{i j}(d P_{i j}-D_{i})k_{j}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}(d o_{i}^{T}\\nu_{j}-D_{i})k_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 11,
                    "virtual_lines": [
                        {
                            "bbox": [
                                162,
                                212,
                                450,
                                222.66666666666666
                            ],
                            "spans": [],
                            "index": 10
                        },
                        {
                            "bbox": [
                                162,
                                222.66666666666666,
                                450,
                                233.33333333333331
                            ],
                            "spans": [],
                            "index": 11
                        },
                        {
                            "bbox": [
                                162,
                                233.33333333333331,
                                450,
                                243.99999999999997
                            ],
                            "spans": [],
                            "index": 12
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        253,
                        113,
                        265
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                252,
                                113,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        252,
                                        113,
                                        266
                                    ],
                                    "score": 1.0,
                                    "content": "Similarly,",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        163,
                        263,
                        449,
                        294
                    ],
                    "lines": [
                        {
                            "bbox": [
                                163,
                                263,
                                449,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        163,
                                        263,
                                        449,
                                        294
                                    ],
                                    "score": 0.93,
                                    "content": "d k_{j}=\\sum_{i}d S_{i j}q_{i}=\\sum_{i}P_{i j}(d P_{i j}-D_{i})q_{i}=\\sum_{i}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}(d o_{i}^{T}\\nu_{j}-D_{i})q_{i}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 15,
                    "virtual_lines": [
                        {
                            "bbox": [
                                163,
                                263,
                                449,
                                273.3333333333333
                            ],
                            "spans": [],
                            "index": 14
                        },
                        {
                            "bbox": [
                                163,
                                273.3333333333333,
                                449,
                                283.66666666666663
                            ],
                            "spans": [],
                            "index": 15
                        },
                        {
                            "bbox": [
                                163,
                                283.66666666666663,
                                449,
                                293.99999999999994
                            ],
                            "spans": [],
                            "index": 16
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        298,
                        425,
                        311
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                299,
                                424,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        299,
                                        335,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "Therefore the backward pass can also be computed with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        335,
                                        301,
                                        356,
                                        311
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        356,
                                        299,
                                        424,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory:",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        82,
                        317,
                        432,
                        392
                    ],
                    "lines": [
                        {
                            "bbox": [
                                83,
                                319,
                                432,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        319,
                                        139,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "1. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        140,
                                        321,
                                        154,
                                        331
                                    ],
                                    "score": 0.92,
                                    "content": "d\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        155,
                                        319,
                                        186,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "for all",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        186,
                                        322,
                                        192,
                                        331
                                    ],
                                    "score": 0.89,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        192,
                                        319,
                                        343,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (3), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        343,
                                        321,
                                        365,
                                        331
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        365,
                                        319,
                                        432,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                83,
                                339,
                                425,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        339,
                                        139,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "2. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        342,
                                        151,
                                        350
                                    ],
                                    "score": 0.91,
                                    "content": "D_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        151,
                                        339,
                                        182,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        183,
                                        342,
                                        186,
                                        348
                                    ],
                                    "score": 0.85,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        186,
                                        339,
                                        337,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (4), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        337,
                                        341,
                                        358,
                                        351
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        358,
                                        339,
                                        425,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                83,
                                358,
                                429,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        358,
                                        139,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "3. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        140,
                                        361,
                                        154,
                                        370
                                    ],
                                    "score": 0.92,
                                    "content": "d{\\boldsymbol{q}}_{i}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        154,
                                        358,
                                        185,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        186,
                                        361,
                                        189,
                                        368
                                    ],
                                    "score": 0.85,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        189,
                                        358,
                                        340,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (5), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        340,
                                        361,
                                        361,
                                        370
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        362,
                                        358,
                                        429,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                83,
                                379,
                                432,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        379,
                                        139,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "4. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        381,
                                        155,
                                        391
                                    ],
                                    "score": 0.92,
                                    "content": "d k_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        155,
                                        379,
                                        186,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "for all",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        381,
                                        192,
                                        390
                                    ],
                                    "score": 0.9,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        192,
                                        379,
                                        343,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (6), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        343,
                                        381,
                                        365,
                                        390
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        365,
                                        379,
                                        432,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 19.5
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        404,
                        301,
                        418
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                405,
                                300,
                                417
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        405,
                                        93,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "B.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        406,
                                        300,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Forward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 22
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        424,
                        543,
                        448
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                421,
                                543,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        421,
                                        455,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": "We describe the full details of FlashAttention forward pass. Given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        455,
                                        425,
                                        522,
                                        436
                                    ],
                                    "score": 0.87,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        522,
                                        421,
                                        543,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": ", we",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                436,
                                288,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        436,
                                        288,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "want to compute the attention output O ∈ R𝑁 ×𝑑:",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 23.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        124,
                        456,
                        485,
                        489
                    ],
                    "lines": [
                        {
                            "bbox": [
                                124,
                                456,
                                485,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        456,
                                        485,
                                        489
                                    ],
                                    "score": 0.89,
                                    "content": "\\begin{array}{r l}&{\\mathbf{S}=\\tau\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{S}^{\\mathrm{masked}}=\\mathrm{MASK}(S)\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S}^{\\mathrm{masked}})\\in\\mathbb{R}^{N\\times N},}\\\\ &{\\mathbf{P}^{\\mathrm{dropped}}=\\mathrm{dropout}(\\mathbf{P},p_{\\mathrm{drop}}),\\quad\\mathbf{0}=\\mathbf{P}^{\\mathrm{dropped}}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 26,
                    "virtual_lines": [
                        {
                            "bbox": [
                                124,
                                456,
                                485,
                                467.0
                            ],
                            "spans": [],
                            "index": 25
                        },
                        {
                            "bbox": [
                                124,
                                467.0,
                                485,
                                478.0
                            ],
                            "spans": [],
                            "index": 26
                        },
                        {
                            "bbox": [
                                124,
                                478.0,
                                485,
                                489.0
                            ],
                            "spans": [],
                            "index": 27
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        497,
                        543,
                        550
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                497,
                                543,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        497,
                                        99,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        501,
                                        123,
                                        508
                                    ],
                                    "score": 0.93,
                                    "content": "\\tau\\in\\mathbb{R}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        123,
                                        497,
                                        273,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": " is some softmax scaling (typically",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        274,
                                        499,
                                        286,
                                        514
                                    ],
                                    "score": 0.88,
                                    "content": "\\scriptstyle{\\frac{1}{\\sqrt{d}}}",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        286,
                                        497,
                                        543,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": "), mask is some masking function that sets some entries of",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                69,
                                512,
                                542,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        512,
                                        126,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "the input to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        126,
                                        516,
                                        142,
                                        523
                                    ],
                                    "score": 0.87,
                                    "content": "-\\infty",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        142,
                                        512,
                                        542,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "and keep other entries the same (e.g., key padding mask when sequences in the batch don’t",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                68,
                                522,
                                541,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        522,
                                        541,
                                        540
                                    ],
                                    "score": 1.0,
                                    "content": "have the same lengths and are padded), and dropout(𝑥, 𝑝) applies dropout to 𝑥 elementwise (i.e., output 1 𝑥𝑝",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                539,
                                400,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        539,
                                        144,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "with probability ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        541,
                                        166,
                                        550
                                    ],
                                    "score": 0.92,
                                    "content": "1-p",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        167,
                                        539,
                                        303,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "and output 0 with probability",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        303,
                                        543,
                                        309,
                                        550
                                    ],
                                    "score": 0.87,
                                    "content": "p",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        310,
                                        539,
                                        387,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "for each element ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        387,
                                        543,
                                        393,
                                        548
                                    ],
                                    "score": 0.83,
                                    "content": "x",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        393,
                                        539,
                                        400,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": ").",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        550,
                        540,
                        574
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                550,
                                541,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        550,
                                        349,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": "The full algorithm is in Algorithm 2. We save the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        349,
                                        552,
                                        357,
                                        560
                                    ],
                                    "score": 0.71,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        357,
                                        550,
                                        462,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": ", the softmax statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        552,
                                        467,
                                        560
                                    ],
                                    "score": 0.89,
                                    "content": "\\ell",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        468,
                                        550,
                                        490,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        491,
                                        555,
                                        498,
                                        560
                                    ],
                                    "score": 0.88,
                                    "content": "m",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        499,
                                        550,
                                        541,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": ", and the",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                563,
                                356,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        563,
                                        245,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "pseudo-random number generator state",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        246,
                                        564,
                                        254,
                                        572
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        254,
                                        563,
                                        356,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": " for the backward pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 32.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 18,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        181,
                        94,
                        430,
                        126
                    ],
                    "lines": [
                        {
                            "bbox": [
                                181,
                                94,
                                430,
                                126
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        181,
                                        94,
                                        430,
                                        126
                                    ],
                                    "score": 0.94,
                                    "content": "D_{i}=P_{i:}^{T}d P_{i:}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}d o_{i}^{T}\\nu_{j}=d o_{i}^{T}\\sum_{j}\\frac{e^{q_{i}^{\\top}k_{j}}}{L_{i}}\\nu_{j}=d o_{i}^{T}o_{i},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "virtual_lines": [
                        {
                            "bbox": [
                                181,
                                94,
                                430,
                                104.66666666666667
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                181,
                                104.66666666666667,
                                430,
                                115.33333333333334
                            ],
                            "spans": [],
                            "index": 3
                        },
                        {
                            "bbox": [
                                181,
                                115.33333333333334,
                                430,
                                126.00000000000001
                            ],
                            "spans": [],
                            "index": 4
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        254,
                        144,
                        357,
                        154
                    ],
                    "lines": [
                        {
                            "bbox": [
                                254,
                                144,
                                357,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        254,
                                        144,
                                        357,
                                        154
                                    ],
                                    "score": 0.86,
                                    "content": "d S_{i:}=P_{i:}\\circ d P_{i:}-D_{i}P_{i:}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "virtual_lines": [
                        {
                            "bbox": [
                                254,
                                144,
                                357,
                                154
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        219,
                        173,
                        392,
                        185
                    ],
                    "lines": [
                        {
                            "bbox": [
                                219,
                                173,
                                392,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        219,
                                        173,
                                        392,
                                        185
                                    ],
                                    "score": 0.88,
                                    "content": "d S_{i j}=P_{i j}d P_{i j}-D_{i}P_{i j}=P_{i j}(d P_{i j}-D_{i}).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 8,
                    "virtual_lines": [
                        {
                            "bbox": [
                                219,
                                173,
                                392,
                                185
                            ],
                            "spans": [],
                            "index": 8
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        162,
                        212,
                        450,
                        244
                    ],
                    "lines": [
                        {
                            "bbox": [
                                162,
                                212,
                                450,
                                244
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        162,
                                        212,
                                        450,
                                        244
                                    ],
                                    "score": 0.93,
                                    "content": "d q_{i}=\\sum_{j}d S_{i j}k_{j}=\\sum_{j}P_{i j}(d P_{i j}-D_{i})k_{j}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}(d o_{i}^{T}\\nu_{j}-D_{i})k_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 11,
                    "virtual_lines": [
                        {
                            "bbox": [
                                162,
                                212,
                                450,
                                222.66666666666666
                            ],
                            "spans": [],
                            "index": 10
                        },
                        {
                            "bbox": [
                                162,
                                222.66666666666666,
                                450,
                                233.33333333333331
                            ],
                            "spans": [],
                            "index": 11
                        },
                        {
                            "bbox": [
                                162,
                                233.33333333333331,
                                450,
                                243.99999999999997
                            ],
                            "spans": [],
                            "index": 12
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        163,
                        263,
                        449,
                        294
                    ],
                    "lines": [
                        {
                            "bbox": [
                                163,
                                263,
                                449,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        163,
                                        263,
                                        449,
                                        294
                                    ],
                                    "score": 0.93,
                                    "content": "d k_{j}=\\sum_{i}d S_{i j}q_{i}=\\sum_{i}P_{i j}(d P_{i j}-D_{i})q_{i}=\\sum_{i}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}(d o_{i}^{T}\\nu_{j}-D_{i})q_{i}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 15,
                    "virtual_lines": [
                        {
                            "bbox": [
                                163,
                                263,
                                449,
                                273.3333333333333
                            ],
                            "spans": [],
                            "index": 14
                        },
                        {
                            "bbox": [
                                163,
                                273.3333333333333,
                                449,
                                283.66666666666663
                            ],
                            "spans": [],
                            "index": 15
                        },
                        {
                            "bbox": [
                                163,
                                283.66666666666663,
                                449,
                                293.99999999999994
                            ],
                            "spans": [],
                            "index": 16
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        124,
                        456,
                        485,
                        489
                    ],
                    "lines": [
                        {
                            "bbox": [
                                124,
                                456,
                                485,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        456,
                                        485,
                                        489
                                    ],
                                    "score": 0.89,
                                    "content": "\\begin{array}{r l}&{\\mathbf{S}=\\tau\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{S}^{\\mathrm{masked}}=\\mathrm{MASK}(S)\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S}^{\\mathrm{masked}})\\in\\mathbb{R}^{N\\times N},}\\\\ &{\\mathbf{P}^{\\mathrm{dropped}}=\\mathrm{dropout}(\\mathbf{P},p_{\\mathrm{drop}}),\\quad\\mathbf{0}=\\mathbf{P}^{\\mathrm{dropped}}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 26,
                    "virtual_lines": [
                        {
                            "bbox": [
                                124,
                                456,
                                485,
                                467.0
                            ],
                            "spans": [],
                            "index": 25
                        },
                        {
                            "bbox": [
                                124,
                                467.0,
                                485,
                                478.0
                            ],
                            "spans": [],
                            "index": 26
                        },
                        {
                            "bbox": [
                                124,
                                478.0,
                                485,
                                489.0
                            ],
                            "spans": [],
                            "index": 27
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "19",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        73,
                        252,
                        85
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                251,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        100,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "where",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        78,
                                        105,
                                        83
                                    ],
                                    "score": 0.8,
                                    "content": "\\circ",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        105,
                                        74,
                                        251,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "denotes pointwise multiplication.",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        74,
                        251,
                        84
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        86,
                        115,
                        96
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                85,
                                115,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        85,
                                        115,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Define",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 1,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        85,
                        85,
                        115,
                        97
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        181,
                        94,
                        430,
                        126
                    ],
                    "lines": [
                        {
                            "bbox": [
                                181,
                                94,
                                430,
                                126
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        181,
                                        94,
                                        430,
                                        126
                                    ],
                                    "score": 0.94,
                                    "content": "D_{i}=P_{i:}^{T}d P_{i:}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}d o_{i}^{T}\\nu_{j}=d o_{i}^{T}\\sum_{j}\\frac{e^{q_{i}^{\\top}k_{j}}}{L_{i}}\\nu_{j}=d o_{i}^{T}o_{i},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "virtual_lines": [
                        {
                            "bbox": [
                                181,
                                94,
                                430,
                                104.66666666666667
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                181,
                                104.66666666666667,
                                430,
                                115.33333333333334
                            ],
                            "spans": [],
                            "index": 3
                        },
                        {
                            "bbox": [
                                181,
                                115.33333333333334,
                                430,
                                126.00000000000001
                            ],
                            "spans": [],
                            "index": 4
                        }
                    ],
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        131,
                        92,
                        142
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                130,
                                93,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        130,
                                        93,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "then",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        130,
                        93,
                        143
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        254,
                        144,
                        357,
                        154
                    ],
                    "lines": [
                        {
                            "bbox": [
                                254,
                                144,
                                357,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        254,
                                        144,
                                        357,
                                        154
                                    ],
                                    "score": 0.86,
                                    "content": "d S_{i:}=P_{i:}\\circ d P_{i:}-D_{i}P_{i:}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "virtual_lines": [
                        {
                            "bbox": [
                                254,
                                144,
                                357,
                                154
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ],
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        160,
                        99,
                        172
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                160,
                                100,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        160,
                                        100,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "Hence",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        160,
                        100,
                        172
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        219,
                        173,
                        392,
                        185
                    ],
                    "lines": [
                        {
                            "bbox": [
                                219,
                                173,
                                392,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        219,
                                        173,
                                        392,
                                        185
                                    ],
                                    "score": 0.88,
                                    "content": "d S_{i j}=P_{i j}d P_{i j}-D_{i}P_{i j}=P_{i j}(d P_{i j}-D_{i}).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 8,
                    "virtual_lines": [
                        {
                            "bbox": [
                                219,
                                173,
                                392,
                                185
                            ],
                            "spans": [],
                            "index": 8
                        }
                    ],
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        85,
                        189,
                        389,
                        203
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                190,
                                387,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        190,
                                        254,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "Now we can get the gradients dQ and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        254,
                                        193,
                                        268,
                                        200
                                    ],
                                    "score": 0.29,
                                    "content": "\\mathbf{dK}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        268,
                                        190,
                                        326,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": ". Recall that ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        326,
                                        191,
                                        372,
                                        203
                                    ],
                                    "score": 0.94,
                                    "content": "S_{i j}=q_{i}^{T}k_{j}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 46
                                },
                                {
                                    "bbox": [
                                        372,
                                        190,
                                        387,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": ", so",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 9,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        85,
                        190,
                        387,
                        204
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        162,
                        212,
                        450,
                        244
                    ],
                    "lines": [
                        {
                            "bbox": [
                                162,
                                212,
                                450,
                                244
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        162,
                                        212,
                                        450,
                                        244
                                    ],
                                    "score": 0.93,
                                    "content": "d q_{i}=\\sum_{j}d S_{i j}k_{j}=\\sum_{j}P_{i j}(d P_{i j}-D_{i})k_{j}=\\sum_{j}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}(d o_{i}^{T}\\nu_{j}-D_{i})k_{j}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 11,
                    "virtual_lines": [
                        {
                            "bbox": [
                                162,
                                212,
                                450,
                                222.66666666666666
                            ],
                            "spans": [],
                            "index": 10
                        },
                        {
                            "bbox": [
                                162,
                                222.66666666666666,
                                450,
                                233.33333333333331
                            ],
                            "spans": [],
                            "index": 11
                        },
                        {
                            "bbox": [
                                162,
                                233.33333333333331,
                                450,
                                243.99999999999997
                            ],
                            "spans": [],
                            "index": 12
                        }
                    ],
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        253,
                        113,
                        265
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                252,
                                113,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        252,
                                        113,
                                        266
                                    ],
                                    "score": 1.0,
                                    "content": "Similarly,",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 13,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        252,
                        113,
                        266
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        163,
                        263,
                        449,
                        294
                    ],
                    "lines": [
                        {
                            "bbox": [
                                163,
                                263,
                                449,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        163,
                                        263,
                                        449,
                                        294
                                    ],
                                    "score": 0.93,
                                    "content": "d k_{j}=\\sum_{i}d S_{i j}q_{i}=\\sum_{i}P_{i j}(d P_{i j}-D_{i})q_{i}=\\sum_{i}\\frac{e^{q_{i}^{T}k_{j}}}{L_{i}}(d o_{i}^{T}\\nu_{j}-D_{i})q_{i}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 15,
                    "virtual_lines": [
                        {
                            "bbox": [
                                163,
                                263,
                                449,
                                273.3333333333333
                            ],
                            "spans": [],
                            "index": 14
                        },
                        {
                            "bbox": [
                                163,
                                273.3333333333333,
                                449,
                                283.66666666666663
                            ],
                            "spans": [],
                            "index": 15
                        },
                        {
                            "bbox": [
                                163,
                                283.66666666666663,
                                449,
                                293.99999999999994
                            ],
                            "spans": [],
                            "index": 16
                        }
                    ],
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        298,
                        425,
                        311
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                299,
                                424,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        299,
                                        335,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "Therefore the backward pass can also be computed with ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        335,
                                        301,
                                        356,
                                        311
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        356,
                                        299,
                                        424,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory:",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        299,
                        424,
                        311
                    ]
                },
                {
                    "type": "index",
                    "bbox": [
                        82,
                        317,
                        432,
                        392
                    ],
                    "lines": [
                        {
                            "bbox": [
                                83,
                                319,
                                432,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        319,
                                        139,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "1. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        140,
                                        321,
                                        154,
                                        331
                                    ],
                                    "score": 0.92,
                                    "content": "d\\nu_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        155,
                                        319,
                                        186,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "for all",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        186,
                                        322,
                                        192,
                                        331
                                    ],
                                    "score": 0.89,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        192,
                                        319,
                                        343,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (3), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        343,
                                        321,
                                        365,
                                        331
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        365,
                                        319,
                                        432,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                83,
                                339,
                                425,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        339,
                                        139,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "2. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        342,
                                        151,
                                        350
                                    ],
                                    "score": 0.91,
                                    "content": "D_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        151,
                                        339,
                                        182,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        183,
                                        342,
                                        186,
                                        348
                                    ],
                                    "score": 0.85,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        186,
                                        339,
                                        337,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (4), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        337,
                                        341,
                                        358,
                                        351
                                    ],
                                    "score": 0.93,
                                    "content": "O(n)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        358,
                                        339,
                                        425,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                83,
                                358,
                                429,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        358,
                                        139,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "3. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        140,
                                        361,
                                        154,
                                        370
                                    ],
                                    "score": 0.92,
                                    "content": "d{\\boldsymbol{q}}_{i}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        154,
                                        358,
                                        185,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        186,
                                        361,
                                        189,
                                        368
                                    ],
                                    "score": 0.85,
                                    "content": "i",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        189,
                                        358,
                                        340,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (5), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        340,
                                        361,
                                        361,
                                        370
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        362,
                                        358,
                                        429,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                83,
                                379,
                                432,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        379,
                                        139,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "4. Compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        139,
                                        381,
                                        155,
                                        391
                                    ],
                                    "score": 0.92,
                                    "content": "d k_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        155,
                                        379,
                                        186,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "for all",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        381,
                                        192,
                                        390
                                    ],
                                    "score": 0.9,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        192,
                                        379,
                                        343,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "according to Eq. (6), which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        343,
                                        381,
                                        365,
                                        390
                                    ],
                                    "score": 0.93,
                                    "content": "O(d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        365,
                                        379,
                                        432,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true
                        }
                    ],
                    "index": 19.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        83,
                        319,
                        432,
                        391
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        404,
                        301,
                        418
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                405,
                                300,
                                417
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        405,
                                        93,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "B.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        406,
                                        300,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Forward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 22,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        424,
                        543,
                        448
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                421,
                                543,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        421,
                                        455,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": "We describe the full details of FlashAttention forward pass. Given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        455,
                                        425,
                                        522,
                                        436
                                    ],
                                    "score": 0.87,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        522,
                                        421,
                                        543,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": ", we",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                436,
                                288,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        436,
                                        288,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "want to compute the attention output O ∈ R𝑁 ×𝑑:",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 23.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        421,
                        543,
                        450
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        124,
                        456,
                        485,
                        489
                    ],
                    "lines": [
                        {
                            "bbox": [
                                124,
                                456,
                                485,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        456,
                                        485,
                                        489
                                    ],
                                    "score": 0.89,
                                    "content": "\\begin{array}{r l}&{\\mathbf{S}=\\tau\\mathbf{Q}\\mathbf{K}^{\\top}\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{S}^{\\mathrm{masked}}=\\mathrm{MASK}(S)\\in\\mathbb{R}^{N\\times N},\\quad\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S}^{\\mathrm{masked}})\\in\\mathbb{R}^{N\\times N},}\\\\ &{\\mathbf{P}^{\\mathrm{dropped}}=\\mathrm{dropout}(\\mathbf{P},p_{\\mathrm{drop}}),\\quad\\mathbf{0}=\\mathbf{P}^{\\mathrm{dropped}}\\mathbf{V}\\in\\mathbb{R}^{N\\times d},}\\end{array}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 26,
                    "virtual_lines": [
                        {
                            "bbox": [
                                124,
                                456,
                                485,
                                467.0
                            ],
                            "spans": [],
                            "index": 25
                        },
                        {
                            "bbox": [
                                124,
                                467.0,
                                485,
                                478.0
                            ],
                            "spans": [],
                            "index": 26
                        },
                        {
                            "bbox": [
                                124,
                                478.0,
                                485,
                                489.0
                            ],
                            "spans": [],
                            "index": 27
                        }
                    ],
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        497,
                        543,
                        550
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                497,
                                543,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        497,
                                        99,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        501,
                                        123,
                                        508
                                    ],
                                    "score": 0.93,
                                    "content": "\\tau\\in\\mathbb{R}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        123,
                                        497,
                                        273,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": " is some softmax scaling (typically",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        274,
                                        499,
                                        286,
                                        514
                                    ],
                                    "score": 0.88,
                                    "content": "\\scriptstyle{\\frac{1}{\\sqrt{d}}}",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        286,
                                        497,
                                        543,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": "), mask is some masking function that sets some entries of",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                69,
                                512,
                                542,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        512,
                                        126,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "the input to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        126,
                                        516,
                                        142,
                                        523
                                    ],
                                    "score": 0.87,
                                    "content": "-\\infty",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        142,
                                        512,
                                        542,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "and keep other entries the same (e.g., key padding mask when sequences in the batch don’t",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                68,
                                522,
                                541,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        522,
                                        541,
                                        540
                                    ],
                                    "score": 1.0,
                                    "content": "have the same lengths and are padded), and dropout(𝑥, 𝑝) applies dropout to 𝑥 elementwise (i.e., output 1 𝑥𝑝",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                539,
                                400,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        539,
                                        144,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "with probability ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        541,
                                        166,
                                        550
                                    ],
                                    "score": 0.92,
                                    "content": "1-p",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        167,
                                        539,
                                        303,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "and output 0 with probability",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        303,
                                        543,
                                        309,
                                        550
                                    ],
                                    "score": 0.87,
                                    "content": "p",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        310,
                                        539,
                                        387,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "for each element ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        387,
                                        543,
                                        393,
                                        548
                                    ],
                                    "score": 0.83,
                                    "content": "x",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        393,
                                        539,
                                        400,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": ").",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        497,
                        543,
                        551
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        550,
                        540,
                        574
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                550,
                                541,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        550,
                                        349,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": "The full algorithm is in Algorithm 2. We save the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        349,
                                        552,
                                        357,
                                        560
                                    ],
                                    "score": 0.71,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        357,
                                        550,
                                        462,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": ", the softmax statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        552,
                                        467,
                                        560
                                    ],
                                    "score": 0.89,
                                    "content": "\\ell",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        468,
                                        550,
                                        490,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        491,
                                        555,
                                        498,
                                        560
                                    ],
                                    "score": 0.88,
                                    "content": "m",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        499,
                                        550,
                                        541,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": ", and the",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                563,
                                356,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        563,
                                        245,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "pseudo-random number generator state",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        246,
                                        564,
                                        254,
                                        572
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        254,
                                        563,
                                        356,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": " for the backward pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 32.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        550,
                        541,
                        574
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        89,
                        543,
                        402
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                88,
                                543,
                                103
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        88,
                                        161,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        91,
                                        231,
                                        101
                                    ],
                                    "score": 0.91,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 70
                                },
                                {
                                    "bbox": [
                                        231,
                                        88,
                                        380,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, on-chip SRAM of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        380,
                                        93,
                                        390,
                                        100
                                    ],
                                    "score": 0.76,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        391,
                                        88,
                                        511,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ", softmax scaling constant ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        512,
                                        91,
                                        538,
                                        101
                                    ],
                                    "score": 0.83,
                                    "content": "\\tau\\in\\mathbb{R}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        539,
                                        88,
                                        543,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                86,
                                101,
                                313,
                                116
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        101,
                                        285,
                                        116
                                    ],
                                    "score": 1.0,
                                    "content": "masking function mask, dropout probability",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        285,
                                        107,
                                        308,
                                        114
                                    ],
                                    "score": 0.86,
                                    "content": "p_{\\mathrm{drop}}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        309,
                                        101,
                                        313,
                                        116
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                77,
                                114,
                                412,
                                126
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        114,
                                        321,
                                        126
                                    ],
                                    "score": 1.0,
                                    "content": "1: Initialize the pseudo-random number generator state ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        321,
                                        116,
                                        329,
                                        123
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        329,
                                        114,
                                        412,
                                        126
                                    ],
                                    "score": 1.0,
                                    "content": " and save to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                74,
                                124,
                                285,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        124,
                                        154,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "2: Set block sizes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        154,
                                        126,
                                        281,
                                        139
                                    ],
                                    "score": 0.91,
                                    "content": "\\begin{array}{r}{B_{c}=\\left\\lceil\\frac{M}{4d}\\right\\rceil,B_{r}=\\operatorname*{min}\\left(\\left\\lceil\\frac{M}{4d}\\right\\rceil,d\\right)}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 127
                                },
                                {
                                    "bbox": [
                                        281,
                                        124,
                                        285,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                73,
                                136,
                                402,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        136,
                                        129,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "3: Initialize ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        129,
                                        140,
                                        212,
                                        151
                                    ],
                                    "score": 0.81,
                                    "content": "{\\bf O}=(0)_{N\\times d}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 83
                                },
                                {
                                    "bbox": [
                                        212,
                                        136,
                                        216,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        216,
                                        140,
                                        358,
                                        151
                                    ],
                                    "score": 0.77,
                                    "content": "\\ell=(0)_{N}\\in\\mathbb{R}^{N},m=(-\\infty)_{N}\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 142
                                },
                                {
                                    "bbox": [
                                        358,
                                        136,
                                        402,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                146,
                                538,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        146,
                                        120,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "4: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        121,
                                        156,
                                        128,
                                        165
                                    ],
                                    "score": 0.65,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        129,
                                        146,
                                        152,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        152,
                                        151,
                                        194,
                                        169
                                    ],
                                    "score": 0.93,
                                    "content": "\\begin{array}{r}{T_{r}=\\left\\lceil\\frac{N}{B_{r}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 18,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        194,
                                        146,
                                        227,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        227,
                                        155,
                                        276,
                                        165
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{Q}_{1},\\ldots,\\mathbf{Q}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 49
                                },
                                {
                                    "bbox": [
                                        277,
                                        146,
                                        311,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        311,
                                        156,
                                        340,
                                        164
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        340,
                                        146,
                                        419,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "each, and divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        419,
                                        153,
                                        440,
                                        165
                                    ],
                                    "score": 0.79,
                                    "content": "\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        440,
                                        146,
                                        466,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": " in to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        466,
                                        150,
                                        509,
                                        170
                                    ],
                                    "score": 0.94,
                                    "content": "\\begin{array}{r}{T_{c}=\\bigg\\lceil\\frac{N}{B_{c}}\\bigg\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 20,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        511,
                                        154,
                                        538,
                                        164
                                    ],
                                    "score": 1.0,
                                    "content": "blocks",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                88,
                                168,
                                302,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        170,
                                        138,
                                        180
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{K}_{1},\\ldots,\\mathbf{K}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        138,
                                        168,
                                        160,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        169,
                                        211,
                                        180
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{V}_{1},\\ldots,\\mathbf{V}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        211,
                                        168,
                                        246,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": ", of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        247,
                                        170,
                                        275,
                                        179
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        275,
                                        168,
                                        302,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                75,
                                179,
                                542,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        179,
                                        119,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "5: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        120,
                                        182,
                                        127,
                                        190
                                    ],
                                    "score": 0.78,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        128,
                                        179,
                                        150,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        150,
                                        182,
                                        160,
                                        191
                                    ],
                                    "score": 0.89,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        160,
                                        179,
                                        193,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        193,
                                        181,
                                        241,
                                        192
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{0}_{i},\\ldots,\\mathbf{0}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        241,
                                        179,
                                        274,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        274,
                                        182,
                                        302,
                                        191
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        303,
                                        179,
                                        360,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "each, divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        360,
                                        182,
                                        365,
                                        189
                                    ],
                                    "score": 0.88,
                                    "content": "\\ell",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        365,
                                        179,
                                        387,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        388,
                                        182,
                                        397,
                                        191
                                    ],
                                    "score": 0.89,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        397,
                                        179,
                                        430,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        430,
                                        181,
                                        471,
                                        192
                                    ],
                                    "score": 0.9,
                                    "content": "\\ell_{i},\\ldots,\\ell_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        471,
                                        179,
                                        504,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        504,
                                        181,
                                        516,
                                        191
                                    ],
                                    "score": 0.87,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        516,
                                        179,
                                        542,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "each,",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                86,
                                191,
                                313,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        191,
                                        117,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        118,
                                        196,
                                        126,
                                        201
                                    ],
                                    "score": 0.87,
                                    "content": "m",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        126,
                                        191,
                                        149,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        194,
                                        158,
                                        203
                                    ],
                                    "score": 0.9,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        158,
                                        191,
                                        191,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        195,
                                        241,
                                        204
                                    ],
                                    "score": 0.81,
                                    "content": "m_{1},\\ldots,m_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        241,
                                        191,
                                        274,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        275,
                                        194,
                                        286,
                                        203
                                    ],
                                    "score": 0.89,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        286,
                                        191,
                                        313,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                74,
                                203,
                                168,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        203,
                                        105,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "6: for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        105,
                                        207,
                                        149,
                                        215
                                    ],
                                    "score": 0.93,
                                    "content": "1\\le j\\le T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 44
                                },
                                {
                                    "bbox": [
                                        150,
                                        203,
                                        168,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                75,
                                215,
                                286,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        216,
                                        86,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "7:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        215,
                                        123,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        123,
                                        218,
                                        151,
                                        228
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{K}_{j},\\mathbf{V}_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        152,
                                        215,
                                        286,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                75,
                                227,
                                174,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        229,
                                        86,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "8:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        97,
                                        227,
                                        115,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        230,
                                        157,
                                        239
                                    ],
                                    "score": 0.91,
                                    "content": "1\\leq i\\leq T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        158,
                                        227,
                                        174,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                75,
                                239,
                                320,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        240,
                                        86,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "9:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        106,
                                        239,
                                        133,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        133,
                                        242,
                                        185,
                                        251
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{Q}_{i},\\mathbf{O}_{i},\\ell_{i},m_{i}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        185,
                                        239,
                                        320,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                250,
                                288,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        252,
                                        86,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "10:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        106,
                                        250,
                                        189,
                                        265
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        252,
                                        285,
                                        266
                                    ],
                                    "score": 0.94,
                                    "content": "\\mathbf{S}_{i j}=\\tau\\mathbf{Q}_{i}\\mathbf{K}_{j}^{T}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 96
                                },
                                {
                                    "bbox": [
                                        285,
                                        250,
                                        288,
                                        265
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                261,
                                286,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        267,
                                        86,
                                        278
                                    ],
                                    "score": 1.0,
                                    "content": "11:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        261,
                                        189,
                                        286
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        266,
                                        277,
                                        280
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{S}_{i j}^{\\mathrm{masked}}=\\mathrm{MASK}(\\mathbf{S}_{i j})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        277,
                                        261,
                                        286,
                                        286
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                276,
                                545,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        281,
                                        86,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "12:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        276,
                                        191,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        279,
                                        536,
                                        295
                                    ],
                                    "score": 0.63,
                                    "content": "\\tilde{m}_{i j}=\\mathrm{rowmax}(\\mathbf{S}_{i j}^{\\mathrm{masked}})\\in\\mathbb{R}^{B_{r}},\\tilde{\\mathbf{P}}_{i j}=\\mathrm{exp}(\\mathbf{S}_{i j}^{\\mathrm{masked}}-\\tilde{m}_{i j})\\in\\mathbb{R}^{B_{r}\\times B_{c}}\\mathrm{(pointwise)},",
                                    "type": "inline_equation",
                                    "height": 16,
                                    "width": 345
                                },
                                {
                                    "bbox": [
                                        537,
                                        276,
                                        545,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                108,
                                295,
                                220,
                                308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        295,
                                        213,
                                        308
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\ell}_{i j}=\\mathrm{rowsum}(\\tilde{\\mathbf{P}}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 105
                                },
                                {
                                    "bbox": [
                                        214,
                                        295,
                                        220,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                306,
                                478,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        310,
                                        86,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "13:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        105,
                                        306,
                                        188,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        308,
                                        306,
                                        322
                                    ],
                                    "score": 0.87,
                                    "content": "m_{i}^{\\mathrm{new}}=\\operatorname*{max}(m_{i},\\tilde{m}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 117
                                },
                                {
                                    "bbox": [
                                        306,
                                        306,
                                        310,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        311,
                                        307,
                                        478,
                                        322
                                    ],
                                    "score": 0.65,
                                    "content": "\\ell_{i}^{\\mathrm{new}}=e^{m_{i}-m_{i}^{\\mathrm{new}}}\\ell_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\ell}_{i j}\\in\\mathbb{R}^{B_{r}}.",
                                    "type": "inline_equation"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                315,
                                329,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        324,
                                        86,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "14:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        315,
                                        188,
                                        344
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        322,
                                        319,
                                        337
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}^{\\mathrm{dropped}}=\\mathrm{dropout}(\\tilde{\\mathbf{P}}_{i j},p_{\\mathrm{drop}})",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 130
                                },
                                {
                                    "bbox": [
                                        319,
                                        315,
                                        329,
                                        344
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                333,
                                448,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        339,
                                        86,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "15:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        333,
                                        135,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        135,
                                        338,
                                        404,
                                        352
                                    ],
                                    "score": 0.87,
                                    "content": "{\\bf O}_{i}\\gets\\mathrm{diag}(\\ell_{i}^{\\mathrm{new}})^{-1}(\\mathrm{diag}(\\ell_{i})e^{m_{i}-m_{i}^{\\mathrm{new}}}{\\bf O}_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\bf P}_{i j}^{\\mathrm{dropped}}{\\bf V}_{j})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 269
                                },
                                {
                                    "bbox": [
                                        404,
                                        333,
                                        448,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                349,
                                276,
                                363
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        86,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "16:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        107,
                                        349,
                                        135,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        135,
                                        351,
                                        177,
                                        363
                                    ],
                                    "score": 0.85,
                                    "content": "\\ell_{i}\\gets\\ell_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        178,
                                        349,
                                        182,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        183,
                                        352,
                                        232,
                                        363
                                    ],
                                    "score": 0.86,
                                    "content": "m_{i}\\gets m_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 49
                                },
                                {
                                    "bbox": [
                                        232,
                                        349,
                                        276,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                362,
                                135,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        363,
                                        86,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "17:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        362,
                                        135,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "end for",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                374,
                                126,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        374,
                                        126,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "18: end for",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                384,
                                166,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        384,
                                        121,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "19: Return",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        386,
                                        162,
                                        397
                                    ],
                                    "score": 0.73,
                                    "content": "\\mathbf{0},\\ell,m,\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 40
                                },
                                {
                                    "bbox": [
                                        163,
                                        384,
                                        166,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 11.5
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        417,
                        310,
                        432
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                417,
                                309,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        417,
                                        95,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "B.4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        419,
                                        309,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Backward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        438,
                        542,
                        474
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                437,
                                542,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        437,
                                        453,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "We describe the full details of FlashAttention backward pass. Given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        453,
                                        439,
                                        520,
                                        450
                                    ],
                                    "score": 0.9,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        520,
                                        437,
                                        542,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": ", the",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                68,
                                447,
                                542,
                                464
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        447,
                                        103,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": "output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        450,
                                        146,
                                        460
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        147,
                                        447,
                                        259,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": ", and the output gradient ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        259,
                                        452,
                                        273,
                                        460
                                    ],
                                    "score": 0.3,
                                    "content": "\\mathbf{d0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        273,
                                        447,
                                        490,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": ", we want to compute the input gradients dQ, dK,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        490,
                                        451,
                                        538,
                                        460
                                    ],
                                    "score": 0.83,
                                    "content": "\\mathbf{dV}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        539,
                                        447,
                                        542,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                86,
                                461,
                                474,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        461,
                                        474,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "We first describe the standard attention backward pass in Algorithm 3 for completeness.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        487,
                        280,
                        498
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                488,
                                280,
                                498
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        488,
                                        280,
                                        498
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 3 Standard Attention Backward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 28
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        501,
                        527,
                        590
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                501,
                                337,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        501,
                                        159,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        160,
                                        504,
                                        243,
                                        515
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V},\\mathbf{dO}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 83
                                },
                                {
                                    "bbox": [
                                        244,
                                        501,
                                        248,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        249,
                                        504,
                                        293,
                                        513
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{P}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 44
                                },
                                {
                                    "bbox": [
                                        294,
                                        501,
                                        337,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                73,
                                512,
                                453,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        512,
                                        113,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": "1: Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        518,
                                        138,
                                        527
                                    ],
                                    "score": 0.36,
                                    "content": "\\mathbf{P},\\mathbf{d}\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        138,
                                        512,
                                        278,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        279,
                                        516,
                                        365,
                                        525
                                    ],
                                    "score": 0.9,
                                    "content": "\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{V}}=\\ensuremath{\\mathbf{P}}^{\\top}\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{O}}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 86
                                },
                                {
                                    "bbox": [
                                        365,
                                        512,
                                        453,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": ", write dV to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                74,
                                524,
                                455,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        524,
                                        279,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "2: Load dO, V by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        279,
                                        528,
                                        367,
                                        537
                                    ],
                                    "score": 0.86,
                                    "content": "\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{P}}=\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{O}}\\ensuremath{\\mathbf{V}}^{\\top}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        368,
                                        524,
                                        398,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": ", write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        398,
                                        530,
                                        411,
                                        537
                                    ],
                                    "score": 0.77,
                                    "content": "\\mathbf{dP}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        411,
                                        524,
                                        455,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                74,
                                537,
                                524,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        537,
                                        113,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "3: Read ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        541,
                                        137,
                                        550
                                    ],
                                    "score": 0.61,
                                    "content": "\\mathbf{P},\\mathbf{dP}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        138,
                                        537,
                                        234,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": " from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        234,
                                        540,
                                        282,
                                        549
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{dS}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        282,
                                        537,
                                        314,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        315,
                                        542,
                                        437,
                                        552
                                    ],
                                    "score": 0.91,
                                    "content": "\\begin{array}{r}{d S_{i j}=P_{i j}(d P_{i j}-\\sum_{l}P_{i l}d P_{i l})}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 122
                                },
                                {
                                    "bbox": [
                                        437,
                                        537,
                                        524,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": ", write dS to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                75,
                                552,
                                427,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        552,
                                        147,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "4: Load dS and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        147,
                                        554,
                                        155,
                                        561
                                    ],
                                    "score": 0.59,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        155,
                                        552,
                                        295,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        296,
                                        553,
                                        339,
                                        563
                                    ],
                                    "score": 0.83,
                                    "content": "\\mathbf{dQ}=\\mathbf{dSK}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        340,
                                        552,
                                        427,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": ", write dQ to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                75,
                                563,
                                433,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        563,
                                        147,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "5: Load dS and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        147,
                                        565,
                                        155,
                                        575
                                    ],
                                    "score": 0.46,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        155,
                                        563,
                                        295,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        295,
                                        564,
                                        345,
                                        574
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{dK}=\\mathbf{dS}^{\\iota}\\mathbf{\\DeltaQ}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        345,
                                        563,
                                        433,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": ", write dK to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                76,
                                576,
                                174,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        576,
                                        174,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "6: Return dQ, dK, dV.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 32
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        605,
                        405,
                        617
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                605,
                                405,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        605,
                                        405,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "We now make two observations about FlashAttention backward pass:",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36
                },
                {
                    "type": "text",
                    "bbox": [
                        82,
                        623,
                        542,
                        705
                    ],
                    "lines": [
                        {
                            "bbox": [
                                82,
                                624,
                                541,
                                638
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        624,
                                        316,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": "1. We do not need to store the dropout mask of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        316,
                                        626,
                                        344,
                                        637
                                    ],
                                    "score": 0.94,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        344,
                                        624,
                                        541,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": " from the forward pass. Instead, we can save",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                95,
                                637,
                                541,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        637,
                                        541,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "the pseudo-random number generator states from the forward pass and re-generate the dropout mask",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                95,
                                649,
                                403,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        649,
                                        311,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": "in the backward pass. This allows us to only use ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        312,
                                        651,
                                        335,
                                        661
                                    ],
                                    "score": 0.93,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        335,
                                        649,
                                        403,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                82,
                                669,
                                541,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        669,
                                        388,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "2. When computing the softmax gradient, we use Eq. (4) to compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        389,
                                        671,
                                        439,
                                        682
                                    ],
                                    "score": 0.93,
                                    "content": "D_{i}=P_{i:}^{\\top}d P_{i}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        439,
                                        669,
                                        541,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": ": without reducing over",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                96,
                                681,
                                541,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        684,
                                        106,
                                        692
                                    ],
                                    "score": 0.89,
                                    "content": "P_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        106,
                                        681,
                                        130,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": ": and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        130,
                                        684,
                                        145,
                                        692
                                    ],
                                    "score": 0.9,
                                    "content": "d P_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        145,
                                        681,
                                        180,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": ": of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        180,
                                        684,
                                        188,
                                        691
                                    ],
                                    "score": 0.9,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        189,
                                        681,
                                        432,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "(they might not fit into SRAM). Instead we can rewrite",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        433,
                                        683,
                                        481,
                                        694
                                    ],
                                    "score": 0.94,
                                    "content": "D_{i}=d o_{i}^{\\scriptscriptstyle1}o_{i}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        481,
                                        681,
                                        541,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "and compute",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                95,
                                693,
                                281,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        693,
                                        271,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "the dot product between vectors of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        271,
                                        695,
                                        277,
                                        703
                                    ],
                                    "score": 0.9,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        277,
                                        694,
                                        281,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 39.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 19,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "20",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        72,
                        89,
                        543,
                        402
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                88,
                                543,
                                103
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        88,
                                        161,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        91,
                                        231,
                                        101
                                    ],
                                    "score": 0.91,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 70
                                },
                                {
                                    "bbox": [
                                        231,
                                        88,
                                        380,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, on-chip SRAM of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        380,
                                        93,
                                        390,
                                        100
                                    ],
                                    "score": 0.76,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        391,
                                        88,
                                        511,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ", softmax scaling constant ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        512,
                                        91,
                                        538,
                                        101
                                    ],
                                    "score": 0.83,
                                    "content": "\\tau\\in\\mathbb{R}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        539,
                                        88,
                                        543,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                86,
                                101,
                                313,
                                116
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        101,
                                        285,
                                        116
                                    ],
                                    "score": 1.0,
                                    "content": "masking function mask, dropout probability",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        285,
                                        107,
                                        308,
                                        114
                                    ],
                                    "score": 0.86,
                                    "content": "p_{\\mathrm{drop}}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        309,
                                        101,
                                        313,
                                        116
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 1,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                77,
                                114,
                                412,
                                126
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        114,
                                        321,
                                        126
                                    ],
                                    "score": 1.0,
                                    "content": "1: Initialize the pseudo-random number generator state ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        321,
                                        116,
                                        329,
                                        123
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        329,
                                        114,
                                        412,
                                        126
                                    ],
                                    "score": 1.0,
                                    "content": " and save to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 2,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                74,
                                124,
                                285,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        124,
                                        154,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "2: Set block sizes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        154,
                                        126,
                                        281,
                                        139
                                    ],
                                    "score": 0.91,
                                    "content": "\\begin{array}{r}{B_{c}=\\left\\lceil\\frac{M}{4d}\\right\\rceil,B_{r}=\\operatorname*{min}\\left(\\left\\lceil\\frac{M}{4d}\\right\\rceil,d\\right)}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 127
                                },
                                {
                                    "bbox": [
                                        281,
                                        124,
                                        285,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                73,
                                136,
                                402,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        136,
                                        129,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "3: Initialize ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        129,
                                        140,
                                        212,
                                        151
                                    ],
                                    "score": 0.81,
                                    "content": "{\\bf O}=(0)_{N\\times d}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 83
                                },
                                {
                                    "bbox": [
                                        212,
                                        136,
                                        216,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        216,
                                        140,
                                        358,
                                        151
                                    ],
                                    "score": 0.77,
                                    "content": "\\ell=(0)_{N}\\in\\mathbb{R}^{N},m=(-\\infty)_{N}\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 142
                                },
                                {
                                    "bbox": [
                                        358,
                                        136,
                                        402,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                146,
                                538,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        146,
                                        120,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "4: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        121,
                                        156,
                                        128,
                                        165
                                    ],
                                    "score": 0.65,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        129,
                                        146,
                                        152,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        152,
                                        151,
                                        194,
                                        169
                                    ],
                                    "score": 0.93,
                                    "content": "\\begin{array}{r}{T_{r}=\\left\\lceil\\frac{N}{B_{r}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 18,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        194,
                                        146,
                                        227,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        227,
                                        155,
                                        276,
                                        165
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{Q}_{1},\\ldots,\\mathbf{Q}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 49
                                },
                                {
                                    "bbox": [
                                        277,
                                        146,
                                        311,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        311,
                                        156,
                                        340,
                                        164
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        340,
                                        146,
                                        419,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "each, and divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        419,
                                        153,
                                        440,
                                        165
                                    ],
                                    "score": 0.79,
                                    "content": "\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        440,
                                        146,
                                        466,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": " in to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        466,
                                        150,
                                        509,
                                        170
                                    ],
                                    "score": 0.94,
                                    "content": "\\begin{array}{r}{T_{c}=\\bigg\\lceil\\frac{N}{B_{c}}\\bigg\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 20,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        511,
                                        154,
                                        538,
                                        164
                                    ],
                                    "score": 1.0,
                                    "content": "blocks",
                                    "type": "text"
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                88,
                                168,
                                302,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        170,
                                        138,
                                        180
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{K}_{1},\\ldots,\\mathbf{K}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        138,
                                        168,
                                        160,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        169,
                                        211,
                                        180
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{V}_{1},\\ldots,\\mathbf{V}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        211,
                                        168,
                                        246,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": ", of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        247,
                                        170,
                                        275,
                                        179
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        275,
                                        168,
                                        302,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                179,
                                542,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        179,
                                        119,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "5: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        120,
                                        182,
                                        127,
                                        190
                                    ],
                                    "score": 0.78,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        128,
                                        179,
                                        150,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        150,
                                        182,
                                        160,
                                        191
                                    ],
                                    "score": 0.89,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        160,
                                        179,
                                        193,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        193,
                                        181,
                                        241,
                                        192
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{0}_{i},\\ldots,\\mathbf{0}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        241,
                                        179,
                                        274,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        274,
                                        182,
                                        302,
                                        191
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        303,
                                        179,
                                        360,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "each, divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        360,
                                        182,
                                        365,
                                        189
                                    ],
                                    "score": 0.88,
                                    "content": "\\ell",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        365,
                                        179,
                                        387,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        388,
                                        182,
                                        397,
                                        191
                                    ],
                                    "score": 0.89,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        397,
                                        179,
                                        430,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        430,
                                        181,
                                        471,
                                        192
                                    ],
                                    "score": 0.9,
                                    "content": "\\ell_{i},\\ldots,\\ell_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        471,
                                        179,
                                        504,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        504,
                                        181,
                                        516,
                                        191
                                    ],
                                    "score": 0.87,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        516,
                                        179,
                                        542,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "each,",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                86,
                                191,
                                313,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        191,
                                        117,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        118,
                                        196,
                                        126,
                                        201
                                    ],
                                    "score": 0.87,
                                    "content": "m",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        126,
                                        191,
                                        149,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        194,
                                        158,
                                        203
                                    ],
                                    "score": 0.9,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        158,
                                        191,
                                        191,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        195,
                                        241,
                                        204
                                    ],
                                    "score": 0.81,
                                    "content": "m_{1},\\ldots,m_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        241,
                                        191,
                                        274,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        275,
                                        194,
                                        286,
                                        203
                                    ],
                                    "score": 0.89,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        286,
                                        191,
                                        313,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                74,
                                203,
                                168,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        203,
                                        105,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "6: for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        105,
                                        207,
                                        149,
                                        215
                                    ],
                                    "score": 0.93,
                                    "content": "1\\le j\\le T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 44
                                },
                                {
                                    "bbox": [
                                        150,
                                        203,
                                        168,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                215,
                                286,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        216,
                                        86,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "7:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        215,
                                        123,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        123,
                                        218,
                                        151,
                                        228
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{K}_{j},\\mathbf{V}_{j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        152,
                                        215,
                                        286,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                227,
                                174,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        229,
                                        86,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "8:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        97,
                                        227,
                                        115,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        230,
                                        157,
                                        239
                                    ],
                                    "score": 0.91,
                                    "content": "1\\leq i\\leq T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        158,
                                        227,
                                        174,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 11,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                239,
                                320,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        240,
                                        86,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "9:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        106,
                                        239,
                                        133,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        133,
                                        242,
                                        185,
                                        251
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{Q}_{i},\\mathbf{O}_{i},\\ell_{i},m_{i}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        185,
                                        239,
                                        320,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                250,
                                288,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        252,
                                        86,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "10:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        106,
                                        250,
                                        189,
                                        265
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        252,
                                        285,
                                        266
                                    ],
                                    "score": 0.94,
                                    "content": "\\mathbf{S}_{i j}=\\tau\\mathbf{Q}_{i}\\mathbf{K}_{j}^{T}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 96
                                },
                                {
                                    "bbox": [
                                        285,
                                        250,
                                        288,
                                        265
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                261,
                                286,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        267,
                                        86,
                                        278
                                    ],
                                    "score": 1.0,
                                    "content": "11:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        261,
                                        189,
                                        286
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        266,
                                        277,
                                        280
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{S}_{i j}^{\\mathrm{masked}}=\\mathrm{MASK}(\\mathbf{S}_{i j})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        277,
                                        261,
                                        286,
                                        286
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                276,
                                545,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        281,
                                        86,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "12:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        276,
                                        191,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        279,
                                        536,
                                        295
                                    ],
                                    "score": 0.63,
                                    "content": "\\tilde{m}_{i j}=\\mathrm{rowmax}(\\mathbf{S}_{i j}^{\\mathrm{masked}})\\in\\mathbb{R}^{B_{r}},\\tilde{\\mathbf{P}}_{i j}=\\mathrm{exp}(\\mathbf{S}_{i j}^{\\mathrm{masked}}-\\tilde{m}_{i j})\\in\\mathbb{R}^{B_{r}\\times B_{c}}\\mathrm{(pointwise)},",
                                    "type": "inline_equation",
                                    "height": 16,
                                    "width": 345
                                },
                                {
                                    "bbox": [
                                        537,
                                        276,
                                        545,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                108,
                                295,
                                220,
                                308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        295,
                                        213,
                                        308
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\ell}_{i j}=\\mathrm{rowsum}(\\tilde{\\mathbf{P}}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 105
                                },
                                {
                                    "bbox": [
                                        214,
                                        295,
                                        220,
                                        308
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                306,
                                478,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        310,
                                        86,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "13:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        105,
                                        306,
                                        188,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        308,
                                        306,
                                        322
                                    ],
                                    "score": 0.87,
                                    "content": "m_{i}^{\\mathrm{new}}=\\operatorname*{max}(m_{i},\\tilde{m}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 117
                                },
                                {
                                    "bbox": [
                                        306,
                                        306,
                                        310,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        311,
                                        307,
                                        478,
                                        322
                                    ],
                                    "score": 0.65,
                                    "content": "\\ell_{i}^{\\mathrm{new}}=e^{m_{i}-m_{i}^{\\mathrm{new}}}\\ell_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\ell}_{i j}\\in\\mathbb{R}^{B_{r}}.",
                                    "type": "inline_equation"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                315,
                                329,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        324,
                                        86,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "14:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        315,
                                        188,
                                        344
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        189,
                                        322,
                                        319,
                                        337
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}^{\\mathrm{dropped}}=\\mathrm{dropout}(\\tilde{\\mathbf{P}}_{i j},p_{\\mathrm{drop}})",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 130
                                },
                                {
                                    "bbox": [
                                        319,
                                        315,
                                        329,
                                        344
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                333,
                                448,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        339,
                                        86,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "15:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        333,
                                        135,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        135,
                                        338,
                                        404,
                                        352
                                    ],
                                    "score": 0.87,
                                    "content": "{\\bf O}_{i}\\gets\\mathrm{diag}(\\ell_{i}^{\\mathrm{new}})^{-1}(\\mathrm{diag}(\\ell_{i})e^{m_{i}-m_{i}^{\\mathrm{new}}}{\\bf O}_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\bf P}_{i j}^{\\mathrm{dropped}}{\\bf V}_{j})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 269
                                },
                                {
                                    "bbox": [
                                        404,
                                        333,
                                        448,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                349,
                                276,
                                363
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        86,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "16:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        107,
                                        349,
                                        135,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        135,
                                        351,
                                        177,
                                        363
                                    ],
                                    "score": 0.85,
                                    "content": "\\ell_{i}\\gets\\ell_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        178,
                                        349,
                                        182,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        183,
                                        352,
                                        232,
                                        363
                                    ],
                                    "score": 0.86,
                                    "content": "m_{i}\\gets m_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 49
                                },
                                {
                                    "bbox": [
                                        232,
                                        349,
                                        276,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                362,
                                135,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        363,
                                        86,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "17:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        362,
                                        135,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "end for",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                374,
                                126,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        374,
                                        126,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "18: end for",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                384,
                                166,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        384,
                                        121,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "19: Return",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        386,
                                        162,
                                        397
                                    ],
                                    "score": 0.73,
                                    "content": "\\mathbf{0},\\ell,m,\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 40
                                },
                                {
                                    "bbox": [
                                        163,
                                        384,
                                        166,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 11.5,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        88,
                        545,
                        398
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        417,
                        310,
                        432
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                417,
                                309,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        417,
                                        95,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "B.4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        419,
                                        309,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "FlashAttention: Backward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        438,
                        542,
                        474
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                437,
                                542,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        437,
                                        453,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "We describe the full details of FlashAttention backward pass. Given input sequences ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        453,
                                        439,
                                        520,
                                        450
                                    ],
                                    "score": 0.9,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        520,
                                        437,
                                        542,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": ", the",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                68,
                                447,
                                542,
                                464
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        447,
                                        103,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": "output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        450,
                                        146,
                                        460
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        147,
                                        447,
                                        259,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": ", and the output gradient ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        259,
                                        452,
                                        273,
                                        460
                                    ],
                                    "score": 0.3,
                                    "content": "\\mathbf{d0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        273,
                                        447,
                                        490,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": ", we want to compute the input gradients dQ, dK,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        490,
                                        451,
                                        538,
                                        460
                                    ],
                                    "score": 0.83,
                                    "content": "\\mathbf{dV}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        539,
                                        447,
                                        542,
                                        464
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                86,
                                461,
                                474,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        461,
                                        474,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "We first describe the standard attention backward pass in Algorithm 3 for completeness.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 26,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        437,
                        542,
                        474
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        487,
                        280,
                        498
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                488,
                                280,
                                498
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        488,
                                        280,
                                        498
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 3 Standard Attention Backward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 28,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "index",
                    "bbox": [
                        72,
                        501,
                        527,
                        590
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                501,
                                337,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        501,
                                        159,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        160,
                                        504,
                                        243,
                                        515
                                    ],
                                    "score": 0.86,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V},\\mathbf{dO}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 83
                                },
                                {
                                    "bbox": [
                                        244,
                                        501,
                                        248,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        249,
                                        504,
                                        293,
                                        513
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{P}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 44
                                },
                                {
                                    "bbox": [
                                        294,
                                        501,
                                        337,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 29,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                73,
                                512,
                                453,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        512,
                                        113,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": "1: Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        518,
                                        138,
                                        527
                                    ],
                                    "score": 0.36,
                                    "content": "\\mathbf{P},\\mathbf{d}\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        138,
                                        512,
                                        278,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        279,
                                        516,
                                        365,
                                        525
                                    ],
                                    "score": 0.9,
                                    "content": "\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{V}}=\\ensuremath{\\mathbf{P}}^{\\top}\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{O}}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 86
                                },
                                {
                                    "bbox": [
                                        365,
                                        512,
                                        453,
                                        528
                                    ],
                                    "score": 1.0,
                                    "content": ", write dV to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 30,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                74,
                                524,
                                455,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        524,
                                        279,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "2: Load dO, V by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        279,
                                        528,
                                        367,
                                        537
                                    ],
                                    "score": 0.86,
                                    "content": "\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{P}}=\\ensuremath{\\mathbf{d}}\\ensuremath{\\mathbf{O}}\\ensuremath{\\mathbf{V}}^{\\top}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        368,
                                        524,
                                        398,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": ", write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        398,
                                        530,
                                        411,
                                        537
                                    ],
                                    "score": 0.77,
                                    "content": "\\mathbf{dP}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        411,
                                        524,
                                        455,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                74,
                                537,
                                524,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        537,
                                        113,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "3: Read ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        541,
                                        137,
                                        550
                                    ],
                                    "score": 0.61,
                                    "content": "\\mathbf{P},\\mathbf{dP}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        138,
                                        537,
                                        234,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": " from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        234,
                                        540,
                                        282,
                                        549
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{dS}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        282,
                                        537,
                                        314,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "where ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        315,
                                        542,
                                        437,
                                        552
                                    ],
                                    "score": 0.91,
                                    "content": "\\begin{array}{r}{d S_{i j}=P_{i j}(d P_{i j}-\\sum_{l}P_{i l}d P_{i l})}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 122
                                },
                                {
                                    "bbox": [
                                        437,
                                        537,
                                        524,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": ", write dS to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                75,
                                552,
                                427,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        552,
                                        147,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "4: Load dS and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        147,
                                        554,
                                        155,
                                        561
                                    ],
                                    "score": 0.59,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        155,
                                        552,
                                        295,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        296,
                                        553,
                                        339,
                                        563
                                    ],
                                    "score": 0.83,
                                    "content": "\\mathbf{dQ}=\\mathbf{dSK}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        340,
                                        552,
                                        427,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": ", write dQ to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                75,
                                563,
                                433,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        563,
                                        147,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "5: Load dS and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        147,
                                        565,
                                        155,
                                        575
                                    ],
                                    "score": 0.46,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        155,
                                        563,
                                        295,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": " by blocks from HBM, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        295,
                                        564,
                                        345,
                                        574
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{dK}=\\mathbf{dS}^{\\iota}\\mathbf{\\DeltaQ}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        345,
                                        563,
                                        433,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": ", write dK to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                76,
                                576,
                                174,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        576,
                                        174,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "6: Return dQ, dK, dV.",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_start_line": true
                        }
                    ],
                    "index": 32,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        501,
                        524,
                        587
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        605,
                        405,
                        617
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                605,
                                405,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        605,
                                        405,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "We now make two observations about FlashAttention backward pass:",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        605,
                        405,
                        617
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        82,
                        623,
                        542,
                        705
                    ],
                    "lines": [
                        {
                            "bbox": [
                                82,
                                624,
                                541,
                                638
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        624,
                                        316,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": "1. We do not need to store the dropout mask of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        316,
                                        626,
                                        344,
                                        637
                                    ],
                                    "score": 0.94,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        344,
                                        624,
                                        541,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": " from the forward pass. Instead, we can save",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                95,
                                637,
                                541,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        637,
                                        541,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "the pseudo-random number generator states from the forward pass and re-generate the dropout mask",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                95,
                                649,
                                403,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        649,
                                        311,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": "in the backward pass. This allows us to only use ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        312,
                                        651,
                                        335,
                                        661
                                    ],
                                    "score": 0.93,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        335,
                                        649,
                                        403,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                82,
                                669,
                                541,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        669,
                                        388,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "2. When computing the softmax gradient, we use Eq. (4) to compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        389,
                                        671,
                                        439,
                                        682
                                    ],
                                    "score": 0.93,
                                    "content": "D_{i}=P_{i:}^{\\top}d P_{i}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        439,
                                        669,
                                        541,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": ": without reducing over",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                96,
                                681,
                                541,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        684,
                                        106,
                                        692
                                    ],
                                    "score": 0.89,
                                    "content": "P_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        106,
                                        681,
                                        130,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": ": and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        130,
                                        684,
                                        145,
                                        692
                                    ],
                                    "score": 0.9,
                                    "content": "d P_{i}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        145,
                                        681,
                                        180,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": ": of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        180,
                                        684,
                                        188,
                                        691
                                    ],
                                    "score": 0.9,
                                    "content": "N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        189,
                                        681,
                                        432,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "(they might not fit into SRAM). Instead we can rewrite",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        433,
                                        683,
                                        481,
                                        694
                                    ],
                                    "score": 0.94,
                                    "content": "D_{i}=d o_{i}^{\\scriptscriptstyle1}o_{i}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        481,
                                        681,
                                        541,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "and compute",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                95,
                                693,
                                281,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        693,
                                        271,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "the dot product between vectors of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        271,
                                        695,
                                        277,
                                        703
                                    ],
                                    "score": 0.9,
                                    "content": "d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        277,
                                        694,
                                        281,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 39.5,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        82,
                        624,
                        541,
                        705
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        73,
                        541,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                73,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        73,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "The full FlashAttention backward pass algorithm is in Algorithm 4. Conceptually it is just a block",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                86,
                                257,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        86,
                                        257,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "version of the derivation in Appendix B.2.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        109,
                        275,
                        122
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                110,
                                275,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        110,
                                        275,
                                        121
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 4 FlashAttention Backward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "table",
                    "bbox": [
                        72,
                        120,
                        543,
                        578
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                72,
                                120,
                                543,
                                578
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        120,
                                        543,
                                        578
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                120,
                                                543,
                                                578
                                            ],
                                            "score": 0.774,
                                            "type": "table",
                                            "image_path": "397d61387975482bb478515f58df92f201b809af3a3f3a13a698d42d52490042.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        120,
                                        543,
                                        272.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        272.66666666666663,
                                        543,
                                        425.33333333333326
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        72,
                                        425.33333333333326,
                                        543,
                                        577.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 5
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        595,
                        540,
                        619
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        596,
                                        396,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": "We see that similar to the forward pass, the backward pass performs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        396,
                                        597,
                                        424,
                                        607
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        424,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs and only requires",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                608,
                                429,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        609,
                                        95,
                                        619
                                    ],
                                    "score": 0.91,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        95,
                                        608,
                                        429,
                                        620
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory beyond inputs, output, output gradient, and input gradients.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6.5
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        620,
                        496,
                        632
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                620,
                                496,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        620,
                                        496,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "We analyze the IO-complexity of the backward pass, similar to the forward pass (Theorem 2).",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        639,
                        542,
                        675
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                639,
                                541,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        639,
                                        483,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "Theorem 5. Let 𝑁 be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        484,
                                        642,
                                        538,
                                        650
                                    ],
                                    "score": 0.87,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        538,
                                        639,
                                        541,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                651,
                                542,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        651,
                                        313,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": "Standard attention (Algorithm 0) backward pass requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        313,
                                        652,
                                        364,
                                        663
                                    ],
                                    "score": 0.89,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        364,
                                        651,
                                        542,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses, while FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                663,
                                361,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        663,
                                        234,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "backward pass (Algorithm 4) requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        234,
                                        664,
                                        290,
                                        675
                                    ],
                                    "score": 0.9,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        290,
                                        663,
                                        361,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        683,
                        211,
                        695
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                684,
                                210,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        684,
                                        210,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "The proof is in Appendix C.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 12
                }
            ],
            "layout_bboxes": [],
            "page_idx": 20,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        72,
                        120,
                        543,
                        578
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                72,
                                120,
                                543,
                                578
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        120,
                                        543,
                                        578
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                120,
                                                543,
                                                578
                                            ],
                                            "score": 0.774,
                                            "type": "table",
                                            "image_path": "397d61387975482bb478515f58df92f201b809af3a3f3a13a698d42d52490042.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        120,
                                        543,
                                        272.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        272.66666666666663,
                                        543,
                                        425.33333333333326
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        72,
                                        425.33333333333326,
                                        543,
                                        577.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 5
                                }
                            ]
                        }
                    ],
                    "index": 4
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        310,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 13,
                                    "width": 15
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        73,
                        541,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                73,
                                541,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        73,
                                        541,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "The full FlashAttention backward pass algorithm is in Algorithm 4. Conceptually it is just a block",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                86,
                                257,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        86,
                                        257,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "version of the derivation in Appendix B.2.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        73,
                        541,
                        97
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        109,
                        275,
                        122
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                110,
                                275,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        110,
                                        275,
                                        121
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 4 FlashAttention Backward Pass",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        72,
                        120,
                        543,
                        578
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                72,
                                120,
                                543,
                                578
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        120,
                                        543,
                                        578
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                120,
                                                543,
                                                578
                                            ],
                                            "score": 0.774,
                                            "type": "table",
                                            "image_path": "397d61387975482bb478515f58df92f201b809af3a3f3a13a698d42d52490042.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        120,
                                        543,
                                        272.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        272.66666666666663,
                                        543,
                                        425.33333333333326
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        72,
                                        425.33333333333326,
                                        543,
                                        577.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 5
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        595,
                        540,
                        619
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        596,
                                        396,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": "We see that similar to the forward pass, the backward pass performs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        396,
                                        597,
                                        424,
                                        607
                                    ],
                                    "score": 0.93,
                                    "content": "O(N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        424,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs and only requires",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                608,
                                429,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        609,
                                        95,
                                        619
                                    ],
                                    "score": 0.91,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        95,
                                        608,
                                        429,
                                        620
                                    ],
                                    "score": 1.0,
                                    "content": " extra memory beyond inputs, output, output gradient, and input gradients.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6.5,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        596,
                        541,
                        620
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        620,
                        496,
                        632
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                620,
                                496,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        620,
                                        496,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "We analyze the IO-complexity of the backward pass, similar to the forward pass (Theorem 2).",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 8,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        87,
                        620,
                        496,
                        631
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        639,
                        542,
                        675
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                639,
                                541,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        639,
                                        483,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "Theorem 5. Let 𝑁 be the sequence length, 𝑑 be the head dimension, and 𝑀 be size of SRAM with",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        484,
                                        642,
                                        538,
                                        650
                                    ],
                                    "score": 0.87,
                                    "content": "d\\leq M\\leq N d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        538,
                                        639,
                                        541,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                651,
                                542,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        651,
                                        313,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": "Standard attention (Algorithm 0) backward pass requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        313,
                                        652,
                                        364,
                                        663
                                    ],
                                    "score": 0.89,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        364,
                                        651,
                                        542,
                                        664
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses, while FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                663,
                                361,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        663,
                                        234,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "backward pass (Algorithm 4) requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        234,
                                        664,
                                        290,
                                        675
                                    ],
                                    "score": 0.9,
                                    "content": "\\Theta(N^{2}d^{2}M^{-1})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        290,
                                        663,
                                        361,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        639,
                        542,
                        676
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        683,
                        211,
                        695
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                684,
                                210,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        684,
                                        210,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "The proof is in Appendix C.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 12,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        684,
                        210,
                        695
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        69,
                        71,
                        334,
                        86
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                333,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        94,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "B.5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        72,
                                        333,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "Comparison with Rabe and Staats [66]",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        91,
                        541,
                        115
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                91,
                                541,
                                104
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        91,
                                        541,
                                        104
                                    ],
                                    "score": 1.0,
                                    "content": "We describe here some similarities and differences between our FlashAttention algorithm and the algorithm",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                104,
                                177,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        104,
                                        177,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "of Rabe and Staats [66].",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 1.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        116,
                        540,
                        163
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                117,
                                541,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        117,
                                        541,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "Conceptually, both FlashAttention and Rabe and Staats [66] operate on blocks of the attention matrix",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                128,
                                540,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        128,
                                        540,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": "using the well-established technique of tiling (or softmax scaling) [51, 60]. To reduce the memory footprint,",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                140,
                                541,
                                152
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        140,
                                        541,
                                        152
                                    ],
                                    "score": 1.0,
                                    "content": "both methods avoid storing the large attention matrix in the forward pass and recompute it in the backward",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                154,
                                95,
                                164
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        154,
                                        95,
                                        164
                                    ],
                                    "score": 1.0,
                                    "content": "pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 4.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        163,
                        541,
                        259
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                163,
                                541,
                                176
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        163,
                                        541,
                                        176
                                    ],
                                    "score": 1.0,
                                    "content": "The first major difference is that Rabe and Staats [66] focuses on the reducing the total memory footprint",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                69,
                                175,
                                541,
                                188
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        175,
                                        541,
                                        188
                                    ],
                                    "score": 1.0,
                                    "content": "(maximum amount of GPU memory required) while FlashAttention focuses on reducing memory accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                188,
                                541,
                                200
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        188,
                                        541,
                                        200
                                    ],
                                    "score": 1.0,
                                    "content": "(the number of memory reads/writes). As mentioned in Section 2, the amount of memory access is the",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                200,
                                541,
                                212
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        200,
                                        541,
                                        212
                                    ],
                                    "score": 1.0,
                                    "content": "primary determining factor of runtime. Reducing memory accesses also necessarily reduces the total amount",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                212,
                                541,
                                223
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        212,
                                        279,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "of memory required (e.g., if an operation incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        280,
                                        214,
                                        286,
                                        221
                                    ],
                                    "score": 0.74,
                                    "content": "A",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        287,
                                        212,
                                        541,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "memory accesses, then its total memory requirement is at",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                224,
                                540,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        224,
                                        95,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "most ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        226,
                                        102,
                                        233
                                    ],
                                    "score": 0.81,
                                    "content": "A",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        103,
                                        224,
                                        410,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "). As a result, FlashAttention is faster than standard attention (2-4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        410,
                                        227,
                                        416,
                                        233
                                    ],
                                    "score": 0.33,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        417,
                                        224,
                                        540,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": ") while Rabe and Staats [66]",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                236,
                                541,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        236,
                                        541,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "is around the same speed or slightly slower than standard attention. In terms of total memory required, both",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                247,
                                254,
                                260
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        247,
                                        254,
                                        260
                                    ],
                                    "score": 1.0,
                                    "content": "methods offer substantial memory saving.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        259,
                        541,
                        343
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                258,
                                541,
                                271
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        258,
                                        541,
                                        271
                                    ],
                                    "score": 1.0,
                                    "content": "The second difference between the two methods is the way information is summarized from each block",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                271,
                                541,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        271,
                                        541,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "to pass to the next block. Rabe and Staats [66] summarizes each block with its temporary output along",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                283,
                                541,
                                295
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        283,
                                        541,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": "with the softmax normalization statistics. At the end of the forward pass, the temporary outputs of all the",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                295,
                                540,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        295,
                                        540,
                                        307
                                    ],
                                    "score": 1.0,
                                    "content": "blocks are combined using the statistics to produce the final output. FlashAttention instead incrementally",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                69,
                                306,
                                542,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        306,
                                        542,
                                        320
                                    ],
                                    "score": 1.0,
                                    "content": "updates the output (Algorithm 1 line 12) after processing each block, so only one copy of the output is needed",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                319,
                                541,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        319,
                                        118,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "(instead of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        118,
                                        322,
                                        126,
                                        329
                                    ],
                                    "score": 0.9,
                                    "content": "K",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        127,
                                        319,
                                        172,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "copies for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        173,
                                        322,
                                        181,
                                        329
                                    ],
                                    "score": 0.89,
                                    "content": "K",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        181,
                                        319,
                                        541,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "blocks). This means that FlashAttention has smaller total memory requirement",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                331,
                                224,
                                343
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        331,
                                        224,
                                        343
                                    ],
                                    "score": 1.0,
                                    "content": "compared to Rabe and Staats [66].",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        343,
                        540,
                        403
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                343,
                                541,
                                355
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        343,
                                        541,
                                        355
                                    ],
                                    "score": 1.0,
                                    "content": "The final major difference is the way the backward pass is computed. Rabe and Staats [66] uses gradient",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                355,
                                541,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        355,
                                        541,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": "checkpointing to recompute the attention matrix and the temporary output of each block. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                367,
                                541,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        367,
                                        541,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "instead simplifies the backward pass analytically (Appendices B.2 and B.4). It only recomputes the attention",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                379,
                                542,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        379,
                                        542,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "matrix and does not recompute the temporary output of each block. This reduces the memory requirement",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                391,
                                256,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        391,
                                        256,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "for the backward pass and yields speedup.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        420,
                        144,
                        435
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                421,
                                144,
                                434
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        421,
                                        85,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "C",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        421,
                                        144,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "Proofs",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        444,
                        452,
                        457
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                445,
                                451,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        445,
                                        451,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Theorem 1. We first count the number of FLOPs and extra memory required.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 28
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        457,
                        541,
                        516
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                458,
                                540,
                                470
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        458,
                                        540,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": "The dominating FLOPs are from matrix multiplication. In the inner loop, (Algorithm 1 line 9), we",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                68,
                                466,
                                543,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        466,
                                        112,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        112,
                                        470,
                                        178,
                                        484
                                    ],
                                    "score": 0.95,
                                    "content": "{\\bf Q}_{i}{\\bf K}_{j}^{\\top}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        178,
                                        466,
                                        197,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        197,
                                        470,
                                        245,
                                        481
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{Q}_{i}\\in\\mathbb{R}^{B_{r}\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        245,
                                        466,
                                        267,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        267,
                                        470,
                                        317,
                                        482
                                    ],
                                    "score": 0.95,
                                    "content": "\\mathbf{K}_{j}\\in\\mathbb{R}^{B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        317,
                                        466,
                                        378,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": ", which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        378,
                                        471,
                                        421,
                                        481
                                    ],
                                    "score": 0.93,
                                    "content": "O(B_{r}B_{c}d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        422,
                                        466,
                                        543,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs. We also compute",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                69,
                                482,
                                542,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        482,
                                        167,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "(Algorithm 1 line 12)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        168,
                                        484,
                                        231,
                                        497
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}\\mathbf{V}_{j}\\in\\mathbb{R}^{B_{r}\\times d}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 63
                                },
                                {
                                    "bbox": [
                                        232,
                                        482,
                                        249,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        249,
                                        484,
                                        305,
                                        497
                                    ],
                                    "score": 0.92,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        306,
                                        482,
                                        327,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        328,
                                        485,
                                        378,
                                        497
                                    ],
                                    "score": 0.94,
                                    "content": "\\mathbf{V}_{j}\\in\\mathbb{R}^{B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        378,
                                        482,
                                        438,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": ", which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        439,
                                        486,
                                        483,
                                        496
                                    ],
                                    "score": 0.94,
                                    "content": "O(B_{r}B_{c}d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 44
                                },
                                {
                                    "bbox": [
                                        483,
                                        482,
                                        542,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs. We",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                68,
                                497,
                                456,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        497,
                                        174,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "execute the inner loops",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        175,
                                        497,
                                        246,
                                        516
                                    ],
                                    "score": 0.93,
                                    "content": "\\begin{array}{r}{T_{c}T_{r}=\\left\\lceil\\frac{N}{B_{c}}\\right\\rceil\\left\\lceil\\frac{N}{B_{r}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 19,
                                    "width": 71
                                },
                                {
                                    "bbox": [
                                        246,
                                        497,
                                        456,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "times. Therefore the total number of FLOPs is",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 30.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        245,
                        526,
                        365,
                        551
                    ],
                    "lines": [
                        {
                            "bbox": [
                                245,
                                526,
                                365,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        245,
                                        526,
                                        365,
                                        551
                                    ],
                                    "score": 0.95,
                                    "content": "O\\left(\\frac{N^{2}}{B_{c}B_{r}}B_{r}B_{c}d\\right)=O(N^{2}d).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 33.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                245,
                                526,
                                365,
                                538.5
                            ],
                            "spans": [],
                            "index": 33
                        },
                        {
                            "bbox": [
                                245,
                                538.5,
                                365,
                                551.0
                            ],
                            "spans": [],
                            "index": 34
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        79,
                        559,
                        525,
                        572
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                560,
                                522,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        560,
                                        334,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "In terms of extra memory required, we see that we need ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        334,
                                        562,
                                        357,
                                        572
                                    ],
                                    "score": 0.94,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        358,
                                        560,
                                        495,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": " memory to store the statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        495,
                                        562,
                                        519,
                                        572
                                    ],
                                    "score": 0.92,
                                    "content": "(\\ell,m)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        520,
                                        560,
                                        522,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 35
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        572,
                        541,
                        646
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                570,
                                542,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        570,
                                        351,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "We now prove the algorithm’s correctness by induction on",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        351,
                                        574,
                                        357,
                                        583
                                    ],
                                    "score": 0.89,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        357,
                                        570,
                                        376,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        376,
                                        574,
                                        423,
                                        583
                                    ],
                                    "score": 0.92,
                                    "content": "0\\leq j\\leq T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 47
                                },
                                {
                                    "bbox": [
                                        424,
                                        570,
                                        450,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": ". Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        450,
                                        572,
                                        507,
                                        584
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{K}_{:j}\\in\\mathbb{R}^{j B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 57
                                },
                                {
                                    "bbox": [
                                        508,
                                        570,
                                        542,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "be the",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                68,
                                580,
                                543,
                                599
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        580,
                                        91,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "first",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        586,
                                        108,
                                        595
                                    ],
                                    "score": 0.91,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        109,
                                        580,
                                        146,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "rows of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        146,
                                        586,
                                        154,
                                        593
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        155,
                                        580,
                                        221,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": ", and similarly ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        221,
                                        584,
                                        277,
                                        596
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{V}_{:j}\\in\\mathbb{R}^{j B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        277,
                                        580,
                                        335,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "the the first",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        335,
                                        586,
                                        352,
                                        595
                                    ],
                                    "score": 0.91,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        352,
                                        580,
                                        390,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "rows of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        390,
                                        586,
                                        398,
                                        593
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        398,
                                        580,
                                        423,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": ". Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        423,
                                        584,
                                        517,
                                        598
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{S}_{:,:j}=\\mathbf{Q}\\mathbf{K}_{:j}^{\\top}\\in\\mathbb{R}^{N\\times j B_{c}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 94
                                },
                                {
                                    "bbox": [
                                        517,
                                        580,
                                        543,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": ", and",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                595,
                                542,
                                612
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        599,
                                        203,
                                        611
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf P_{:,:j}=\\mathrm{softmax}(\\mathbf S_{:,:j})\\in\\mathbb R^{N\\times j B_{c}}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 132
                                },
                                {
                                    "bbox": [
                                        203,
                                        595,
                                        345,
                                        612
                                    ],
                                    "score": 1.0,
                                    "content": "(softmax applied row-wise). Let",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        346,
                                        598,
                                        400,
                                        609
                                    ],
                                    "score": 0.92,
                                    "content": "m^{j},\\ell^{(j)},\\mathbf{0}^{(j)}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        400,
                                        595,
                                        473,
                                        612
                                    ],
                                    "score": 1.0,
                                    "content": " be the values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        473,
                                        600,
                                        502,
                                        609
                                    ],
                                    "score": 0.91,
                                    "content": "m,\\ell,0",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        502,
                                        595,
                                        542,
                                        612
                                    ],
                                    "score": 1.0,
                                    "content": " in HBM",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                611,
                                540,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        611,
                                        111,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "after the",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        111,
                                        613,
                                        117,
                                        622
                                    ],
                                    "score": 0.88,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        117,
                                        611,
                                        456,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "-th iteration of the outer loop (Algorithm 1 line 5). (Note that these values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        456,
                                        613,
                                        484,
                                        621
                                    ],
                                    "score": 0.91,
                                    "content": "m,\\ell,0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        485,
                                        611,
                                        540,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": " are updated",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                69,
                                622,
                                542,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        622,
                                        385,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "after each iteration of the outer loop.) We want to show that after the",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        386,
                                        625,
                                        391,
                                        634
                                    ],
                                    "score": 0.88,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        391,
                                        622,
                                        542,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "-th iteration of the outer loop, we",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                69,
                                634,
                                180,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        634,
                                        180,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": "have computed in HBM:",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 38.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        101,
                        655,
                        500,
                        668
                    ],
                    "lines": [
                        {
                            "bbox": [
                                101,
                                655,
                                500,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        101,
                                        655,
                                        500,
                                        668
                                    ],
                                    "score": 0.86,
                                    "content": "m^{(j)}=\\mathrm{rowmax}(\\mathbf{S}_{::j})\\in\\mathbb{R}^{N},\\quad\\ell^{(j)}=\\mathrm{rowsum}(\\exp(\\mathbf{S}_{::j}-m^{(j)}))\\in\\mathbb{R}^{N},\\quad\\mathbf{0}^{(j)}=\\mathbf{P}_{:::j}\\mathbf{V}_{:j}\\in\\mathbb{R}^{N\\times}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                101,
                                655,
                                500,
                                668
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        677,
                        541,
                        714
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                678,
                                540,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        678,
                                        389,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "Based on our initialization (Algorithm 1 line 2), this claim is true for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        389,
                                        681,
                                        411,
                                        690
                                    ],
                                    "score": 0.91,
                                    "content": "j=0",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        411,
                                        678,
                                        540,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": " (i.e., before the any iteration",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                690,
                                541,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        690,
                                        370,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "of the outer loop is executed). Suppose that the claim holds for some",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        370,
                                        692,
                                        438,
                                        701
                                    ],
                                    "score": 0.92,
                                    "content": "j=0,\\ldots,T_{c}-1",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 68
                                },
                                {
                                    "bbox": [
                                        439,
                                        690,
                                        541,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": ". We want to show that",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                70,
                                702,
                                542,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        702,
                                        176,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": "the claim also holds for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        176,
                                        704,
                                        196,
                                        713
                                    ],
                                    "score": 0.92,
                                    "content": "j+1",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        197,
                                        702,
                                        542,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": ". Indeed, when we update the statistics in the inner loop (Algorithm 1 line 10)",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        }
                    ],
                    "index": 44
                }
            ],
            "layout_bboxes": [],
            "page_idx": 21,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        245,
                        526,
                        365,
                        551
                    ],
                    "lines": [
                        {
                            "bbox": [
                                245,
                                526,
                                365,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        245,
                                        526,
                                        365,
                                        551
                                    ],
                                    "score": 0.95,
                                    "content": "O\\left(\\frac{N^{2}}{B_{c}B_{r}}B_{r}B_{c}d\\right)=O(N^{2}d).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 33.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                245,
                                526,
                                365,
                                538.5
                            ],
                            "spans": [],
                            "index": 33
                        },
                        {
                            "bbox": [
                                245,
                                538.5,
                                365,
                                551.0
                            ],
                            "spans": [],
                            "index": 34
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        101,
                        655,
                        500,
                        668
                    ],
                    "lines": [
                        {
                            "bbox": [
                                101,
                                655,
                                500,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        101,
                                        655,
                                        500,
                                        668
                                    ],
                                    "score": 0.86,
                                    "content": "m^{(j)}=\\mathrm{rowmax}(\\mathbf{S}_{::j})\\in\\mathbb{R}^{N},\\quad\\ell^{(j)}=\\mathrm{rowsum}(\\exp(\\mathbf{S}_{::j}-m^{(j)}))\\in\\mathbb{R}^{N},\\quad\\mathbf{0}^{(j)}=\\mathbf{P}_{:::j}\\mathbf{V}_{:j}\\in\\mathbb{R}^{N\\times}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                101,
                                655,
                                500,
                                668
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "22",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        69,
                        71,
                        334,
                        86
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                333,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        94,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "B.5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        72,
                                        333,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "Comparison with Rabe and Staats [66]",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        91,
                        541,
                        115
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                91,
                                541,
                                104
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        91,
                                        541,
                                        104
                                    ],
                                    "score": 1.0,
                                    "content": "We describe here some similarities and differences between our FlashAttention algorithm and the algorithm",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                104,
                                177,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        104,
                                        177,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "of Rabe and Staats [66].",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 1.5,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        91,
                        541,
                        117
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        116,
                        540,
                        163
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                117,
                                541,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        117,
                                        541,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "Conceptually, both FlashAttention and Rabe and Staats [66] operate on blocks of the attention matrix",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                128,
                                540,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        128,
                                        540,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": "using the well-established technique of tiling (or softmax scaling) [51, 60]. To reduce the memory footprint,",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                140,
                                541,
                                152
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        140,
                                        541,
                                        152
                                    ],
                                    "score": 1.0,
                                    "content": "both methods avoid storing the large attention matrix in the forward pass and recompute it in the backward",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                154,
                                95,
                                164
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        154,
                                        95,
                                        164
                                    ],
                                    "score": 1.0,
                                    "content": "pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 4.5,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        117,
                        541,
                        164
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        163,
                        541,
                        259
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                163,
                                541,
                                176
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        163,
                                        541,
                                        176
                                    ],
                                    "score": 1.0,
                                    "content": "The first major difference is that Rabe and Staats [66] focuses on the reducing the total memory footprint",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                69,
                                175,
                                541,
                                188
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        175,
                                        541,
                                        188
                                    ],
                                    "score": 1.0,
                                    "content": "(maximum amount of GPU memory required) while FlashAttention focuses on reducing memory accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                188,
                                541,
                                200
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        188,
                                        541,
                                        200
                                    ],
                                    "score": 1.0,
                                    "content": "(the number of memory reads/writes). As mentioned in Section 2, the amount of memory access is the",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                200,
                                541,
                                212
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        200,
                                        541,
                                        212
                                    ],
                                    "score": 1.0,
                                    "content": "primary determining factor of runtime. Reducing memory accesses also necessarily reduces the total amount",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                212,
                                541,
                                223
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        212,
                                        279,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "of memory required (e.g., if an operation incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        280,
                                        214,
                                        286,
                                        221
                                    ],
                                    "score": 0.74,
                                    "content": "A",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        287,
                                        212,
                                        541,
                                        223
                                    ],
                                    "score": 1.0,
                                    "content": "memory accesses, then its total memory requirement is at",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                224,
                                540,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        224,
                                        95,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "most ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        226,
                                        102,
                                        233
                                    ],
                                    "score": 0.81,
                                    "content": "A",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        103,
                                        224,
                                        410,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": "). As a result, FlashAttention is faster than standard attention (2-4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        410,
                                        227,
                                        416,
                                        233
                                    ],
                                    "score": 0.33,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        417,
                                        224,
                                        540,
                                        235
                                    ],
                                    "score": 1.0,
                                    "content": ") while Rabe and Staats [66]",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                236,
                                541,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        236,
                                        541,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "is around the same speed or slightly slower than standard attention. In terms of total memory required, both",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                247,
                                254,
                                260
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        247,
                                        254,
                                        260
                                    ],
                                    "score": 1.0,
                                    "content": "methods offer substantial memory saving.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        163,
                        541,
                        260
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        259,
                        541,
                        343
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                258,
                                541,
                                271
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        258,
                                        541,
                                        271
                                    ],
                                    "score": 1.0,
                                    "content": "The second difference between the two methods is the way information is summarized from each block",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                271,
                                541,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        271,
                                        541,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "to pass to the next block. Rabe and Staats [66] summarizes each block with its temporary output along",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                283,
                                541,
                                295
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        283,
                                        541,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": "with the softmax normalization statistics. At the end of the forward pass, the temporary outputs of all the",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                295,
                                540,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        295,
                                        540,
                                        307
                                    ],
                                    "score": 1.0,
                                    "content": "blocks are combined using the statistics to produce the final output. FlashAttention instead incrementally",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                69,
                                306,
                                542,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        306,
                                        542,
                                        320
                                    ],
                                    "score": 1.0,
                                    "content": "updates the output (Algorithm 1 line 12) after processing each block, so only one copy of the output is needed",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                319,
                                541,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        319,
                                        118,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "(instead of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        118,
                                        322,
                                        126,
                                        329
                                    ],
                                    "score": 0.9,
                                    "content": "K",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        127,
                                        319,
                                        172,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "copies for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        173,
                                        322,
                                        181,
                                        329
                                    ],
                                    "score": 0.89,
                                    "content": "K",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        181,
                                        319,
                                        541,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "blocks). This means that FlashAttention has smaller total memory requirement",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                331,
                                224,
                                343
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        331,
                                        224,
                                        343
                                    ],
                                    "score": 1.0,
                                    "content": "compared to Rabe and Staats [66].",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 18,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        258,
                        542,
                        343
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        343,
                        540,
                        403
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                343,
                                541,
                                355
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        343,
                                        541,
                                        355
                                    ],
                                    "score": 1.0,
                                    "content": "The final major difference is the way the backward pass is computed. Rabe and Staats [66] uses gradient",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                355,
                                541,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        355,
                                        541,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": "checkpointing to recompute the attention matrix and the temporary output of each block. FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                367,
                                541,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        367,
                                        541,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "instead simplifies the backward pass analytically (Appendices B.2 and B.4). It only recomputes the attention",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                379,
                                542,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        379,
                                        542,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "matrix and does not recompute the temporary output of each block. This reduces the memory requirement",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                391,
                                256,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        391,
                                        256,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "for the backward pass and yields speedup.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 24,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        343,
                        542,
                        403
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        420,
                        144,
                        435
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                421,
                                144,
                                434
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        421,
                                        85,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "C",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        421,
                                        144,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "Proofs",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        444,
                        452,
                        457
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                445,
                                451,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        445,
                                        451,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Theorem 1. We first count the number of FLOPs and extra memory required.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 28,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        445,
                        451,
                        458
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        457,
                        541,
                        516
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                458,
                                540,
                                470
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        458,
                                        540,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": "The dominating FLOPs are from matrix multiplication. In the inner loop, (Algorithm 1 line 9), we",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                68,
                                466,
                                543,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        466,
                                        112,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        112,
                                        470,
                                        178,
                                        484
                                    ],
                                    "score": 0.95,
                                    "content": "{\\bf Q}_{i}{\\bf K}_{j}^{\\top}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 66
                                },
                                {
                                    "bbox": [
                                        178,
                                        466,
                                        197,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        197,
                                        470,
                                        245,
                                        481
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{Q}_{i}\\in\\mathbb{R}^{B_{r}\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        245,
                                        466,
                                        267,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        267,
                                        470,
                                        317,
                                        482
                                    ],
                                    "score": 0.95,
                                    "content": "\\mathbf{K}_{j}\\in\\mathbb{R}^{B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        317,
                                        466,
                                        378,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": ", which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        378,
                                        471,
                                        421,
                                        481
                                    ],
                                    "score": 0.93,
                                    "content": "O(B_{r}B_{c}d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        422,
                                        466,
                                        543,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs. We also compute",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                69,
                                482,
                                542,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        482,
                                        167,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "(Algorithm 1 line 12)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        168,
                                        484,
                                        231,
                                        497
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}\\mathbf{V}_{j}\\in\\mathbb{R}^{B_{r}\\times d}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 63
                                },
                                {
                                    "bbox": [
                                        232,
                                        482,
                                        249,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        249,
                                        484,
                                        305,
                                        497
                                    ],
                                    "score": 0.92,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        306,
                                        482,
                                        327,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        328,
                                        485,
                                        378,
                                        497
                                    ],
                                    "score": 0.94,
                                    "content": "\\mathbf{V}_{j}\\in\\mathbb{R}^{B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        378,
                                        482,
                                        438,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": ", which takes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        439,
                                        486,
                                        483,
                                        496
                                    ],
                                    "score": 0.94,
                                    "content": "O(B_{r}B_{c}d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 44
                                },
                                {
                                    "bbox": [
                                        483,
                                        482,
                                        542,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": " FLOPs. We",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                68,
                                497,
                                456,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        497,
                                        174,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "execute the inner loops",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        175,
                                        497,
                                        246,
                                        516
                                    ],
                                    "score": 0.93,
                                    "content": "\\begin{array}{r}{T_{c}T_{r}=\\left\\lceil\\frac{N}{B_{c}}\\right\\rceil\\left\\lceil\\frac{N}{B_{r}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 19,
                                    "width": 71
                                },
                                {
                                    "bbox": [
                                        246,
                                        497,
                                        456,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "times. Therefore the total number of FLOPs is",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 30.5,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        458,
                        543,
                        516
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        245,
                        526,
                        365,
                        551
                    ],
                    "lines": [
                        {
                            "bbox": [
                                245,
                                526,
                                365,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        245,
                                        526,
                                        365,
                                        551
                                    ],
                                    "score": 0.95,
                                    "content": "O\\left(\\frac{N^{2}}{B_{c}B_{r}}B_{r}B_{c}d\\right)=O(N^{2}d).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 33.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                245,
                                526,
                                365,
                                538.5
                            ],
                            "spans": [],
                            "index": 33
                        },
                        {
                            "bbox": [
                                245,
                                538.5,
                                365,
                                551.0
                            ],
                            "spans": [],
                            "index": 34
                        }
                    ],
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        79,
                        559,
                        525,
                        572
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                560,
                                522,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        560,
                                        334,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": "In terms of extra memory required, we see that we need ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        334,
                                        562,
                                        357,
                                        572
                                    ],
                                    "score": 0.94,
                                    "content": "O(N)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        358,
                                        560,
                                        495,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": " memory to store the statistics ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        495,
                                        562,
                                        519,
                                        572
                                    ],
                                    "score": 0.92,
                                    "content": "(\\ell,m)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 24
                                },
                                {
                                    "bbox": [
                                        520,
                                        560,
                                        522,
                                        572
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 35,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        560,
                        522,
                        572
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        572,
                        541,
                        646
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                570,
                                542,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        570,
                                        351,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "We now prove the algorithm’s correctness by induction on",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        351,
                                        574,
                                        357,
                                        583
                                    ],
                                    "score": 0.89,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        357,
                                        570,
                                        376,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        376,
                                        574,
                                        423,
                                        583
                                    ],
                                    "score": 0.92,
                                    "content": "0\\leq j\\leq T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 47
                                },
                                {
                                    "bbox": [
                                        424,
                                        570,
                                        450,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": ". Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        450,
                                        572,
                                        507,
                                        584
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{K}_{:j}\\in\\mathbb{R}^{j B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 57
                                },
                                {
                                    "bbox": [
                                        508,
                                        570,
                                        542,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "be the",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                68,
                                580,
                                543,
                                599
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        580,
                                        91,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "first",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        586,
                                        108,
                                        595
                                    ],
                                    "score": 0.91,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        109,
                                        580,
                                        146,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "rows of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        146,
                                        586,
                                        154,
                                        593
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        155,
                                        580,
                                        221,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": ", and similarly ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        221,
                                        584,
                                        277,
                                        596
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{V}_{:j}\\in\\mathbb{R}^{j B_{c}\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 56
                                },
                                {
                                    "bbox": [
                                        277,
                                        580,
                                        335,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "the the first",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        335,
                                        586,
                                        352,
                                        595
                                    ],
                                    "score": 0.91,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        352,
                                        580,
                                        390,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": "rows of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        390,
                                        586,
                                        398,
                                        593
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        398,
                                        580,
                                        423,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": ". Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        423,
                                        584,
                                        517,
                                        598
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{S}_{:,:j}=\\mathbf{Q}\\mathbf{K}_{:j}^{\\top}\\in\\mathbb{R}^{N\\times j B_{c}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 94
                                },
                                {
                                    "bbox": [
                                        517,
                                        580,
                                        543,
                                        599
                                    ],
                                    "score": 1.0,
                                    "content": ", and",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                595,
                                542,
                                612
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        599,
                                        203,
                                        611
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf P_{:,:j}=\\mathrm{softmax}(\\mathbf S_{:,:j})\\in\\mathbb R^{N\\times j B_{c}}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 132
                                },
                                {
                                    "bbox": [
                                        203,
                                        595,
                                        345,
                                        612
                                    ],
                                    "score": 1.0,
                                    "content": "(softmax applied row-wise). Let",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        346,
                                        598,
                                        400,
                                        609
                                    ],
                                    "score": 0.92,
                                    "content": "m^{j},\\ell^{(j)},\\mathbf{0}^{(j)}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 54
                                },
                                {
                                    "bbox": [
                                        400,
                                        595,
                                        473,
                                        612
                                    ],
                                    "score": 1.0,
                                    "content": " be the values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        473,
                                        600,
                                        502,
                                        609
                                    ],
                                    "score": 0.91,
                                    "content": "m,\\ell,0",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        502,
                                        595,
                                        542,
                                        612
                                    ],
                                    "score": 1.0,
                                    "content": " in HBM",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                611,
                                540,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        611,
                                        111,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "after the",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        111,
                                        613,
                                        117,
                                        622
                                    ],
                                    "score": 0.88,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        117,
                                        611,
                                        456,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "-th iteration of the outer loop (Algorithm 1 line 5). (Note that these values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        456,
                                        613,
                                        484,
                                        621
                                    ],
                                    "score": 0.91,
                                    "content": "m,\\ell,0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        485,
                                        611,
                                        540,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": " are updated",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                69,
                                622,
                                542,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        622,
                                        385,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "after each iteration of the outer loop.) We want to show that after the",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        386,
                                        625,
                                        391,
                                        634
                                    ],
                                    "score": 0.88,
                                    "content": "j",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        391,
                                        622,
                                        542,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "-th iteration of the outer loop, we",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                69,
                                634,
                                180,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        634,
                                        180,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": "have computed in HBM:",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 38.5,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        570,
                        543,
                        646
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        101,
                        655,
                        500,
                        668
                    ],
                    "lines": [
                        {
                            "bbox": [
                                101,
                                655,
                                500,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        101,
                                        655,
                                        500,
                                        668
                                    ],
                                    "score": 0.86,
                                    "content": "m^{(j)}=\\mathrm{rowmax}(\\mathbf{S}_{::j})\\in\\mathbb{R}^{N},\\quad\\ell^{(j)}=\\mathrm{rowsum}(\\exp(\\mathbf{S}_{::j}-m^{(j)}))\\in\\mathbb{R}^{N},\\quad\\mathbf{0}^{(j)}=\\mathbf{P}_{:::j}\\mathbf{V}_{:j}\\in\\mathbb{R}^{N\\times}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 42,
                    "virtual_lines": [
                        {
                            "bbox": [
                                101,
                                655,
                                500,
                                668
                            ],
                            "spans": [],
                            "index": 42
                        }
                    ],
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        677,
                        541,
                        714
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                678,
                                540,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        678,
                                        389,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "Based on our initialization (Algorithm 1 line 2), this claim is true for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        389,
                                        681,
                                        411,
                                        690
                                    ],
                                    "score": 0.91,
                                    "content": "j=0",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        411,
                                        678,
                                        540,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": " (i.e., before the any iteration",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                690,
                                541,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        690,
                                        370,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "of the outer loop is executed). Suppose that the claim holds for some",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        370,
                                        692,
                                        438,
                                        701
                                    ],
                                    "score": 0.92,
                                    "content": "j=0,\\ldots,T_{c}-1",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 68
                                },
                                {
                                    "bbox": [
                                        439,
                                        690,
                                        541,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": ". We want to show that",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                70,
                                702,
                                542,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        702,
                                        176,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": "the claim also holds for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        176,
                                        704,
                                        196,
                                        713
                                    ],
                                    "score": 0.92,
                                    "content": "j+1",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        197,
                                        702,
                                        542,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": ". Indeed, when we update the statistics in the inner loop (Algorithm 1 line 10)",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        }
                    ],
                    "index": 44,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        678,
                        542,
                        714
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        72,
                        540,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                543,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        102,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "on the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        75,
                                        130,
                                        85
                                    ],
                                    "score": 0.91,
                                    "content": "(j+1)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        130,
                                        72,
                                        312,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "-th iteration of the outer loop, we update ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        312,
                                        74,
                                        407,
                                        85
                                    ],
                                    "score": 0.93,
                                    "content": "m^{(j+1)}=\\operatorname*{max}(m^{(j)},\\tilde{m})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 95
                                },
                                {
                                    "bbox": [
                                        407,
                                        72,
                                        438,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": " where",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        438,
                                        74,
                                        471,
                                        83
                                    ],
                                    "score": 0.93,
                                    "content": "\\tilde{m}\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 33
                                },
                                {
                                    "bbox": [
                                        472,
                                        72,
                                        543,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "is the row-max",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                85,
                                441,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        85,
                                        82,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        82,
                                        88,
                                        111,
                                        98
                                    ],
                                    "score": 0.42,
                                    "content": "\\mathbf{s}_{:,j:j+1}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        112,
                                        85,
                                        234,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": ", the slice of S from column",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        88,
                                        251,
                                        97
                                    ],
                                    "score": 0.92,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        251,
                                        85,
                                        302,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "to column ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        302,
                                        87,
                                        357,
                                        97
                                    ],
                                    "score": 0.93,
                                    "content": "(j+1)B_{c}-1",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        357,
                                        85,
                                        441,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": ". This implies that",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        238,
                        108,
                        372,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                238,
                                108,
                                372,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        238,
                                        108,
                                        372,
                                        121
                                    ],
                                    "score": 0.9,
                                    "content": "m^{(j+1)}=\\mathrm{rowmax}(\\mathbf{S}_{:,:j+1})\\in\\mathbb{R}^{N}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                238,
                                108,
                                372,
                                121
                            ],
                            "spans": [],
                            "index": 2
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        130,
                        162,
                        142
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                131,
                                161,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        131,
                                        161,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "Similarly, we update",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        230,
                        142,
                        380,
                        155
                    ],
                    "lines": [
                        {
                            "bbox": [
                                230,
                                142,
                                380,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        230,
                                        142,
                                        380,
                                        155
                                    ],
                                    "score": 0.89,
                                    "content": "\\ell^{(j+1)}=e^{m^{(j)}-m^{(j+1)}}\\ell^{(j)}+e^{\\tilde{m}-m^{(j+1)}}\\tilde{\\ell},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "virtual_lines": [
                        {
                            "bbox": [
                                230,
                                142,
                                380,
                                155
                            ],
                            "spans": [],
                            "index": 4
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        161,
                        534,
                        174
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                160,
                                533,
                                176
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        160,
                                        99,
                                        176
                                    ],
                                    "score": 1.0,
                                    "content": "where",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        162,
                                        253,
                                        174
                                    ],
                                    "score": 0.91,
                                    "content": "\\bar{\\ell}=\\mathrm{rowsum}(\\exp(\\mathbf{S}_{:,j:j+1}-\\tilde{m}))\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 153
                                },
                                {
                                    "bbox": [
                                        253,
                                        160,
                                        533,
                                        176
                                    ],
                                    "score": 1.0,
                                    "content": ". By the same algebraic manipulation in Section 3.1, we obtain:",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        210,
                        184,
                        401,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                210,
                                184,
                                401,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        210,
                                        184,
                                        401,
                                        198
                                    ],
                                    "score": 0.91,
                                    "content": "\\ell^{(j+1)}=\\operatorname{rowsum}(\\exp(\\mathbf{S}_{:,:j+1}-m^{(j+1)}))\\in\\mathbb{R}^{N}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "virtual_lines": [
                        {
                            "bbox": [
                                210,
                                184,
                                401,
                                198
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        85,
                        206,
                        462,
                        219
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                207,
                                464,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        207,
                                        104,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": "Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        209,
                                        130,
                                        219
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{V}_{j:j+1}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        131,
                                        207,
                                        197,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": " be the slice of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        197,
                                        209,
                                        205,
                                        217
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        205,
                                        207,
                                        266,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": " from column",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        266,
                                        210,
                                        282,
                                        219
                                    ],
                                    "score": 0.92,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        283,
                                        207,
                                        333,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": "to column ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        333,
                                        209,
                                        388,
                                        219
                                    ],
                                    "score": 0.93,
                                    "content": "(j+1)B_{c}-1",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        389,
                                        207,
                                        464,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": ", we also update:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        87,
                        226,
                        487,
                        361
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                226,
                                487,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        226,
                                        487,
                                        361
                                    ],
                                    "score": 0.92,
                                    "content": "\\begin{array}{r l}{\\mathbf{0}^{(j+1)}=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j)}-m^{(j+1)}}\\mathbf{0}^{(j)}+e^{\\bar{m}-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1}-\\bar{m})\\mathbf{V}_{j;j+1})}&{}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j)}-m^{(j+1)}}\\mathbf{P}_{:::j}\\mathbf{V}_{:j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j-m)(j+1)}}\\mathrm{diag}(\\ell^{(j)})\\exp(\\mathbf{S}_{::j;j}-m^{(j)})\\mathbf{V}_{j;j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{::j})\\mathbf{V}_{j;j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\exp(\\mathbf{S}_{::j}-m^{(j+1)})\\mathbf{V}_{:j}+\\exp(\\mathbf{S}_{j;j+1}-m^{(j+1)})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\exp(\\mathbf{S}_{::j}-m^{(j+1)})\\mathbf{V}_{j;j+1}-m^{(j+1)})\\Bigg[\\mathbf{V}_{j;j+1}]}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}\\left(\\exp\\left(\\left[\\mathbf{S}_{:,j}\\mathbf{\\Delta}_{j;j+1}\\right]-m^{(j+1)}\\right)\\right)\\Bigg[\\mathbf{V}_{j;j+1}\\Bigg]}\\\\ &{=\\mathrm{softmax}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 9,
                    "virtual_lines": [
                        {
                            "bbox": [
                                87,
                                226,
                                487,
                                271.0
                            ],
                            "spans": [],
                            "index": 8
                        },
                        {
                            "bbox": [
                                87,
                                271.0,
                                487,
                                316.0
                            ],
                            "spans": [],
                            "index": 9
                        },
                        {
                            "bbox": [
                                87,
                                316.0,
                                487,
                                361.0
                            ],
                            "spans": [],
                            "index": 10
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        369,
                        508,
                        393
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                368,
                                508,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        368,
                                        258,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "We then see that the claim is also true for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        258,
                                        372,
                                        279,
                                        380
                                    ],
                                    "score": 0.91,
                                    "content": "j+1",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        279,
                                        368,
                                        452,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": ". By induction, the claim is true for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        452,
                                        371,
                                        505,
                                        380
                                    ],
                                    "score": 0.89,
                                    "content": "j=0,\\ldots,T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 53
                                },
                                {
                                    "bbox": [
                                        505,
                                        368,
                                        508,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                86,
                                381,
                                503,
                                393
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        381,
                                        115,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": "When ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        384,
                                        141,
                                        393
                                    ],
                                    "score": 0.92,
                                    "content": "j=T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        141,
                                        381,
                                        300,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": ", we conclude that the final value of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        301,
                                        383,
                                        308,
                                        390
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        309,
                                        381,
                                        462,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": " in HBM is softmax(S)V = softmax",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        381,
                                        498,
                                        393
                                    ],
                                    "score": 0.36,
                                    "content": "(\\mathbf{Q}\\mathbf{K}^{\\top})\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 36
                                },
                                {
                                    "bbox": [
                                        499,
                                        381,
                                        503,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        412,
                        543,
                        460
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                414,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        414,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Theorem 2. We first analyze the IO complexity of standard attention implementation. The inputs",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                423,
                                543,
                                438
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        425,
                                        138,
                                        436
                                    ],
                                    "score": 0.88,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        138,
                                        423,
                                        413,
                                        438
                                    ],
                                    "score": 1.0,
                                    "content": "reside in HBM, and the at the end of the algorithm the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        414,
                                        425,
                                        456,
                                        434
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        457,
                                        423,
                                        543,
                                        438
                                    ],
                                    "score": 1.0,
                                    "content": "is written to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                84,
                                437,
                                541,
                                448
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        437,
                                        304,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": "In the first step of computing the matrix multiply ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        304,
                                        438,
                                        343,
                                        448
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 39
                                },
                                {
                                    "bbox": [
                                        343,
                                        437,
                                        395,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": ", the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        396,
                                        439,
                                        415,
                                        448
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{Q},\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        416,
                                        437,
                                        541,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": " are read from HBM and the",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                446,
                                503,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        446,
                                        103,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        450,
                                        146,
                                        458
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{S}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        147,
                                        446,
                                        381,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "is written to HBM (Algorithm 0 line 1). This incurs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        381,
                                        450,
                                        432,
                                        460
                                    ],
                                    "score": 0.91,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        433,
                                        446,
                                        503,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 14.5
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        460,
                        540,
                        484
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                461,
                                541,
                                472
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        461,
                                        234,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": "In the second step of computing ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        462,
                                        303,
                                        472
                                    ],
                                    "score": 0.33,
                                    "content": "\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 68
                                },
                                {
                                    "bbox": [
                                        303,
                                        461,
                                        521,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": ", the input S is read from HBM and the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        522,
                                        462,
                                        529,
                                        470
                                    ],
                                    "score": 0.82,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        529,
                                        461,
                                        541,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": " is",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                73,
                                472,
                                389,
                                485
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        472,
                                        291,
                                        485
                                    ],
                                    "score": 1.0,
                                    "content": "written to HBM (Algorithm 0 line 2). This incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        292,
                                        474,
                                        319,
                                        484
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        320,
                                        472,
                                        389,
                                        485
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 17.5
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        484,
                        534,
                        507
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                486,
                                533,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        486,
                                        215,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "In the last step of computing ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        215,
                                        487,
                                        249,
                                        494
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{0}=\\mathbf{PV}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        249,
                                        486,
                                        302,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": ", the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        302,
                                        487,
                                        321,
                                        496
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{P},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        321,
                                        486,
                                        522,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": " are read from global memory and the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        522,
                                        487,
                                        529,
                                        494
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        530,
                                        486,
                                        533,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": " ",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                72,
                                496,
                                412,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        496,
                                        291,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "written to HBM (Algorithm 0 line 3). This incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        292,
                                        497,
                                        343,
                                        508
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        343,
                                        496,
                                        412,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 19.5
                },
                {
                    "type": "text",
                    "bbox": [
                        81,
                        508,
                        478,
                        520
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                507,
                                477,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        507,
                                        316,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "Overall, standard attention implementation requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        509,
                                        368,
                                        520
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        369,
                                        507,
                                        477,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": " global memory accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 21
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        521,
                        345,
                        532
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                520,
                                342,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        520,
                                        342,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "We now analyze the IO complexity of streaming attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 22
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        533,
                        542,
                        567
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                533,
                                541,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        533,
                                        320,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "Following Algorithm 1, we see that each element of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        535,
                                        328,
                                        542
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        329,
                                        533,
                                        352,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        352,
                                        535,
                                        360,
                                        542
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        360,
                                        533,
                                        541,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": " is loaded from HBM once (Algorithm 1",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                542,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        152,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "line 6). We make ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        153,
                                        547,
                                        162,
                                        555
                                    ],
                                    "score": 0.91,
                                    "content": "T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        162,
                                        545,
                                        219,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        219,
                                        547,
                                        227,
                                        556
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        227,
                                        545,
                                        250,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        250,
                                        547,
                                        258,
                                        554
                                    ],
                                    "score": 0.75,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        258,
                                        545,
                                        372,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": ", each pass loading all of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        373,
                                        547,
                                        380,
                                        555
                                    ],
                                    "score": 0.45,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        381,
                                        545,
                                        430,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": " and all of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        430,
                                        547,
                                        438,
                                        554
                                    ],
                                    "score": 0.7,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        438,
                                        545,
                                        542,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM (Algorithm 1",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                555,
                                407,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        555,
                                        290,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "line 8). Therefore the number of HBM accesses is ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        291,
                                        558,
                                        404,
                                        568
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta\\left(N d+N d T_{c}\\right)=\\Theta(N d T_{c})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 113
                                },
                                {
                                    "bbox": [
                                        405,
                                        555,
                                        407,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        568,
                        542,
                        592
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                568,
                                540,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        568,
                                        272,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "We derive the conditions on the block sizes",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        273,
                                        571,
                                        284,
                                        579
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        284,
                                        568,
                                        306,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        306,
                                        571,
                                        317,
                                        579
                                    ],
                                    "score": 0.9,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        317,
                                        568,
                                        409,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": ". We need the blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        410,
                                        570,
                                        422,
                                        581
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{K}_{j}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        423,
                                        568,
                                        443,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        444,
                                        570,
                                        456,
                                        581
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{V}_{j}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        456,
                                        568,
                                        488,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        488,
                                        570,
                                        516,
                                        579
                                    ],
                                    "score": 0.93,
                                    "content": "B_{c}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        516,
                                        568,
                                        540,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "to fit",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                582,
                                254,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        582,
                                        254,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "into on-chip memory, which translates to:",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 26.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        241,
                        602,
                        370,
                        627
                    ],
                    "lines": [
                        {
                            "bbox": [
                                241,
                                602,
                                370,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        602,
                                        370,
                                        627
                                    ],
                                    "score": 0.94,
                                    "content": "B_{c}d={\\cal O}(M)\\Leftrightarrow B_{c}={\\cal O}\\left(\\frac{M}{d}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 28,
                    "virtual_lines": [
                        {
                            "bbox": [
                                241,
                                602,
                                370,
                                627
                            ],
                            "spans": [],
                            "index": 28
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        634,
                        499,
                        648
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                634,
                                499,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        634,
                                        200,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "Similarly, we need the blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        201,
                                        637,
                                        226,
                                        646
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{Q}_{i},\\mathbf{O}_{i}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        226,
                                        634,
                                        259,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        260,
                                        637,
                                        288,
                                        646
                                    ],
                                    "score": 0.93,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        288,
                                        634,
                                        499,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "to fit into on-chip memory, which translates to:",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        241,
                        657,
                        369,
                        682
                    ],
                    "lines": [
                        {
                            "bbox": [
                                241,
                                657,
                                369,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        657,
                                        369,
                                        682
                                    ],
                                    "score": 0.94,
                                    "content": "B_{r}d=O(M)\\Leftrightarrow B_{r}=O\\left(\\frac{M}{d}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 30,
                    "virtual_lines": [
                        {
                            "bbox": [
                                241,
                                657,
                                369,
                                682
                            ],
                            "spans": [],
                            "index": 30
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        689,
                        477,
                        702
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                689,
                                479,
                                703
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        689,
                                        188,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "Finally, we need the block ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        188,
                                        692,
                                        201,
                                        702
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{S}_{i j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        201,
                                        689,
                                        234,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        234,
                                        693,
                                        267,
                                        701
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times B_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 33
                                },
                                {
                                    "bbox": [
                                        268,
                                        689,
                                        479,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "to fit into on-chip memory, which translates to:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        274,
                        713,
                        337,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                274,
                                713,
                                337,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        274,
                                        713,
                                        337,
                                        723
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}B_{c}={\\cal O}(M).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 32,
                    "virtual_lines": [
                        {
                            "bbox": [
                                274,
                                713,
                                337,
                                723
                            ],
                            "spans": [],
                            "index": 32
                        }
                    ]
                }
            ],
            "layout_bboxes": [],
            "page_idx": 22,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        238,
                        108,
                        372,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                238,
                                108,
                                372,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        238,
                                        108,
                                        372,
                                        121
                                    ],
                                    "score": 0.9,
                                    "content": "m^{(j+1)}=\\mathrm{rowmax}(\\mathbf{S}_{:,:j+1})\\in\\mathbb{R}^{N}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                238,
                                108,
                                372,
                                121
                            ],
                            "spans": [],
                            "index": 2
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        230,
                        142,
                        380,
                        155
                    ],
                    "lines": [
                        {
                            "bbox": [
                                230,
                                142,
                                380,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        230,
                                        142,
                                        380,
                                        155
                                    ],
                                    "score": 0.89,
                                    "content": "\\ell^{(j+1)}=e^{m^{(j)}-m^{(j+1)}}\\ell^{(j)}+e^{\\tilde{m}-m^{(j+1)}}\\tilde{\\ell},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "virtual_lines": [
                        {
                            "bbox": [
                                230,
                                142,
                                380,
                                155
                            ],
                            "spans": [],
                            "index": 4
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        210,
                        184,
                        401,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                210,
                                184,
                                401,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        210,
                                        184,
                                        401,
                                        198
                                    ],
                                    "score": 0.91,
                                    "content": "\\ell^{(j+1)}=\\operatorname{rowsum}(\\exp(\\mathbf{S}_{:,:j+1}-m^{(j+1)}))\\in\\mathbb{R}^{N}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "virtual_lines": [
                        {
                            "bbox": [
                                210,
                                184,
                                401,
                                198
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        87,
                        226,
                        487,
                        361
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                226,
                                487,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        226,
                                        487,
                                        361
                                    ],
                                    "score": 0.92,
                                    "content": "\\begin{array}{r l}{\\mathbf{0}^{(j+1)}=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j)}-m^{(j+1)}}\\mathbf{0}^{(j)}+e^{\\bar{m}-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1}-\\bar{m})\\mathbf{V}_{j;j+1})}&{}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j)}-m^{(j+1)}}\\mathbf{P}_{:::j}\\mathbf{V}_{:j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j-m)(j+1)}}\\mathrm{diag}(\\ell^{(j)})\\exp(\\mathbf{S}_{::j;j}-m^{(j)})\\mathbf{V}_{j;j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{::j})\\mathbf{V}_{j;j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\exp(\\mathbf{S}_{::j}-m^{(j+1)})\\mathbf{V}_{:j}+\\exp(\\mathbf{S}_{j;j+1}-m^{(j+1)})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\exp(\\mathbf{S}_{::j}-m^{(j+1)})\\mathbf{V}_{j;j+1}-m^{(j+1)})\\Bigg[\\mathbf{V}_{j;j+1}]}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}\\left(\\exp\\left(\\left[\\mathbf{S}_{:,j}\\mathbf{\\Delta}_{j;j+1}\\right]-m^{(j+1)}\\right)\\right)\\Bigg[\\mathbf{V}_{j;j+1}\\Bigg]}\\\\ &{=\\mathrm{softmax}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 9,
                    "virtual_lines": [
                        {
                            "bbox": [
                                87,
                                226,
                                487,
                                271.0
                            ],
                            "spans": [],
                            "index": 8
                        },
                        {
                            "bbox": [
                                87,
                                271.0,
                                487,
                                316.0
                            ],
                            "spans": [],
                            "index": 9
                        },
                        {
                            "bbox": [
                                87,
                                316.0,
                                487,
                                361.0
                            ],
                            "spans": [],
                            "index": 10
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        241,
                        602,
                        370,
                        627
                    ],
                    "lines": [
                        {
                            "bbox": [
                                241,
                                602,
                                370,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        602,
                                        370,
                                        627
                                    ],
                                    "score": 0.94,
                                    "content": "B_{c}d={\\cal O}(M)\\Leftrightarrow B_{c}={\\cal O}\\left(\\frac{M}{d}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 28,
                    "virtual_lines": [
                        {
                            "bbox": [
                                241,
                                602,
                                370,
                                627
                            ],
                            "spans": [],
                            "index": 28
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        241,
                        657,
                        369,
                        682
                    ],
                    "lines": [
                        {
                            "bbox": [
                                241,
                                657,
                                369,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        657,
                                        369,
                                        682
                                    ],
                                    "score": 0.94,
                                    "content": "B_{r}d=O(M)\\Leftrightarrow B_{r}=O\\left(\\frac{M}{d}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 30,
                    "virtual_lines": [
                        {
                            "bbox": [
                                241,
                                657,
                                369,
                                682
                            ],
                            "spans": [],
                            "index": 30
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        274,
                        713,
                        337,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                274,
                                713,
                                337,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        274,
                                        713,
                                        337,
                                        723
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}B_{c}={\\cal O}(M).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 32,
                    "virtual_lines": [
                        {
                            "bbox": [
                                274,
                                713,
                                337,
                                723
                            ],
                            "spans": [],
                            "index": 32
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        752
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "23",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        532,
                        394,
                        540,
                        404
                    ],
                    "lines": [
                        {
                            "bbox": [
                                532,
                                396,
                                541,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        532,
                                        396,
                                        541,
                                        404
                                    ],
                                    "score": 1.0,
                                    "content": "□",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        72,
                        540,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                72,
                                543,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        72,
                                        102,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "on the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        75,
                                        130,
                                        85
                                    ],
                                    "score": 0.91,
                                    "content": "(j+1)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        130,
                                        72,
                                        312,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "-th iteration of the outer loop, we update ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        312,
                                        74,
                                        407,
                                        85
                                    ],
                                    "score": 0.93,
                                    "content": "m^{(j+1)}=\\operatorname*{max}(m^{(j)},\\tilde{m})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 95
                                },
                                {
                                    "bbox": [
                                        407,
                                        72,
                                        438,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": " where",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        438,
                                        74,
                                        471,
                                        83
                                    ],
                                    "score": 0.93,
                                    "content": "\\tilde{m}\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 33
                                },
                                {
                                    "bbox": [
                                        472,
                                        72,
                                        543,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "is the row-max",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                85,
                                441,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        85,
                                        82,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        82,
                                        88,
                                        111,
                                        98
                                    ],
                                    "score": 0.42,
                                    "content": "\\mathbf{s}_{:,j:j+1}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        112,
                                        85,
                                        234,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": ", the slice of S from column",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        88,
                                        251,
                                        97
                                    ],
                                    "score": 0.92,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        251,
                                        85,
                                        302,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "to column ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        302,
                                        87,
                                        357,
                                        97
                                    ],
                                    "score": 0.93,
                                    "content": "(j+1)B_{c}-1",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        357,
                                        85,
                                        441,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": ". This implies that",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        72,
                        543,
                        99
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        238,
                        108,
                        372,
                        121
                    ],
                    "lines": [
                        {
                            "bbox": [
                                238,
                                108,
                                372,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        238,
                                        108,
                                        372,
                                        121
                                    ],
                                    "score": 0.9,
                                    "content": "m^{(j+1)}=\\mathrm{rowmax}(\\mathbf{S}_{:,:j+1})\\in\\mathbb{R}^{N}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                238,
                                108,
                                372,
                                121
                            ],
                            "spans": [],
                            "index": 2
                        }
                    ],
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        130,
                        162,
                        142
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                131,
                                161,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        131,
                                        161,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "Similarly, we update",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 3,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        131,
                        161,
                        142
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        230,
                        142,
                        380,
                        155
                    ],
                    "lines": [
                        {
                            "bbox": [
                                230,
                                142,
                                380,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        230,
                                        142,
                                        380,
                                        155
                                    ],
                                    "score": 0.89,
                                    "content": "\\ell^{(j+1)}=e^{m^{(j)}-m^{(j+1)}}\\ell^{(j)}+e^{\\tilde{m}-m^{(j+1)}}\\tilde{\\ell},",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "virtual_lines": [
                        {
                            "bbox": [
                                230,
                                142,
                                380,
                                155
                            ],
                            "spans": [],
                            "index": 4
                        }
                    ],
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        161,
                        534,
                        174
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                160,
                                533,
                                176
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        160,
                                        99,
                                        176
                                    ],
                                    "score": 1.0,
                                    "content": "where",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        100,
                                        162,
                                        253,
                                        174
                                    ],
                                    "score": 0.91,
                                    "content": "\\bar{\\ell}=\\mathrm{rowsum}(\\exp(\\mathbf{S}_{:,j:j+1}-\\tilde{m}))\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 153
                                },
                                {
                                    "bbox": [
                                        253,
                                        160,
                                        533,
                                        176
                                    ],
                                    "score": 1.0,
                                    "content": ". By the same algebraic manipulation in Section 3.1, we obtain:",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        160,
                        533,
                        176
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        210,
                        184,
                        401,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                210,
                                184,
                                401,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        210,
                                        184,
                                        401,
                                        198
                                    ],
                                    "score": 0.91,
                                    "content": "\\ell^{(j+1)}=\\operatorname{rowsum}(\\exp(\\mathbf{S}_{:,:j+1}-m^{(j+1)}))\\in\\mathbb{R}^{N}.",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "virtual_lines": [
                        {
                            "bbox": [
                                210,
                                184,
                                401,
                                198
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ],
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        85,
                        206,
                        462,
                        219
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                207,
                                464,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        207,
                                        104,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": "Let ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        209,
                                        130,
                                        219
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{V}_{j:j+1}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        131,
                                        207,
                                        197,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": " be the slice of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        197,
                                        209,
                                        205,
                                        217
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        205,
                                        207,
                                        266,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": " from column",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        266,
                                        210,
                                        282,
                                        219
                                    ],
                                    "score": 0.92,
                                    "content": "j B_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 16
                                },
                                {
                                    "bbox": [
                                        283,
                                        207,
                                        333,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": "to column ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        333,
                                        209,
                                        388,
                                        219
                                    ],
                                    "score": 0.93,
                                    "content": "(j+1)B_{c}-1",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 55
                                },
                                {
                                    "bbox": [
                                        389,
                                        207,
                                        464,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": ", we also update:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        85,
                        207,
                        464,
                        220
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        87,
                        226,
                        487,
                        361
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                226,
                                487,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        226,
                                        487,
                                        361
                                    ],
                                    "score": 0.92,
                                    "content": "\\begin{array}{r l}{\\mathbf{0}^{(j+1)}=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j)}-m^{(j+1)}}\\mathbf{0}^{(j)}+e^{\\bar{m}-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1}-\\bar{m})\\mathbf{V}_{j;j+1})}&{}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j)}-m^{(j+1)}}\\mathbf{P}_{:::j}\\mathbf{V}_{:j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\mathrm{diag}(\\ell^{(j)})e^{m^{(j-m)(j+1)}}\\mathrm{diag}(\\ell^{(j)})\\exp(\\mathbf{S}_{::j;j}-m^{(j)})\\mathbf{V}_{j;j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{::j})\\mathbf{V}_{j;j}+e^{-m^{(j+1)}}\\exp(\\mathbf{S}_{j;j+1})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\exp(\\mathbf{S}_{::j}-m^{(j+1)})\\mathbf{V}_{:j}+\\exp(\\mathbf{S}_{j;j+1}-m^{(j+1)})\\mathbf{V}_{j;j+1})}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}(\\exp(\\mathbf{S}_{::j}-m^{(j+1)})\\mathbf{V}_{j;j+1}-m^{(j+1)})\\Bigg[\\mathbf{V}_{j;j+1}]}\\\\ &{=\\mathrm{diag}(\\ell^{(j+1)})^{-1}\\left(\\exp\\left(\\left[\\mathbf{S}_{:,j}\\mathbf{\\Delta}_{j;j+1}\\right]-m^{(j+1)}\\right)\\right)\\Bigg[\\mathbf{V}_{j;j+1}\\Bigg]}\\\\ &{=\\mathrm{softmax}",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 9,
                    "virtual_lines": [
                        {
                            "bbox": [
                                87,
                                226,
                                487,
                                271.0
                            ],
                            "spans": [],
                            "index": 8
                        },
                        {
                            "bbox": [
                                87,
                                271.0,
                                487,
                                316.0
                            ],
                            "spans": [],
                            "index": 9
                        },
                        {
                            "bbox": [
                                87,
                                316.0,
                                487,
                                361.0
                            ],
                            "spans": [],
                            "index": 10
                        }
                    ],
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        369,
                        508,
                        393
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                368,
                                508,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        368,
                                        258,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "We then see that the claim is also true for",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        258,
                                        372,
                                        279,
                                        380
                                    ],
                                    "score": 0.91,
                                    "content": "j+1",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        279,
                                        368,
                                        452,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": ". By induction, the claim is true for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        452,
                                        371,
                                        505,
                                        380
                                    ],
                                    "score": 0.89,
                                    "content": "j=0,\\ldots,T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 53
                                },
                                {
                                    "bbox": [
                                        505,
                                        368,
                                        508,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                86,
                                381,
                                503,
                                393
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        381,
                                        115,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": "When ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        384,
                                        141,
                                        393
                                    ],
                                    "score": 0.92,
                                    "content": "j=T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        141,
                                        381,
                                        300,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": ", we conclude that the final value of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        301,
                                        383,
                                        308,
                                        390
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        309,
                                        381,
                                        462,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": " in HBM is softmax(S)V = softmax",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        381,
                                        498,
                                        393
                                    ],
                                    "score": 0.36,
                                    "content": "(\\mathbf{Q}\\mathbf{K}^{\\top})\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 36
                                },
                                {
                                    "bbox": [
                                        499,
                                        381,
                                        503,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11.5,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        368,
                        508,
                        393
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        412,
                        543,
                        460
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                414,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        414,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Theorem 2. We first analyze the IO complexity of standard attention implementation. The inputs",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                423,
                                543,
                                438
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        425,
                                        138,
                                        436
                                    ],
                                    "score": 0.88,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 67
                                },
                                {
                                    "bbox": [
                                        138,
                                        423,
                                        413,
                                        438
                                    ],
                                    "score": 1.0,
                                    "content": "reside in HBM, and the at the end of the algorithm the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        414,
                                        425,
                                        456,
                                        434
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        457,
                                        423,
                                        543,
                                        438
                                    ],
                                    "score": 1.0,
                                    "content": "is written to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                84,
                                437,
                                541,
                                448
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        437,
                                        304,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": "In the first step of computing the matrix multiply ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        304,
                                        438,
                                        343,
                                        448
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{S}=\\mathbf{Q}\\mathbf{K}^{\\top}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 39
                                },
                                {
                                    "bbox": [
                                        343,
                                        437,
                                        395,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": ", the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        396,
                                        439,
                                        415,
                                        448
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{Q},\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        416,
                                        437,
                                        541,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": " are read from HBM and the",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                446,
                                503,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        446,
                                        103,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        450,
                                        146,
                                        458
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{S}\\in\\mathbb{R}^{N\\times N}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        147,
                                        446,
                                        381,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "is written to HBM (Algorithm 0 line 1). This incurs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        381,
                                        450,
                                        432,
                                        460
                                    ],
                                    "score": 0.91,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        433,
                                        446,
                                        503,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 14.5,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        414,
                        543,
                        462
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        460,
                        540,
                        484
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                461,
                                541,
                                472
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        461,
                                        234,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": "In the second step of computing ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        462,
                                        303,
                                        472
                                    ],
                                    "score": 0.33,
                                    "content": "\\mathbf{P}=\\mathrm{softmax}(\\mathbf{S})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 68
                                },
                                {
                                    "bbox": [
                                        303,
                                        461,
                                        521,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": ", the input S is read from HBM and the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        522,
                                        462,
                                        529,
                                        470
                                    ],
                                    "score": 0.82,
                                    "content": "\\mathbf{P}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        529,
                                        461,
                                        541,
                                        472
                                    ],
                                    "score": 1.0,
                                    "content": " is",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                73,
                                472,
                                389,
                                485
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        472,
                                        291,
                                        485
                                    ],
                                    "score": 1.0,
                                    "content": "written to HBM (Algorithm 0 line 2). This incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        292,
                                        474,
                                        319,
                                        484
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        320,
                                        472,
                                        389,
                                        485
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 17.5,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        73,
                        461,
                        541,
                        485
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        484,
                        534,
                        507
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                486,
                                533,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        486,
                                        215,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "In the last step of computing ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        215,
                                        487,
                                        249,
                                        494
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{0}=\\mathbf{PV}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 34
                                },
                                {
                                    "bbox": [
                                        249,
                                        486,
                                        302,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": ", the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        302,
                                        487,
                                        321,
                                        496
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{P},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        321,
                                        486,
                                        522,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": " are read from global memory and the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        522,
                                        487,
                                        529,
                                        494
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        530,
                                        486,
                                        533,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": " ",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                72,
                                496,
                                412,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        496,
                                        291,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "written to HBM (Algorithm 0 line 3). This incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        292,
                                        497,
                                        343,
                                        508
                                    ],
                                    "score": 0.93,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        343,
                                        496,
                                        412,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 19.5,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        486,
                        533,
                        509
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        81,
                        508,
                        478,
                        520
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                507,
                                477,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        507,
                                        316,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "Overall, standard attention implementation requires ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        509,
                                        368,
                                        520
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 51
                                },
                                {
                                    "bbox": [
                                        369,
                                        507,
                                        477,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": " global memory accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 21,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        507,
                        477,
                        520
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        521,
                        345,
                        532
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                520,
                                342,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        520,
                                        342,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "We now analyze the IO complexity of streaming attention.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 22,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        520,
                        342,
                        532
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        533,
                        542,
                        567
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                533,
                                541,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        533,
                                        320,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "Following Algorithm 1, we see that each element of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        535,
                                        328,
                                        542
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        329,
                                        533,
                                        352,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        352,
                                        535,
                                        360,
                                        542
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        360,
                                        533,
                                        541,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": " is loaded from HBM once (Algorithm 1",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                542,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        152,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "line 6). We make ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        153,
                                        547,
                                        162,
                                        555
                                    ],
                                    "score": 0.91,
                                    "content": "T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        162,
                                        545,
                                        219,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        219,
                                        547,
                                        227,
                                        556
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        227,
                                        545,
                                        250,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        250,
                                        547,
                                        258,
                                        554
                                    ],
                                    "score": 0.75,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        258,
                                        545,
                                        372,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": ", each pass loading all of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        373,
                                        547,
                                        380,
                                        555
                                    ],
                                    "score": 0.45,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        381,
                                        545,
                                        430,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": " and all of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        430,
                                        547,
                                        438,
                                        554
                                    ],
                                    "score": 0.7,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        438,
                                        545,
                                        542,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM (Algorithm 1",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                555,
                                407,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        555,
                                        290,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "line 8). Therefore the number of HBM accesses is ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        291,
                                        558,
                                        404,
                                        568
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta\\left(N d+N d T_{c}\\right)=\\Theta(N d T_{c})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 113
                                },
                                {
                                    "bbox": [
                                        405,
                                        555,
                                        407,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        533,
                        542,
                        569
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        568,
                        542,
                        592
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                568,
                                540,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        568,
                                        272,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "We derive the conditions on the block sizes",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        273,
                                        571,
                                        284,
                                        579
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        284,
                                        568,
                                        306,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        306,
                                        571,
                                        317,
                                        579
                                    ],
                                    "score": 0.9,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        317,
                                        568,
                                        409,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": ". We need the blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        410,
                                        570,
                                        422,
                                        581
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{K}_{j}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        423,
                                        568,
                                        443,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        444,
                                        570,
                                        456,
                                        581
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{V}_{j}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        456,
                                        568,
                                        488,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        488,
                                        570,
                                        516,
                                        579
                                    ],
                                    "score": 0.93,
                                    "content": "B_{c}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        516,
                                        568,
                                        540,
                                        579
                                    ],
                                    "score": 1.0,
                                    "content": "to fit",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                582,
                                254,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        582,
                                        254,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "into on-chip memory, which translates to:",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 26.5,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        568,
                        540,
                        592
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        241,
                        602,
                        370,
                        627
                    ],
                    "lines": [
                        {
                            "bbox": [
                                241,
                                602,
                                370,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        602,
                                        370,
                                        627
                                    ],
                                    "score": 0.94,
                                    "content": "B_{c}d={\\cal O}(M)\\Leftrightarrow B_{c}={\\cal O}\\left(\\frac{M}{d}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 28,
                    "virtual_lines": [
                        {
                            "bbox": [
                                241,
                                602,
                                370,
                                627
                            ],
                            "spans": [],
                            "index": 28
                        }
                    ],
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        634,
                        499,
                        648
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                634,
                                499,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        634,
                                        200,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "Similarly, we need the blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        201,
                                        637,
                                        226,
                                        646
                                    ],
                                    "score": 0.93,
                                    "content": "\\mathbf{Q}_{i},\\mathbf{O}_{i}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        226,
                                        634,
                                        259,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        260,
                                        637,
                                        288,
                                        646
                                    ],
                                    "score": 0.93,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        288,
                                        634,
                                        499,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "to fit into on-chip memory, which translates to:",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        634,
                        499,
                        648
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        241,
                        657,
                        369,
                        682
                    ],
                    "lines": [
                        {
                            "bbox": [
                                241,
                                657,
                                369,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        657,
                                        369,
                                        682
                                    ],
                                    "score": 0.94,
                                    "content": "B_{r}d=O(M)\\Leftrightarrow B_{r}=O\\left(\\frac{M}{d}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 30,
                    "virtual_lines": [
                        {
                            "bbox": [
                                241,
                                657,
                                369,
                                682
                            ],
                            "spans": [],
                            "index": 30
                        }
                    ],
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        689,
                        477,
                        702
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                689,
                                479,
                                703
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        689,
                                        188,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "Finally, we need the block ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        188,
                                        692,
                                        201,
                                        702
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{S}_{i j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        201,
                                        689,
                                        234,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        234,
                                        693,
                                        267,
                                        701
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times B_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 33
                                },
                                {
                                    "bbox": [
                                        268,
                                        689,
                                        479,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "to fit into on-chip memory, which translates to:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        689,
                        479,
                        703
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        274,
                        713,
                        337,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                274,
                                713,
                                337,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        274,
                                        713,
                                        337,
                                        723
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}B_{c}={\\cal O}(M).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 32,
                    "virtual_lines": [
                        {
                            "bbox": [
                                274,
                                713,
                                337,
                                723
                            ],
                            "spans": [],
                            "index": 32
                        }
                    ],
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        73,
                        146,
                        85
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                146,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        146,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "We therefore set:",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        174,
                        83,
                        436,
                        108
                    ],
                    "lines": [
                        {
                            "bbox": [
                                174,
                                83,
                                436,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        174,
                                        83,
                                        436,
                                        108
                                    ],
                                    "score": 0.92,
                                    "content": "B_{c}=\\Theta\\left(\\frac{M}{d}\\right),\\qquadB_{r}=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},\\frac{M}{B_{c}}\\right)\\right)=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},d\\right)\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                174,
                                83,
                                436,
                                91.33333333333333
                            ],
                            "spans": [],
                            "index": 1
                        },
                        {
                            "bbox": [
                                174,
                                91.33333333333333,
                                436,
                                99.66666666666666
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                174,
                                99.66666666666666,
                                436,
                                107.99999999999999
                            ],
                            "spans": [],
                            "index": 3
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        112,
                        134,
                        124
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                113,
                                134,
                                123
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        113,
                                        134,
                                        123
                                    ],
                                    "score": 1.0,
                                    "content": "We then have:",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        263,
                        122,
                        348,
                        147
                    ],
                    "lines": [
                        {
                            "bbox": [
                                263,
                                122,
                                348,
                                147
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        263,
                                        122,
                                        348,
                                        147
                                    ],
                                    "score": 0.95,
                                    "content": "T_{c}=\\frac{N}{B_{c}}=\\Theta\\left(\\frac{N d}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 5.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                263,
                                122,
                                348,
                                134.5
                            ],
                            "spans": [],
                            "index": 5
                        },
                        {
                            "bbox": [
                                263,
                                134.5,
                                348,
                                147.0
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        151,
                        279,
                        163
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                152,
                                279,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        152,
                                        279,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "As a result, the number of HBM accesses is:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        255,
                        173,
                        356,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                255,
                                173,
                                356,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        255,
                                        173,
                                        356,
                                        198
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d T_{c}\\right)=\\Theta\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 8.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                255,
                                173,
                                356,
                                185.5
                            ],
                            "spans": [],
                            "index": 8
                        },
                        {
                            "bbox": [
                                255,
                                185.5,
                                356,
                                198.0
                            ],
                            "spans": [],
                            "index": 9
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        224,
                        540,
                        249
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                226,
                                541,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        226,
                                        541,
                                        236
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Proposition 3. For contradiction, suppose that there exists an algorithm that computes exact",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                237,
                                361,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        237,
                                        297,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "attention where the number for HBM access for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        297,
                                        239,
                                        349,
                                        248
                                    ],
                                    "score": 0.93,
                                    "content": "M\\in[d,N d]",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        350,
                                        237,
                                        361,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": " is",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        282,
                        258,
                        329,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                282,
                                258,
                                329,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        282,
                                        258,
                                        329,
                                        284
                                    ],
                                    "score": 0.93,
                                    "content": "o\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 12.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                282,
                                258,
                                329,
                                271.0
                            ],
                            "spans": [],
                            "index": 12
                        },
                        {
                            "bbox": [
                                282,
                                271.0,
                                329,
                                284.0
                            ],
                            "spans": [],
                            "index": 13
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        291,
                        408,
                        304
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                293,
                                408,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        293,
                                        159,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "In the regime of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        159,
                                        294,
                                        209,
                                        304
                                    ],
                                    "score": 0.91,
                                    "content": "M=\\Theta(N d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        209,
                                        293,
                                        408,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": ", this results in the number of HBM accesses:",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 14
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        264,
                        313,
                        347,
                        339
                    ],
                    "lines": [
                        {
                            "bbox": [
                                264,
                                313,
                                347,
                                339
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        264,
                                        313,
                                        347,
                                        339
                                    ],
                                    "score": 0.94,
                                    "content": "o\\left(\\frac{N^{2}d^{2}}{N d}\\right)=o(N d).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 15.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                264,
                                313,
                                347,
                                326.0
                            ],
                            "spans": [],
                            "index": 15
                        },
                        {
                            "bbox": [
                                264,
                                326.0,
                                347,
                                339.0
                            ],
                            "spans": [],
                            "index": 16
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        347,
                        542,
                        383
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                347,
                                541,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        347,
                                        256,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "However, the input to attention (matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        256,
                                        349,
                                        288,
                                        359
                                    ],
                                    "score": 0.79,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        288,
                                        347,
                                        363,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": ") and the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        363,
                                        350,
                                        371,
                                        357
                                    ],
                                    "score": 0.56,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        371,
                                        347,
                                        415,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": " have size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        416,
                                        350,
                                        430,
                                        357
                                    ],
                                    "score": 0.83,
                                    "content": "N d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        430,
                                        347,
                                        541,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "and they start out being",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                360,
                                542,
                                372
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        360,
                                        401,
                                        372
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, so if the algorithm computes exact attention it must incur at least ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        401,
                                        362,
                                        431,
                                        371
                                    ],
                                    "score": 0.93,
                                    "content": "\\Omega(N d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        431,
                                        360,
                                        542,
                                        372
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses. This is a",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                374,
                                132,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        374,
                                        132,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "contradiction.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        390,
                        542,
                        415
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                392,
                                542,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        392,
                                        542,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Theorem 5. The IO complexity of the attention backward is very similar to the IO complexity of",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                72,
                                403,
                                397,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        403,
                                        397,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "the attention forward (Theorem 2). Here we provide a sketch of the proof.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 20.5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        415,
                        538,
                        439
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                414,
                                540,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        414,
                                        455,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "We first analyze the IO complexity of standard attention backward pass. The inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        456,
                                        415,
                                        540,
                                        427
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V},\\mathbf{dO}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 84
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                68,
                                425,
                                532,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        425,
                                        352,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "reside in HBM, and the at the end of the algorithm the outputs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        353,
                                        427,
                                        437,
                                        439
                                    ],
                                    "score": 0.44,
                                    "content": "\\mathbf{dQ},\\mathbf{dK},\\mathbf{dV}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 84
                                },
                                {
                                    "bbox": [
                                        437,
                                        425,
                                        532,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "are written to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 22.5
                },
                {
                    "type": "text",
                    "bbox": [
                        77,
                        439,
                        540,
                        462
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                439,
                                540,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        439,
                                        473,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "At each step of the standard attention backward pass, one needs to load inputs of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        473,
                                        440,
                                        488,
                                        449
                                    ],
                                    "score": 0.72,
                                    "content": "N d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        488,
                                        439,
                                        502,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "or",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        502,
                                        440,
                                        515,
                                        449
                                    ],
                                    "score": 0.89,
                                    "content": "N^{2}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        516,
                                        439,
                                        540,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": " from",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                75,
                                451,
                                527,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        451,
                                        268,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "HBM, and needs to write the outputs of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        269,
                                        452,
                                        281,
                                        461
                                    ],
                                    "score": 0.91,
                                    "content": "N^{2}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        282,
                                        451,
                                        296,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": " or",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        297,
                                        453,
                                        311,
                                        461
                                    ],
                                    "score": 0.88,
                                    "content": "N d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        311,
                                        451,
                                        407,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM. This incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        407,
                                        452,
                                        459,
                                        462
                                    ],
                                    "score": 0.91,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        459,
                                        451,
                                        527,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24.5
                },
                {
                    "type": "text",
                    "bbox": [
                        83,
                        463,
                        407,
                        474
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                464,
                                404,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        464,
                                        404,
                                        475
                                    ],
                                    "score": 1.0,
                                    "content": "We now analyze the IO complexity of FlashAttention backward pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        475,
                        542,
                        522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                475,
                                542,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        475,
                                        309,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "Similar to Theorem 2, we see that each element of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        309,
                                        478,
                                        317,
                                        485
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        317,
                                        475,
                                        339,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        340,
                                        478,
                                        348,
                                        485
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        348,
                                        475,
                                        542,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": " is loaded from HBM once. Each element of",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                488,
                                541,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        488,
                                        295,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "dK and dV is only written to HBM once. We make ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        295,
                                        490,
                                        304,
                                        498
                                    ],
                                    "score": 0.9,
                                    "content": "T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        305,
                                        488,
                                        358,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        358,
                                        489,
                                        395,
                                        499
                                    ],
                                    "score": 0.47,
                                    "content": "\\mathbf{Q},\\mathbf{O},\\mathbf{dO}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 37
                                },
                                {
                                    "bbox": [
                                        396,
                                        488,
                                        541,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": ", each pass loading all of Q, O, dO",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                500,
                                541,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        500,
                                        175,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM. We also make ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        175,
                                        502,
                                        185,
                                        510
                                    ],
                                    "score": 0.91,
                                    "content": "T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        185,
                                        500,
                                        239,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        239,
                                        501,
                                        252,
                                        510
                                    ],
                                    "score": 0.35,
                                    "content": "{\\bf d Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        253,
                                        500,
                                        541,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": ", each pass reading/writing all of dQ from/to HBM. Therefore the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                512,
                                310,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        512,
                                        193,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": "number of HBM accesses is ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        194,
                                        513,
                                        307,
                                        522
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta\\left(N d+N d T_{c}\\right)=\\Theta(N d T_{c})",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 113
                                },
                                {
                                    "bbox": [
                                        307,
                                        512,
                                        310,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 28.5
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        523,
                        407,
                        534
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                524,
                                406,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        524,
                                        406,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "As in the proof of Theorem 2, the constraints on the block sizes are that:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        218,
                        545,
                        392,
                        570
                    ],
                    "lines": [
                        {
                            "bbox": [
                                218,
                                545,
                                392,
                                570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        218,
                                        545,
                                        392,
                                        570
                                    ],
                                    "score": 0.94,
                                    "content": "B_{c}=\\Theta\\left(\\frac{M}{d}\\right),\\qquadB_{r}=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},d\\right)\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 32.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                218,
                                545,
                                392,
                                557.5
                            ],
                            "spans": [],
                            "index": 32
                        },
                        {
                            "bbox": [
                                218,
                                557.5,
                                392,
                                570.0
                            ],
                            "spans": [],
                            "index": 33
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        577,
                        134,
                        589
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                579,
                                133,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        579,
                                        133,
                                        588
                                    ],
                                    "score": 1.0,
                                    "content": "We then have:",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 34
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        263,
                        587,
                        348,
                        613
                    ],
                    "lines": [
                        {
                            "bbox": [
                                263,
                                587,
                                348,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        263,
                                        587,
                                        348,
                                        613
                                    ],
                                    "score": 0.95,
                                    "content": "T_{c}=\\frac{N}{B_{c}}=\\Theta\\left(\\frac{N d}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 35.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                263,
                                587,
                                348,
                                600.0
                            ],
                            "spans": [],
                            "index": 35
                        },
                        {
                            "bbox": [
                                263,
                                600.0,
                                348,
                                613.0
                            ],
                            "spans": [],
                            "index": 36
                        }
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        616,
                        280,
                        629
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                617,
                                279,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        617,
                                        279,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "As a result, the number of HBM accesses is:",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        255,
                        638,
                        356,
                        664
                    ],
                    "lines": [
                        {
                            "bbox": [
                                255,
                                638,
                                356,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        255,
                                        638,
                                        356,
                                        664
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d T_{c}\\right)=\\Theta\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 38.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                255,
                                638,
                                356,
                                651.0
                            ],
                            "spans": [],
                            "index": 38
                        },
                        {
                            "bbox": [
                                255,
                                651.0,
                                356,
                                664.0
                            ],
                            "spans": [],
                            "index": 39
                        }
                    ]
                }
            ],
            "layout_bboxes": [],
            "page_idx": 23,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        174,
                        83,
                        436,
                        108
                    ],
                    "lines": [
                        {
                            "bbox": [
                                174,
                                83,
                                436,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        174,
                                        83,
                                        436,
                                        108
                                    ],
                                    "score": 0.92,
                                    "content": "B_{c}=\\Theta\\left(\\frac{M}{d}\\right),\\qquadB_{r}=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},\\frac{M}{B_{c}}\\right)\\right)=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},d\\right)\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                174,
                                83,
                                436,
                                91.33333333333333
                            ],
                            "spans": [],
                            "index": 1
                        },
                        {
                            "bbox": [
                                174,
                                91.33333333333333,
                                436,
                                99.66666666666666
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                174,
                                99.66666666666666,
                                436,
                                107.99999999999999
                            ],
                            "spans": [],
                            "index": 3
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        263,
                        122,
                        348,
                        147
                    ],
                    "lines": [
                        {
                            "bbox": [
                                263,
                                122,
                                348,
                                147
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        263,
                                        122,
                                        348,
                                        147
                                    ],
                                    "score": 0.95,
                                    "content": "T_{c}=\\frac{N}{B_{c}}=\\Theta\\left(\\frac{N d}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 5.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                263,
                                122,
                                348,
                                134.5
                            ],
                            "spans": [],
                            "index": 5
                        },
                        {
                            "bbox": [
                                263,
                                134.5,
                                348,
                                147.0
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        255,
                        173,
                        356,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                255,
                                173,
                                356,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        255,
                                        173,
                                        356,
                                        198
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d T_{c}\\right)=\\Theta\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 8.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                255,
                                173,
                                356,
                                185.5
                            ],
                            "spans": [],
                            "index": 8
                        },
                        {
                            "bbox": [
                                255,
                                185.5,
                                356,
                                198.0
                            ],
                            "spans": [],
                            "index": 9
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        282,
                        258,
                        329,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                282,
                                258,
                                329,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        282,
                                        258,
                                        329,
                                        284
                                    ],
                                    "score": 0.93,
                                    "content": "o\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 12.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                282,
                                258,
                                329,
                                271.0
                            ],
                            "spans": [],
                            "index": 12
                        },
                        {
                            "bbox": [
                                282,
                                271.0,
                                329,
                                284.0
                            ],
                            "spans": [],
                            "index": 13
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        264,
                        313,
                        347,
                        339
                    ],
                    "lines": [
                        {
                            "bbox": [
                                264,
                                313,
                                347,
                                339
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        264,
                                        313,
                                        347,
                                        339
                                    ],
                                    "score": 0.94,
                                    "content": "o\\left(\\frac{N^{2}d^{2}}{N d}\\right)=o(N d).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 15.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                264,
                                313,
                                347,
                                326.0
                            ],
                            "spans": [],
                            "index": 15
                        },
                        {
                            "bbox": [
                                264,
                                326.0,
                                347,
                                339.0
                            ],
                            "spans": [],
                            "index": 16
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        218,
                        545,
                        392,
                        570
                    ],
                    "lines": [
                        {
                            "bbox": [
                                218,
                                545,
                                392,
                                570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        218,
                                        545,
                                        392,
                                        570
                                    ],
                                    "score": 0.94,
                                    "content": "B_{c}=\\Theta\\left(\\frac{M}{d}\\right),\\qquadB_{r}=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},d\\right)\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 32.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                218,
                                545,
                                392,
                                557.5
                            ],
                            "spans": [],
                            "index": 32
                        },
                        {
                            "bbox": [
                                218,
                                557.5,
                                392,
                                570.0
                            ],
                            "spans": [],
                            "index": 33
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        263,
                        587,
                        348,
                        613
                    ],
                    "lines": [
                        {
                            "bbox": [
                                263,
                                587,
                                348,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        263,
                                        587,
                                        348,
                                        613
                                    ],
                                    "score": 0.95,
                                    "content": "T_{c}=\\frac{N}{B_{c}}=\\Theta\\left(\\frac{N d}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 35.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                263,
                                587,
                                348,
                                600.0
                            ],
                            "spans": [],
                            "index": 35
                        },
                        {
                            "bbox": [
                                263,
                                600.0,
                                348,
                                613.0
                            ],
                            "spans": [],
                            "index": 36
                        }
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        255,
                        638,
                        356,
                        664
                    ],
                    "lines": [
                        {
                            "bbox": [
                                255,
                                638,
                                356,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        255,
                                        638,
                                        356,
                                        664
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d T_{c}\\right)=\\Theta\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 38.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                255,
                                638,
                                356,
                                651.0
                            ],
                            "spans": [],
                            "index": 38
                        },
                        {
                            "bbox": [
                                255,
                                651.0,
                                356,
                                664.0
                            ],
                            "spans": [],
                            "index": 39
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "24",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        532,
                        672,
                        541,
                        681
                    ],
                    "lines": [
                        {
                            "bbox": [
                                532,
                                673,
                                541,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        532,
                                        673,
                                        541,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "□",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        532,
                        206,
                        541,
                        216
                    ],
                    "lines": [
                        {
                            "bbox": [
                                533,
                                208,
                                541,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        533,
                                        208,
                                        541,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "□",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        532,
                        374,
                        540,
                        382
                    ],
                    "lines": [
                        {
                            "bbox": [
                                532,
                                374,
                                542,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        532,
                                        374,
                                        542,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "□",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        70,
                        73,
                        146,
                        85
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                74,
                                146,
                                84
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        74,
                                        146,
                                        84
                                    ],
                                    "score": 1.0,
                                    "content": "We therefore set:",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        74,
                        146,
                        84
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        174,
                        83,
                        436,
                        108
                    ],
                    "lines": [
                        {
                            "bbox": [
                                174,
                                83,
                                436,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        174,
                                        83,
                                        436,
                                        108
                                    ],
                                    "score": 0.92,
                                    "content": "B_{c}=\\Theta\\left(\\frac{M}{d}\\right),\\qquadB_{r}=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},\\frac{M}{B_{c}}\\right)\\right)=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},d\\right)\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "virtual_lines": [
                        {
                            "bbox": [
                                174,
                                83,
                                436,
                                91.33333333333333
                            ],
                            "spans": [],
                            "index": 1
                        },
                        {
                            "bbox": [
                                174,
                                91.33333333333333,
                                436,
                                99.66666666666666
                            ],
                            "spans": [],
                            "index": 2
                        },
                        {
                            "bbox": [
                                174,
                                99.66666666666666,
                                436,
                                107.99999999999999
                            ],
                            "spans": [],
                            "index": 3
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        112,
                        134,
                        124
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                113,
                                134,
                                123
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        113,
                                        134,
                                        123
                                    ],
                                    "score": 1.0,
                                    "content": "We then have:",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        113,
                        134,
                        123
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        263,
                        122,
                        348,
                        147
                    ],
                    "lines": [
                        {
                            "bbox": [
                                263,
                                122,
                                348,
                                147
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        263,
                                        122,
                                        348,
                                        147
                                    ],
                                    "score": 0.95,
                                    "content": "T_{c}=\\frac{N}{B_{c}}=\\Theta\\left(\\frac{N d}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 5.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                263,
                                122,
                                348,
                                134.5
                            ],
                            "spans": [],
                            "index": 5
                        },
                        {
                            "bbox": [
                                263,
                                134.5,
                                348,
                                147.0
                            ],
                            "spans": [],
                            "index": 6
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        151,
                        279,
                        163
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                152,
                                279,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        152,
                                        279,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "As a result, the number of HBM accesses is:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        87,
                        152,
                        279,
                        162
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        255,
                        173,
                        356,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                255,
                                173,
                                356,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        255,
                                        173,
                                        356,
                                        198
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d T_{c}\\right)=\\Theta\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 8.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                255,
                                173,
                                356,
                                185.5
                            ],
                            "spans": [],
                            "index": 8
                        },
                        {
                            "bbox": [
                                255,
                                185.5,
                                356,
                                198.0
                            ],
                            "spans": [],
                            "index": 9
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        224,
                        540,
                        249
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                226,
                                541,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        226,
                                        541,
                                        236
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Proposition 3. For contradiction, suppose that there exists an algorithm that computes exact",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                237,
                                361,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        237,
                                        297,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "attention where the number for HBM access for all ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        297,
                                        239,
                                        349,
                                        248
                                    ],
                                    "score": 0.93,
                                    "content": "M\\in[d,N d]",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        350,
                                        237,
                                        361,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": " is",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        226,
                        541,
                        248
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        282,
                        258,
                        329,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                282,
                                258,
                                329,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        282,
                                        258,
                                        329,
                                        284
                                    ],
                                    "score": 0.93,
                                    "content": "o\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 12.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                282,
                                258,
                                329,
                                271.0
                            ],
                            "spans": [],
                            "index": 12
                        },
                        {
                            "bbox": [
                                282,
                                271.0,
                                329,
                                284.0
                            ],
                            "spans": [],
                            "index": 13
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        291,
                        408,
                        304
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                293,
                                408,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        293,
                                        159,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "In the regime of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        159,
                                        294,
                                        209,
                                        304
                                    ],
                                    "score": 0.91,
                                    "content": "M=\\Theta(N d)",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        209,
                                        293,
                                        408,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": ", this results in the number of HBM accesses:",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 14,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        293,
                        408,
                        304
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        264,
                        313,
                        347,
                        339
                    ],
                    "lines": [
                        {
                            "bbox": [
                                264,
                                313,
                                347,
                                339
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        264,
                                        313,
                                        347,
                                        339
                                    ],
                                    "score": 0.94,
                                    "content": "o\\left(\\frac{N^{2}d^{2}}{N d}\\right)=o(N d).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 15.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                264,
                                313,
                                347,
                                326.0
                            ],
                            "spans": [],
                            "index": 15
                        },
                        {
                            "bbox": [
                                264,
                                326.0,
                                347,
                                339.0
                            ],
                            "spans": [],
                            "index": 16
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        347,
                        542,
                        383
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                347,
                                541,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        347,
                                        256,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "However, the input to attention (matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        256,
                                        349,
                                        288,
                                        359
                                    ],
                                    "score": 0.79,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 32
                                },
                                {
                                    "bbox": [
                                        288,
                                        347,
                                        363,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": ") and the output ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        363,
                                        350,
                                        371,
                                        357
                                    ],
                                    "score": 0.56,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        371,
                                        347,
                                        415,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": " have size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        416,
                                        350,
                                        430,
                                        357
                                    ],
                                    "score": 0.83,
                                    "content": "N d",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        430,
                                        347,
                                        541,
                                        360
                                    ],
                                    "score": 1.0,
                                    "content": "and they start out being",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                360,
                                542,
                                372
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        360,
                                        401,
                                        372
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, so if the algorithm computes exact attention it must incur at least ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        401,
                                        362,
                                        431,
                                        371
                                    ],
                                    "score": 0.93,
                                    "content": "\\Omega(N d)",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        431,
                                        360,
                                        542,
                                        372
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses. This is a",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                374,
                                132,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        374,
                                        132,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "contradiction.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 18,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        347,
                        542,
                        383
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        390,
                        542,
                        415
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                392,
                                542,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        392,
                                        542,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Theorem 5. The IO complexity of the attention backward is very similar to the IO complexity of",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                72,
                                403,
                                397,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        403,
                                        397,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "the attention forward (Theorem 2). Here we provide a sketch of the proof.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 20.5,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        392,
                        542,
                        415
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        415,
                        538,
                        439
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                414,
                                540,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        414,
                                        455,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "We first analyze the IO complexity of standard attention backward pass. The inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        456,
                                        415,
                                        540,
                                        427
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{Q},\\mathbf{K},\\mathbf{V},\\mathbf{dO}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 84
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                68,
                                425,
                                532,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        425,
                                        352,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "reside in HBM, and the at the end of the algorithm the outputs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        353,
                                        427,
                                        437,
                                        439
                                    ],
                                    "score": 0.44,
                                    "content": "\\mathbf{dQ},\\mathbf{dK},\\mathbf{dV}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 84
                                },
                                {
                                    "bbox": [
                                        437,
                                        425,
                                        532,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "are written to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 22.5,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        414,
                        540,
                        440
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        77,
                        439,
                        540,
                        462
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                439,
                                540,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        439,
                                        473,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "At each step of the standard attention backward pass, one needs to load inputs of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        473,
                                        440,
                                        488,
                                        449
                                    ],
                                    "score": 0.72,
                                    "content": "N d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        488,
                                        439,
                                        502,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "or",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        502,
                                        440,
                                        515,
                                        449
                                    ],
                                    "score": 0.89,
                                    "content": "N^{2}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        516,
                                        439,
                                        540,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": " from",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                75,
                                451,
                                527,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        451,
                                        268,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "HBM, and needs to write the outputs of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        269,
                                        452,
                                        281,
                                        461
                                    ],
                                    "score": 0.91,
                                    "content": "N^{2}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        282,
                                        451,
                                        296,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": " or",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        297,
                                        453,
                                        311,
                                        461
                                    ],
                                    "score": 0.88,
                                    "content": "N d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        311,
                                        451,
                                        407,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM. This incurs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        407,
                                        452,
                                        459,
                                        462
                                    ],
                                    "score": 0.91,
                                    "content": "\\Theta(N d+N^{2})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        459,
                                        451,
                                        527,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": " HBM accesses.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 24.5,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        75,
                        439,
                        540,
                        463
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        83,
                        463,
                        407,
                        474
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                464,
                                404,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        464,
                                        404,
                                        475
                                    ],
                                    "score": 1.0,
                                    "content": "We now analyze the IO complexity of FlashAttention backward pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        86,
                        464,
                        404,
                        475
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        475,
                        542,
                        522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                475,
                                542,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        475,
                                        309,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "Similar to Theorem 2, we see that each element of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        309,
                                        478,
                                        317,
                                        485
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        317,
                                        475,
                                        339,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        340,
                                        478,
                                        348,
                                        485
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        348,
                                        475,
                                        542,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": " is loaded from HBM once. Each element of",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                488,
                                541,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        488,
                                        295,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "dK and dV is only written to HBM once. We make ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        295,
                                        490,
                                        304,
                                        498
                                    ],
                                    "score": 0.9,
                                    "content": "T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        305,
                                        488,
                                        358,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        358,
                                        489,
                                        395,
                                        499
                                    ],
                                    "score": 0.47,
                                    "content": "\\mathbf{Q},\\mathbf{O},\\mathbf{dO}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 37
                                },
                                {
                                    "bbox": [
                                        396,
                                        488,
                                        541,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": ", each pass loading all of Q, O, dO",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                500,
                                541,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        500,
                                        175,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM. We also make ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        175,
                                        502,
                                        185,
                                        510
                                    ],
                                    "score": 0.91,
                                    "content": "T_{c}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        185,
                                        500,
                                        239,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "passes over ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        239,
                                        501,
                                        252,
                                        510
                                    ],
                                    "score": 0.35,
                                    "content": "{\\bf d Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        253,
                                        500,
                                        541,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": ", each pass reading/writing all of dQ from/to HBM. Therefore the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                512,
                                310,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        512,
                                        193,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": "number of HBM accesses is ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        194,
                                        513,
                                        307,
                                        522
                                    ],
                                    "score": 0.92,
                                    "content": "\\Theta\\left(N d+N d T_{c}\\right)=\\Theta(N d T_{c})",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 113
                                },
                                {
                                    "bbox": [
                                        307,
                                        512,
                                        310,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 28.5,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        475,
                        542,
                        523
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        84,
                        523,
                        407,
                        534
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                524,
                                406,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        524,
                                        406,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "As in the proof of Theorem 2, the constraints on the block sizes are that:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        87,
                        524,
                        406,
                        534
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        218,
                        545,
                        392,
                        570
                    ],
                    "lines": [
                        {
                            "bbox": [
                                218,
                                545,
                                392,
                                570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        218,
                                        545,
                                        392,
                                        570
                                    ],
                                    "score": 0.94,
                                    "content": "B_{c}=\\Theta\\left(\\frac{M}{d}\\right),\\qquadB_{r}=\\Theta\\left(\\operatorname*{min}\\left(\\frac{M}{d},d\\right)\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 32.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                218,
                                545,
                                392,
                                557.5
                            ],
                            "spans": [],
                            "index": 32
                        },
                        {
                            "bbox": [
                                218,
                                557.5,
                                392,
                                570.0
                            ],
                            "spans": [],
                            "index": 33
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        577,
                        134,
                        589
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                579,
                                133,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        579,
                                        133,
                                        588
                                    ],
                                    "score": 1.0,
                                    "content": "We then have:",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 34,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        579,
                        133,
                        588
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        263,
                        587,
                        348,
                        613
                    ],
                    "lines": [
                        {
                            "bbox": [
                                263,
                                587,
                                348,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        263,
                                        587,
                                        348,
                                        613
                                    ],
                                    "score": 0.95,
                                    "content": "T_{c}=\\frac{N}{B_{c}}=\\Theta\\left(\\frac{N d}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 35.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                263,
                                587,
                                348,
                                600.0
                            ],
                            "spans": [],
                            "index": 35
                        },
                        {
                            "bbox": [
                                263,
                                600.0,
                                348,
                                613.0
                            ],
                            "spans": [],
                            "index": 36
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        86,
                        616,
                        280,
                        629
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                617,
                                279,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        617,
                                        279,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "As a result, the number of HBM accesses is:",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        87,
                        617,
                        279,
                        628
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        255,
                        638,
                        356,
                        664
                    ],
                    "lines": [
                        {
                            "bbox": [
                                255,
                                638,
                                356,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        255,
                                        638,
                                        356,
                                        664
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d T_{c}\\right)=\\Theta\\left(\\frac{N^{2}d^{2}}{M}\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 38.5,
                    "virtual_lines": [
                        {
                            "bbox": [
                                255,
                                638,
                                356,
                                651.0
                            ],
                            "spans": [],
                            "index": 38
                        },
                        {
                            "bbox": [
                                255,
                                651.0,
                                356,
                                664.0
                            ],
                            "spans": [],
                            "index": 39
                        }
                    ],
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        86,
                        543,
                        425
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                88,
                                542,
                                103
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        88,
                                        161,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        91,
                                        230,
                                        101
                                    ],
                                    "score": 0.9,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 69
                                },
                                {
                                    "bbox": [
                                        231,
                                        88,
                                        380,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, on-chip SRAM of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        380,
                                        93,
                                        390,
                                        100
                                    ],
                                    "score": 0.84,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        391,
                                        88,
                                        511,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ", softmax scaling constant ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        512,
                                        92,
                                        538,
                                        100
                                    ],
                                    "score": 0.86,
                                    "content": "\\tau\\in\\mathbb{R}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        538,
                                        88,
                                        542,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                86,
                                100,
                                542,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        100,
                                        294,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "masking function mask, dropout probability ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        294,
                                        106,
                                        317,
                                        114
                                    ],
                                    "score": 0.83,
                                    "content": "p_{\\mathrm{drop}}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        317,
                                        100,
                                        375,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": ", block sizes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        375,
                                        102,
                                        509,
                                        115
                                    ],
                                    "score": 0.92,
                                    "content": "\\begin{array}{r}{B_{c}=\\left\\lceil\\frac{M}{4d}\\right\\rceil,B_{r}=\\operatorname*{min}\\left(\\left\\lceil\\frac{M}{4d}\\right\\rceil,d\\right)}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 134
                                },
                                {
                                    "bbox": [
                                        509,
                                        100,
                                        542,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": ", block",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                86,
                                113,
                                249,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        113,
                                        249,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "sparsity mask 𝑀 ∈ {0, 1}𝑁 /𝐵𝑟×𝑁 /𝐵𝑐 ..",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                75,
                                127,
                                413,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        127,
                                        321,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": "1: Initialize the pseudo-random number generator state ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        321,
                                        129,
                                        329,
                                        137
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        329,
                                        127,
                                        413,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": " and save to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                74,
                                137,
                                403,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        137,
                                        129,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "2: Initialize ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        129,
                                        140,
                                        213,
                                        151
                                    ],
                                    "score": 0.83,
                                    "content": "{\\bf O}=(0)_{N\\times d}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 84
                                },
                                {
                                    "bbox": [
                                        213,
                                        137,
                                        216,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        216,
                                        140,
                                        358,
                                        151
                                    ],
                                    "score": 0.47,
                                    "content": "\\ell=(0)_{N}\\in\\mathbb{R}^{N},m=(-\\infty)_{N}\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 142
                                },
                                {
                                    "bbox": [
                                        358,
                                        137,
                                        403,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                76,
                                149,
                                539,
                                170
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        149,
                                        120,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "3: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        121,
                                        156,
                                        129,
                                        165
                                    ],
                                    "score": 0.81,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        129,
                                        149,
                                        152,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        152,
                                        151,
                                        194,
                                        169
                                    ],
                                    "score": 0.93,
                                    "content": "\\begin{array}{r}{T_{r}=\\left\\lceil\\frac{N}{B_{r}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 18,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        194,
                                        149,
                                        227,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        227,
                                        156,
                                        276,
                                        166
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{Q}_{1},\\ldots,\\mathbf{Q}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 49
                                },
                                {
                                    "bbox": [
                                        277,
                                        149,
                                        311,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        311,
                                        156,
                                        340,
                                        165
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        340,
                                        149,
                                        419,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "each, and divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        419,
                                        155,
                                        439,
                                        165
                                    ],
                                    "score": 0.79,
                                    "content": "\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        440,
                                        149,
                                        466,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": " in to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        467,
                                        151,
                                        509,
                                        170
                                    ],
                                    "score": 0.94,
                                    "content": "\\begin{array}{r}{T_{c}=\\left\\lceil\\frac{N}{B_{c}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 19,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        510,
                                        153,
                                        539,
                                        166
                                    ],
                                    "score": 1.0,
                                    "content": "blocks",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                88,
                                169,
                                302,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        170,
                                        138,
                                        180
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{K}_{1},\\ldots,\\mathbf{K}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        138,
                                        169,
                                        160,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        169,
                                        211,
                                        180
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{V}_{1},\\ldots,\\mathbf{V}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        211,
                                        169,
                                        246,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": ", of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        247,
                                        171,
                                        275,
                                        179
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}\\times d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        275,
                                        169,
                                        302,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                75,
                                180,
                                542,
                                193
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        180,
                                        119,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "4: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        120,
                                        182,
                                        127,
                                        190
                                    ],
                                    "score": 0.47,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        128,
                                        180,
                                        150,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        150,
                                        182,
                                        160,
                                        191
                                    ],
                                    "score": 0.82,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        160,
                                        180,
                                        192,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "blocks",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        193,
                                        181,
                                        241,
                                        192
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{O}_{i},\\ldots,\\mathbf{O}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        241,
                                        180,
                                        274,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        274,
                                        182,
                                        302,
                                        191
                                    ],
                                    "score": 0.91,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        303,
                                        180,
                                        360,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "each, divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        360,
                                        182,
                                        365,
                                        190
                                    ],
                                    "score": 0.88,
                                    "content": "\\ell",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        365,
                                        180,
                                        387,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        388,
                                        183,
                                        397,
                                        191
                                    ],
                                    "score": 0.9,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        397,
                                        180,
                                        430,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        430,
                                        181,
                                        471,
                                        192
                                    ],
                                    "score": 0.88,
                                    "content": "\\ell_{i},\\ldots,\\ell_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        471,
                                        180,
                                        504,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        504,
                                        181,
                                        515,
                                        191
                                    ],
                                    "score": 0.86,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        516,
                                        180,
                                        542,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "each,",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                86,
                                191,
                                313,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        191,
                                        117,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        117,
                                        196,
                                        126,
                                        201
                                    ],
                                    "score": 0.8,
                                    "content": "m",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        126,
                                        191,
                                        148,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        194,
                                        158,
                                        203
                                    ],
                                    "score": 0.87,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        158,
                                        191,
                                        191,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        194,
                                        241,
                                        204
                                    ],
                                    "score": 0.84,
                                    "content": "m_{1},\\ldots,m_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        241,
                                        191,
                                        274,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        275,
                                        195,
                                        286,
                                        203
                                    ],
                                    "score": 0.89,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        286,
                                        191,
                                        313,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                75,
                                203,
                                167,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        203,
                                        105,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "5: for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        105,
                                        206,
                                        150,
                                        215
                                    ],
                                    "score": 0.89,
                                    "content": "1\\leq j\\leq T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 45
                                },
                                {
                                    "bbox": [
                                        150,
                                        203,
                                        167,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                75,
                                216,
                                287,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        217,
                                        86,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "6:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        216,
                                        123,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        123,
                                        217,
                                        152,
                                        228
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{K}_{j},\\mathbf{V}_{j}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        152,
                                        216,
                                        287,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                75,
                                228,
                                175,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        229,
                                        86,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "7:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        97,
                                        228,
                                        115,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        229,
                                        157,
                                        239
                                    ],
                                    "score": 0.88,
                                    "content": "1\\leq i\\leq T_{r}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        158,
                                        228,
                                        175,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                75,
                                240,
                                180,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        241,
                                        86,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "8:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        107,
                                        240,
                                        118,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "if ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        119,
                                        240,
                                        152,
                                        252
                                    ],
                                    "score": 0.91,
                                    "content": "M_{i j}\\neq0",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 33
                                },
                                {
                                    "bbox": [
                                        153,
                                        240,
                                        180,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": " then",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                74,
                                252,
                                329,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        253,
                                        86,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "9:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        116,
                                        252,
                                        142,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "Load",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        143,
                                        252,
                                        195,
                                        263
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{Q}_{i},\\mathbf{O}_{i},\\ell_{i},m_{i}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        195,
                                        252,
                                        329,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                263,
                                297,
                                278
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        264,
                                        86,
                                        276
                                    ],
                                    "score": 1.0,
                                    "content": "10:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        263,
                                        198,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        263,
                                        295,
                                        278
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{S}_{i j}=\\tau\\mathbf{Q}_{i}\\mathbf{K}_{j}^{T}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 96
                                },
                                {
                                    "bbox": [
                                        295,
                                        263,
                                        297,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                275,
                                294,
                                295
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        279,
                                        86,
                                        291
                                    ],
                                    "score": 1.0,
                                    "content": "11:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        114,
                                        275,
                                        199,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        278,
                                        287,
                                        292
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{S}_{i j}^{\\mathrm{masked}}=\\mathrm{MASK}(\\mathbf{S}_{i j})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        288,
                                        275,
                                        294,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                288,
                                545,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        294,
                                        86,
                                        305
                                    ],
                                    "score": 1.0,
                                    "content": "12:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        288,
                                        200,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        201,
                                        291,
                                        529,
                                        307
                                    ],
                                    "score": 0.61,
                                    "content": "\\tilde{m}_{i j}=\\mathrm{rowmax}(\\mathbf{S}_{i j}^{\\mathrm{masked}})\\in\\mathbb{R}^{B r},\\tilde{\\mathbf{P}}_{i j}=\\mathrm{exp}(\\mathbf{S}_{i j}^{\\mathrm{masked}}-\\tilde{m}_{i j})\\in\\mathbb{R}^{B r\\times B_{c}}\\ (\\mathrm{pointwise}),",
                                    "type": "inline_equation",
                                    "height": 16,
                                    "width": 328
                                },
                                {
                                    "bbox": [
                                        529,
                                        288,
                                        545,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "e),",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                118,
                                306,
                                229,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        306,
                                        224,
                                        320
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\ell}_{i j}=\\mathrm{rowsum}(\\tilde{\\mathbf{P}}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 106
                                },
                                {
                                    "bbox": [
                                        224,
                                        306,
                                        229,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                318,
                                488,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        322,
                                        86,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "13:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        116,
                                        318,
                                        198,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        320,
                                        316,
                                        333
                                    ],
                                    "score": 0.84,
                                    "content": "m_{i}^{\\mathrm{new}}=\\operatorname*{max}(m_{i},\\tilde{m}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 117
                                },
                                {
                                    "bbox": [
                                        316,
                                        318,
                                        320,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        319,
                                        488,
                                        333
                                    ],
                                    "score": 0.67,
                                    "content": "\\ell_{i}^{\\mathrm{new}}=e^{m_{i}-m_{i}^{\\mathrm{new}}}\\ell_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\ell}_{i j}\\in\\mathbb{R}^{B_{r}}.",
                                    "type": "inline_equation"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                328,
                                336,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        336,
                                        86,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "14:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        114,
                                        328,
                                        198,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        198,
                                        334,
                                        328,
                                        348
                                    ],
                                    "score": 0.9,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}^{\\mathrm{dropped}}=\\mathrm{dropout}(\\tilde{\\mathbf{P}}_{i j},p_{\\mathrm{drop}})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 130
                                },
                                {
                                    "bbox": [
                                        329,
                                        328,
                                        336,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                346,
                                459,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        351,
                                        86,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "15:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        346,
                                        145,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        349,
                                        413,
                                        365
                                    ],
                                    "score": 0.87,
                                    "content": " \\mathbf{0}_{i}\\gets\\mathrm{diag}(\\ell_{i}^{\\mathrm{new}})^{-1}(\\mathrm{diag}(\\ell_{i})e^{m_{i}-m_{i}^{\\mathrm{new}}}\\mathbf{0}_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\mathbf{P}}_{i j}^{\\mathrm{dropped}}\\mathbf{V}_{j})",
                                    "type": "inline_equation",
                                    "height": 16,
                                    "width": 268
                                },
                                {
                                    "bbox": [
                                        414,
                                        346,
                                        459,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                361,
                                286,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        363,
                                        87,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "16:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        116,
                                        361,
                                        145,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        146,
                                        364,
                                        187,
                                        375
                                    ],
                                    "score": 0.87,
                                    "content": "\\ell_{i}\\gets\\ell_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        188,
                                        361,
                                        192,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        192,
                                        364,
                                        242,
                                        375
                                    ],
                                    "score": 0.87,
                                    "content": "m_{i}\\gets m_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        242,
                                        361,
                                        286,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                374,
                                140,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        375,
                                        86,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "17:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        106,
                                        374,
                                        140,
                                        386
                                    ],
                                    "score": 1.0,
                                    "content": "end if",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                386,
                                136,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        387,
                                        86,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "18:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        386,
                                        136,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "end for",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                399,
                                126,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        399,
                                        126,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "19: end for",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                72,
                                410,
                                165,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        410,
                                        122,
                                        421
                                    ],
                                    "score": 1.0,
                                    "content": "20: Return ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        411,
                                        162,
                                        421
                                    ],
                                    "score": 0.8,
                                    "content": "\\mathbf{0},\\ell,m,\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 40
                                },
                                {
                                    "bbox": [
                                        162,
                                        410,
                                        165,
                                        421
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 12.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        441,
                        222,
                        458
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                443,
                                221,
                                457
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        443,
                                        86,
                                        457
                                    ],
                                    "score": 1.0,
                                    "content": "D",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        444,
                                        221,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "Extension Details",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        468,
                        291,
                        482
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                468,
                                291,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        468,
                                        95,
                                        481
                                    ],
                                    "score": 1.0,
                                    "content": "D.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        291,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "Block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        487,
                        541,
                        511
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                489,
                                541,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        489,
                                        541,
                                        500
                                    ],
                                    "score": 1.0,
                                    "content": "We describe the full block-sparse FlashAttention algorithm in Algorithm 5. The algorithm is identical",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                501,
                                282,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        501,
                                        282,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "to Algorithm 2, except that we skip zero blocks.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 28.5
                },
                {
                    "type": "text",
                    "bbox": [
                        85,
                        512,
                        365,
                        524
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                513,
                                364,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        513,
                                        364,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": "We prove the IO-complexity of block-sparse FlashAttention.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        531,
                        541,
                        579
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                532,
                                541,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        532,
                                        541,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Proposition 4. The proof is very similar to the proof of Theorem 2. For the block-sparse case, notice",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                543,
                                540,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        543,
                                        540,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "that we only need to load blocks corresponding to nonzero blocks. As a result, the number of HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                72,
                                557,
                                540,
                                567
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        557,
                                        130,
                                        567
                                    ],
                                    "score": 1.0,
                                    "content": "are scaled by ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        131,
                                        561,
                                        135,
                                        565
                                    ],
                                    "score": 0.83,
                                    "content": "s",
                                    "type": "inline_equation",
                                    "height": 4,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        136,
                                        557,
                                        517,
                                        567
                                    ],
                                    "score": 1.0,
                                    "content": ", the fraction of nonzero blocks in the block-sparsity mask. However, for small values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        518,
                                        561,
                                        522,
                                        565
                                    ],
                                    "score": 0.85,
                                    "content": "s",
                                    "type": "inline_equation",
                                    "height": 4,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        523,
                                        557,
                                        540,
                                        567
                                    ],
                                    "score": 1.0,
                                    "content": ", we",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                567,
                                459,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        567,
                                        225,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "would still need to write the result ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        569,
                                        268,
                                        577
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        268,
                                        567,
                                        459,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": ". Therefore the number of HBM accesses is",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 32.5
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        267,
                        587,
                        343,
                        613
                    ],
                    "lines": [
                        {
                            "bbox": [
                                267,
                                587,
                                343,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        267,
                                        587,
                                        343,
                                        613
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d+\\frac{N^{2}d^{2}}{M}s\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 35,
                    "virtual_lines": [
                        {
                            "bbox": [
                                267,
                                587,
                                343,
                                613
                            ],
                            "spans": [],
                            "index": 35
                        }
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        645,
                        228,
                        659
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                646,
                                227,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        646,
                                        94,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "D.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        646,
                                        227,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "Potential Extensions",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        665,
                        530,
                        677
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                666,
                                526,
                                678
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        666,
                                        526,
                                        678
                                    ],
                                    "score": 1.0,
                                    "content": "We discuss here a few potential extensions of the IO-aware approach to speed up deep learning training.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        678,
                        540,
                        713
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                677,
                                541,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        677,
                                        541,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-GPU Attention. Large language models are trained on hundreds or thousands of GPUs, and",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                689,
                                541,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        689,
                                        541,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "one typically splits the attention computation between 4-8 GPUs on the same node [77]. This introduces",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                701,
                                541,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        701,
                                        541,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "another level of memory hierarchy: beside GPU SRAM and GPU HBM, we also have the HBM of other",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 39
                }
            ],
            "layout_bboxes": [],
            "page_idx": 24,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [
                {
                    "type": "interline_equation",
                    "bbox": [
                        267,
                        587,
                        343,
                        613
                    ],
                    "lines": [
                        {
                            "bbox": [
                                267,
                                587,
                                343,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        267,
                                        587,
                                        343,
                                        613
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d+\\frac{N^{2}d^{2}}{M}s\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 35,
                    "virtual_lines": [
                        {
                            "bbox": [
                                267,
                                587,
                                343,
                                613
                            ],
                            "spans": [],
                            "index": 35
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "25",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        532,
                        621,
                        541,
                        630
                    ],
                    "lines": [
                        {
                            "bbox": [
                                532,
                                622,
                                541,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        532,
                                        622,
                                        541,
                                        631
                                    ],
                                    "score": 1.0,
                                    "content": "□",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        70,
                        73,
                        323,
                        84
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                73,
                                323,
                                85
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        73,
                                        323,
                                        85
                                    ],
                                    "score": 1.0,
                                    "content": "Algorithm 5 Block-Sparse FlashAttention Forward Pass",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        72,
                        86,
                        543,
                        425
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                88,
                                542,
                                103
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        88,
                                        161,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "Require: Matrices ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        91,
                                        230,
                                        101
                                    ],
                                    "score": 0.9,
                                    "content": "{\\bf Q},{\\bf K},{\\bf V}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 69
                                },
                                {
                                    "bbox": [
                                        231,
                                        88,
                                        380,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM, on-chip SRAM of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        380,
                                        93,
                                        390,
                                        100
                                    ],
                                    "score": 0.84,
                                    "content": "M",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        391,
                                        88,
                                        511,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ", softmax scaling constant ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        512,
                                        92,
                                        538,
                                        100
                                    ],
                                    "score": 0.86,
                                    "content": "\\tau\\in\\mathbb{R}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        538,
                                        88,
                                        542,
                                        103
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                86,
                                100,
                                542,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        100,
                                        294,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "masking function mask, dropout probability ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        294,
                                        106,
                                        317,
                                        114
                                    ],
                                    "score": 0.83,
                                    "content": "p_{\\mathrm{drop}}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 23
                                },
                                {
                                    "bbox": [
                                        317,
                                        100,
                                        375,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": ", block sizes ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        375,
                                        102,
                                        509,
                                        115
                                    ],
                                    "score": 0.92,
                                    "content": "\\begin{array}{r}{B_{c}=\\left\\lceil\\frac{M}{4d}\\right\\rceil,B_{r}=\\operatorname*{min}\\left(\\left\\lceil\\frac{M}{4d}\\right\\rceil,d\\right)}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 134
                                },
                                {
                                    "bbox": [
                                        509,
                                        100,
                                        542,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": ", block",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                86,
                                113,
                                249,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        113,
                                        249,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "sparsity mask 𝑀 ∈ {0, 1}𝑁 /𝐵𝑟×𝑁 /𝐵𝑐 ..",
                                    "type": "text"
                                }
                            ],
                            "index": 2,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                127,
                                413,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        127,
                                        321,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": "1: Initialize the pseudo-random number generator state ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        321,
                                        129,
                                        329,
                                        137
                                    ],
                                    "score": 0.89,
                                    "content": "\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        329,
                                        127,
                                        413,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": " and save to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                74,
                                137,
                                403,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        137,
                                        129,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "2: Initialize ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        129,
                                        140,
                                        213,
                                        151
                                    ],
                                    "score": 0.83,
                                    "content": "{\\bf O}=(0)_{N\\times d}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 84
                                },
                                {
                                    "bbox": [
                                        213,
                                        137,
                                        216,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        216,
                                        140,
                                        358,
                                        151
                                    ],
                                    "score": 0.47,
                                    "content": "\\ell=(0)_{N}\\in\\mathbb{R}^{N},m=(-\\infty)_{N}\\in\\mathbb{R}^{N}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 142
                                },
                                {
                                    "bbox": [
                                        358,
                                        137,
                                        403,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "in HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                76,
                                149,
                                539,
                                170
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        149,
                                        120,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "3: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        121,
                                        156,
                                        129,
                                        165
                                    ],
                                    "score": 0.81,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        129,
                                        149,
                                        152,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        152,
                                        151,
                                        194,
                                        169
                                    ],
                                    "score": 0.93,
                                    "content": "\\begin{array}{r}{T_{r}=\\left\\lceil\\frac{N}{B_{r}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 18,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        194,
                                        149,
                                        227,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        227,
                                        156,
                                        276,
                                        166
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{Q}_{1},\\ldots,\\mathbf{Q}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 49
                                },
                                {
                                    "bbox": [
                                        277,
                                        149,
                                        311,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        311,
                                        156,
                                        340,
                                        165
                                    ],
                                    "score": 0.92,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        340,
                                        149,
                                        419,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "each, and divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        419,
                                        155,
                                        439,
                                        165
                                    ],
                                    "score": 0.79,
                                    "content": "\\mathbf{K},\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        440,
                                        149,
                                        466,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": " in to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        467,
                                        151,
                                        509,
                                        170
                                    ],
                                    "score": 0.94,
                                    "content": "\\begin{array}{r}{T_{c}=\\left\\lceil\\frac{N}{B_{c}}\\right\\rceil}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 19,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        510,
                                        153,
                                        539,
                                        166
                                    ],
                                    "score": 1.0,
                                    "content": "blocks",
                                    "type": "text"
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                88,
                                169,
                                302,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        170,
                                        138,
                                        180
                                    ],
                                    "score": 0.9,
                                    "content": "\\mathbf{K}_{1},\\ldots,\\mathbf{K}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        138,
                                        169,
                                        160,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        161,
                                        169,
                                        211,
                                        180
                                    ],
                                    "score": 0.87,
                                    "content": "\\mathbf{V}_{1},\\ldots,\\mathbf{V}_{T_{c}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        211,
                                        169,
                                        246,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": ", of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        247,
                                        171,
                                        275,
                                        179
                                    ],
                                    "score": 0.91,
                                    "content": "B_{c}\\times d",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        275,
                                        169,
                                        302,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                180,
                                542,
                                193
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        180,
                                        119,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "4: Divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        120,
                                        182,
                                        127,
                                        190
                                    ],
                                    "score": 0.47,
                                    "content": "\\mathbf{0}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        128,
                                        180,
                                        150,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": " into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        150,
                                        182,
                                        160,
                                        191
                                    ],
                                    "score": 0.82,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        160,
                                        180,
                                        192,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "blocks",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        193,
                                        181,
                                        241,
                                        192
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{O}_{i},\\ldots,\\mathbf{O}_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 48
                                },
                                {
                                    "bbox": [
                                        241,
                                        180,
                                        274,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        274,
                                        182,
                                        302,
                                        191
                                    ],
                                    "score": 0.91,
                                    "content": "B_{r}\\times d",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 28
                                },
                                {
                                    "bbox": [
                                        303,
                                        180,
                                        360,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "each, divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        360,
                                        182,
                                        365,
                                        190
                                    ],
                                    "score": 0.88,
                                    "content": "\\ell",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        365,
                                        180,
                                        387,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        388,
                                        183,
                                        397,
                                        191
                                    ],
                                    "score": 0.9,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        397,
                                        180,
                                        430,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        430,
                                        181,
                                        471,
                                        192
                                    ],
                                    "score": 0.88,
                                    "content": "\\ell_{i},\\ldots,\\ell_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        471,
                                        180,
                                        504,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        504,
                                        181,
                                        515,
                                        191
                                    ],
                                    "score": 0.86,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        516,
                                        180,
                                        542,
                                        193
                                    ],
                                    "score": 1.0,
                                    "content": "each,",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                86,
                                191,
                                313,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        191,
                                        117,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "divide ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        117,
                                        196,
                                        126,
                                        201
                                    ],
                                    "score": 0.8,
                                    "content": "m",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        126,
                                        191,
                                        148,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "into ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        194,
                                        158,
                                        203
                                    ],
                                    "score": 0.87,
                                    "content": "T_{r}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        158,
                                        191,
                                        191,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "blocks ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        194,
                                        241,
                                        204
                                    ],
                                    "score": 0.84,
                                    "content": "m_{1},\\ldots,m_{T_{r}}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        241,
                                        191,
                                        274,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "of size",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        275,
                                        195,
                                        286,
                                        203
                                    ],
                                    "score": 0.89,
                                    "content": "B_{r}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        286,
                                        191,
                                        313,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "each.",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                203,
                                167,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        203,
                                        105,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "5: for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        105,
                                        206,
                                        150,
                                        215
                                    ],
                                    "score": 0.89,
                                    "content": "1\\leq j\\leq T_{c}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 45
                                },
                                {
                                    "bbox": [
                                        150,
                                        203,
                                        167,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                216,
                                287,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        217,
                                        86,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "6:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        216,
                                        123,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "Load ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        123,
                                        217,
                                        152,
                                        228
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{K}_{j},\\mathbf{V}_{j}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        152,
                                        216,
                                        287,
                                        229
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                228,
                                175,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        229,
                                        86,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "7:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        97,
                                        228,
                                        115,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        229,
                                        157,
                                        239
                                    ],
                                    "score": 0.88,
                                    "content": "1\\leq i\\leq T_{r}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 42
                                },
                                {
                                    "bbox": [
                                        158,
                                        228,
                                        175,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "do",
                                    "type": "text"
                                }
                            ],
                            "index": 11,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                75,
                                240,
                                180,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        241,
                                        86,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "8:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        107,
                                        240,
                                        118,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "if ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        119,
                                        240,
                                        152,
                                        252
                                    ],
                                    "score": 0.91,
                                    "content": "M_{i j}\\neq0",
                                    "type": "inline_equation",
                                    "height": 12,
                                    "width": 33
                                },
                                {
                                    "bbox": [
                                        153,
                                        240,
                                        180,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": " then",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                74,
                                252,
                                329,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        253,
                                        86,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "9:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        116,
                                        252,
                                        142,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "Load",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        143,
                                        252,
                                        195,
                                        263
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{Q}_{i},\\mathbf{O}_{i},\\ell_{i},m_{i}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        195,
                                        252,
                                        329,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "from HBM to on-chip SRAM.",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                263,
                                297,
                                278
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        264,
                                        86,
                                        276
                                    ],
                                    "score": 1.0,
                                    "content": "10:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        263,
                                        198,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        263,
                                        295,
                                        278
                                    ],
                                    "score": 0.91,
                                    "content": "\\mathbf{S}_{i j}=\\tau\\mathbf{Q}_{i}\\mathbf{K}_{j}^{T}\\in\\mathbb{R}^{B_{r}\\times B_{c}}",
                                    "type": "inline_equation",
                                    "height": 15,
                                    "width": 96
                                },
                                {
                                    "bbox": [
                                        295,
                                        263,
                                        297,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                275,
                                294,
                                295
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        279,
                                        86,
                                        291
                                    ],
                                    "score": 1.0,
                                    "content": "11:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        114,
                                        275,
                                        199,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        278,
                                        287,
                                        292
                                    ],
                                    "score": 0.88,
                                    "content": "\\mathbf{S}_{i j}^{\\mathrm{masked}}=\\mathrm{MASK}(\\mathbf{S}_{i j})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 88
                                },
                                {
                                    "bbox": [
                                        288,
                                        275,
                                        294,
                                        295
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                288,
                                545,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        294,
                                        86,
                                        305
                                    ],
                                    "score": 1.0,
                                    "content": "12:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        288,
                                        200,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        201,
                                        291,
                                        529,
                                        307
                                    ],
                                    "score": 0.61,
                                    "content": "\\tilde{m}_{i j}=\\mathrm{rowmax}(\\mathbf{S}_{i j}^{\\mathrm{masked}})\\in\\mathbb{R}^{B r},\\tilde{\\mathbf{P}}_{i j}=\\mathrm{exp}(\\mathbf{S}_{i j}^{\\mathrm{masked}}-\\tilde{m}_{i j})\\in\\mathbb{R}^{B r\\times B_{c}}\\ (\\mathrm{pointwise}),",
                                    "type": "inline_equation",
                                    "height": 16,
                                    "width": 328
                                },
                                {
                                    "bbox": [
                                        529,
                                        288,
                                        545,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "e),",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                118,
                                306,
                                229,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        306,
                                        224,
                                        320
                                    ],
                                    "score": 0.91,
                                    "content": "\\tilde{\\ell}_{i j}=\\mathrm{rowsum}(\\tilde{\\mathbf{P}}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 106
                                },
                                {
                                    "bbox": [
                                        224,
                                        306,
                                        229,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                318,
                                488,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        322,
                                        86,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "13:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        116,
                                        318,
                                        198,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        320,
                                        316,
                                        333
                                    ],
                                    "score": 0.84,
                                    "content": "m_{i}^{\\mathrm{new}}=\\operatorname*{max}(m_{i},\\tilde{m}_{i j})\\in\\mathbb{R}^{B_{r}}",
                                    "type": "inline_equation",
                                    "height": 13,
                                    "width": 117
                                },
                                {
                                    "bbox": [
                                        316,
                                        318,
                                        320,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        319,
                                        488,
                                        333
                                    ],
                                    "score": 0.67,
                                    "content": "\\ell_{i}^{\\mathrm{new}}=e^{m_{i}-m_{i}^{\\mathrm{new}}}\\ell_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\ell}_{i j}\\in\\mathbb{R}^{B_{r}}.",
                                    "type": "inline_equation"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                328,
                                336,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        336,
                                        86,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "14:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        114,
                                        328,
                                        198,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": "On chip, compute",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        198,
                                        334,
                                        328,
                                        348
                                    ],
                                    "score": 0.9,
                                    "content": "\\tilde{\\mathbf{P}}_{i j}^{\\mathrm{dropped}}=\\mathrm{dropout}(\\tilde{\\mathbf{P}}_{i j},p_{\\mathrm{drop}})",
                                    "type": "inline_equation",
                                    "height": 14,
                                    "width": 130
                                },
                                {
                                    "bbox": [
                                        329,
                                        328,
                                        336,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                346,
                                459,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        351,
                                        86,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "15:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        115,
                                        346,
                                        145,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        145,
                                        349,
                                        413,
                                        365
                                    ],
                                    "score": 0.87,
                                    "content": " \\mathbf{0}_{i}\\gets\\mathrm{diag}(\\ell_{i}^{\\mathrm{new}})^{-1}(\\mathrm{diag}(\\ell_{i})e^{m_{i}-m_{i}^{\\mathrm{new}}}\\mathbf{0}_{i}+e^{\\tilde{m}_{i j}-m_{i}^{\\mathrm{new}}}\\tilde{\\mathbf{P}}_{i j}^{\\mathrm{dropped}}\\mathbf{V}_{j})",
                                    "type": "inline_equation",
                                    "height": 16,
                                    "width": 268
                                },
                                {
                                    "bbox": [
                                        414,
                                        346,
                                        459,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                361,
                                286,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        363,
                                        87,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "16:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        116,
                                        361,
                                        145,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "Write ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        146,
                                        364,
                                        187,
                                        375
                                    ],
                                    "score": 0.87,
                                    "content": "\\ell_{i}\\gets\\ell_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 41
                                },
                                {
                                    "bbox": [
                                        188,
                                        361,
                                        192,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": ",",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        192,
                                        364,
                                        242,
                                        375
                                    ],
                                    "score": 0.87,
                                    "content": "m_{i}\\gets m_{i}^{\\mathrm{new}}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 50
                                },
                                {
                                    "bbox": [
                                        242,
                                        361,
                                        286,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "to HBM.",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                374,
                                140,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        375,
                                        86,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "17:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        106,
                                        374,
                                        140,
                                        386
                                    ],
                                    "score": 1.0,
                                    "content": "end if",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                386,
                                136,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        387,
                                        86,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "18:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        386,
                                        136,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "end for",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                399,
                                126,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        399,
                                        126,
                                        410
                                    ],
                                    "score": 1.0,
                                    "content": "19: end for",
                                    "type": "text"
                                }
                            ],
                            "index": 24,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                410,
                                165,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        410,
                                        122,
                                        421
                                    ],
                                    "score": 1.0,
                                    "content": "20: Return ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        411,
                                        162,
                                        421
                                    ],
                                    "score": 0.8,
                                    "content": "\\mathbf{0},\\ell,m,\\mathcal{R}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 40
                                },
                                {
                                    "bbox": [
                                        162,
                                        410,
                                        165,
                                        421
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 25,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 12.5,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        88,
                        545,
                        421
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        441,
                        222,
                        458
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                443,
                                221,
                                457
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        443,
                                        86,
                                        457
                                    ],
                                    "score": 1.0,
                                    "content": "D",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        444,
                                        221,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "Extension Details",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        468,
                        291,
                        482
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                468,
                                291,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        468,
                                        95,
                                        481
                                    ],
                                    "score": 1.0,
                                    "content": "D.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        291,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "Block-sparse FlashAttention",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        487,
                        541,
                        511
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                489,
                                541,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        489,
                                        541,
                                        500
                                    ],
                                    "score": 1.0,
                                    "content": "We describe the full block-sparse FlashAttention algorithm in Algorithm 5. The algorithm is identical",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                501,
                                282,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        501,
                                        282,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "to Algorithm 2, except that we skip zero blocks.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 28.5,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        489,
                        541,
                        511
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        85,
                        512,
                        365,
                        524
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                513,
                                364,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        513,
                                        364,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": "We prove the IO-complexity of block-sparse FlashAttention.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 30,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        87,
                        513,
                        364,
                        523
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        531,
                        541,
                        579
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                532,
                                541,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        532,
                                        541,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "Proof of Proposition 4. The proof is very similar to the proof of Theorem 2. For the block-sparse case, notice",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                543,
                                540,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        543,
                                        540,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "that we only need to load blocks corresponding to nonzero blocks. As a result, the number of HBM accesses",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                72,
                                557,
                                540,
                                567
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        557,
                                        130,
                                        567
                                    ],
                                    "score": 1.0,
                                    "content": "are scaled by ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        131,
                                        561,
                                        135,
                                        565
                                    ],
                                    "score": 0.83,
                                    "content": "s",
                                    "type": "inline_equation",
                                    "height": 4,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        136,
                                        557,
                                        517,
                                        567
                                    ],
                                    "score": 1.0,
                                    "content": ", the fraction of nonzero blocks in the block-sparsity mask. However, for small values of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        518,
                                        561,
                                        522,
                                        565
                                    ],
                                    "score": 0.85,
                                    "content": "s",
                                    "type": "inline_equation",
                                    "height": 4,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        523,
                                        557,
                                        540,
                                        567
                                    ],
                                    "score": 1.0,
                                    "content": ", we",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                567,
                                459,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        567,
                                        225,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "would still need to write the result ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        569,
                                        268,
                                        577
                                    ],
                                    "score": 0.92,
                                    "content": "\\mathbf{O}\\in\\mathbb{R}^{N\\times d}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 43
                                },
                                {
                                    "bbox": [
                                        268,
                                        567,
                                        459,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": ". Therefore the number of HBM accesses is",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 32.5,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        532,
                        541,
                        580
                    ]
                },
                {
                    "type": "interline_equation",
                    "bbox": [
                        267,
                        587,
                        343,
                        613
                    ],
                    "lines": [
                        {
                            "bbox": [
                                267,
                                587,
                                343,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        267,
                                        587,
                                        343,
                                        613
                                    ],
                                    "score": 0.94,
                                    "content": "\\Theta\\left(N d+\\frac{N^{2}d^{2}}{M}s\\right).",
                                    "type": "interline_equation"
                                }
                            ]
                        }
                    ],
                    "index": 35,
                    "virtual_lines": [
                        {
                            "bbox": [
                                267,
                                587,
                                343,
                                613
                            ],
                            "spans": [],
                            "index": 35
                        }
                    ],
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        645,
                        228,
                        659
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                646,
                                227,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        646,
                                        94,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "D.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        646,
                                        227,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "Potential Extensions",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        665,
                        530,
                        677
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                666,
                                526,
                                678
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        666,
                                        526,
                                        678
                                    ],
                                    "score": 1.0,
                                    "content": "We discuss here a few potential extensions of the IO-aware approach to speed up deep learning training.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        666,
                        526,
                        678
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        678,
                        540,
                        713
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                677,
                                541,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        677,
                                        541,
                                        689
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-GPU Attention. Large language models are trained on hundreds or thousands of GPUs, and",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                689,
                                541,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        689,
                                        541,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "one typically splits the attention computation between 4-8 GPUs on the same node [77]. This introduces",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                701,
                                541,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        701,
                                        541,
                                        713
                                    ],
                                    "score": 1.0,
                                    "content": "another level of memory hierarchy: beside GPU SRAM and GPU HBM, we also have the HBM of other",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 39,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        677,
                        541,
                        713
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        74,
                        73,
                        541,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                73,
                                541,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        73,
                                        541,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "GPUs. For very long sequences, the different GPUs on the same node can cooperate to compute attention by",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                73,
                                85,
                                398,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        85,
                                        398,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "taking into account the asymmetry of different levels of memory hierarchy.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        97,
                        541,
                        168
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                97,
                                540,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        97,
                                        540,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "Sparse MLP layers. Typical dense MLP layers are compute-bound and not memory-bound. To improve",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                109,
                                541,
                                123
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        109,
                                        541,
                                        123
                                    ],
                                    "score": 1.0,
                                    "content": "their efficiency, MLP layers with sparse weight matrices can be used [17]. However, many sparse MLP layers",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                122,
                                541,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        122,
                                        541,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "are instead memory-bound, and their speedup is often not proportional to the sparsity. We believe that an",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                133,
                                541,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        133,
                                        541,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "IO-aware implementation can alleviate this issue and realize the benefits of sparsity. We are excited about",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                146,
                                541,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        146,
                                        541,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "future work in this direction, to reduce the computational requirement of large models and improve their",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                157,
                                156,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        157,
                                        156,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "wall-block runtime.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 4.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        169,
                        541,
                        264
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                169,
                                540,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        169,
                                        511,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": "Kernel machine learning. Our approach in FlashAttention relies on the fact that the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        511,
                                        172,
                                        540,
                                        180
                                    ],
                                    "score": 0.93,
                                    "content": "N\\times N",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                181,
                                541,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        181,
                                        317,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "attention matrix is a function of a low-rank matrix QK",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        183,
                                        322,
                                        191
                                    ],
                                    "score": 0.41,
                                    "content": "^{1}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        322,
                                        181,
                                        365,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "(of rank ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        365,
                                        183,
                                        394,
                                        191
                                    ],
                                    "score": 0.9,
                                    "content": "d\\ll N",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        394,
                                        181,
                                        541,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "). As a result, we can repeatedly",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                192,
                                541,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        192,
                                        141,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "load the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        195,
                                        161,
                                        204
                                    ],
                                    "score": 0.72,
                                    "content": "\\mathbf{Q},\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        162,
                                        192,
                                        541,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": " and recompute the block of the attention matrix that we need, significantly reducing",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                205,
                                542,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        205,
                                        437,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "HBM access. As similar scenario happens in kernel machine learning: each element",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        438,
                                        208,
                                        452,
                                        218
                                    ],
                                    "score": 0.93,
                                    "content": "K_{i j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        452,
                                        205,
                                        483,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "of the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        483,
                                        208,
                                        510,
                                        215
                                    ],
                                    "score": 0.92,
                                    "content": "N\\times N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        510,
                                        205,
                                        542,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "kernel",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                216,
                                539,
                                230
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        216,
                                        103,
                                        230
                                    ],
                                    "score": 1.0,
                                    "content": "matrix ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        111,
                                        227
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        112,
                                        216,
                                        265,
                                        230
                                    ],
                                    "score": 1.0,
                                    "content": " is a function of two vectors of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        219,
                                        294,
                                        227
                                    ],
                                    "score": 0.92,
                                    "content": "d\\ll N",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        294,
                                        216,
                                        531,
                                        230
                                    ],
                                    "score": 1.0,
                                    "content": ", as it measures the similarity between two datapoints ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        531,
                                        222,
                                        539,
                                        228
                                    ],
                                    "score": 0.89,
                                    "content": "x_{i}",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 8
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                230,
                                540,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        230,
                                        89,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        234,
                                        99,
                                        241
                                    ],
                                    "score": 0.91,
                                    "content": "x_{j}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        100,
                                        230,
                                        540,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": ". The KeOps library [8, 26] is a successful example of how reducing memory reads/writes can speed up",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                241,
                                542,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        241,
                                        542,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "kernel operations. We hope that this will motivate kernel methods that focus more on reducing IOs instead",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                253,
                                137,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        253,
                                        137,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "of just FLOPs.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 11.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        282,
                        279,
                        298
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                283,
                                279,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        283,
                                        84,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "E",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        284,
                                        279,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "Full Experimental Results",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        307,
                        142,
                        321
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                308,
                                142,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        308,
                                        93,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "E.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        308,
                                        142,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "BERT",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        327,
                        541,
                        387
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                328,
                                542,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        328,
                                        542,
                                        340
                                    ],
                                    "score": 1.0,
                                    "content": "We train BERT-large following the training procedure and hyperparameters of the reference MLPerf 1.1",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                341,
                                541,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        341,
                                        541,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": "implementation. In particular, we use the LAMB optimizer with learning rate 3.75e-3, with batch size 448,",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                69,
                                351,
                                541,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        351,
                                        541,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "trained for at most 7100 steps. The training is stopped once the validation accuracy (for masked language",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                365,
                                541,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        365,
                                        198,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "modeling) reaches the target ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        198,
                                        365,
                                        225,
                                        375
                                    ],
                                    "score": 0.72,
                                    "content": "72.0\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        225,
                                        365,
                                        541,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": ", and the wall-clock run-time is measured. We train with FP16 precision",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                377,
                                277,
                                388
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        377,
                                        277,
                                        388
                                    ],
                                    "score": 1.0,
                                    "content": "using Apex AMP (with O2 optimization level).",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        388,
                        538,
                        411
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                388,
                                541,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        388,
                                        541,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "We compare our results with the reported training speed from Nvidia that was submitted to MLPerf 1.1",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                399,
                                115,
                                412
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        399,
                                        115,
                                        412
                                    ],
                                    "score": 1.0,
                                    "content": "(Table 1).",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 23.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        411,
                        537,
                        435
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                411,
                                539,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        411,
                                        539,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "We use the same train / validation data split provided by MLPerf 1.1 reference implementation. In",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                424,
                                470,
                                435
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        424,
                                        470,
                                        435
                                    ],
                                    "score": 1.0,
                                    "content": "particular, we evaluate on the same 10000 validation examples as the baseline from Nvidia.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.5
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        436,
                        538,
                        459
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                435,
                                540,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        435,
                                        191,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "We train the model on 8",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        439,
                                        198,
                                        446
                                    ],
                                    "score": 0.3,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        199,
                                        435,
                                        540,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "A100-80GB GPUs. Each training run takes between 16 and 19 minutes, and we",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                448,
                                202,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        448,
                                        202,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "average the results of 10 runs.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        473,
                        145,
                        486
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                473,
                                145,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        473,
                                        93,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "E.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        474,
                                        145,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        493,
                        539,
                        517
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                494,
                                541,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        494,
                                        541,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "We use the standard implementations of GPT-2 [67] from Huggingface transformers library and from",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                506,
                                444,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        506,
                                        444,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "Nvidia’s Megatron-LM repo. We follow the training recipe of the Megatron-LM repo.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 30.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        518,
                        541,
                        565
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                516,
                                543,
                                531
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        516,
                                        543,
                                        531
                                    ],
                                    "score": 1.0,
                                    "content": "We use an effective batch size of 512, and use gradient accumulation to fit into available GPU memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                530,
                                541,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        530,
                                        541,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "We use the AdamW optimizer, with learning rate 6e-4 for GPT-2 small and 1.5e-4 for GPT-2 medium, and",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                542,
                                541,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        542,
                                        541,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "weight decay of 0.1. All models are trained with the same hyperparameters for 400K steps. We run all",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                554,
                                353,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        554,
                                        353,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "implementations with mixed-precision training (PyTorch AMP).",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 33.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        565,
                        541,
                        600
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                565,
                                541,
                                577
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        566,
                                        457,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": "We use the Openwebtext dataset, with the GPT-2 BPE tokenizer. We randomly select ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        457,
                                        565,
                                        479,
                                        576
                                    ],
                                    "score": 0.81,
                                    "content": "0.5\\%",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        479,
                                        566,
                                        541,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": " of the dataset",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                578,
                                541,
                                589
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        578,
                                        541,
                                        589
                                    ],
                                    "score": 1.0,
                                    "content": "as the validation set, with the rest being used as training set. This random selection of validation set is done",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                69,
                                590,
                                343,
                                601
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        590,
                                        343,
                                        601
                                    ],
                                    "score": 1.0,
                                    "content": "once, and all models are evaluated on the same validation set.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 37
                },
                {
                    "type": "text",
                    "bbox": [
                        67,
                        601,
                        542,
                        672
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                600,
                                541,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        600,
                                        198,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "We train the model on 8",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        198,
                                        605,
                                        205,
                                        611
                                    ],
                                    "score": 0.36,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        205,
                                        600,
                                        541,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "A100-40GB GPUs, and we measure the wall-clock training time. Training",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                613,
                                541,
                                625
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        613,
                                        541,
                                        625
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2 small takes between 2.7-9.5 days, and training GPT-2 medium takes between 6.9-21.0 days (Table 2).",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                84,
                                625,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        625,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "In Fig. 4, we plot of the validation perplexity throughout training of GPT-2 small/medium, using either",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                71,
                                637,
                                541,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        637,
                                        541,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "HuggingFace implementation or our FlashAttention implementation. We see that FlashAttention be-",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                650,
                                541,
                                661
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        650,
                                        541,
                                        661
                                    ],
                                    "score": 1.0,
                                    "content": "haves the same as the baseline implementation and the validation perplexity curves of the two implementations",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                662,
                                208,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        662,
                                        208,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "almost lie on top of each other.",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        }
                    ],
                    "index": 41.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        686,
                        540,
                        711
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                687,
                                542,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        687,
                                        542,
                                        699
                                    ],
                                    "score": 1.0,
                                    "content": "Long Document Classification. For MIMIC-III and ECtHR, we follow the hyperparameters of Dai et al.",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                69,
                                698,
                                92,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        698,
                                        92,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": "[13].",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 45.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 25,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "26",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        74,
                        73,
                        541,
                        97
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                73,
                                541,
                                87
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        73,
                                        541,
                                        87
                                    ],
                                    "score": 1.0,
                                    "content": "GPUs. For very long sequences, the different GPUs on the same node can cooperate to compute attention by",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                73,
                                85,
                                398,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        85,
                                        398,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "taking into account the asymmetry of different levels of memory hierarchy.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        73,
                        73,
                        541,
                        97
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        97,
                        541,
                        168
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                97,
                                540,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        97,
                                        540,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "Sparse MLP layers. Typical dense MLP layers are compute-bound and not memory-bound. To improve",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                109,
                                541,
                                123
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        109,
                                        541,
                                        123
                                    ],
                                    "score": 1.0,
                                    "content": "their efficiency, MLP layers with sparse weight matrices can be used [17]. However, many sparse MLP layers",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                122,
                                541,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        122,
                                        541,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "are instead memory-bound, and their speedup is often not proportional to the sparsity. We believe that an",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                133,
                                541,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        133,
                                        541,
                                        146
                                    ],
                                    "score": 1.0,
                                    "content": "IO-aware implementation can alleviate this issue and realize the benefits of sparsity. We are excited about",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                146,
                                541,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        146,
                                        541,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "future work in this direction, to reduce the computational requirement of large models and improve their",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                157,
                                156,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        157,
                                        156,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "wall-block runtime.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 4.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        97,
                        541,
                        169
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        169,
                        541,
                        264
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                169,
                                540,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        169,
                                        511,
                                        181
                                    ],
                                    "score": 1.0,
                                    "content": "Kernel machine learning. Our approach in FlashAttention relies on the fact that the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        511,
                                        172,
                                        540,
                                        180
                                    ],
                                    "score": 0.93,
                                    "content": "N\\times N",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                181,
                                541,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        181,
                                        317,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "attention matrix is a function of a low-rank matrix QK",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        183,
                                        322,
                                        191
                                    ],
                                    "score": 0.41,
                                    "content": "^{1}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        322,
                                        181,
                                        365,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "(of rank ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        365,
                                        183,
                                        394,
                                        191
                                    ],
                                    "score": 0.9,
                                    "content": "d\\ll N",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        394,
                                        181,
                                        541,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "). As a result, we can repeatedly",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                192,
                                541,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        192,
                                        141,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "load the inputs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        195,
                                        161,
                                        204
                                    ],
                                    "score": 0.72,
                                    "content": "\\mathbf{Q},\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        162,
                                        192,
                                        541,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": " and recompute the block of the attention matrix that we need, significantly reducing",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                205,
                                542,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        205,
                                        437,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "HBM access. As similar scenario happens in kernel machine learning: each element",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        438,
                                        208,
                                        452,
                                        218
                                    ],
                                    "score": 0.93,
                                    "content": "K_{i j}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 14
                                },
                                {
                                    "bbox": [
                                        452,
                                        205,
                                        483,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "of the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        483,
                                        208,
                                        510,
                                        215
                                    ],
                                    "score": 0.92,
                                    "content": "N\\times N",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        510,
                                        205,
                                        542,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "kernel",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                216,
                                539,
                                230
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        216,
                                        103,
                                        230
                                    ],
                                    "score": 1.0,
                                    "content": "matrix ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        111,
                                        227
                                    ],
                                    "score": 0.84,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        112,
                                        216,
                                        265,
                                        230
                                    ],
                                    "score": 1.0,
                                    "content": " is a function of two vectors of size ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        219,
                                        294,
                                        227
                                    ],
                                    "score": 0.92,
                                    "content": "d\\ll N",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 29
                                },
                                {
                                    "bbox": [
                                        294,
                                        216,
                                        531,
                                        230
                                    ],
                                    "score": 1.0,
                                    "content": ", as it measures the similarity between two datapoints ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        531,
                                        222,
                                        539,
                                        228
                                    ],
                                    "score": 0.89,
                                    "content": "x_{i}",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 8
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                230,
                                540,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        230,
                                        89,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        234,
                                        99,
                                        241
                                    ],
                                    "score": 0.91,
                                    "content": "x_{j}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        100,
                                        230,
                                        540,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": ". The KeOps library [8, 26] is a successful example of how reducing memory reads/writes can speed up",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                241,
                                542,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        241,
                                        542,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "kernel operations. We hope that this will motivate kernel methods that focus more on reducing IOs instead",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                253,
                                137,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        253,
                                        137,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "of just FLOPs.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 11.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        169,
                        542,
                        264
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        282,
                        279,
                        298
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                283,
                                279,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        283,
                                        84,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "E",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        96,
                                        284,
                                        279,
                                        297
                                    ],
                                    "score": 1.0,
                                    "content": "Full Experimental Results",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        307,
                        142,
                        321
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                308,
                                142,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        308,
                                        93,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "E.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        308,
                                        142,
                                        321
                                    ],
                                    "score": 1.0,
                                    "content": "BERT",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        327,
                        541,
                        387
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                328,
                                542,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        328,
                                        542,
                                        340
                                    ],
                                    "score": 1.0,
                                    "content": "We train BERT-large following the training procedure and hyperparameters of the reference MLPerf 1.1",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                341,
                                541,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        341,
                                        541,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": "implementation. In particular, we use the LAMB optimizer with learning rate 3.75e-3, with batch size 448,",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                69,
                                351,
                                541,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        351,
                                        541,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "trained for at most 7100 steps. The training is stopped once the validation accuracy (for masked language",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                365,
                                541,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        365,
                                        198,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "modeling) reaches the target ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        198,
                                        365,
                                        225,
                                        375
                                    ],
                                    "score": 0.72,
                                    "content": "72.0\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        225,
                                        365,
                                        541,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": ", and the wall-clock run-time is measured. We train with FP16 precision",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                377,
                                277,
                                388
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        377,
                                        277,
                                        388
                                    ],
                                    "score": 1.0,
                                    "content": "using Apex AMP (with O2 optimization level).",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        328,
                        542,
                        388
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        388,
                        538,
                        411
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                388,
                                541,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        388,
                                        541,
                                        399
                                    ],
                                    "score": 1.0,
                                    "content": "We compare our results with the reported training speed from Nvidia that was submitted to MLPerf 1.1",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                399,
                                115,
                                412
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        399,
                                        115,
                                        412
                                    ],
                                    "score": 1.0,
                                    "content": "(Table 1).",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 23.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        388,
                        541,
                        412
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        411,
                        537,
                        435
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                411,
                                539,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        411,
                                        539,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "We use the same train / validation data split provided by MLPerf 1.1 reference implementation. In",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                424,
                                470,
                                435
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        424,
                                        470,
                                        435
                                    ],
                                    "score": 1.0,
                                    "content": "particular, we evaluate on the same 10000 validation examples as the baseline from Nvidia.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        411,
                        539,
                        435
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        436,
                        538,
                        459
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                435,
                                540,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        435,
                                        191,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "We train the model on 8",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        191,
                                        439,
                                        198,
                                        446
                                    ],
                                    "score": 0.3,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        199,
                                        435,
                                        540,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "A100-80GB GPUs. Each training run takes between 16 and 19 minutes, and we",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                448,
                                202,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        448,
                                        202,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "average the results of 10 runs.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        435,
                        540,
                        458
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        473,
                        145,
                        486
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                473,
                                145,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        473,
                                        93,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "E.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        474,
                                        145,
                                        486
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        493,
                        539,
                        517
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                494,
                                541,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        494,
                                        541,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "We use the standard implementations of GPT-2 [67] from Huggingface transformers library and from",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                506,
                                444,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        506,
                                        444,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "Nvidia’s Megatron-LM repo. We follow the training recipe of the Megatron-LM repo.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 30.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        494,
                        541,
                        518
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        518,
                        541,
                        565
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                516,
                                543,
                                531
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        516,
                                        543,
                                        531
                                    ],
                                    "score": 1.0,
                                    "content": "We use an effective batch size of 512, and use gradient accumulation to fit into available GPU memory.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                530,
                                541,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        530,
                                        541,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": "We use the AdamW optimizer, with learning rate 6e-4 for GPT-2 small and 1.5e-4 for GPT-2 medium, and",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                542,
                                541,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        542,
                                        541,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "weight decay of 0.1. All models are trained with the same hyperparameters for 400K steps. We run all",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                554,
                                353,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        554,
                                        353,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "implementations with mixed-precision training (PyTorch AMP).",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 33.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        516,
                        543,
                        566
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        565,
                        541,
                        600
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                565,
                                541,
                                577
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        566,
                                        457,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": "We use the Openwebtext dataset, with the GPT-2 BPE tokenizer. We randomly select ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        457,
                                        565,
                                        479,
                                        576
                                    ],
                                    "score": 0.81,
                                    "content": "0.5\\%",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 22
                                },
                                {
                                    "bbox": [
                                        479,
                                        566,
                                        541,
                                        577
                                    ],
                                    "score": 1.0,
                                    "content": " of the dataset",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                578,
                                541,
                                589
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        578,
                                        541,
                                        589
                                    ],
                                    "score": 1.0,
                                    "content": "as the validation set, with the rest being used as training set. This random selection of validation set is done",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                69,
                                590,
                                343,
                                601
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        590,
                                        343,
                                        601
                                    ],
                                    "score": 1.0,
                                    "content": "once, and all models are evaluated on the same validation set.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 37,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        565,
                        541,
                        601
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        67,
                        601,
                        542,
                        672
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                600,
                                541,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        600,
                                        198,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "We train the model on 8",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        198,
                                        605,
                                        205,
                                        611
                                    ],
                                    "score": 0.36,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        205,
                                        600,
                                        541,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "A100-40GB GPUs, and we measure the wall-clock training time. Training",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                613,
                                541,
                                625
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        613,
                                        541,
                                        625
                                    ],
                                    "score": 1.0,
                                    "content": "GPT-2 small takes between 2.7-9.5 days, and training GPT-2 medium takes between 6.9-21.0 days (Table 2).",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                84,
                                625,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        625,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "In Fig. 4, we plot of the validation perplexity throughout training of GPT-2 small/medium, using either",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                71,
                                637,
                                541,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        637,
                                        541,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "HuggingFace implementation or our FlashAttention implementation. We see that FlashAttention be-",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                650,
                                541,
                                661
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        650,
                                        541,
                                        661
                                    ],
                                    "score": 1.0,
                                    "content": "haves the same as the baseline implementation and the validation perplexity curves of the two implementations",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                662,
                                208,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        662,
                                        208,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "almost lie on top of each other.",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        }
                    ],
                    "index": 41.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        600,
                        541,
                        672
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        69,
                        686,
                        540,
                        711
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                687,
                                542,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        687,
                                        542,
                                        699
                                    ],
                                    "score": 1.0,
                                    "content": "Long Document Classification. For MIMIC-III and ECtHR, we follow the hyperparameters of Dai et al.",
                                    "type": "text"
                                }
                            ],
                            "index": 45,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                698,
                                92,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        698,
                                        92,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": "[13].",
                                    "type": "text"
                                }
                            ],
                            "index": 46,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 45.5,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        687,
                        542,
                        714
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        144,
                        75,
                        465,
                        323
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                144,
                                75,
                                465,
                                323
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        144,
                                        75,
                                        465,
                                        323
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                144,
                                                75,
                                                465,
                                                323
                                            ],
                                            "score": 0.972,
                                            "type": "image",
                                            "image_path": "8da66f105ab43e729c2e800ff5363889378b27129aa71ae29d616e798a156cf5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        144,
                                        75,
                                        465,
                                        157.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        144,
                                        157.66666666666669,
                                        465,
                                        240.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        144,
                                        240.33333333333337,
                                        465,
                                        323.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                336,
                                540,
                                361
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        337,
                                        541,
                                        348
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                337,
                                                541,
                                                348
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 4: Validation perplexity of GPT-2 small/medium using two implementations. We confirm that",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        350,
                                        523,
                                        361
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                350,
                                                523,
                                                361
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention yields the same validation curves as the baseline implementation from HuggingFace.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        380,
                        176,
                        393
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                380,
                                175,
                                393
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        380,
                                        93,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": "E.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        381,
                                        175,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "LRA details",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        400,
                        541,
                        460
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                400,
                                543,
                                413
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        400,
                                        543,
                                        413
                                    ],
                                    "score": 1.0,
                                    "content": "We follow the hyperparameters from the Long-range arena paper [80], the Long-range arena repo (https:",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                413,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        413,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "//github.com/google-research/long-range-arena), and the Nyströmformer reproduction [90]. To be",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                426,
                                542,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        426,
                                        542,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "generous to the baseline methods, if we are unable to reproduce the performance of any baseline for any of",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                437,
                                541,
                                448
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        437,
                                        541,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": "the five tasks, we report the better performance from Tay et al. [80] or Xiong et al. [90] for that baseline on",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                449,
                                115,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        449,
                                        115,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "that task.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        460,
                        540,
                        484
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                460,
                                541,
                                473
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        460,
                                        541,
                                        473
                                    ],
                                    "score": 1.0,
                                    "content": "After hyperparameter tuning, almost all of the attention methods achieve similar accuracy on all of the",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                472,
                                140,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        472,
                                        140,
                                        484
                                    ],
                                    "score": 1.0,
                                    "content": "five LRA tasks.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        484,
                        538,
                        507
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                484,
                                538,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        484,
                                        538,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "We run all methods with mixed-precision training, except for Performer (not stable with mixed precision)",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                497,
                                345,
                                508
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        497,
                                        345,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": "and Local Attention (implementation does not support FP16).",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 13.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        508,
                        538,
                        531
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                507,
                                540,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        507,
                                        540,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "To calculate the overall wallclock-time speedup, we take the geometric mean of the wallclock-time speedup",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                519,
                                177,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        519,
                                        177,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "of each of the five tasks.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        545,
                        541,
                        629
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                546,
                                541,
                                558
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        546,
                                        541,
                                        558
                                    ],
                                    "score": 1.0,
                                    "content": "Path-X For Path-X and Path-256, we follow the hyperparameters from the PathFinder-32 experiments",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                558,
                                541,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        558,
                                        541,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "from the long-range arena paper[80]. For both, we first pretrain a model on Path-64. We take the checkpoint",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                72,
                                571,
                                540,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        571,
                                        540,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "after 200 epochs, upsample its positional embedding (we duplicate the positional embeddings gridwise in",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                541,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        541,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": "space), and fine-tune it on the downstream task for 200 epochs with one epoch of linear warmup, and cosine",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                594,
                                540,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        594,
                                        540,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "decay of the learning rate. For Path-X, we take the best performing checkpoint (according to val accuracy),",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                72,
                                606,
                                540,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        606,
                                        540,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "and additionally fine-tune it for 200 epochs with the same warmup and learning rate (this adds roughly 4",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                618,
                                497,
                                630
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        618,
                                        497,
                                        630
                                    ],
                                    "score": 1.0,
                                    "content": "points of accuracy to FlashAttention for Path-X, but the model starts overfitting afterwards).",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        642,
                        287,
                        657
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                644,
                                287,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        94,
                                        656
                                    ],
                                    "score": 1.0,
                                    "content": "E.4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        644,
                                        287,
                                        657
                                    ],
                                    "score": 1.0,
                                    "content": "Comparison with Apex FMHA",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        663,
                        539,
                        687
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                665,
                                541,
                                675
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        665,
                                        541,
                                        675
                                    ],
                                    "score": 1.0,
                                    "content": "We compare our method/implementation with Apex FMHA (https://github.com/NVIDIA/apex/tree/",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                677,
                                229,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        677,
                                        229,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "master/apex/contrib/csrc/fmha).",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        688,
                        541,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                687,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        687,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "When we started this project, Apex FMHA was the fastest implementation of attention (that we knew",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                700,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        700,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "of), tailored for short sequences of length at most 512. In fact, almost all MLPerf submissions for BERT",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                711,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        711,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "training benchmark running on Nvidia GPUs use FMHA for their model code, as of MLPerf 1.1 [58]. Since",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 28
                }
            ],
            "layout_bboxes": [],
            "page_idx": 26,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        144,
                        75,
                        465,
                        323
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                144,
                                75,
                                465,
                                323
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        144,
                                        75,
                                        465,
                                        323
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                144,
                                                75,
                                                465,
                                                323
                                            ],
                                            "score": 0.972,
                                            "type": "image",
                                            "image_path": "8da66f105ab43e729c2e800ff5363889378b27129aa71ae29d616e798a156cf5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        144,
                                        75,
                                        465,
                                        157.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        144,
                                        157.66666666666669,
                                        465,
                                        240.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        144,
                                        240.33333333333337,
                                        465,
                                        323.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                336,
                                540,
                                361
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        337,
                                        541,
                                        348
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                337,
                                                541,
                                                348
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 4: Validation perplexity of GPT-2 small/medium using two implementations. We confirm that",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        350,
                                        523,
                                        361
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                350,
                                                523,
                                                361
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention yields the same validation curves as the baseline implementation from HuggingFace.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "27",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        144,
                        75,
                        465,
                        323
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                144,
                                75,
                                465,
                                323
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        144,
                                        75,
                                        465,
                                        323
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                144,
                                                75,
                                                465,
                                                323
                                            ],
                                            "score": 0.972,
                                            "type": "image",
                                            "image_path": "8da66f105ab43e729c2e800ff5363889378b27129aa71ae29d616e798a156cf5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        144,
                                        75,
                                        465,
                                        157.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        144,
                                        157.66666666666669,
                                        465,
                                        240.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        144,
                                        240.33333333333337,
                                        465,
                                        323.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                336,
                                540,
                                361
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        337,
                                        541,
                                        348
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                337,
                                                541,
                                                348
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 4: Validation perplexity of GPT-2 small/medium using two implementations. We confirm that",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        350,
                                        523,
                                        361
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                350,
                                                523,
                                                361
                                            ],
                                            "score": 1.0,
                                            "content": "FlashAttention yields the same validation curves as the baseline implementation from HuggingFace.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        380,
                        176,
                        393
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                380,
                                175,
                                393
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        380,
                                        93,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": "E.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        381,
                                        175,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "LRA details",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        400,
                        541,
                        460
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                400,
                                543,
                                413
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        400,
                                        543,
                                        413
                                    ],
                                    "score": 1.0,
                                    "content": "We follow the hyperparameters from the Long-range arena paper [80], the Long-range arena repo (https:",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                413,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        413,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "//github.com/google-research/long-range-arena), and the Nyströmformer reproduction [90]. To be",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                426,
                                542,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        426,
                                        542,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "generous to the baseline methods, if we are unable to reproduce the performance of any baseline for any of",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                437,
                                541,
                                448
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        437,
                                        541,
                                        448
                                    ],
                                    "score": 1.0,
                                    "content": "the five tasks, we report the better performance from Tay et al. [80] or Xiong et al. [90] for that baseline on",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                449,
                                115,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        449,
                                        115,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "that task.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        400,
                        543,
                        459
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        460,
                        540,
                        484
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                460,
                                541,
                                473
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        460,
                                        541,
                                        473
                                    ],
                                    "score": 1.0,
                                    "content": "After hyperparameter tuning, almost all of the attention methods achieve similar accuracy on all of the",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                472,
                                140,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        472,
                                        140,
                                        484
                                    ],
                                    "score": 1.0,
                                    "content": "five LRA tasks.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11.5,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        460,
                        541,
                        484
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        484,
                        538,
                        507
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                484,
                                538,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        484,
                                        538,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "We run all methods with mixed-precision training, except for Performer (not stable with mixed precision)",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                497,
                                345,
                                508
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        497,
                                        345,
                                        508
                                    ],
                                    "score": 1.0,
                                    "content": "and Local Attention (implementation does not support FP16).",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 13.5,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        484,
                        538,
                        508
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        508,
                        538,
                        531
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                507,
                                540,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        507,
                                        540,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "To calculate the overall wallclock-time speedup, we take the geometric mean of the wallclock-time speedup",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                519,
                                177,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        519,
                                        177,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "of each of the five tasks.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        507,
                        540,
                        532
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        545,
                        541,
                        629
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                546,
                                541,
                                558
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        546,
                                        541,
                                        558
                                    ],
                                    "score": 1.0,
                                    "content": "Path-X For Path-X and Path-256, we follow the hyperparameters from the PathFinder-32 experiments",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                558,
                                541,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        558,
                                        541,
                                        569
                                    ],
                                    "score": 1.0,
                                    "content": "from the long-range arena paper[80]. For both, we first pretrain a model on Path-64. We take the checkpoint",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                72,
                                571,
                                540,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        571,
                                        540,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "after 200 epochs, upsample its positional embedding (we duplicate the positional embeddings gridwise in",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                541,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        541,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": "space), and fine-tune it on the downstream task for 200 epochs with one epoch of linear warmup, and cosine",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                594,
                                540,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        594,
                                        540,
                                        605
                                    ],
                                    "score": 1.0,
                                    "content": "decay of the learning rate. For Path-X, we take the best performing checkpoint (according to val accuracy),",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                72,
                                606,
                                540,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        606,
                                        540,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "and additionally fine-tune it for 200 epochs with the same warmup and learning rate (this adds roughly 4",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                618,
                                497,
                                630
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        618,
                                        497,
                                        630
                                    ],
                                    "score": 1.0,
                                    "content": "points of accuracy to FlashAttention for Path-X, but the model starts overfitting afterwards).",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 20,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        546,
                        541,
                        630
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        642,
                        287,
                        657
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                644,
                                287,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        94,
                                        656
                                    ],
                                    "score": 1.0,
                                    "content": "E.4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        644,
                                        287,
                                        657
                                    ],
                                    "score": 1.0,
                                    "content": "Comparison with Apex FMHA",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        663,
                        539,
                        687
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                665,
                                541,
                                675
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        665,
                                        541,
                                        675
                                    ],
                                    "score": 1.0,
                                    "content": "We compare our method/implementation with Apex FMHA (https://github.com/NVIDIA/apex/tree/",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                677,
                                229,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        677,
                                        229,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "master/apex/contrib/csrc/fmha).",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.5,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        665,
                        541,
                        687
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        688,
                        541,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                687,
                                541,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        687,
                                        541,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "When we started this project, Apex FMHA was the fastest implementation of attention (that we knew",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                700,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        700,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "of), tailored for short sequences of length at most 512. In fact, almost all MLPerf submissions for BERT",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                711,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        711,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "training benchmark running on Nvidia GPUs use FMHA for their model code, as of MLPerf 1.1 [58]. Since",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 28,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        687,
                        541,
                        723
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        164,
                        102,
                        443,
                        189
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                67,
                                71,
                                541,
                                94
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        72,
                                        541,
                                        83
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                72,
                                                541,
                                                83
                                            ],
                                            "score": 1.0,
                                            "content": "Table 7: Runtime (ms) of FlashAttention compared to FMHA by sequence length, with masking and dropout,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        514,
                                        94
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                83,
                                                514,
                                                94
                                            ],
                                            "score": 1.0,
                                            "content": "measured on an A100-SXM4-40GB GPU. Batch size 64, 16 heads, head dimension 64 (i.e., BERT-large size).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                164,
                                102,
                                443,
                                189
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        164,
                                        102,
                                        443,
                                        189
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                164,
                                                102,
                                                443,
                                                189
                                            ],
                                            "score": 0.982,
                                            "type": "table",
                                            "image_path": "3a95e6ced3a0e4f73a65ddf497e66e6619d4dd72057ffde760634e46c140857c.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        164,
                                        102,
                                        443,
                                        131.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        164,
                                        131.0,
                                        443,
                                        160.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        164,
                                        160.0,
                                        443,
                                        189.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        208,
                        541,
                        268
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                208,
                                541,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        208,
                                        541,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": "FMHA targets BERT models, it only supports head dimension 64, and only runs on A100 GPUs. FMHA",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                221,
                                541,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        221,
                                        541,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "fuses the attention computation dropout softmax mask QK⊤ V into one CUDA kernel. In the forward",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                233,
                                542,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        233,
                                        261,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "pass, it stores the attention matrix softmax(",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        261,
                                        233,
                                        320,
                                        244
                                    ],
                                    "score": 0.32,
                                    "content": "\\mathrm{MASK}(\\mathbf{QK}^{T}))",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 59
                                },
                                {
                                    "bbox": [
                                        320,
                                        233,
                                        542,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM to be used in gradient computation. As a",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                246,
                                540,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        246,
                                        540,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "result, it does not offer substantial memory saving (though for shorter sequences memory footprint is often",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                258,
                                176,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        258,
                                        176,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "not a primary concern).",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        268,
                        541,
                        316
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                268,
                                541,
                                281
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        268,
                                        541,
                                        281
                                    ],
                                    "score": 1.0,
                                    "content": "We use FMHA code as a starting point, and apply two well-established techniques (tiling and recomputa-",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                280,
                                540,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        280,
                                        540,
                                        292
                                    ],
                                    "score": 1.0,
                                    "content": "tion) to deal with long sequences and to save memory as mentioned in Section 3. As a result, we can support",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                293,
                                542,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        293,
                                        542,
                                        304
                                    ],
                                    "score": 1.0,
                                    "content": "much longer sequences (e.g., up to length 64K). We also support more head dimensions (16, 32, 64, 128) and",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                69,
                                304,
                                398,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        304,
                                        398,
                                        317
                                    ],
                                    "score": 1.0,
                                    "content": "broader GPU types (all Turing and Ampere GPUs at the time of writing).",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 11.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        316,
                        541,
                        388
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                316,
                                540,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        316,
                                        540,
                                        329
                                    ],
                                    "score": 1.0,
                                    "content": "In Table 7, we compare the performance of FlashAttention and Apex FMHA for short sequences (as",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                327,
                                541,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        327,
                                        541,
                                        342
                                    ],
                                    "score": 1.0,
                                    "content": "FMHA only supports sequence length at most 512). Generally FlashAttention is slightly faster than",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                340,
                                541,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        340,
                                        541,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "FMHA in the forward pass and slightly slower than FMHA in the backward pass. This is because we do not",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                352,
                                541,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        352,
                                        541,
                                        364
                                    ],
                                    "score": 1.0,
                                    "content": "store the attention matrix in the forward pass and recompute it in the backward pass. Compared to FMHA,",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                365,
                                541,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        365,
                                        541,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "the overall runtime of FlashAttention is about 4% slower for sequence length 128, 8% faster for sequence",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                376,
                                290,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        376,
                                        290,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "length 256, and 5% faster for sequence length 512.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 16.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        401,
                        413,
                        416
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                402,
                                411,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        402,
                                        93,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "E.5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        403,
                                        411,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "Speedup On Different Hardware and Configurations",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        421,
                        541,
                        446
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                422,
                                541,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        422,
                                        541,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "Speedup varies between different types of GPU types and generations depending on HBM bandwidth and",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                433,
                                529,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        433,
                                        529,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "SRAM size. In this section, we profile FlashAttention speedup on different GPUs and configurations.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 21.5
                },
                {
                    "type": "image",
                    "bbox": [
                        109,
                        460,
                        501,
                        635
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                460,
                                501,
                                635
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        460,
                                        501,
                                        635
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                460,
                                                501,
                                                635
                                            ],
                                            "score": 0.968,
                                            "type": "image",
                                            "image_path": "0cc35fc7784396fec1083ebfb5be1ca5190960084233a1e920548d42ba5a5448.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 24,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        460,
                                        501,
                                        518.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        109,
                                        518.3333333333334,
                                        501,
                                        576.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        109,
                                        576.6666666666667,
                                        501,
                                        635.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 25
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                105,
                                649,
                                505,
                                661
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        649,
                                        505,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                649,
                                                505,
                                                662
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 5: Speedup over standard PyTorch attention at different sequence lengths, on A100.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 26
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.0
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        687,
                        540,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                687,
                                540,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        687,
                                        540,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "A100 Figure 5 shows speedup on an A100 GPU with batch size 8, head dimension 64, and 12 attention",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                700,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        700,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "heads, across different sequence lengths. We generally see 2-4× speedup, and we see more speedup when",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                712,
                                285,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        712,
                                        285,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "using dropout and masking due to kernel fusion.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 28
                }
            ],
            "layout_bboxes": [],
            "page_idx": 27,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        109,
                        460,
                        501,
                        635
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                460,
                                501,
                                635
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        460,
                                        501,
                                        635
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                460,
                                                501,
                                                635
                                            ],
                                            "score": 0.968,
                                            "type": "image",
                                            "image_path": "0cc35fc7784396fec1083ebfb5be1ca5190960084233a1e920548d42ba5a5448.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 24,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        460,
                                        501,
                                        518.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        109,
                                        518.3333333333334,
                                        501,
                                        576.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        109,
                                        576.6666666666667,
                                        501,
                                        635.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 25
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                105,
                                649,
                                505,
                                661
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        649,
                                        505,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                649,
                                                505,
                                                662
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 5: Speedup over standard PyTorch attention at different sequence lengths, on A100.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 26
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.0
                }
            ],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        164,
                        102,
                        443,
                        189
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                67,
                                71,
                                541,
                                94
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        72,
                                        541,
                                        83
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                72,
                                                541,
                                                83
                                            ],
                                            "score": 1.0,
                                            "content": "Table 7: Runtime (ms) of FlashAttention compared to FMHA by sequence length, with masking and dropout,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        514,
                                        94
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                83,
                                                514,
                                                94
                                            ],
                                            "score": 1.0,
                                            "content": "measured on an A100-SXM4-40GB GPU. Batch size 64, 16 heads, head dimension 64 (i.e., BERT-large size).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                164,
                                102,
                                443,
                                189
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        164,
                                        102,
                                        443,
                                        189
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                164,
                                                102,
                                                443,
                                                189
                                            ],
                                            "score": 0.982,
                                            "type": "table",
                                            "image_path": "3a95e6ced3a0e4f73a65ddf497e66e6619d4dd72057ffde760634e46c140857c.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        164,
                                        102,
                                        443,
                                        131.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        164,
                                        131.0,
                                        443,
                                        160.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        164,
                                        160.0,
                                        443,
                                        189.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "28",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        164,
                        102,
                        443,
                        189
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                67,
                                71,
                                541,
                                94
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        72,
                                        541,
                                        83
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                72,
                                                541,
                                                83
                                            ],
                                            "score": 1.0,
                                            "content": "Table 7: Runtime (ms) of FlashAttention compared to FMHA by sequence length, with masking and dropout,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        514,
                                        94
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                83,
                                                514,
                                                94
                                            ],
                                            "score": 1.0,
                                            "content": "measured on an A100-SXM4-40GB GPU. Batch size 64, 16 heads, head dimension 64 (i.e., BERT-large size).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                164,
                                102,
                                443,
                                189
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        164,
                                        102,
                                        443,
                                        189
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                164,
                                                102,
                                                443,
                                                189
                                            ],
                                            "score": 0.982,
                                            "type": "table",
                                            "image_path": "3a95e6ced3a0e4f73a65ddf497e66e6619d4dd72057ffde760634e46c140857c.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        164,
                                        102,
                                        443,
                                        131.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        164,
                                        131.0,
                                        443,
                                        160.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        164,
                                        160.0,
                                        443,
                                        189.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        208,
                        541,
                        268
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                208,
                                541,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        208,
                                        541,
                                        220
                                    ],
                                    "score": 1.0,
                                    "content": "FMHA targets BERT models, it only supports head dimension 64, and only runs on A100 GPUs. FMHA",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                221,
                                541,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        221,
                                        541,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "fuses the attention computation dropout softmax mask QK⊤ V into one CUDA kernel. In the forward",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                233,
                                542,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        233,
                                        261,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "pass, it stores the attention matrix softmax(",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        261,
                                        233,
                                        320,
                                        244
                                    ],
                                    "score": 0.32,
                                    "content": "\\mathrm{MASK}(\\mathbf{QK}^{T}))",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 59
                                },
                                {
                                    "bbox": [
                                        320,
                                        233,
                                        542,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": " to HBM to be used in gradient computation. As a",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                246,
                                540,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        246,
                                        540,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "result, it does not offer substantial memory saving (though for shorter sequences memory footprint is often",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                258,
                                176,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        258,
                                        176,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "not a primary concern).",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 7,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        208,
                        542,
                        269
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        268,
                        541,
                        316
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                268,
                                541,
                                281
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        268,
                                        541,
                                        281
                                    ],
                                    "score": 1.0,
                                    "content": "We use FMHA code as a starting point, and apply two well-established techniques (tiling and recomputa-",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                280,
                                540,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        280,
                                        540,
                                        292
                                    ],
                                    "score": 1.0,
                                    "content": "tion) to deal with long sequences and to save memory as mentioned in Section 3. As a result, we can support",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                293,
                                542,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        293,
                                        542,
                                        304
                                    ],
                                    "score": 1.0,
                                    "content": "much longer sequences (e.g., up to length 64K). We also support more head dimensions (16, 32, 64, 128) and",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                69,
                                304,
                                398,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        304,
                                        398,
                                        317
                                    ],
                                    "score": 1.0,
                                    "content": "broader GPU types (all Turing and Ampere GPUs at the time of writing).",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 11.5,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        268,
                        542,
                        317
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        316,
                        541,
                        388
                    ],
                    "lines": [
                        {
                            "bbox": [
                                84,
                                316,
                                540,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        316,
                                        540,
                                        329
                                    ],
                                    "score": 1.0,
                                    "content": "In Table 7, we compare the performance of FlashAttention and Apex FMHA for short sequences (as",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                327,
                                541,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        327,
                                        541,
                                        342
                                    ],
                                    "score": 1.0,
                                    "content": "FMHA only supports sequence length at most 512). Generally FlashAttention is slightly faster than",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                340,
                                541,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        340,
                                        541,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "FMHA in the forward pass and slightly slower than FMHA in the backward pass. This is because we do not",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                352,
                                541,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        352,
                                        541,
                                        364
                                    ],
                                    "score": 1.0,
                                    "content": "store the attention matrix in the forward pass and recompute it in the backward pass. Compared to FMHA,",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                365,
                                541,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        365,
                                        541,
                                        376
                                    ],
                                    "score": 1.0,
                                    "content": "the overall runtime of FlashAttention is about 4% slower for sequence length 128, 8% faster for sequence",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                376,
                                290,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        376,
                                        290,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "length 256, and 5% faster for sequence length 512.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 16.5,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        316,
                        541,
                        387
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        401,
                        413,
                        416
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                402,
                                411,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        402,
                                        93,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "E.5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        102,
                                        403,
                                        411,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "Speedup On Different Hardware and Configurations",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 20,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        421,
                        541,
                        446
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                422,
                                541,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        422,
                                        541,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "Speedup varies between different types of GPU types and generations depending on HBM bandwidth and",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                433,
                                529,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        433,
                                        529,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "SRAM size. In this section, we profile FlashAttention speedup on different GPUs and configurations.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 21.5,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        422,
                        541,
                        446
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        109,
                        460,
                        501,
                        635
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                460,
                                501,
                                635
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        460,
                                        501,
                                        635
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                460,
                                                501,
                                                635
                                            ],
                                            "score": 0.968,
                                            "type": "image",
                                            "image_path": "0cc35fc7784396fec1083ebfb5be1ca5190960084233a1e920548d42ba5a5448.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 24,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        460,
                                        501,
                                        518.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        109,
                                        518.3333333333334,
                                        501,
                                        576.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        109,
                                        576.6666666666667,
                                        501,
                                        635.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 25
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                105,
                                649,
                                505,
                                661
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        649,
                                        505,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                649,
                                                505,
                                                662
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 5: Speedup over standard PyTorch attention at different sequence lengths, on A100.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 26
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 25.0,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        687,
                        540,
                        723
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                687,
                                540,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        687,
                                        540,
                                        700
                                    ],
                                    "score": 1.0,
                                    "content": "A100 Figure 5 shows speedup on an A100 GPU with batch size 8, head dimension 64, and 12 attention",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                700,
                                541,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        700,
                                        541,
                                        712
                                    ],
                                    "score": 1.0,
                                    "content": "heads, across different sequence lengths. We generally see 2-4× speedup, and we see more speedup when",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                712,
                                285,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        712,
                                        285,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "using dropout and masking due to kernel fusion.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 28,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        687,
                        541,
                        724
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        109,
                        75,
                        501,
                        242
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                75,
                                501,
                                242
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        75,
                                        501,
                                        242
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                75,
                                                501,
                                                242
                                            ],
                                            "score": 0.964,
                                            "type": "image",
                                            "image_path": "0c35a70be21fc504d9ad6f3f0bf1a3af7736678ca3fc54dfd57da7777facd252.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        75,
                                        501,
                                        130.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        109,
                                        130.66666666666666,
                                        501,
                                        186.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        109,
                                        186.33333333333331,
                                        501,
                                        241.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                255,
                                537,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        256,
                                        538,
                                        267
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                256,
                                                538,
                                                267
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 6: Speedup over standard PyTorch attention at different sequence lengths, on A100, with head",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        137,
                                        279
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                268,
                                                137,
                                                279
                                            ],
                                            "score": 1.0,
                                            "content": "dimension 128.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        300,
                        541,
                        348
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                301,
                                541,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        301,
                                        541,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "A100, Head Dimension 128 Speedup also changes when we increase the head dimension. Each block",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                69,
                                313,
                                541,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        313,
                                        541,
                                        325
                                    ],
                                    "score": 1.0,
                                    "content": "requires more memory, so we need to use smaller block sizes to fit into SRAM. Figure 6 shows speedup with",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                325,
                                540,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        325,
                                        540,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "head dimension 128 on an A100 (batch size 16, 12 heads). We see less speedup overall—but we can still see",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                337,
                                462,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        338,
                                        186,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": "significant speedup (up to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        337,
                                        200,
                                        348
                                    ],
                                    "score": 0.77,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        200,
                                        338,
                                        462,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": ") with a causal mask, where half the blocks are masked out.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 6.5
                },
                {
                    "type": "image",
                    "bbox": [
                        109,
                        363,
                        501,
                        538
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                363,
                                501,
                                538
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        501,
                                        538
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                363,
                                                501,
                                                538
                                            ],
                                            "score": 0.969,
                                            "type": "image",
                                            "image_path": "94b0ccb5baaa4f332fa3d14edc1ed161145c3a233d44ebb7ca5baedea247f64f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 10,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        501,
                                        421.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        109,
                                        421.3333333333333,
                                        501,
                                        479.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        109,
                                        479.66666666666663,
                                        501,
                                        538.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                92,
                                552,
                                515,
                                565
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        552,
                                        517,
                                        565
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                552,
                                                517,
                                                565
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 7: Speedup over standard PyTorch attention at different sequence lengths, on RTX 3090.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 12
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11.0
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        591,
                        541,
                        627
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                592,
                                541,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        541,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "RTX 3090 Figure 7 shows speedup on an RTX 3090 GPU. Here, we use batch size 12 with 12 attention",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                604,
                                541,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        604,
                                        401,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "heads. We observe slightly higher speedups on the RTX 3090 (between 2.5-4.5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        401,
                                        608,
                                        408,
                                        614
                                    ],
                                    "score": 0.4,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        408,
                                        604,
                                        541,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "), since the memory bandwidth",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                69,
                                615,
                                408,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        615,
                                        408,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "on an RTX 3090 is lower than on an A100 (roughly 900 GB/s vs. 1.5 TB/s).",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 14
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        640,
                        540,
                        689
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                642,
                                541,
                                654
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        642,
                                        541,
                                        654
                                    ],
                                    "score": 1.0,
                                    "content": "T4 Figure 8 shows speedup on a T4 GPU. T4 SRAM is smaller than A100, so we need to make the block",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                654,
                                540,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        654,
                                        540,
                                        665
                                    ],
                                    "score": 1.0,
                                    "content": "sizes smaller in FlashAttention. As a result, we observe less speedup on T4, which matches the IO",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                666,
                                541,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        666,
                                        541,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "complexity analysis in Section 3.2. T4 GPUs are commonly used for inference, so we also report speedup on",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                677,
                                168,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        677,
                                        168,
                                        690
                                    ],
                                    "score": 1.0,
                                    "content": "the forward pass only.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 17.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 28,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        109,
                        75,
                        501,
                        242
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                75,
                                501,
                                242
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        75,
                                        501,
                                        242
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                75,
                                                501,
                                                242
                                            ],
                                            "score": 0.964,
                                            "type": "image",
                                            "image_path": "0c35a70be21fc504d9ad6f3f0bf1a3af7736678ca3fc54dfd57da7777facd252.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        75,
                                        501,
                                        130.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        109,
                                        130.66666666666666,
                                        501,
                                        186.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        109,
                                        186.33333333333331,
                                        501,
                                        241.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                255,
                                537,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        256,
                                        538,
                                        267
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                256,
                                                538,
                                                267
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 6: Speedup over standard PyTorch attention at different sequence lengths, on A100, with head",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        137,
                                        279
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                268,
                                                137,
                                                279
                                            ],
                                            "score": 1.0,
                                            "content": "dimension 128.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                },
                {
                    "type": "image",
                    "bbox": [
                        109,
                        363,
                        501,
                        538
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                363,
                                501,
                                538
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        501,
                                        538
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                363,
                                                501,
                                                538
                                            ],
                                            "score": 0.969,
                                            "type": "image",
                                            "image_path": "94b0ccb5baaa4f332fa3d14edc1ed161145c3a233d44ebb7ca5baedea247f64f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 10,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        501,
                                        421.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        109,
                                        421.3333333333333,
                                        501,
                                        479.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        109,
                                        479.66666666666663,
                                        501,
                                        538.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                92,
                                552,
                                515,
                                565
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        552,
                                        517,
                                        565
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                552,
                                                517,
                                                565
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 7: Speedup over standard PyTorch attention at different sequence lengths, on RTX 3090.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 12
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11.0
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "29",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        109,
                        75,
                        501,
                        242
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                75,
                                501,
                                242
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        75,
                                        501,
                                        242
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                75,
                                                501,
                                                242
                                            ],
                                            "score": 0.964,
                                            "type": "image",
                                            "image_path": "0c35a70be21fc504d9ad6f3f0bf1a3af7736678ca3fc54dfd57da7777facd252.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        75,
                                        501,
                                        130.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        109,
                                        130.66666666666666,
                                        501,
                                        186.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        109,
                                        186.33333333333331,
                                        501,
                                        241.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                255,
                                537,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        256,
                                        538,
                                        267
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                256,
                                                538,
                                                267
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 6: Speedup over standard PyTorch attention at different sequence lengths, on A100, with head",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        137,
                                        279
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                268,
                                                137,
                                                279
                                            ],
                                            "score": 1.0,
                                            "content": "dimension 128.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25,
                    "page_num": "page_28",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        300,
                        541,
                        348
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                301,
                                541,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        301,
                                        541,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "A100, Head Dimension 128 Speedup also changes when we increase the head dimension. Each block",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                69,
                                313,
                                541,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        313,
                                        541,
                                        325
                                    ],
                                    "score": 1.0,
                                    "content": "requires more memory, so we need to use smaller block sizes to fit into SRAM. Figure 6 shows speedup with",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                325,
                                540,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        325,
                                        540,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "head dimension 128 on an A100 (batch size 16, 12 heads). We see less speedup overall—but we can still see",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                337,
                                462,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        338,
                                        186,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": "significant speedup (up to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        337,
                                        200,
                                        348
                                    ],
                                    "score": 0.77,
                                    "content": "3\\times",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        200,
                                        338,
                                        462,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": ") with a causal mask, where half the blocks are masked out.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 6.5,
                    "page_num": "page_28",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        301,
                        541,
                        348
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        109,
                        363,
                        501,
                        538
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                363,
                                501,
                                538
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        501,
                                        538
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                363,
                                                501,
                                                538
                                            ],
                                            "score": 0.969,
                                            "type": "image",
                                            "image_path": "94b0ccb5baaa4f332fa3d14edc1ed161145c3a233d44ebb7ca5baedea247f64f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 10,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        363,
                                        501,
                                        421.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        109,
                                        421.3333333333333,
                                        501,
                                        479.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        109,
                                        479.66666666666663,
                                        501,
                                        538.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                92,
                                552,
                                515,
                                565
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        552,
                                        517,
                                        565
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                552,
                                                517,
                                                565
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 7: Speedup over standard PyTorch attention at different sequence lengths, on RTX 3090.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 12
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11.0,
                    "page_num": "page_28",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        591,
                        541,
                        627
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                592,
                                541,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        541,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "RTX 3090 Figure 7 shows speedup on an RTX 3090 GPU. Here, we use batch size 12 with 12 attention",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                604,
                                541,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        604,
                                        401,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "heads. We observe slightly higher speedups on the RTX 3090 (between 2.5-4.5",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        401,
                                        608,
                                        408,
                                        614
                                    ],
                                    "score": 0.4,
                                    "content": "\\times",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        408,
                                        604,
                                        541,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "), since the memory bandwidth",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                69,
                                615,
                                408,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        615,
                                        408,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "on an RTX 3090 is lower than on an A100 (roughly 900 GB/s vs. 1.5 TB/s).",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 14,
                    "page_num": "page_28",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        592,
                        541,
                        628
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        640,
                        540,
                        689
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                642,
                                541,
                                654
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        642,
                                        541,
                                        654
                                    ],
                                    "score": 1.0,
                                    "content": "T4 Figure 8 shows speedup on a T4 GPU. T4 SRAM is smaller than A100, so we need to make the block",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                654,
                                540,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        654,
                                        540,
                                        665
                                    ],
                                    "score": 1.0,
                                    "content": "sizes smaller in FlashAttention. As a result, we observe less speedup on T4, which matches the IO",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                666,
                                541,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        666,
                                        541,
                                        677
                                    ],
                                    "score": 1.0,
                                    "content": "complexity analysis in Section 3.2. T4 GPUs are commonly used for inference, so we also report speedup on",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                677,
                                168,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        677,
                                        168,
                                        690
                                    ],
                                    "score": 1.0,
                                    "content": "the forward pass only.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 17.5,
                    "page_num": "page_28",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        642,
                        541,
                        690
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        109,
                        76,
                        501,
                        432
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                76,
                                501,
                                432
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        76,
                                        501,
                                        432
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                76,
                                                501,
                                                432
                                            ],
                                            "score": 0.975,
                                            "type": "image",
                                            "image_path": "4de6e74195bb88d0d29a7d8047e451e5ae8eafd5e86dfb86edc69d04017d667f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        76,
                                        501,
                                        194.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        109,
                                        194.66666666666669,
                                        501,
                                        313.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        109,
                                        313.33333333333337,
                                        501,
                                        432.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                445,
                                538,
                                470
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        447,
                                        539,
                                        457
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                447,
                                                539,
                                                457
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 8: Speedup over standard PyTorch attention at different sequence lengths, on T4. Top: Combined",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        459,
                                        338,
                                        469
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                459,
                                                128,
                                                469
                                            ],
                                            "score": 1.0,
                                            "content": "forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                129,
                                                459,
                                                138,
                                                469
                                            ],
                                            "score": 0.6,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                139,
                                                459,
                                                338,
                                                469
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass. Bottom: Forward pass only.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        489,
                        264,
                        504
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                489,
                                263,
                                503
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        489,
                                        93,
                                        503
                                    ],
                                    "score": 1.0,
                                    "content": "E.6",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        491,
                                        263,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "Full Benchmarking Results",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        509,
                        398,
                        522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                510,
                                399,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        510,
                                        399,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "We report the full benchmarking results and experimental details on A100.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 6
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        535,
                        541,
                        619
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                535,
                                541,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        535,
                                        541,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "Baselines We compare against reference implementations for exact attention from PyTorch/HuggingFace",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                548,
                                541,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        548,
                                        541,
                                        560
                                    ],
                                    "score": 1.0,
                                    "content": "and Megatron, approximate attention, and sparse attention. For approximate attention, we compare against",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                561,
                                540,
                                571
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        561,
                                        540,
                                        571
                                    ],
                                    "score": 1.0,
                                    "content": "reference implementations of Reformer [51], Local Attention [68], Linformer Attention [84], Smyrf [19], and",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                571,
                                542,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        571,
                                        542,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "LongShortFormer (LSFormer) [94]. For sparse attention, we compare against reference implementations of",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                542,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        542,
                                        597
                                    ],
                                    "score": 1.0,
                                    "content": "Block-Sparse Attention form OpenAI [11], Longformer[3], and BigBird Attention [92]. For the approximate",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        596,
                                        293,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": "and sparse attention, we use a compression ratio of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        293,
                                        597,
                                        308,
                                        608
                                    ],
                                    "score": 0.49,
                                    "content": "1/8",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        308,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": ", or a compressed sequence length of 256, whichever is",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                106,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        106,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "smaller.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        633,
                        541,
                        717
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                633,
                                541,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        633,
                                        541,
                                        645
                                    ],
                                    "score": 1.0,
                                    "content": "Setup We measure runtime and memory usage of the attention computation with 8 heads of dimension 64,",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                69,
                                644,
                                541,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        644,
                                        541,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "and batch size 16 on a machine with one A100 GPU with 40 GB of GPU HBM. We vary sequence length",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                659,
                                540,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        659,
                                        372,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": "in our experiments. We compute attention on random vectors for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        372,
                                        660,
                                        380,
                                        669
                                    ],
                                    "score": 0.8,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        380,
                                        659,
                                        385,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": ", ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        386,
                                        660,
                                        394,
                                        667
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        395,
                                        659,
                                        420,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": ", and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        421,
                                        660,
                                        429,
                                        667
                                    ],
                                    "score": 0.58,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        429,
                                        659,
                                        540,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": " (we do not measure the",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                69,
                                669,
                                541,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        669,
                                        541,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "projection from the hidden layer). For dropout, we use dropout 0.1; for masking, we use a padding mask",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                682,
                                541,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        682,
                                        541,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "with uniformly-random mask lengths between the total sequence length and the total sequence length minus",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                694,
                                541,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        694,
                                        541,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "20. To measure runtime, we take the average of 100 measurements of the attention call. We only measure",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                706,
                                335,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        706,
                                        335,
                                        716
                                    ],
                                    "score": 1.0,
                                    "content": "memory footprint once, since it does not vary between runs.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 17
                }
            ],
            "layout_bboxes": [],
            "page_idx": 29,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        109,
                        76,
                        501,
                        432
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                76,
                                501,
                                432
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        76,
                                        501,
                                        432
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                76,
                                                501,
                                                432
                                            ],
                                            "score": 0.975,
                                            "type": "image",
                                            "image_path": "4de6e74195bb88d0d29a7d8047e451e5ae8eafd5e86dfb86edc69d04017d667f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        76,
                                        501,
                                        194.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        109,
                                        194.66666666666669,
                                        501,
                                        313.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        109,
                                        313.33333333333337,
                                        501,
                                        432.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                445,
                                538,
                                470
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        447,
                                        539,
                                        457
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                447,
                                                539,
                                                457
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 8: Speedup over standard PyTorch attention at different sequence lengths, on T4. Top: Combined",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        459,
                                        338,
                                        469
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                459,
                                                128,
                                                469
                                            ],
                                            "score": 1.0,
                                            "content": "forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                129,
                                                459,
                                                138,
                                                469
                                            ],
                                            "score": 0.6,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                139,
                                                459,
                                                338,
                                                469
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass. Bottom: Forward pass only.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "30",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        109,
                        76,
                        501,
                        432
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                109,
                                76,
                                501,
                                432
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        109,
                                        76,
                                        501,
                                        432
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                109,
                                                76,
                                                501,
                                                432
                                            ],
                                            "score": 0.975,
                                            "type": "image",
                                            "image_path": "4de6e74195bb88d0d29a7d8047e451e5ae8eafd5e86dfb86edc69d04017d667f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        109,
                                        76,
                                        501,
                                        194.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        109,
                                        194.66666666666669,
                                        501,
                                        313.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        109,
                                        313.33333333333337,
                                        501,
                                        432.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                445,
                                538,
                                470
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        447,
                                        539,
                                        457
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                447,
                                                539,
                                                457
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 8: Speedup over standard PyTorch attention at different sequence lengths, on T4. Top: Combined",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        459,
                                        338,
                                        469
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                459,
                                                128,
                                                469
                                            ],
                                            "score": 1.0,
                                            "content": "forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                129,
                                                459,
                                                138,
                                                469
                                            ],
                                            "score": 0.6,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                139,
                                                459,
                                                338,
                                                469
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass. Bottom: Forward pass only.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25,
                    "page_num": "page_29",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        489,
                        264,
                        504
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                489,
                                263,
                                503
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        489,
                                        93,
                                        503
                                    ],
                                    "score": 1.0,
                                    "content": "E.6",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        103,
                                        491,
                                        263,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "Full Benchmarking Results",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5,
                    "page_num": "page_29",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        509,
                        398,
                        522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                510,
                                399,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        510,
                                        399,
                                        521
                                    ],
                                    "score": 1.0,
                                    "content": "We report the full benchmarking results and experimental details on A100.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 6,
                    "page_num": "page_29",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        510,
                        399,
                        521
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        535,
                        541,
                        619
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                535,
                                541,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        535,
                                        541,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "Baselines We compare against reference implementations for exact attention from PyTorch/HuggingFace",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                548,
                                541,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        548,
                                        541,
                                        560
                                    ],
                                    "score": 1.0,
                                    "content": "and Megatron, approximate attention, and sparse attention. For approximate attention, we compare against",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                561,
                                540,
                                571
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        561,
                                        540,
                                        571
                                    ],
                                    "score": 1.0,
                                    "content": "reference implementations of Reformer [51], Local Attention [68], Linformer Attention [84], Smyrf [19], and",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                571,
                                542,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        571,
                                        542,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "LongShortFormer (LSFormer) [94]. For sparse attention, we compare against reference implementations of",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                542,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        542,
                                        597
                                    ],
                                    "score": 1.0,
                                    "content": "Block-Sparse Attention form OpenAI [11], Longformer[3], and BigBird Attention [92]. For the approximate",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        596,
                                        293,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": "and sparse attention, we use a compression ratio of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        293,
                                        597,
                                        308,
                                        608
                                    ],
                                    "score": 0.49,
                                    "content": "1/8",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 15
                                },
                                {
                                    "bbox": [
                                        308,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 1.0,
                                    "content": ", or a compressed sequence length of 256, whichever is",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                106,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        106,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "smaller.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 10,
                    "page_num": "page_29",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        535,
                        542,
                        619
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        633,
                        541,
                        717
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                633,
                                541,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        633,
                                        541,
                                        645
                                    ],
                                    "score": 1.0,
                                    "content": "Setup We measure runtime and memory usage of the attention computation with 8 heads of dimension 64,",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                69,
                                644,
                                541,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        644,
                                        541,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "and batch size 16 on a machine with one A100 GPU with 40 GB of GPU HBM. We vary sequence length",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                659,
                                540,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        659,
                                        372,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": "in our experiments. We compute attention on random vectors for ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        372,
                                        660,
                                        380,
                                        669
                                    ],
                                    "score": 0.8,
                                    "content": "\\mathbf{Q}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        380,
                                        659,
                                        385,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": ", ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        386,
                                        660,
                                        394,
                                        667
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathbf{K}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        395,
                                        659,
                                        420,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": ", and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        421,
                                        660,
                                        429,
                                        667
                                    ],
                                    "score": 0.58,
                                    "content": "\\mathbf{V}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        429,
                                        659,
                                        540,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": " (we do not measure the",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                69,
                                669,
                                541,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        669,
                                        541,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "projection from the hidden layer). For dropout, we use dropout 0.1; for masking, we use a padding mask",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                682,
                                541,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        682,
                                        541,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "with uniformly-random mask lengths between the total sequence length and the total sequence length minus",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                694,
                                541,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        694,
                                        541,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "20. To measure runtime, we take the average of 100 measurements of the attention call. We only measure",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                706,
                                335,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        706,
                                        335,
                                        716
                                    ],
                                    "score": 1.0,
                                    "content": "memory footprint once, since it does not vary between runs.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 17,
                    "page_num": "page_29",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        633,
                        541,
                        716
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        159,
                        92,
                        453,
                        267
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                229,
                                72,
                                381,
                                84
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        229,
                                        72,
                                        380,
                                        83
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                229,
                                                72,
                                                380,
                                                83
                                            ],
                                            "score": 1.0,
                                            "content": "Table 8: Pointers to results tables.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                159,
                                92,
                                453,
                                267
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        159,
                                        92,
                                        453,
                                        267
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                159,
                                                92,
                                                453,
                                                267
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "653df3e5113cc7e2be5e35cb73b47b6588fb7cd8fc4d891e3d0dbe0527248076.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        159,
                                        92,
                                        453,
                                        150.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        159,
                                        150.33333333333334,
                                        453,
                                        208.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        159,
                                        208.66666666666669,
                                        453,
                                        267.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0
                },
                {
                    "type": "table",
                    "bbox": [
                        85,
                        312,
                        523,
                        425
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                68,
                                281,
                                542,
                                303
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        281,
                                        541,
                                        293
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                281,
                                                541,
                                                293
                                            ],
                                            "score": 1.0,
                                            "content": "Table 9: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        293,
                                        353,
                                        302
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                293,
                                                353,
                                                302
                                            ],
                                            "score": 1.0,
                                            "content": "with dropout and masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                }
                            ],
                            "index": 4.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                85,
                                312,
                                523,
                                425
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        85,
                                        312,
                                        523,
                                        425
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                85,
                                                312,
                                                523,
                                                425
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "09ffed922064f0eb20d0e3bed0b8c5a1e6f50ea8252bc0fb56191ab9cc2495c9.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        85,
                                        312,
                                        523,
                                        349.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        85,
                                        349.6666666666667,
                                        523,
                                        387.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        85,
                                        387.33333333333337,
                                        523,
                                        425.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 8
                                }
                            ]
                        }
                    ],
                    "index": 5.75
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        445,
                        542,
                        505
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                445,
                                542,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        445,
                                        462,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "We report timing results on the forward pass, backward pass, and combined forward",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        446,
                                        472,
                                        456
                                    ],
                                    "score": 0.36,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        473,
                                        445,
                                        542,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                457,
                                541,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        457,
                                        541,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "We measure each method with and without dropout, masking, or both—except for Block Sparse, Longformer,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                470,
                                541,
                                481
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        470,
                                        541,
                                        481
                                    ],
                                    "score": 1.0,
                                    "content": "and BigBird. These methods did not successfully run the backward pass with masking due to a bug in",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                482,
                                541,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        482,
                                        541,
                                        493
                                    ],
                                    "score": 1.0,
                                    "content": "external libraries, so we measured them without masking to be generous. We use FP16 for all measurements,",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                494,
                                384,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        494,
                                        384,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "except for Local Attention, whose implementation only supports FP32.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 11
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        505,
                        541,
                        552
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                506,
                                539,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        506,
                                        539,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "For each baseline, we increase sequence length until it runs out of memory on the GPU, except for the",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                518,
                                541,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        518,
                                        541,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "following exceptions: The Megatron implementation does not support sequence lengths longer than 2048.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                530,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        530,
                                        541,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "Block-Sparse (OpenAI) does not support sequence lengths longer than 4096. Longformer and BigBird do not",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                542,
                                260,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        542,
                                        260,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "support sequence lengths longer than 8092.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 15.5
                },
                {
                    "type": "text",
                    "bbox": [
                        77,
                        553,
                        530,
                        565
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                554,
                                525,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        554,
                                        319,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "We measure memory usage on the combined forward ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        556,
                                        328,
                                        564
                                    ],
                                    "score": 0.29,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        328,
                                        554,
                                        525,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass, without dropout or masking.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        578,
                        537,
                        591
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                579,
                                539,
                                591
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        579,
                                        539,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "Results Table 8 summarizes all the experimental configurations and contains pointers to the results tables.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19
                }
            ],
            "layout_bboxes": [],
            "page_idx": 30,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        159,
                        92,
                        453,
                        267
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                229,
                                72,
                                381,
                                84
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        229,
                                        72,
                                        380,
                                        83
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                229,
                                                72,
                                                380,
                                                83
                                            ],
                                            "score": 1.0,
                                            "content": "Table 8: Pointers to results tables.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                159,
                                92,
                                453,
                                267
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        159,
                                        92,
                                        453,
                                        267
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                159,
                                                92,
                                                453,
                                                267
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "653df3e5113cc7e2be5e35cb73b47b6588fb7cd8fc4d891e3d0dbe0527248076.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        159,
                                        92,
                                        453,
                                        150.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        159,
                                        150.33333333333334,
                                        453,
                                        208.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        159,
                                        208.66666666666669,
                                        453,
                                        267.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0
                },
                {
                    "type": "table",
                    "bbox": [
                        85,
                        312,
                        523,
                        425
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                68,
                                281,
                                542,
                                303
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        281,
                                        541,
                                        293
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                281,
                                                541,
                                                293
                                            ],
                                            "score": 1.0,
                                            "content": "Table 9: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        293,
                                        353,
                                        302
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                293,
                                                353,
                                                302
                                            ],
                                            "score": 1.0,
                                            "content": "with dropout and masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                }
                            ],
                            "index": 4.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                85,
                                312,
                                523,
                                425
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        85,
                                        312,
                                        523,
                                        425
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                85,
                                                312,
                                                523,
                                                425
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "09ffed922064f0eb20d0e3bed0b8c5a1e6f50ea8252bc0fb56191ab9cc2495c9.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        85,
                                        312,
                                        523,
                                        349.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        85,
                                        349.6666666666667,
                                        523,
                                        387.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        85,
                                        387.33333333333337,
                                        523,
                                        425.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 8
                                }
                            ]
                        }
                    ],
                    "index": 5.75
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        310,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "score": 1.0,
                                    "content": "",
                                    "type": "text",
                                    "height": 13,
                                    "width": 15
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        159,
                        92,
                        453,
                        267
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                229,
                                72,
                                381,
                                84
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        229,
                                        72,
                                        380,
                                        83
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                229,
                                                72,
                                                380,
                                                83
                                            ],
                                            "score": 1.0,
                                            "content": "Table 8: Pointers to results tables.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                159,
                                92,
                                453,
                                267
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        159,
                                        92,
                                        453,
                                        267
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                159,
                                                92,
                                                453,
                                                267
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "653df3e5113cc7e2be5e35cb73b47b6588fb7cd8fc4d891e3d0dbe0527248076.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        159,
                                        92,
                                        453,
                                        150.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        159,
                                        150.33333333333334,
                                        453,
                                        208.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        159,
                                        208.66666666666669,
                                        453,
                                        267.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0,
                    "page_num": "page_30",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        85,
                        312,
                        523,
                        425
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                68,
                                281,
                                542,
                                303
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        281,
                                        541,
                                        293
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                281,
                                                541,
                                                293
                                            ],
                                            "score": 1.0,
                                            "content": "Table 9: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        293,
                                        353,
                                        302
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                293,
                                                353,
                                                302
                                            ],
                                            "score": 1.0,
                                            "content": "with dropout and masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                }
                            ],
                            "index": 4.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                85,
                                312,
                                523,
                                425
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        85,
                                        312,
                                        523,
                                        425
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                85,
                                                312,
                                                523,
                                                425
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "09ffed922064f0eb20d0e3bed0b8c5a1e6f50ea8252bc0fb56191ab9cc2495c9.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        85,
                                        312,
                                        523,
                                        349.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        85,
                                        349.6666666666667,
                                        523,
                                        387.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        85,
                                        387.33333333333337,
                                        523,
                                        425.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 8
                                }
                            ]
                        }
                    ],
                    "index": 5.75,
                    "page_num": "page_30",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        445,
                        542,
                        505
                    ],
                    "lines": [
                        {
                            "bbox": [
                                85,
                                445,
                                542,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        445,
                                        462,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "We report timing results on the forward pass, backward pass, and combined forward",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        462,
                                        446,
                                        472,
                                        456
                                    ],
                                    "score": 0.36,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        473,
                                        445,
                                        542,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                457,
                                541,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        457,
                                        541,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "We measure each method with and without dropout, masking, or both—except for Block Sparse, Longformer,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                470,
                                541,
                                481
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        470,
                                        541,
                                        481
                                    ],
                                    "score": 1.0,
                                    "content": "and BigBird. These methods did not successfully run the backward pass with masking due to a bug in",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                482,
                                541,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        482,
                                        541,
                                        493
                                    ],
                                    "score": 1.0,
                                    "content": "external libraries, so we measured them without masking to be generous. We use FP16 for all measurements,",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                494,
                                384,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        494,
                                        384,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "except for Local Attention, whose implementation only supports FP32.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 11,
                    "page_num": "page_30",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        445,
                        542,
                        506
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        505,
                        541,
                        552
                    ],
                    "lines": [
                        {
                            "bbox": [
                                86,
                                506,
                                539,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        506,
                                        539,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "For each baseline, we increase sequence length until it runs out of memory on the GPU, except for the",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                518,
                                541,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        518,
                                        541,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "following exceptions: The Megatron implementation does not support sequence lengths longer than 2048.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                530,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        530,
                                        541,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "Block-Sparse (OpenAI) does not support sequence lengths longer than 4096. Longformer and BigBird do not",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                542,
                                260,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        542,
                                        260,
                                        553
                                    ],
                                    "score": 1.0,
                                    "content": "support sequence lengths longer than 8092.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 15.5,
                    "page_num": "page_30",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        506,
                        541,
                        553
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        77,
                        553,
                        530,
                        565
                    ],
                    "lines": [
                        {
                            "bbox": [
                                87,
                                554,
                                525,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        554,
                                        319,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "We measure memory usage on the combined forward ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        320,
                                        556,
                                        328,
                                        564
                                    ],
                                    "score": 0.29,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        328,
                                        554,
                                        525,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass, without dropout or masking.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18,
                    "page_num": "page_30",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        87,
                        554,
                        525,
                        565
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        578,
                        537,
                        591
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                579,
                                539,
                                591
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        579,
                                        539,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "Results Table 8 summarizes all the experimental configurations and contains pointers to the results tables.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19,
                    "page_num": "page_30",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        579,
                        539,
                        591
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        81,
                        109,
                        528,
                        223
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                78,
                                540,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        541,
                                        90
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                541,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": "Table 10: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        89,
                                        353,
                                        101
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                89,
                                                353,
                                                101
                                            ],
                                            "score": 1.0,
                                            "content": "with dropout and masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                109,
                                528,
                                223
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        109,
                                        528,
                                        223
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                109,
                                                528,
                                                223
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "ca687cea1ee1f7c115728c69501080a93c065d35d9d40aa9a9218333572b2b59.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        109,
                                        528,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        81,
                                        147.0,
                                        528,
                                        185.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        81,
                                        185.0,
                                        528,
                                        223.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        242,
                        540,
                        264
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                243,
                                540,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        243,
                                        165,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "Table 11: Forward pass",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        166,
                                        243,
                                        175,
                                        252
                                    ],
                                    "score": 0.62,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        243,
                                        540,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                72,
                                254,
                                422,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        254,
                                        422,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "sequence length, with dropout and masking. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5.5
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        273,
                        531,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                273,
                                531,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        273,
                                        531,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                273,
                                                531,
                                                387
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "84fabe8f291cc854fe78a51c60c307d02531377534ec96cc4df3d26e1a24d1f5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        273,
                                        531,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        78,
                                        311.0,
                                        531,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        78,
                                        349.0,
                                        531,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        406,
                        539,
                        428
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                406,
                                539,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        406,
                                        539,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Table 12: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                417,
                                292,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        292,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "with masking. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "table",
                    "bbox": [
                        83,
                        438,
                        526,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                83,
                                438,
                                526,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        83,
                                        438,
                                        526,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                83,
                                                438,
                                                526,
                                                550
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "772953733c930c9c16e2c0c81adf6bcecc5381480b5c8efa85450b954bdbe9f6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        83,
                                        438,
                                        526,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        83,
                                        475.3333333333333,
                                        526,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        83,
                                        512.6666666666666,
                                        526,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        570,
                        538,
                        592
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                571,
                                538,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        571,
                                        538,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "Table 13: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                72,
                                581,
                                291,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        581,
                                        291,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "with masking. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        601,
                        527,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                601,
                                527,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        601,
                                        527,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                601,
                                                527,
                                                714
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "d69944a581c6d31b1a493458c86e5e1be99c36afd52e7796f372e636123128de.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        601,
                                        527,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        81,
                                        638.6666666666666,
                                        527,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        81,
                                        676.3333333333333,
                                        527,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18
                }
            ],
            "layout_bboxes": [],
            "page_idx": 31,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        81,
                        109,
                        528,
                        223
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                78,
                                540,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        541,
                                        90
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                541,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": "Table 10: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        89,
                                        353,
                                        101
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                89,
                                                353,
                                                101
                                            ],
                                            "score": 1.0,
                                            "content": "with dropout and masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                109,
                                528,
                                223
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        109,
                                        528,
                                        223
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                109,
                                                528,
                                                223
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "ca687cea1ee1f7c115728c69501080a93c065d35d9d40aa9a9218333572b2b59.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        109,
                                        528,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        81,
                                        147.0,
                                        528,
                                        185.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        81,
                                        185.0,
                                        528,
                                        223.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        273,
                        531,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                273,
                                531,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        273,
                                        531,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                273,
                                                531,
                                                387
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "84fabe8f291cc854fe78a51c60c307d02531377534ec96cc4df3d26e1a24d1f5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        273,
                                        531,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        78,
                                        311.0,
                                        531,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        78,
                                        349.0,
                                        531,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "table",
                    "bbox": [
                        83,
                        438,
                        526,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                83,
                                438,
                                526,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        83,
                                        438,
                                        526,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                83,
                                                438,
                                                526,
                                                550
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "772953733c930c9c16e2c0c81adf6bcecc5381480b5c8efa85450b954bdbe9f6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        83,
                                        438,
                                        526,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        83,
                                        475.3333333333333,
                                        526,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        83,
                                        512.6666666666666,
                                        526,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        601,
                        527,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                601,
                                527,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        601,
                                        527,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                601,
                                                527,
                                                714
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "d69944a581c6d31b1a493458c86e5e1be99c36afd52e7796f372e636123128de.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        601,
                                        527,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        81,
                                        638.6666666666666,
                                        527,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        81,
                                        676.3333333333333,
                                        527,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "32",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        81,
                        109,
                        528,
                        223
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                78,
                                540,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        541,
                                        90
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                541,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": "Table 10: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        89,
                                        353,
                                        101
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                89,
                                                353,
                                                101
                                            ],
                                            "score": 1.0,
                                            "content": "with dropout and masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                109,
                                528,
                                223
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        109,
                                        528,
                                        223
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                109,
                                                528,
                                                223
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "ca687cea1ee1f7c115728c69501080a93c065d35d9d40aa9a9218333572b2b59.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        109,
                                        528,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        81,
                                        147.0,
                                        528,
                                        185.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        81,
                                        185.0,
                                        528,
                                        223.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        242,
                        540,
                        264
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                243,
                                540,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        243,
                                        165,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": "Table 11: Forward pass",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        166,
                                        243,
                                        175,
                                        252
                                    ],
                                    "score": 0.62,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        243,
                                        540,
                                        253
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                72,
                                254,
                                422,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        254,
                                        422,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "sequence length, with dropout and masking. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5.5,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        243,
                        540,
                        264
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        273,
                        531,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                273,
                                531,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        273,
                                        531,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                273,
                                                531,
                                                387
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "84fabe8f291cc854fe78a51c60c307d02531377534ec96cc4df3d26e1a24d1f5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        273,
                                        531,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        78,
                                        311.0,
                                        531,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        78,
                                        349.0,
                                        531,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 8,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        406,
                        539,
                        428
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                406,
                                539,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        406,
                                        539,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Table 12: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                417,
                                292,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        292,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "with masking. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        406,
                        539,
                        429
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        83,
                        438,
                        526,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                83,
                                438,
                                526,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        83,
                                        438,
                                        526,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                83,
                                                438,
                                                526,
                                                550
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "772953733c930c9c16e2c0c81adf6bcecc5381480b5c8efa85450b954bdbe9f6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        83,
                                        438,
                                        526,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        83,
                                        475.3333333333333,
                                        526,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        83,
                                        512.6666666666666,
                                        526,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        }
                    ],
                    "index": 13,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        570,
                        538,
                        592
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                571,
                                538,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        571,
                                        538,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "Table 13: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                72,
                                581,
                                291,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        581,
                                        291,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "with masking. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        571,
                        538,
                        592
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        601,
                        527,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                601,
                                527,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        601,
                                        527,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                601,
                                                527,
                                                714
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "d69944a581c6d31b1a493458c86e5e1be99c36afd52e7796f372e636123128de.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        601,
                                        527,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        81,
                                        638.6666666666666,
                                        527,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        81,
                                        676.3333333333333,
                                        527,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        78,
                        109,
                        531,
                        223
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                78,
                                539,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        540,
                                        90
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                165,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": "Table 14: Forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                166,
                                                79,
                                                175,
                                                88
                                            ],
                                            "score": 0.48,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                176,
                                                78,
                                                540,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        70,
                                        90,
                                        362,
                                        100
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                90,
                                                362,
                                                100
                                            ],
                                            "score": 1.0,
                                            "content": "sequence length, with masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                109,
                                531,
                                223
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        109,
                                        531,
                                        223
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                109,
                                                531,
                                                223
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "3500ca56bcda62a0f3a1af9eedd21663b0c23a61f4b7b0978486e3c6bff97569.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        109,
                                        531,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        78,
                                        147.0,
                                        531,
                                        185.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        78,
                                        185.0,
                                        531,
                                        223.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        242,
                        539,
                        264
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                243,
                                538,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        243,
                                        538,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "Table 15: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                72,
                                253,
                                290,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        253,
                                        290,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "with dropout. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5.5
                },
                {
                    "type": "table",
                    "bbox": [
                        85,
                        273,
                        523,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                85,
                                273,
                                523,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        85,
                                        273,
                                        523,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                85,
                                                273,
                                                523,
                                                387
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "7b7f0831a09ebafe7f0af1398f9a33569f06b9d425b2e915cc706d50b0396ea4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        85,
                                        273,
                                        523,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        85,
                                        311.0,
                                        523,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        85,
                                        349.0,
                                        523,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        406,
                        540,
                        428
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                406,
                                541,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        406,
                                        541,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Table 16: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                417,
                                291,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        291,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "with dropout. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        438,
                        528,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                438,
                                528,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        438,
                                        528,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                438,
                                                528,
                                                550
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "c8c4461bc78b19932d2bf9d2ba50b12cb9e91087eda60d82b07757a328970264.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        438,
                                        528,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        81,
                                        475.3333333333333,
                                        528,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        81,
                                        512.6666666666666,
                                        528,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        570,
                        538,
                        592
                    ],
                    "lines": [
                        {
                            "bbox": [
                                75,
                                571,
                                539,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        571,
                                        165,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "able 17: Forward pass",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        166,
                                        571,
                                        175,
                                        580
                                    ],
                                    "score": 0.55,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        571,
                                        539,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                75,
                                582,
                                361,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        582,
                                        361,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "equence length, with dropout. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        601,
                        530,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                601,
                                530,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        601,
                                        530,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                601,
                                                530,
                                                714
                                            ],
                                            "score": 0.983,
                                            "type": "table",
                                            "image_path": "ffb58d66dd156a50519d916d96510dc1886e4df1581be16cfc20a48bf2bb48cb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        601,
                                        530,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        78,
                                        638.6666666666666,
                                        530,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        78,
                                        676.3333333333333,
                                        530,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18
                }
            ],
            "layout_bboxes": [],
            "page_idx": 32,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        78,
                        109,
                        531,
                        223
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                78,
                                539,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        540,
                                        90
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                165,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": "Table 14: Forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                166,
                                                79,
                                                175,
                                                88
                                            ],
                                            "score": 0.48,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                176,
                                                78,
                                                540,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        70,
                                        90,
                                        362,
                                        100
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                90,
                                                362,
                                                100
                                            ],
                                            "score": 1.0,
                                            "content": "sequence length, with masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                109,
                                531,
                                223
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        109,
                                        531,
                                        223
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                109,
                                                531,
                                                223
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "3500ca56bcda62a0f3a1af9eedd21663b0c23a61f4b7b0978486e3c6bff97569.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        109,
                                        531,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        78,
                                        147.0,
                                        531,
                                        185.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        78,
                                        185.0,
                                        531,
                                        223.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                },
                {
                    "type": "table",
                    "bbox": [
                        85,
                        273,
                        523,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                85,
                                273,
                                523,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        85,
                                        273,
                                        523,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                85,
                                                273,
                                                523,
                                                387
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "7b7f0831a09ebafe7f0af1398f9a33569f06b9d425b2e915cc706d50b0396ea4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        85,
                                        273,
                                        523,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        85,
                                        311.0,
                                        523,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        85,
                                        349.0,
                                        523,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        438,
                        528,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                438,
                                528,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        438,
                                        528,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                438,
                                                528,
                                                550
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "c8c4461bc78b19932d2bf9d2ba50b12cb9e91087eda60d82b07757a328970264.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        438,
                                        528,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        81,
                                        475.3333333333333,
                                        528,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        81,
                                        512.6666666666666,
                                        528,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        601,
                        530,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                601,
                                530,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        601,
                                        530,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                601,
                                                530,
                                                714
                                            ],
                                            "score": 0.983,
                                            "type": "table",
                                            "image_path": "ffb58d66dd156a50519d916d96510dc1886e4df1581be16cfc20a48bf2bb48cb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        601,
                                        530,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        78,
                                        638.6666666666666,
                                        530,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        78,
                                        676.3333333333333,
                                        530,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        752
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "33",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        78,
                        109,
                        531,
                        223
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                78,
                                539,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        540,
                                        90
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                165,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": "Table 14: Forward pass",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                166,
                                                79,
                                                175,
                                                88
                                            ],
                                            "score": 0.48,
                                            "content": "+",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 9
                                        },
                                        {
                                            "bbox": [
                                                176,
                                                78,
                                                540,
                                                90
                                            ],
                                            "score": 1.0,
                                            "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        70,
                                        90,
                                        362,
                                        100
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                90,
                                                362,
                                                100
                                            ],
                                            "score": 1.0,
                                            "content": "sequence length, with masking. Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                109,
                                531,
                                223
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        109,
                                        531,
                                        223
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                109,
                                                531,
                                                223
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "3500ca56bcda62a0f3a1af9eedd21663b0c23a61f4b7b0978486e3c6bff97569.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        109,
                                        531,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        78,
                                        147.0,
                                        531,
                                        185.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        78,
                                        185.0,
                                        531,
                                        223.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        242,
                        539,
                        264
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                243,
                                538,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        243,
                                        538,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "Table 15: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                72,
                                253,
                                290,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        253,
                                        290,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "with dropout. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5.5,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        72,
                        243,
                        538,
                        264
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        85,
                        273,
                        523,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                85,
                                273,
                                523,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        85,
                                        273,
                                        523,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                85,
                                                273,
                                                523,
                                                387
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "7b7f0831a09ebafe7f0af1398f9a33569f06b9d425b2e915cc706d50b0396ea4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        85,
                                        273,
                                        523,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        85,
                                        311.0,
                                        523,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        85,
                                        349.0,
                                        523,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 8,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        406,
                        540,
                        428
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                406,
                                541,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        406,
                                        541,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Table 16: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                417,
                                291,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        291,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "with dropout. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        406,
                        541,
                        429
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        438,
                        528,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                438,
                                528,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        438,
                                        528,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                438,
                                                528,
                                                550
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "c8c4461bc78b19932d2bf9d2ba50b12cb9e91087eda60d82b07757a328970264.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        438,
                                        528,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        81,
                                        475.3333333333333,
                                        528,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        81,
                                        512.6666666666666,
                                        528,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        }
                    ],
                    "index": 13,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        75,
                        570,
                        538,
                        592
                    ],
                    "lines": [
                        {
                            "bbox": [
                                75,
                                571,
                                539,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        571,
                                        165,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "able 17: Forward pass",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        166,
                                        571,
                                        175,
                                        580
                                    ],
                                    "score": 0.55,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        571,
                                        539,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                75,
                                582,
                                361,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        582,
                                        361,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "equence length, with dropout. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 15.5,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        75,
                        571,
                        539,
                        592
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        601,
                        530,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                601,
                                530,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        601,
                                        530,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                601,
                                                530,
                                                714
                                            ],
                                            "score": 0.983,
                                            "type": "table",
                                            "image_path": "ffb58d66dd156a50519d916d96510dc1886e4df1581be16cfc20a48bf2bb48cb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        601,
                                        530,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        78,
                                        638.6666666666666,
                                        530,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        78,
                                        676.3333333333333,
                                        530,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        86,
                        110,
                        522,
                        222
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                78,
                                540,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        540,
                                        89
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                540,
                                                89
                                            ],
                                            "score": 1.0,
                                            "content": "Table 18: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        90,
                                        223,
                                        100
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                90,
                                                223,
                                                100
                                            ],
                                            "score": 1.0,
                                            "content": "Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                86,
                                110,
                                522,
                                222
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        522,
                                        222
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                86,
                                                110,
                                                522,
                                                222
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "217ffcb23b550dd368bb31675fee8171a3fd030813b015a5fc5d68263a917c26.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        522,
                                        147.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        86,
                                        147.33333333333334,
                                        522,
                                        184.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        86,
                                        184.66666666666669,
                                        522,
                                        222.00000000000003
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        273,
                        527,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                72,
                                242,
                                537,
                                264
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        243,
                                        537,
                                        254
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                243,
                                                537,
                                                254
                                            ],
                                            "score": 1.0,
                                            "content": "Table 19: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        254,
                                        223,
                                        264
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                254,
                                                223,
                                                264
                                            ],
                                            "score": 1.0,
                                            "content": "Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 5.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                273,
                                527,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        273,
                                        527,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                273,
                                                527,
                                                387
                                            ],
                                            "score": 0.985,
                                            "type": "table",
                                            "image_path": "807f96de54b9fb994f013950556a5a2fbc1732645ce327e60e94d6a990f6e0f6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        273,
                                        527,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        81,
                                        311.0,
                                        527,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        81,
                                        349.0,
                                        527,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 6.75
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        406,
                        539,
                        428
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                406,
                                540,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        406,
                                        165,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Table 20: Forward pass",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        166,
                                        407,
                                        175,
                                        416
                                    ],
                                    "score": 0.65,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        406,
                                        540,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                417,
                                294,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        417,
                                        294,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "sequence length. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        438,
                        531,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                438,
                                531,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        438,
                                        531,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                438,
                                                531,
                                                550
                                            ],
                                            "score": 0.983,
                                            "type": "table",
                                            "image_path": "3e3ca603bcf5c6ef13036985756097c0c59bb8b1d18b376b72b6c3d798c8f54d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        438,
                                        531,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        78,
                                        475.3333333333333,
                                        531,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        78,
                                        512.6666666666666,
                                        531,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        },
                        {
                            "type": "table_caption",
                            "bbox": [
                                74,
                                570,
                                536,
                                592
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        570,
                                        537,
                                        582
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                570,
                                                537,
                                                582
                                            ],
                                            "score": 1.0,
                                            "content": "Table 21: Memory usage (MB) of various exact/approximate/sparse attention mechanisms by sequence length. Bes",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        73,
                                        582,
                                        202,
                                        592
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                582,
                                                202,
                                                592
                                            ],
                                            "score": 1.0,
                                            "content": "in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                }
                            ],
                            "index": 15.5
                        }
                    ],
                    "index": 14.25
                },
                {
                    "type": "table",
                    "bbox": [
                        94,
                        601,
                        515,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                94,
                                601,
                                515,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        601,
                                        515,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                601,
                                                515,
                                                714
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "73d223cdf5f7edbc6b0c4fe544cf892ba116e6aaa5acba48191415ffca2641a8.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        94,
                                        601,
                                        515,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        94,
                                        638.6666666666666,
                                        515,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        94,
                                        676.3333333333333,
                                        515,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18
                }
            ],
            "layout_bboxes": [],
            "page_idx": 33,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        86,
                        110,
                        522,
                        222
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                78,
                                540,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        540,
                                        89
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                540,
                                                89
                                            ],
                                            "score": 1.0,
                                            "content": "Table 18: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        90,
                                        223,
                                        100
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                90,
                                                223,
                                                100
                                            ],
                                            "score": 1.0,
                                            "content": "Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                86,
                                110,
                                522,
                                222
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        522,
                                        222
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                86,
                                                110,
                                                522,
                                                222
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "217ffcb23b550dd368bb31675fee8171a3fd030813b015a5fc5d68263a917c26.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        522,
                                        147.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        86,
                                        147.33333333333334,
                                        522,
                                        184.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        86,
                                        184.66666666666669,
                                        522,
                                        222.00000000000003
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        273,
                        527,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                72,
                                242,
                                537,
                                264
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        243,
                                        537,
                                        254
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                243,
                                                537,
                                                254
                                            ],
                                            "score": 1.0,
                                            "content": "Table 19: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        254,
                                        223,
                                        264
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                254,
                                                223,
                                                264
                                            ],
                                            "score": 1.0,
                                            "content": "Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 5.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                273,
                                527,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        273,
                                        527,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                273,
                                                527,
                                                387
                                            ],
                                            "score": 0.985,
                                            "type": "table",
                                            "image_path": "807f96de54b9fb994f013950556a5a2fbc1732645ce327e60e94d6a990f6e0f6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        273,
                                        527,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        81,
                                        311.0,
                                        527,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        81,
                                        349.0,
                                        527,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 6.75
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        438,
                        531,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                438,
                                531,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        438,
                                        531,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                438,
                                                531,
                                                550
                                            ],
                                            "score": 0.983,
                                            "type": "table",
                                            "image_path": "3e3ca603bcf5c6ef13036985756097c0c59bb8b1d18b376b72b6c3d798c8f54d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        438,
                                        531,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        78,
                                        475.3333333333333,
                                        531,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        78,
                                        512.6666666666666,
                                        531,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        },
                        {
                            "type": "table_caption",
                            "bbox": [
                                74,
                                570,
                                536,
                                592
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        570,
                                        537,
                                        582
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                570,
                                                537,
                                                582
                                            ],
                                            "score": 1.0,
                                            "content": "Table 21: Memory usage (MB) of various exact/approximate/sparse attention mechanisms by sequence length. Bes",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        73,
                                        582,
                                        202,
                                        592
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                582,
                                                202,
                                                592
                                            ],
                                            "score": 1.0,
                                            "content": "in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                }
                            ],
                            "index": 15.5
                        }
                    ],
                    "index": 14.25
                },
                {
                    "type": "table",
                    "bbox": [
                        94,
                        601,
                        515,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                94,
                                601,
                                515,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        601,
                                        515,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                601,
                                                515,
                                                714
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "73d223cdf5f7edbc6b0c4fe544cf892ba116e6aaa5acba48191415ffca2641a8.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        94,
                                        601,
                                        515,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        94,
                                        638.6666666666666,
                                        515,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        94,
                                        676.3333333333333,
                                        515,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                741,
                                313,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        741,
                                        313,
                                        753
                                    ],
                                    "score": 1.0,
                                    "content": "34",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        86,
                        110,
                        522,
                        222
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                78,
                                540,
                                100
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        78,
                                        540,
                                        89
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                78,
                                                540,
                                                89
                                            ],
                                            "score": 1.0,
                                            "content": "Table 18: Forward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        90,
                                        223,
                                        100
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                90,
                                                223,
                                                100
                                            ],
                                            "score": 1.0,
                                            "content": "Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                }
                            ],
                            "index": 0.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                86,
                                110,
                                522,
                                222
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        522,
                                        222
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                86,
                                                110,
                                                522,
                                                222
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "217ffcb23b550dd368bb31675fee8171a3fd030813b015a5fc5d68263a917c26.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        86,
                                        110,
                                        522,
                                        147.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        86,
                                        147.33333333333334,
                                        522,
                                        184.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        86,
                                        184.66666666666669,
                                        522,
                                        222.00000000000003
                                    ],
                                    "spans": [],
                                    "index": 4
                                }
                            ]
                        }
                    ],
                    "index": 1.75,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        81,
                        273,
                        527,
                        387
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                72,
                                242,
                                537,
                                264
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        243,
                                        537,
                                        254
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                243,
                                                537,
                                                254
                                            ],
                                            "score": 1.0,
                                            "content": "Table 19: Backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by sequence length",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        254,
                                        223,
                                        264
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                254,
                                                223,
                                                264
                                            ],
                                            "score": 1.0,
                                            "content": "Best in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 5.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                81,
                                273,
                                527,
                                387
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        273,
                                        527,
                                        387
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                273,
                                                527,
                                                387
                                            ],
                                            "score": 0.985,
                                            "type": "table",
                                            "image_path": "807f96de54b9fb994f013950556a5a2fbc1732645ce327e60e94d6a990f6e0f6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        273,
                                        527,
                                        311.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        81,
                                        311.0,
                                        527,
                                        349.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        81,
                                        349.0,
                                        527,
                                        387.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                }
                            ]
                        }
                    ],
                    "index": 6.75,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        406,
                        539,
                        428
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                406,
                                540,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        406,
                                        165,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Table 20: Forward pass",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        166,
                                        407,
                                        175,
                                        416
                                    ],
                                    "score": 0.65,
                                    "content": "+",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        176,
                                        406,
                                        540,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": " backward pass runtime (ms) of various exact/approximate/sparse attention mechanisms by",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                417,
                                294,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        417,
                                        294,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "sequence length. Best in bold, second best underlined.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        406,
                        540,
                        428
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        78,
                        438,
                        531,
                        550
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                438,
                                531,
                                550
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        438,
                                        531,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                438,
                                                531,
                                                550
                                            ],
                                            "score": 0.983,
                                            "type": "table",
                                            "image_path": "3e3ca603bcf5c6ef13036985756097c0c59bb8b1d18b376b72b6c3d798c8f54d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        438,
                                        531,
                                        475.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        78,
                                        475.3333333333333,
                                        531,
                                        512.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        78,
                                        512.6666666666666,
                                        531,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                }
                            ]
                        },
                        {
                            "type": "table_caption",
                            "bbox": [
                                74,
                                570,
                                536,
                                592
                            ],
                            "group_id": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        570,
                                        537,
                                        582
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                570,
                                                537,
                                                582
                                            ],
                                            "score": 1.0,
                                            "content": "Table 21: Memory usage (MB) of various exact/approximate/sparse attention mechanisms by sequence length. Bes",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        73,
                                        582,
                                        202,
                                        592
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                582,
                                                202,
                                                592
                                            ],
                                            "score": 1.0,
                                            "content": "in bold, second best underlined.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                }
                            ],
                            "index": 15.5
                        }
                    ],
                    "index": 14.25,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        94,
                        601,
                        515,
                        714
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                94,
                                601,
                                515,
                                714
                            ],
                            "group_id": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        601,
                                        515,
                                        714
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                601,
                                                515,
                                                714
                                            ],
                                            "score": 0.984,
                                            "type": "table",
                                            "image_path": "73d223cdf5f7edbc6b0c4fe544cf892ba116e6aaa5acba48191415ffca2641a8.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        94,
                                        601,
                                        515,
                                        638.6666666666666
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        94,
                                        638.6666666666666,
                                        515,
                                        676.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        94,
                                        676.3333333333333,
                                        515,
                                        713.9999999999999
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 18,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        }
    ],
    "_parse_type": "txt",
    "_version_name": "1.3.2",
    "lang": "en"
}