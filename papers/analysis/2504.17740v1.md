# 2504.17740V1 - ËÆ∫ÊñáÊÄªÁªì



# Title and authors of the Paper  
Title: Embedding Empirical Distributions for Computing Optimal Transport Maps  
Authors: Mingchen Jiang, Peng Xu, Xichen Ye, Xiaohui Chen, Yun Yang, Yifan Chen  

# Main Goal and Fundamental Concept  
**Main Goal**: To efficiently compute optimal transport (OT) maps between multiple empirical distributions and a fixed target distribution, addressing the limitation of existing methods that require retraining from scratch for each new distribution pair.  

**Fundamental Concept**: The core idea is to learn embeddings of empirical distributions using a transformer, then use these embeddings to generate neural OT maps via hypernetworks. This allows generalizing to new distributions without retraining, enabling scalable computation of multiple OT maps.  

# Technical Approach  
The proposed framework, Hypernetworks for Optimal Transport with Embedding Transformers (HOTET), consists of three key modules:  
1. **Embedding Network (Transformer)**: Processes empirical distributions (variable-length samples) to produce fixed-dimensional embeddings. Transformers are chosen for their permutation invariance, ability to handle variable sizes, and universal approximation of set-to-set maps.  
2. **Hypernetworks (‚Ñ±, ùí¢)**: Generate parameters for Input Convex Neural Networks (ICNNs) that approximate the dual potentials of the OT problem. These potentials, when differentiated, yield the OT maps.  
3. **Base OT Solvers**: Use ICNNs to approximate dual potentials (œÜ, œà) via maximization-minimization (MM-B or MMv2 solvers). Loss from these solvers is aggregated across multiple source distributions and a fixed target during training, updating the embedding and hypernetworks.  

# Distinctive Features  
- **Transformer Embeddings**: Handle variable-length distributional data and permutations, unlike prior methods (e.g., CONDOT, Meta OT) that struggle with size mismatches.  
- **Hypernetwork-Generated OT Maps**: Avoids retraining for each new distribution pair by generating ICNN parameters from embeddings, enabling efficient multi-map computation.  
- **No Pre-Training**: Skips pre-training ICNNs (used in prior works) by initializing hypernetwork weights with small variance, leveraging residual connections in ICNNs to approximate identity maps.  

# Experimental Setup and Results  
**Experimental Design**:  
- **W2B Benchmark**: Evaluates OT maps on Gaussian mixtures using metrics like ‚Ñí¬≤-UVP (unexplained variance percentage) and cosine similarity.  
- **OT Map Prediction**: Trains on 500 Gaussian mixtures (reference ŒΩ) and tests on 100 unseen mixtures to assess generalization.  
- **Color Transfer**: Applies OT maps to transform color histograms of images (WikiArt dataset), testing one-to-one and many-to-one settings, including in-context learning with few fine-tuning steps.  
- **Ablation Study**: Removes the embedding module to validate its impact.  

**Key Results**:  
- HOTET matches direct OT solvers (MM-B, MMv2) in ‚Ñí¬≤-UVP (e.g., 2.2‚Äì4.5% for forward maps in 8D) and cosine similarity (0.96‚Äì0.98).  
- Outperforms Meta OT in high-dimensional OT prediction (e.g., 3.7% vs. 6.2% ‚Ñí¬≤-UVP for 64D forward maps).  
- Successfully transfers colors in images, with in-context learning (50 steps) achieving quality comparable to full training.  
- Ablation confirms embedding modules are critical (e.g., 3.7% vs. 6.5% ‚Ñí¬≤-UVP in 64D).  

# Advantages and Limitations  
**Advantages**:  
- Efficiently generates OT maps for new distributions without retraining.  
- Handles variable-sized distributions and provides useful embeddings for downstream tasks.  
- Competitive performance with state-of-the-art OT solvers.  

**Limitations**:  
- Challenges in many-to-many settings (multiple distribution pairs), requiring further exploration.  

# Conclusion  
HOTET introduces a transformer-based embedding and hypernetwork framework to efficiently compute OT maps across multiple empirical distributions. It outperforms baselines in generalization and scalability, with applications in color transfer and distributional data processing. Limitations lie in complex many-to-many scenarios, but the work provides a robust paradigm for scalable OT map computation.